/*! For license information please see main.31a6af38.js.LICENSE.txt */
(()=>{"use strict";var e={12(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("scale",[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]])},43(e,t,n){e.exports=n(202)},73(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},118(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},130(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]])},153(e,t,n){var r=n(43),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,s={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:s,_owner:a.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202(e,t){var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var x=b.prototype=new v;x.constructor=b,m(x,y.prototype),x.isPureReactComponent=!0;var w=Array.isArray,I=Object.prototype.hasOwnProperty,E={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,r){var i,s={},o=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)I.call(t,i)&&!N.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:E.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var _=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function k(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===s?"."+C(l,0):s,w(o)?(i="",null!=e&&(i=e.replace(_,"$&/")+"/"),k(o,t,i,"",function(e){return e})):null!=o&&(T(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(_,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",w(e))for(var c=0;c<e.length;c++){var u=s+C(a=e[c],c);l+=k(a,t,i,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=k(a=a.value,t,i,u=s+C(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,n){if(null==e)return e;var r=[],i=0;return k(e,r,"","",function(e){return t.call(n,e,i++)}),r}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},O={transition:null},L={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:O,ReactCurrentOwner:E};function M(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,n){A(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return A(e,function(){t++}),t},toArray:function(e){return A(e,function(e){return e})||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=o,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.act=M,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=E.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)I.call(t,c)&&!N.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=M,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},234(e,t){function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<i&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function w(e){if(g=!1,x(e),!m)if(null!==r(c))m=!0,O(I);else{var t=r(u);null!==t&&L(w,t.startTime-e)}}function I(e,n){m=!1,g&&(g=!1,v(T),T=-1),p=!0;var s=f;try{for(x(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!k());){var o=h.callback;if("function"===typeof o){h.callback=null,f=h.priorityLevel;var a=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?h.callback=a:h===r(c)&&i(c),x(n)}else i(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&L(w,d.startTime-n),l=!1}return l}finally{h=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,N=!1,S=null,T=-1,_=5,C=-1;function k(){return!(t.unstable_now()-C<_)}function A(){if(null!==S){var e=t.unstable_now();C=e;var n=!0;try{n=S(!0,e)}finally{n?E():(N=!1,S=null)}}else N=!1}if("function"===typeof b)E=function(){b(A)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,P=R.port2;R.port1.onmessage=A,E=function(){P.postMessage(null)}}else E=function(){y(A,0)};function O(e){S=e,N||(N=!0,E())}function L(e,n){T=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,O(I))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(g?(v(T),T=-1):g=!0,L(w,s-o))):(e.sortIndex=a,n(c,e),m||p||(m=!0,O(I))),e},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},382(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("brain",[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]])},391(e,t,n){var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},489(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},537(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},555(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function s(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}n.d(t,{A:()=>a})},579(e,t,n){e.exports=n(153)},629(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]])},730(e,t,n){var r=n(43),i=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,i,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),I=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),_=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=L&&e[L]||e["@@iterator"])?e:null}var j,D=Object.assign;function F(e){if(void 0===j)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);j=t&&t[1]||""}return"\n"+j+e}var q=!1;function U(e,t){if(!e||q)return"";q=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),s=r.stack.split("\n"),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||i[o]!==s[a]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{q=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function V(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case I:return"Portal";case S:return"Profiler";case N:return"StrictMode";case k:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case _:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case R:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return z(e(t))}catch(n){}}return null}function B(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(Xt){return e.body}}function Q(e,t){var n=t.checked;return D({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function $(e,t){X(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Y(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return D({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function se(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ye=D({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ie=null,Ee=null,Ne=null;function Se(e){if(e=xi(e)){if("function"!==typeof Ie)throw Error(s(280));var t=e.stateNode;t&&(t=Ii(t),Ie(e.stateNode,e.type,t))}}function Te(e){Ee?Ne?Ne.push(e):Ne=[e]:Ee=e}function _e(){if(Ee){var e=Ee,t=Ne;if(Ne=Ee=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ce(e,t){return e(t)}function ke(){}var Ae=!1;function Re(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Ce(e,t,n)}finally{Ae=!1,(null!==Ee||null!==Ne)&&(ke(),_e())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=Ii(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Oe=!1;if(u)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(ue){Oe=!1}function Me(e,t,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var je=!1,De=null,Fe=!1,qe=null,Ue={onError:function(e){je=!0,De=e}};function Ve(e,t,n,r,i,s,o,a,l){je=!1,De=null,Me.apply(Ue,arguments)}function ze(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Be(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(ze(e)!==e)throw Error(s(188))}function Ge(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=ze(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return He(i),e;if(o===r)return He(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e),null!==e?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var Ke=i.unstable_scheduleCallback,Ye=i.unstable_cancelCallback,Qe=i.unstable_shouldYield,Je=i.unstable_requestPaint,Xe=i.unstable_now,$e=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~i;0!==a?r=dt(a):0!==(s&=o)&&(r=dt(s))}else 0!==(o=n&~i)?r=dt(o):0!==s&&(r=dt(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,It,Et,Nt,St,Tt=!1,_t=[],Ct=null,kt=null,At=null,Rt=new Map,Pt=new Map,Ot=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":kt=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Rt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function jt(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=xi(t))&&It(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Dt(e){var t=bi(e.target);if(null!==t){var n=ze(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Be(n)))return e.blockedOn=t,void St(e.priority,function(){Et(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=xi(n))&&It(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function qt(e,t,n){Ft(e)&&n.delete(t)}function Ut(){Tt=!1,null!==Ct&&Ft(Ct)&&(Ct=null),null!==kt&&Ft(kt)&&(kt=null),null!==At&&Ft(At)&&(At=null),Rt.forEach(qt),Pt.forEach(qt)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ut)))}function zt(e){function t(t){return Vt(t,e)}if(0<_t.length){Vt(_t[0],e);for(var n=1;n<_t.length;n++){var r=_t[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Ct&&Vt(Ct,e),null!==kt&&Vt(kt,e),null!==At&&Vt(At,e),Rt.forEach(t),Pt.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)Dt(n),null===n.blockedOn&&Ot.shift()}var Bt=x.ReactCurrentBatchConfig,Ht=!0;function Gt(e,t,n,r){var i=bt,s=Bt.transition;Bt.transition=null;try{bt=1,Kt(e,t,n,r)}finally{bt=i,Bt.transition=s}}function Wt(e,t,n,r){var i=bt,s=Bt.transition;Bt.transition=null;try{bt=4,Kt(e,t,n,r)}finally{bt=i,Bt.transition=s}}function Kt(e,t,n,r){if(Ht){var i=Qt(e,t,n,r);if(null===i)Gr(e,t,r,Yt,n),Mt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Ct=jt(Ct,e,t,n,r,i),!0;case"dragenter":return kt=jt(kt,e,t,n,r,i),!0;case"mouseover":return At=jt(At,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Rt.set(s,jt(Rt.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Pt.set(s,jt(Pt.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Lt.indexOf(e)){for(;null!==i;){var s=xi(i);if(null!==s&&wt(s),null===(s=Qt(e,t,n,r))&&Gr(e,t,r,Yt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else Gr(e,t,r,null,n)}}var Yt=null;function Qt(e,t,n,r){if(Yt=null,null!==(e=bi(e=we(r))))if(null===(t=ze(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Be(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var $t=null,Zt=null,en=null;function tn(){if(en)return en;var e,t,n=Zt,r=n.length,i="value"in $t?$t.value:$t.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[s-t];t++);return en=i.slice(e,1<t?1-t:void 0)}function nn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rn(){return!0}function sn(){return!1}function on(e){function t(t,n,r,i,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?rn:sn,this.isPropagationStopped=sn,this}return D(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rn)},persist:function(){},isPersistent:rn}),t}var an,ln,cn,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=on(un),hn=D({},un,{view:0,detail:0}),fn=on(hn),pn=D({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cn&&(cn&&"mousemove"===e.type?(an=e.screenX-cn.screenX,ln=e.screenY-cn.screenY):ln=an=0,cn=e),an)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),mn=on(pn),gn=on(D({},pn,{dataTransfer:0})),yn=on(D({},hn,{relatedTarget:0})),vn=on(D({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=D({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xn=on(bn),wn=on(D({},un,{data:0})),In={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Nn[e])&&!!t[e]}function Tn(){return Sn}var _n=D({},hn,{key:function(e){if(e.key){var t=In[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=nn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?En[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tn,charCode:function(e){return"keypress"===e.type?nn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?nn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cn=on(_n),kn=on(D({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=on(D({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tn})),Rn=on(D({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=D({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),On=on(Pn),Ln=[9,13,27,32],Mn=u&&"CompositionEvent"in window,jn=null;u&&"documentMode"in document&&(jn=document.documentMode);var Dn=u&&"TextEvent"in window&&!jn,Fn=u&&(!Mn||jn&&8<jn&&11>=jn),qn=String.fromCharCode(32),Un=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Ln.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function Wn(e,t,n,r){Te(r),0<(t=Kr(t,"onChange")).length&&(n=new dn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Kn=null,Yn=null;function Qn(e){qr(e,0)}function Jn(e){if(K(wi(e)))return e}function Xn(e,t){if("change"===e)return t}var $n=!1;if(u){var Zn;if(u){var er="oninput"in document;if(!er){var tr=document.createElement("div");tr.setAttribute("oninput","return;"),er="function"===typeof tr.oninput}Zn=er}else Zn=!1;$n=Zn&&(!document.documentMode||9<document.documentMode)}function nr(){Kn&&(Kn.detachEvent("onpropertychange",rr),Yn=Kn=null)}function rr(e){if("value"===e.propertyName&&Jn(Yn)){var t=[];Wn(t,Yn,e,we(e)),Re(Qn,t)}}function ir(e,t,n){"focusin"===e?(nr(),Yn=n,(Kn=t).attachEvent("onpropertychange",rr)):"focusout"===e&&nr()}function sr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(Yn)}function or(e,t){if("click"===e)return Jn(t)}function ar(e,t){if("input"===e||"change"===e)return Jn(t)}var lr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cr(e,t){if(lr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!lr(e[i],t[i]))return!1}return!0}function ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=ur(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ur(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fr(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Y((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mr(e){var t=fr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=dr(n,s);var o=dr(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gr=u&&"documentMode"in document&&11>=document.documentMode,yr=null,vr=null,br=null,xr=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;xr||null==yr||yr!==Y(r)||("selectionStart"in(r=yr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},br&&cr(br,r)||(br=r,0<(r=Kr(vr,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=yr)))}function Ir(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Er={animationend:Ir("Animation","AnimationEnd"),animationiteration:Ir("Animation","AnimationIteration"),animationstart:Ir("Animation","AnimationStart"),transitionend:Ir("Transition","TransitionEnd")},Nr={},Sr={};function Tr(e){if(Nr[e])return Nr[e];if(!Er[e])return e;var t,n=Er[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return Nr[e]=n[t];return e}u&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete Er.animationend.animation,delete Er.animationiteration.animation,delete Er.animationstart.animation),"TransitionEvent"in window||delete Er.transitionend.transition);var _r=Tr("animationend"),Cr=Tr("animationiteration"),kr=Tr("animationstart"),Ar=Tr("transitionend"),Rr=new Map,Pr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Or(e,t){Rr.set(e,t),l(t,[e])}for(var Lr=0;Lr<Pr.length;Lr++){var Mr=Pr[Lr];Or(Mr.toLowerCase(),"on"+(Mr[0].toUpperCase()+Mr.slice(1)))}Or(_r,"onAnimationEnd"),Or(Cr,"onAnimationIteration"),Or(kr,"onAnimationStart"),Or("dblclick","onDoubleClick"),Or("focusin","onFocus"),Or("focusout","onBlur"),Or(Ar,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dr=new Set("cancel close invalid load scroll toggle".split(" ").concat(jr));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,a,l,c){if(Ve.apply(this,arguments),je){if(!je)throw Error(s(198));var u=De;je=!1,De=null,Fe||(Fe=!0,qe=u)}}(r,t,void 0,e),e.currentTarget=null}function qr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Fr(i,a,c),s=l}else for(o=0;o<r.length;o++){if(l=(a=r[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Fr(i,a,c),s=l}}}if(Fe)throw e=qe,Fe=!1,qe=null,e}function Ur(e,t){var n=t[gi];void 0===n&&(n=t[gi]=new Set);var r=e+"__bubble";n.has(r)||(Hr(t,e,2,!1),n.add(r))}function Vr(e,t,n){var r=0;t&&(r|=4),Hr(n,e,r,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[zr]){e[zr]=!0,o.forEach(function(t){"selectionchange"!==t&&(Dr.has(t)||Vr(t,!1,e),Vr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zr]||(t[zr]=!0,Vr("selectionchange",!1,t))}}function Hr(e,t,n,r){switch(Jt(t)){case 1:var i=Gt;break;case 4:i=Wt;break;default:i=Kt}n=i.bind(null,t,n,e),i=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Gr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==a;){if(null===(o=bi(a)))return;if(5===(l=o.tag)||6===l){r=s=o;continue e}a=a.parentNode}}r=r.return}Re(function(){var r=s,i=we(n),o=[];e:{var a=Rr.get(e);if(void 0!==a){var l=dn,c=e;switch(e){case"keypress":if(0===nn(n))break e;case"keydown":case"keyup":l=Cn;break;case"focusin":c="focus",l=yn;break;case"focusout":c="blur",l=yn;break;case"beforeblur":case"afterblur":l=yn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=An;break;case _r:case Cr:case kr:l=vn;break;case Ar:l=Rn;break;case"scroll":l=fn;break;case"wheel":l=On;break;case"copy":case"cut":case"paste":l=xn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=kn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==h&&(null!=(m=Pe(p,h))&&u.push(Wr(p,m,f)))),d)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,i),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!bi(c)&&!c[mi])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?bi(c):null)&&(c!==(d=ze(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=mn,m="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=kn,m="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?a:wi(l),f=null==c?a:wi(c),(a=new u(m,p+"leave",l,n,i)).target=d,a.relatedTarget=f,m=null,bi(i)===r&&((u=new u(h,p+"enter",c,n,i)).target=f,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,p=0,f=u=l;f;f=Yr(f))p++;for(f=0,m=h;m;m=Yr(m))f++;for(;0<p-f;)u=Yr(u),p--;for(;0<f-p;)h=Yr(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Yr(u),h=Yr(h)}u=null}else u=null;null!==l&&Qr(o,a,l,u,!1),null!==c&&null!==d&&Qr(o,d,c,u,!0)}if("select"===(l=(a=r?wi(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Xn;else if(Gn(a))if($n)g=ar;else{g=sr;var y=ir}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=or);switch(g&&(g=g(e,r))?Wn(o,g,n,i):(y&&y(e,a,r),"focusout"===e&&(y=a._wrapperState)&&y.controlled&&"number"===a.type&&ee(a,"number",a.value)),y=r?wi(r):window,e){case"focusin":(Gn(y)||"true"===y.contentEditable)&&(yr=y,vr=r,br=null);break;case"focusout":br=vr=yr=null;break;case"mousedown":xr=!0;break;case"contextmenu":case"mouseup":case"dragend":xr=!1,wr(o,n,i);break;case"selectionchange":if(gr)break;case"keydown":case"keyup":wr(o,n,i)}var v;if(Mn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Bn?Vn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Fn&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Bn&&(v=tn()):(Zt="value"in($t=i)?$t.value:$t.textContent,Bn=!0)),0<(y=Kr(r,b)).length&&(b=new wn(b,e,null,n,i),o.push({event:b,listeners:y}),v?b.data=v:null!==(v=zn(n))&&(b.data=v))),(v=Dn?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Un=!0,qn);case"textInput":return(e=t.data)===qn&&Un?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!Mn&&Vn(e,t)?(e=tn(),en=Zt=$t=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Kr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=v))}qr(o,t)})}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Kr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=Pe(e,n))&&r.unshift(Wr(e,s,i)),null!=(s=Pe(e,t))&&r.push(Wr(e,s,i))),e=e.return}return r}function Yr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,i){for(var s=t._reactName,o=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==c&&(a=c,i?null!=(l=Pe(n,s))&&o.unshift(Wr(n,l,a)):i||null!=(l=Pe(n,s))&&o.push(Wr(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Jr=/\r\n?/g,Xr=/\u0000|\uFFFD/g;function $r(e){return("string"===typeof e?e:""+e).replace(Jr,"\n").replace(Xr,"")}function Zr(e,t,n){if(t=$r(t),$r(e)!==t&&n)throw Error(s(425))}function ei(){}var ti=null,ni=null;function ri(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ii="function"===typeof setTimeout?setTimeout:void 0,si="function"===typeof clearTimeout?clearTimeout:void 0,oi="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oi?function(e){return oi.resolve(null).then(e).catch(li)}:ii;function li(e){setTimeout(function(){throw e})}function ci(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void zt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);zt(t)}function ui(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function di(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),fi="__reactFiber$"+hi,pi="__reactProps$"+hi,mi="__reactContainer$"+hi,gi="__reactEvents$"+hi,yi="__reactListeners$"+hi,vi="__reactHandles$"+hi;function bi(e){var t=e[fi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[mi]||n[fi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=di(e);null!==e;){if(n=e[fi])return n;e=di(e)}return t}n=(e=n).parentNode}return null}function xi(e){return!(e=e[fi]||e[mi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function Ii(e){return e[pi]||null}var Ei=[],Ni=-1;function Si(e){return{current:e}}function Ti(e){0>Ni||(e.current=Ei[Ni],Ei[Ni]=null,Ni--)}function _i(e,t){Ni++,Ei[Ni]=e.current,e.current=t}var Ci={},ki=Si(Ci),Ai=Si(!1),Ri=Ci;function Pi(e,t){var n=e.type.contextTypes;if(!n)return Ci;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Oi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Li(){Ti(Ai),Ti(ki)}function Mi(e,t,n){if(ki.current!==Ci)throw Error(s(168));_i(ki,t),_i(Ai,n)}function ji(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,B(e)||"Unknown",i));return D({},n,r)}function Di(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ci,Ri=ki.current,_i(ki,e),_i(Ai,Ai.current),!0}function Fi(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=ji(e,t,Ri),r.__reactInternalMemoizedMergedChildContext=e,Ti(Ai),Ti(ki),_i(ki,e)):Ti(Ai),_i(Ai,n)}var qi=null,Ui=!1,Vi=!1;function zi(e){null===qi?qi=[e]:qi.push(e)}function Bi(){if(!Vi&&null!==qi){Vi=!0;var e=0,t=bt;try{var n=qi;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}qi=null,Ui=!1}catch(i){throw null!==qi&&(qi=qi.slice(e+1)),Ke(Ze,Bi),i}finally{bt=t,Vi=!1}}return null}var Hi=[],Gi=0,Wi=null,Ki=0,Yi=[],Qi=0,Ji=null,Xi=1,$i="";function Zi(e,t){Hi[Gi++]=Ki,Hi[Gi++]=Wi,Wi=e,Ki=t}function es(e,t,n){Yi[Qi++]=Xi,Yi[Qi++]=$i,Yi[Qi++]=Ji,Ji=e;var r=Xi;e=$i;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var s=32-ot(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Xi=1<<32-ot(t)+i|n<<i|r,$i=s+e}else Xi=1<<s|n<<i|r,$i=e}function ts(e){null!==e.return&&(Zi(e,1),es(e,1,0))}function ns(e){for(;e===Wi;)Wi=Hi[--Gi],Hi[Gi]=null,Ki=Hi[--Gi],Hi[Gi]=null;for(;e===Ji;)Ji=Yi[--Qi],Yi[Qi]=null,$i=Yi[--Qi],Yi[Qi]=null,Xi=Yi[--Qi],Yi[Qi]=null}var rs=null,is=null,ss=!1,os=null;function as(e,t){var n=Rc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ls(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,rs=e,is=ui(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,rs=e,is=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ji?{id:Xi,overflow:$i}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Rc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,rs=e,is=null,!0);default:return!1}}function cs(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function us(e){if(ss){var t=is;if(t){var n=t;if(!ls(e,t)){if(cs(e))throw Error(s(418));t=ui(n.nextSibling);var r=rs;t&&ls(e,t)?as(r,n):(e.flags=-4097&e.flags|2,ss=!1,rs=e)}}else{if(cs(e))throw Error(s(418));e.flags=-4097&e.flags|2,ss=!1,rs=e}}}function ds(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;rs=e}function hs(e){if(e!==rs)return!1;if(!ss)return ds(e),ss=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ri(e.type,e.memoizedProps)),t&&(t=is)){if(cs(e))throw fs(),Error(s(418));for(;t;)as(e,t),t=ui(t.nextSibling)}if(ds(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){is=ui(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}is=null}}else is=rs?ui(e.stateNode.nextSibling):null;return!0}function fs(){for(var e=is;e;)e=ui(e.nextSibling)}function ps(){is=rs=null,ss=!1}function ms(e){null===os?os=[e]:os.push(e)}var gs=x.ReactCurrentBatchConfig;function ys(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function vs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bs(e){return(0,e._init)(e._payload)}function xs(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Oc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Dc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===E?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===P&&bs(s)===t.type)?((r=i(t,n.props)).ref=ys(e,t,n),r.return=e,r):((r=Lc(n.type,n.key,n.props,null,e.mode,r)).ref=ys(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,s){return null===t||7!==t.tag?((t=Mc(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Dc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Lc(t.type,t.key,t.props,null,e.mode,n)).ref=ys(e,null,t),n.return=e,n;case I:return(t=Fc(t,e.mode,n)).return=e,t;case P:return h(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=Mc(t,e.mode,n,null)).return=e,t;vs(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?c(e,t,n,r):null;case I:return n.key===i?u(e,t,n,r):null;case P:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||M(n))return null!==i?null:d(e,t,n,r,null);vs(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case I:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case P:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||M(r))return d(t,e=e.get(n)||null,r,i,null);vs(t,r)}return null}function m(i,s,a,l){for(var c=null,u=null,d=s,m=s=0,g=null;null!==d&&m<a.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var y=f(i,d,a[m],l);if(null===y){null===d&&(d=g);break}e&&d&&null===y.alternate&&t(i,d),s=o(y,s,m),null===u?c=y:u.sibling=y,u=y,d=g}if(m===a.length)return n(i,d),ss&&Zi(i,m),c;if(null===d){for(;m<a.length;m++)null!==(d=h(i,a[m],l))&&(s=o(d,s,m),null===u?c=d:u.sibling=d,u=d);return ss&&Zi(i,m),c}for(d=r(i,d);m<a.length;m++)null!==(g=p(d,i,m,a[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),s=o(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(i,e)}),ss&&Zi(i,m),c}function g(i,a,l,c){var u=M(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var d=u=null,m=a,g=a=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var b=f(i,m,v.value,c);if(null===b){null===m&&(m=y);break}e&&m&&null===b.alternate&&t(i,m),a=o(b,a,g),null===d?u=b:d.sibling=b,d=b,m=y}if(v.done)return n(i,m),ss&&Zi(i,g),u;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=h(i,v.value,c))&&(a=o(v,a,g),null===d?u=v:d.sibling=v,d=v);return ss&&Zi(i,g),u}for(m=r(i,m);!v.done;g++,v=l.next())null!==(v=p(m,i,g,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),a=o(v,a,g),null===d?u=v:d.sibling=v,d=v);return e&&m.forEach(function(e){return t(i,e)}),ss&&Zi(i,g),u}return function e(r,s,o,l){if("object"===typeof o&&null!==o&&o.type===E&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var c=o.key,u=s;null!==u;){if(u.key===c){if((c=o.type)===E){if(7===u.tag){n(r,u.sibling),(s=i(u,o.props.children)).return=r,r=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&bs(c)===u.type){n(r,u.sibling),(s=i(u,o.props)).ref=ys(r,u,o),s.return=r,r=s;break e}n(r,u);break}t(r,u),u=u.sibling}o.type===E?((s=Mc(o.props.children,r.mode,l,o.key)).return=r,r=s):((l=Lc(o.type,o.key,o.props,null,r.mode,l)).ref=ys(r,s,o),l.return=r,r=l)}return a(r);case I:e:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(r,s.sibling),(s=i(s,o.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Fc(o,r.mode,l)).return=r,r=s}return a(r);case P:return e(r,s,(u=o._init)(o._payload),l)}if(te(o))return m(r,s,o,l);if(M(o))return g(r,s,o,l);vs(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,o)).return=r,r=s):(n(r,s),(s=Dc(o,r.mode,l)).return=r,r=s),a(r)):n(r,s)}}var ws=xs(!0),Is=xs(!1),Es=Si(null),Ns=null,Ss=null,Ts=null;function _s(){Ts=Ss=Ns=null}function Cs(e){var t=Es.current;Ti(Es),e._currentValue=t}function ks(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function As(e,t){Ns=e,Ts=Ss=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xa=!0),e.firstContext=null)}function Rs(e){var t=e._currentValue;if(Ts!==e)if(e={context:e,memoizedValue:t,next:null},null===Ss){if(null===Ns)throw Error(s(308));Ss=e,Ns.dependencies={lanes:0,firstContext:e}}else Ss=Ss.next=e;return t}var Ps=null;function Os(e){null===Ps?Ps=[e]:Ps.push(e)}function Ls(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Os(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ms(e,r)}function Ms(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var js=!1;function Ds(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Us(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Cl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ms(e,n)}return null===(i=r.interleaved)?(t.next=t,Os(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ms(e,n)}function Vs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function zs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Bs(e,t,n,r){var i=e.updateQueue;js=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=i.baseState;for(o=0,u=c=l=null,a=s;;){var h=a.lane,f=a.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,m=a;switch(h=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=m.payload)?p.call(f,d,h):p)||void 0===h)break e;d=D({},d,h);break e;case 2:js=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,o|=h;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(h=a).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);jl|=o,e.lanes=o,e.memoizedState=d}}function Hs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var Gs={},Ws=Si(Gs),Ks=Si(Gs),Ys=Si(Gs);function Qs(e){if(e===Gs)throw Error(s(174));return e}function Js(e,t){switch(_i(Ys,t),_i(Ks,e),_i(Ws,Gs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ti(Ws),_i(Ws,t)}function Xs(){Ti(Ws),Ti(Ks),Ti(Ys)}function $s(e){Qs(Ys.current);var t=Qs(Ws.current),n=le(t,e.type);t!==n&&(_i(Ks,e),_i(Ws,n))}function Zs(e){Ks.current===e&&(Ti(Ws),Ti(Ks))}var eo=Si(0);function to(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var no=[];function ro(){for(var e=0;e<no.length;e++)no[e]._workInProgressVersionPrimary=null;no.length=0}var io=x.ReactCurrentDispatcher,so=x.ReactCurrentBatchConfig,oo=0,ao=null,lo=null,co=null,uo=!1,ho=!1,fo=0,po=0;function mo(){throw Error(s(321))}function go(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!lr(e[n],t[n]))return!1;return!0}function yo(e,t,n,r,i,o){if(oo=o,ao=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,io.current=null===e||null===e.memoizedState?ea:ta,e=n(r,i),ho){o=0;do{if(ho=!1,fo=0,25<=o)throw Error(s(301));o+=1,co=lo=null,t.updateQueue=null,io.current=na,e=n(r,i)}while(ho)}if(io.current=Zo,t=null!==lo&&null!==lo.next,oo=0,co=lo=ao=null,uo=!1,t)throw Error(s(300));return e}function vo(){var e=0!==fo;return fo=0,e}function bo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===co?ao.memoizedState=co=e:co=co.next=e,co}function xo(){if(null===lo){var e=ao.alternate;e=null!==e?e.memoizedState:null}else e=lo.next;var t=null===co?ao.memoizedState:co.next;if(null!==t)co=t,lo=e;else{if(null===e)throw Error(s(310));e={memoizedState:(lo=e).memoizedState,baseState:lo.baseState,baseQueue:lo.baseQueue,queue:lo.queue,next:null},null===co?ao.memoizedState=co=e:co=co.next=e}return co}function wo(e,t){return"function"===typeof t?t(e):t}function Io(e){var t=xo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=lo,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=a=null,c=null,u=o;do{var d=u.lane;if((oo&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,a=r):c=c.next=h,ao.lanes|=d,jl|=d}u=u.next}while(null!==u&&u!==o);null===c?a=r:c.next=l,lr(r,t.memoizedState)||(xa=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,ao.lanes|=o,jl|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Eo(e){var t=xo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);lr(o,t.memoizedState)||(xa=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function No(){}function So(e,t){var n=ao,r=xo(),i=t(),o=!lr(r.memoizedState,i);if(o&&(r.memoizedState=i,xa=!0),r=r.queue,Do(Co.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==co&&1&co.memoizedState.tag){if(n.flags|=2048,Po(9,_o.bind(null,n,r,i,t),void 0,null),null===kl)throw Error(s(349));0!==(30&oo)||To(n,t,i)}return i}function To(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ao.updateQueue)?(t={lastEffect:null,stores:null},ao.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function _o(e,t,n,r){t.value=n,t.getSnapshot=r,ko(t)&&Ao(e)}function Co(e,t,n){return n(function(){ko(t)&&Ao(e)})}function ko(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!lr(e,n)}catch(r){return!0}}function Ao(e){var t=Ms(e,1);null!==t&&nc(t,e,1,-1)}function Ro(e){var t=bo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wo,lastRenderedState:e},t.queue=e,e=e.dispatch=Qo.bind(null,ao,e),[t.memoizedState,e]}function Po(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ao.updateQueue)?(t={lastEffect:null,stores:null},ao.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Oo(){return xo().memoizedState}function Lo(e,t,n,r){var i=bo();ao.flags|=e,i.memoizedState=Po(1|t,n,void 0,void 0===r?null:r)}function Mo(e,t,n,r){var i=xo();r=void 0===r?null:r;var s=void 0;if(null!==lo){var o=lo.memoizedState;if(s=o.destroy,null!==r&&go(r,o.deps))return void(i.memoizedState=Po(t,n,s,r))}ao.flags|=e,i.memoizedState=Po(1|t,n,s,r)}function jo(e,t){return Lo(8390656,8,e,t)}function Do(e,t){return Mo(2048,8,e,t)}function Fo(e,t){return Mo(4,2,e,t)}function qo(e,t){return Mo(4,4,e,t)}function Uo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Vo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Mo(4,4,Uo.bind(null,t,e),n)}function zo(){}function Bo(e,t){var n=xo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&go(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ho(e,t){var n=xo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&go(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Go(e,t,n){return 0===(21&oo)?(e.baseState&&(e.baseState=!1,xa=!0),e.memoizedState=n):(lr(n,t)||(n=mt(),ao.lanes|=n,jl|=n,e.baseState=!0),t)}function Wo(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=so.transition;so.transition={};try{e(!1),t()}finally{bt=n,so.transition=r}}function Ko(){return xo().memoizedState}function Yo(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Jo(e))Xo(t,n);else if(null!==(n=Ls(e,t,n,r))){nc(n,e,r,ec()),$o(n,t,r)}}function Qo(e,t,n){var r=tc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Jo(e))Xo(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,lr(a,o)){var l=t.interleaved;return null===l?(i.next=i,Os(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Ls(e,t,i,r))&&(nc(n,e,r,i=ec()),$o(n,t,r))}}function Jo(e){var t=e.alternate;return e===ao||null!==t&&t===ao}function Xo(e,t){ho=uo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function $o(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Zo={readContext:Rs,useCallback:mo,useContext:mo,useEffect:mo,useImperativeHandle:mo,useInsertionEffect:mo,useLayoutEffect:mo,useMemo:mo,useReducer:mo,useRef:mo,useState:mo,useDebugValue:mo,useDeferredValue:mo,useTransition:mo,useMutableSource:mo,useSyncExternalStore:mo,useId:mo,unstable_isNewReconciler:!1},ea={readContext:Rs,useCallback:function(e,t){return bo().memoizedState=[e,void 0===t?null:t],e},useContext:Rs,useEffect:jo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Lo(4194308,4,Uo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Lo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Lo(4,2,e,t)},useMemo:function(e,t){var n=bo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=bo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Yo.bind(null,ao,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},bo().memoizedState=e},useState:Ro,useDebugValue:zo,useDeferredValue:function(e){return bo().memoizedState=e},useTransition:function(){var e=Ro(!1),t=e[0];return e=Wo.bind(null,e[1]),bo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ao,i=bo();if(ss){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===kl)throw Error(s(349));0!==(30&oo)||To(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,jo(Co.bind(null,r,o,e),[e]),r.flags|=2048,Po(9,_o.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=bo(),t=kl.identifierPrefix;if(ss){var n=$i;t=":"+t+"R"+(n=(Xi&~(1<<32-ot(Xi)-1)).toString(32)+n),0<(n=fo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=po++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ta={readContext:Rs,useCallback:Bo,useContext:Rs,useEffect:Do,useImperativeHandle:Vo,useInsertionEffect:Fo,useLayoutEffect:qo,useMemo:Ho,useReducer:Io,useRef:Oo,useState:function(){return Io(wo)},useDebugValue:zo,useDeferredValue:function(e){return Go(xo(),lo.memoizedState,e)},useTransition:function(){return[Io(wo)[0],xo().memoizedState]},useMutableSource:No,useSyncExternalStore:So,useId:Ko,unstable_isNewReconciler:!1},na={readContext:Rs,useCallback:Bo,useContext:Rs,useEffect:Do,useImperativeHandle:Vo,useInsertionEffect:Fo,useLayoutEffect:qo,useMemo:Ho,useReducer:Eo,useRef:Oo,useState:function(){return Eo(wo)},useDebugValue:zo,useDeferredValue:function(e){var t=xo();return null===lo?t.memoizedState=e:Go(t,lo.memoizedState,e)},useTransition:function(){return[Eo(wo)[0],xo().memoizedState]},useMutableSource:No,useSyncExternalStore:So,useId:Ko,unstable_isNewReconciler:!1};function ra(e,t){if(e&&e.defaultProps){for(var n in t=D({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ia(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:D({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var sa={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),s=qs(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,i))&&(nc(t,e,i,r),Vs(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),s=qs(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,i))&&(nc(t,e,i,r),Vs(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),i=qs(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Us(e,i,r))&&(nc(t,e,r,n),Vs(t,e,r))}};function oa(e,t,n,r,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!cr(n,r)||!cr(i,s))}function aa(e,t,n){var r=!1,i=Ci,s=t.contextType;return"object"===typeof s&&null!==s?s=Rs(s):(i=Oi(t)?Ri:ki.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Pi(e,i):Ci),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=sa,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function la(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&sa.enqueueReplaceState(t,t.state,null)}function ca(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Ds(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=Rs(s):(s=Oi(t)?Ri:ki.current,i.context=Pi(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ia(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&sa.enqueueReplaceState(i,i.state,null),Bs(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function ua(e,t){try{var n="",r=t;do{n+=V(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function da(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ha(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var fa="function"===typeof WeakMap?WeakMap:Map;function pa(e,t,n){(n=qs(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hl||(Hl=!0,Gl=r),ha(0,t)},n}function ma(e,t,n){(n=qs(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ha(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){ha(0,t),"function"!==typeof r&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ga(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new fa;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Sc.bind(null,e,t,n),t.then(e,e))}function ya(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function va(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=qs(-1,1)).tag=2,Us(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ba=x.ReactCurrentOwner,xa=!1;function wa(e,t,n,r){t.child=null===e?Is(t,null,n,r):ws(t,e.child,n,r)}function Ia(e,t,n,r,i){n=n.render;var s=t.ref;return As(t,i),r=yo(e,t,n,r,s,i),n=vo(),null===e||xa?(ss&&n&&ts(t),t.flags|=1,wa(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ha(e,t,i))}function Ea(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Pc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Lc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Na(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:cr)(o,r)&&e.ref===t.ref)return Ha(e,t,i)}return t.flags|=1,(e=Oc(s,r)).ref=t.ref,e.return=t,t.child=e}function Na(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(cr(s,r)&&e.ref===t.ref){if(xa=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,Ha(e,t,i);0!==(131072&e.flags)&&(xa=!0)}}return _a(e,t,n,r,i)}function Sa(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},_i(Ol,Pl),Pl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,_i(Ol,Pl),Pl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,_i(Ol,Pl),Pl|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,_i(Ol,Pl),Pl|=r;return wa(e,t,i,n),t.child}function Ta(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function _a(e,t,n,r,i){var s=Oi(n)?Ri:ki.current;return s=Pi(t,s),As(t,i),n=yo(e,t,n,r,s,i),r=vo(),null===e||xa?(ss&&r&&ts(t),t.flags|=1,wa(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ha(e,t,i))}function Ca(e,t,n,r,i){if(Oi(n)){var s=!0;Di(t)}else s=!1;if(As(t,i),null===t.stateNode)Ba(e,t),aa(t,n,r),ca(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Rs(c):c=Pi(t,c=Oi(n)?Ri:ki.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;d||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==r||l!==c)&&la(t,o,r,c),js=!1;var h=t.memoizedState;o.state=h,Bs(t,r,o,i),l=t.memoizedState,a!==r||h!==l||Ai.current||js?("function"===typeof u&&(ia(t,n,u,r),l=t.memoizedState),(a=js||oa(t,n,a,r,h,l,c))?(d||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Fs(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:ra(t.type,a),o.props=c,d=t.pendingProps,h=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Rs(l):l=Pi(t,l=Oi(n)?Ri:ki.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==d||h!==l)&&la(t,o,r,l),js=!1,h=t.memoizedState,o.state=h,Bs(t,r,o,i);var p=t.memoizedState;a!==d||h!==p||Ai.current||js?("function"===typeof f&&(ia(t,n,f,r),p=t.memoizedState),(c=js||oa(t,n,c,r,h,p,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return ka(e,t,n,r,s,i)}function ka(e,t,n,r,i,s){Ta(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Fi(t,n,!1),Ha(e,t,s);r=t.stateNode,ba.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=ws(t,e.child,null,s),t.child=ws(t,null,a,s)):wa(e,t,a,s),t.memoizedState=r.state,i&&Fi(t,n,!0),t.child}function Aa(e){var t=e.stateNode;t.pendingContext?Mi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Mi(0,t.context,!1),Js(e,t.containerInfo)}function Ra(e,t,n,r,i){return ps(),ms(i),t.flags|=256,wa(e,t,n,r),t.child}var Pa,Oa,La,Ma={dehydrated:null,treeContext:null,retryLane:0};function ja(e){return{baseLanes:e,cachePool:null,transitions:null}}function Da(e,t,n){var r,i=t.pendingProps,o=eo.current,a=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),_i(eo,1&o),null===e)return us(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,a?(i=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=jc(l,i,0,null),e=Mc(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=ja(n),t.memoizedState=Ma,e):Fa(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,a){if(n)return 256&t.flags?(t.flags&=-257,qa(e,t,a,r=da(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=jc({mode:"visible",children:r.children},i,0,null),(o=Mc(o,i,a,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&ws(t,e.child,null,a),t.child.memoizedState=ja(a),t.memoizedState=Ma,o);if(0===(1&t.mode))return qa(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,qa(e,t,a,r=da(o=Error(s(419)),r,void 0))}if(l=0!==(a&e.childLanes),xa||l){if(null!==(r=kl)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|a))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Ms(e,i),nc(r,e,i,-1))}return mc(),qa(e,t,a,r=da(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=_c.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,is=ui(i.nextSibling),rs=t,ss=!0,os=null,null!==e&&(Yi[Qi++]=Xi,Yi[Qi++]=$i,Yi[Qi++]=Ji,Xi=e.id,$i=e.overflow,Ji=t),t=Fa(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,o,n);if(a){a=i.fallback,l=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Oc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?a=Oc(r,a):(a=Mc(a,l,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,l=null===(l=e.child.memoizedState)?ja(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Ma,i}return e=(a=e.child).sibling,i=Oc(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Fa(e,t){return(t=jc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function qa(e,t,n,r){return null!==r&&ms(r),ws(t,e.child,null,n),(e=Fa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ua(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ks(e.return,t,n)}function Va(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function za(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(wa(e,t,r.children,n),0!==(2&(r=eo.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ua(e,n,t);else if(19===e.tag)Ua(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(_i(eo,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===to(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Va(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===to(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Va(t,!0,n,null,s);break;case"together":Va(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ba(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ha(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),jl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Oc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Oc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ga(e,t){if(!ss)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Wa(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ka(e,t,n){var r=t.pendingProps;switch(ns(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wa(t),null;case 1:case 17:return Oi(t.type)&&Li(),Wa(t),null;case 3:return r=t.stateNode,Xs(),Ti(Ai),Ti(ki),ro(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==os&&(oc(os),os=null))),Wa(t),null;case 5:Zs(t);var i=Qs(Ys.current);if(n=t.type,null!==e&&null!=t.stateNode)Oa(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Wa(t),null}if(e=Qs(Ws.current),hs(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[fi]=t,r[pi]=o,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(i=0;i<jr.length;i++)Ur(jr[i],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":J(r,o),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Ur("invalid",r);break;case"textarea":ie(r,o),Ur("invalid",r)}for(var l in ve(n,o),i=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Zr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Zr(r.textContent,c,e),i=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ur("scroll",r)}switch(n){case"input":W(r),Z(r,o,!0);break;case"textarea":W(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=ei)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[fi]=t,e[pi]=r,Pa(e,t),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),i=r;break;case"iframe":case"object":case"embed":Ur("load",e),i=r;break;case"video":case"audio":for(i=0;i<jr.length;i++)Ur(jr[i],e);i=r;break;case"source":Ur("error",e),i=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),i=r;break;case"details":Ur("toggle",e),i=r;break;case"input":J(e,r),i=Q(e,r),Ur("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=D({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Ur("invalid",e)}for(o in ve(n,i),c=i)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?ge(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Ur("scroll",e):null!=u&&b(e,o,u,l))}switch(n){case"input":W(e),Z(e,r,!1);break;case"textarea":W(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=ei)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Wa(t),null;case 6:if(e&&null!=t.stateNode)La(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Qs(Ys.current),Qs(Ws.current),hs(t)){if(r=t.stateNode,n=t.memoizedProps,r[fi]=t,(o=r.nodeValue!==n)&&null!==(e=rs))switch(e.tag){case 3:Zr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[fi]=t,t.stateNode=r}return Wa(t),null;case 13:if(Ti(eo),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ss&&null!==is&&0!==(1&t.mode)&&0===(128&t.flags))fs(),ps(),t.flags|=98560,o=!1;else if(o=hs(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[fi]=t}else ps(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Wa(t),o=!1}else null!==os&&(oc(os),os=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&eo.current)?0===Ll&&(Ll=3):mc())),null!==t.updateQueue&&(t.flags|=4),Wa(t),null);case 4:return Xs(),null===e&&Br(t.stateNode.containerInfo),Wa(t),null;case 10:return Cs(t.type._context),Wa(t),null;case 19:if(Ti(eo),null===(o=t.memoizedState))return Wa(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)Ga(o,!1);else{if(0!==Ll||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=to(e))){for(t.flags|=128,Ga(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return _i(eo,1&eo.current|2),t.child}e=e.sibling}null!==o.tail&&Xe()>zl&&(t.flags|=128,r=!0,Ga(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=to(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ga(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!ss)return Wa(t),null}else 2*Xe()-o.renderingStartTime>zl&&1073741824!==n&&(t.flags|=128,r=!0,Ga(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Xe(),t.sibling=null,n=eo.current,_i(eo,r?1&n|2:1&n),t):(Wa(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Pl)&&(Wa(t),6&t.subtreeFlags&&(t.flags|=8192)):Wa(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ya(e,t){switch(ns(t),t.tag){case 1:return Oi(t.type)&&Li(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xs(),Ti(Ai),Ti(ki),ro(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zs(t),null;case 13:if(Ti(eo),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ps()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ti(eo),null;case 4:return Xs(),null;case 10:return Cs(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Pa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Oa=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Qs(Ws.current);var s,o=null;switch(n){case"input":i=Q(e,i),r=Q(e,r),o=[];break;case"select":i=D({},i,{value:void 0}),r=D({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=ei)}for(u in ve(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ur("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},La=function(e,t,n,r){n!==r&&(t.flags|=4)};var Qa=!1,Ja=!1,Xa="function"===typeof WeakSet?WeakSet:Set,$a=null;function Za(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Nc(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Nc(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&el(t,n,s)}i=i.next}while(i!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fi],delete t[pi],delete t[gi],delete t[yi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function al(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=ei));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(a){}switch(n.tag){case 5:Ja||Za(n,t);case 6:var r=ul,i=dl;ul=null,hl(e,t,n),dl=i,null!==(ul=r)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?ci(e.parentNode,n):1===e.nodeType&&ci(e,n),zt(e)):ci(ul,n.stateNode));break;case 4:r=ul,i=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=r,dl=i;break;case 0:case 11:case 14:case 15:if(!Ja&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&el(n,t,o),i=i.next}while(i!==r)}hl(e,t,n);break;case 1:if(!Ja&&(Za(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Nc(n,t,a)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Ja=(r=Ja)||null!==n.memoizedState,hl(e,t,n),Ja=r):hl(e,t,n);break;default:hl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xa),t.forEach(function(t){var r=Cc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(s(160));fl(o,a,i),ul=null,dl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){Nc(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){Nc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Nc(e,e.return,g)}}break;case 1:ml(t,e),yl(e),512&r&&null!==n&&Za(n,n.return);break;case 5:if(ml(t,e),yl(e),512&r&&null!==n&&Za(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(g){Nc(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&X(i,o),be(l,a);var u=be(l,o);for(a=0;a<c.length;a+=2){var d=c[a],h=c[a+1];"style"===d?ge(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):b(i,d,h,u)}switch(l){case"input":$(i,o);break;case"textarea":se(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[pi]=o}catch(g){Nc(e,e.return,g)}}break;case 6:if(ml(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){Nc(e,e.return,g)}}break;case 3:if(ml(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{zt(t.containerInfo)}catch(g){Nc(e,e.return,g)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(Vl=Xe())),4&r&&pl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Ja=(u=Ja)||d,ml(t,e),Ja=u):ml(t,e),yl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for($a=e,d=e.child;null!==d;){for(h=$a=d;null!==$a;){switch(p=(f=$a).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:Za(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Nc(r,n,g)}}break;case 5:Za(f,f.return);break;case 22:if(null!==f.memoizedState){wl(h);continue}}null!==p?(p.return=f,$a=p):wl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,u?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=h.stateNode,a=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",a))}catch(g){Nc(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Nc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),yl(e),4&r&&pl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),cl(e,al(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;ll(e,al(e),o);break;default:throw Error(s(161))}}catch(a){Nc(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){$a=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==$a;){var i=$a,s=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Qa;if(!o){var a=i.alternate,l=null!==a&&null!==a.memoizedState||Ja;a=Qa;var c=Ja;if(Qa=o,(Ja=l)&&!c)for($a=i;null!==$a;)l=(o=$a).child,22===o.tag&&null!==o.memoizedState?Il(i):null!==l?(l.return=o,$a=l):Il(i);for(;null!==s;)$a=s,bl(s,t,n),s=s.sibling;$a=i,Qa=a,Ja=c}xl(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,$a=s):xl(e)}}function xl(e){for(;null!==$a;){var t=$a;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ja||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ja)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ra(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Hs(t,o,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Hs(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&zt(h)}}}break;default:throw Error(s(163))}Ja||512&t.flags&&il(t)}catch(f){Nc(t,t.return,f)}}if(t===e){$a=null;break}if(null!==(n=t.sibling)){n.return=t.return,$a=n;break}$a=t.return}}function wl(e){for(;null!==$a;){var t=$a;if(t===e){$a=null;break}var n=t.sibling;if(null!==n){n.return=t.return,$a=n;break}$a=t.return}}function Il(e){for(;null!==$a;){var t=$a;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Nc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Nc(t,i,l)}}var s=t.return;try{il(t)}catch(l){Nc(t,s,l)}break;case 5:var o=t.return;try{il(t)}catch(l){Nc(t,o,l)}}}catch(l){Nc(t,t.return,l)}if(t===e){$a=null;break}var a=t.sibling;if(null!==a){a.return=t.return,$a=a;break}$a=t.return}}var El,Nl=Math.ceil,Sl=x.ReactCurrentDispatcher,Tl=x.ReactCurrentOwner,_l=x.ReactCurrentBatchConfig,Cl=0,kl=null,Al=null,Rl=0,Pl=0,Ol=Si(0),Ll=0,Ml=null,jl=0,Dl=0,Fl=0,ql=null,Ul=null,Vl=0,zl=1/0,Bl=null,Hl=!1,Gl=null,Wl=null,Kl=!1,Yl=null,Ql=0,Jl=0,Xl=null,$l=-1,Zl=0;function ec(){return 0!==(6&Cl)?Xe():-1!==$l?$l:$l=Xe()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==Rl?Rl&-Rl:null!==gs.transition?(0===Zl&&(Zl=mt()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function nc(e,t,n,r){if(50<Jl)throw Jl=0,Xl=null,Error(s(185));yt(e,n,r),0!==(2&Cl)&&e===kl||(e===kl&&(0===(2&Cl)&&(Dl|=n),4===Ll&&ac(e,Rl)),rc(e,r),1===n&&0===Cl&&0===(1&t.mode)&&(zl=Xe()+500,Ui&&Bi()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,l=i[o];-1===l?0!==(a&n)&&0===(a&r)||(i[o]=ft(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var r=ht(e,e===kl?Rl:0);if(0===r)null!==n&&Ye(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ye(n),1===t)0===e.tag?function(e){Ui=!0,zi(e)}(lc.bind(null,e)):zi(lc.bind(null,e)),ai(function(){0===(6&Cl)&&Bi()}),n=null;else{switch(xt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=kc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if($l=-1,Zl=0,0!==(6&Cl))throw Error(s(327));var n=e.callbackNode;if(Ic()&&e.callbackNode!==n)return null;var r=ht(e,e===kl?Rl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var i=Cl;Cl|=2;var o=pc();for(kl===e&&Rl===t||(Bl=null,zl=Xe()+500,hc(e,t));;)try{vc();break}catch(l){fc(e,l)}_s(),Sl.current=o,Cl=i,null!==Al?t=0:(kl=null,Rl=0,t=Ll)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=sc(e,i))),1===t)throw n=Ml,hc(e,0),ac(e,r),rc(e,Xe()),n;if(6===t)ac(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!lr(s(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=gc(e,r))&&(0!==(o=pt(e))&&(r=o,t=sc(e,o))),1===t))throw n=Ml,hc(e,0),ac(e,r),rc(e,Xe()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:wc(e,Ul,Bl);break;case 3:if(ac(e,r),(130023424&r)===r&&10<(t=Vl+500-Xe())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ii(wc.bind(null,e,Ul,Bl),t);break}wc(e,Ul,Bl);break;case 4:if(ac(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-ot(r);o=1<<a,(a=t[a])>i&&(i=a),r&=~o}if(r=i,10<(r=(120>(r=Xe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Nl(r/1960))-r)){e.timeoutHandle=ii(wc.bind(null,e,Ul,Bl),r);break}wc(e,Ul,Bl);break;default:throw Error(s(329))}}}return rc(e,Xe()),e.callbackNode===n?ic.bind(null,e):null}function sc(e,t){var n=ql;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Ul,Ul=n,null!==t&&oc(t)),e}function oc(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function ac(e,t){for(t&=~Fl,t&=~Dl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&Cl))throw Error(s(327));Ic();var t=ht(e,0);if(0===(1&t))return rc(e,Xe()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=sc(e,r))}if(1===n)throw n=Ml,hc(e,0),ac(e,t),rc(e,Xe()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Ul,Bl),rc(e,Xe()),null}function cc(e,t){var n=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=n)&&(zl=Xe()+500,Ui&&Bi())}}function uc(e){null!==Yl&&0===Yl.tag&&0===(6&Cl)&&Ic();var t=Cl;Cl|=1;var n=_l.transition,r=bt;try{if(_l.transition=null,bt=1,e)return e()}finally{bt=r,_l.transition=n,0===(6&(Cl=t))&&Bi()}}function dc(){Pl=Ol.current,Ti(Ol)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,si(n)),null!==Al)for(n=Al.return;null!==n;){var r=n;switch(ns(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Li();break;case 3:Xs(),Ti(Ai),Ti(ki),ro();break;case 5:Zs(r);break;case 4:Xs();break;case 13:case 19:Ti(eo);break;case 10:Cs(r.type._context);break;case 22:case 23:dc()}n=n.return}if(kl=e,Al=e=Oc(e.current,null),Rl=Pl=t,Ll=0,Ml=null,Fl=Dl=jl=0,Ul=ql=null,null!==Ps){for(t=0;t<Ps.length;t++)if(null!==(r=(n=Ps[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var o=s.next;s.next=i,r.next=o}n.pending=r}Ps=null}return e}function fc(e,t){for(;;){var n=Al;try{if(_s(),io.current=Zo,uo){for(var r=ao.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}uo=!1}if(oo=0,co=lo=ao=null,ho=!1,fo=0,Tl.current=null,null===n||null===n.return){Ll=1,Ml=t,Al=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=Rl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=ya(a);if(null!==p){p.flags&=-257,va(p,a,l,0,t),1&p.mode&&ga(o,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){ga(o,u,t),mc();break e}c=Error(s(426))}else if(ss&&1&l.mode){var y=ya(a);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),va(y,a,l,0,t),ms(ua(c,l));break e}}o=c=ua(c,l),4!==Ll&&(Ll=2),null===ql?ql=[o]:ql.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,zs(o,pa(0,c,t));break e;case 1:l=c;var v=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Wl||!Wl.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,zs(o,ma(o,l,t));break e}}o=o.return}while(null!==o)}xc(n)}catch(x){t=x,Al===n&&null!==n&&(Al=n=n.return);continue}break}}function pc(){var e=Sl.current;return Sl.current=Zo,null===e?Zo:e}function mc(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===kl||0===(268435455&jl)&&0===(268435455&Dl)||ac(kl,Rl)}function gc(e,t){var n=Cl;Cl|=2;var r=pc();for(kl===e&&Rl===t||(Bl=null,hc(e,t));;)try{yc();break}catch(i){fc(e,i)}if(_s(),Cl=n,Sl.current=r,null!==Al)throw Error(s(261));return kl=null,Rl=0,Ll}function yc(){for(;null!==Al;)bc(Al)}function vc(){for(;null!==Al&&!Qe();)bc(Al)}function bc(e){var t=El(e.alternate,e,Pl);e.memoizedProps=e.pendingProps,null===t?xc(e):Al=t,Tl.current=null}function xc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ka(n,t,Pl)))return void(Al=n)}else{if(null!==(n=Ya(n,t)))return n.flags&=32767,void(Al=n);if(null===e)return Ll=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Ll&&(Ll=5)}function wc(e,t,n){var r=bt,i=_l.transition;try{_l.transition=null,bt=1,function(e,t,n,r){do{Ic()}while(null!==Yl);if(0!==(6&Cl))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,o),e===kl&&(Al=kl=null,Rl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,kc(tt,function(){return Ic(),null})),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=_l.transition,_l.transition=null;var a=bt;bt=1;var l=Cl;Cl|=4,Tl.current=null,function(e,t){if(ti=Ht,pr(e=fr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(l=a+i),h!==o||0!==r&&3!==h.nodeType||(c=a+r),3===h.nodeType&&(a+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===i&&(l=a),f===o&&++d===r&&(c=a),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ni={focusedElem:e,selectionRange:n},Ht=!1,$a=t;null!==$a;)if(e=(t=$a).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,$a=e;else for(;null!==$a;){t=$a;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:ra(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(s(163))}}catch(w){Nc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,$a=e;break}$a=t.return}m=tl,tl=!1}(e,n),gl(n,e),mr(ni),Ht=!!ti,ni=ti=null,e.current=n,vl(n,e,i),Je(),Cl=l,bt=a,_l.transition=o}else e.current=n;if(Kl&&(Kl=!1,Yl=e,Ql=i),o=e.pendingLanes,0===o&&(Wl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Xe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Hl)throw Hl=!1,e=Gl,Gl=null,e;0!==(1&Ql)&&0!==e.tag&&Ic(),o=e.pendingLanes,0!==(1&o)?e===Xl?Jl++:(Jl=0,Xl=e):Jl=0,Bi()}(e,t,n,r)}finally{_l.transition=i,bt=r}return null}function Ic(){if(null!==Yl){var e=xt(Ql),t=_l.transition,n=bt;try{if(_l.transition=null,bt=16>e?16:e,null===Yl)var r=!1;else{if(e=Yl,Yl=null,Ql=0,0!==(6&Cl))throw Error(s(331));var i=Cl;for(Cl|=4,$a=e.current;null!==$a;){var o=$a,a=o.child;if(0!==(16&$a.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for($a=u;null!==$a;){var d=$a;switch(d.tag){case 0:case 11:case 15:nl(8,d,o)}var h=d.child;if(null!==h)h.return=d,$a=h;else for(;null!==$a;){var f=(d=$a).sibling,p=d.return;if(sl(d),d===u){$a=null;break}if(null!==f){f.return=p,$a=f;break}$a=p}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}$a=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,$a=a;else e:for(;null!==$a;){if(0!==(2048&(o=$a).flags))switch(o.tag){case 0:case 11:case 15:nl(9,o,o.return)}var v=o.sibling;if(null!==v){v.return=o.return,$a=v;break e}$a=o.return}}var b=e.current;for($a=b;null!==$a;){var x=(a=$a).child;if(0!==(2064&a.subtreeFlags)&&null!==x)x.return=a,$a=x;else e:for(a=b;null!==$a;){if(0!==(2048&(l=$a).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(I){Nc(l,l.return,I)}if(l===a){$a=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,$a=w;break e}$a=l.return}}if(Cl=i,Bi(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(I){}r=!0}return r}finally{bt=n,_l.transition=t}}return!1}function Ec(e,t,n){e=Us(e,t=pa(0,t=ua(n,t),1),1),t=ec(),null!==e&&(yt(e,1,t),rc(e,t))}function Nc(e,t,n){if(3===e.tag)Ec(e,e,n);else for(;null!==t;){if(3===t.tag){Ec(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Wl||!Wl.has(r))){t=Us(t,e=ma(t,e=ua(n,e),1),1),e=ec(),null!==t&&(yt(t,1,e),rc(t,e));break}}t=t.return}}function Sc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,kl===e&&(Rl&n)===n&&(4===Ll||3===Ll&&(130023424&Rl)===Rl&&500>Xe()-Vl?hc(e,0):Fl|=n),rc(e,t)}function Tc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Ms(e,t))&&(yt(e,t,n),rc(e,n))}function _c(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Tc(e,n)}function Cc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Tc(e,n)}function kc(e,t){return Ke(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(e,t,n,r){return new Ac(e,t,n,r)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Oc(e,t){var n=e.alternate;return null===n?((n=Rc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Lc(e,t,n,r,i,o){var a=2;if(r=e,"function"===typeof e)Pc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case E:return Mc(n.children,i,o,t);case N:a=8,i|=8;break;case S:return(e=Rc(12,n,t,2|i)).elementType=S,e.lanes=o,e;case k:return(e=Rc(13,n,t,i)).elementType=k,e.lanes=o,e;case A:return(e=Rc(19,n,t,i)).elementType=A,e.lanes=o,e;case O:return jc(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:a=10;break e;case _:a=9;break e;case C:a=11;break e;case R:a=14;break e;case P:a=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Rc(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Mc(e,t,n,r){return(e=Rc(7,e,r,t)).lanes=n,e}function jc(e,t,n,r){return(e=Rc(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Dc(e,t,n){return(e=Rc(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Rc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Uc(e,t,n,r,i,s,o,a,l){return e=new qc(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Rc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ds(s),e}function Vc(e){if(!e)return Ci;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Oi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Oi(n))return ji(e,n,t)}return t}function zc(e,t,n,r,i,s,o,a,l){return(e=Uc(n,r,!0,e,0,s,0,a,l)).context=Vc(null),n=e.current,(s=qs(r=ec(),i=tc(n))).callback=void 0!==t&&null!==t?t:null,Us(n,s,i),e.current.lanes=i,yt(e,i,r),rc(e,r),e}function Bc(e,t,n,r){var i=t.current,s=ec(),o=tc(i);return n=Vc(n),null===t.context?t.context=n:t.pendingContext=n,(t=qs(s,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Us(i,t,o))&&(nc(e,i,o,s),Vs(e,i,o)),o}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Wc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}El=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ai.current)xa=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xa=!1,function(e,t,n){switch(t.tag){case 3:Aa(t),ps();break;case 5:$s(t);break;case 1:Oi(t.type)&&Di(t);break;case 4:Js(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;_i(Es,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(_i(eo,1&eo.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Da(e,t,n):(_i(eo,1&eo.current),null!==(e=Ha(e,t,n))?e.sibling:null);_i(eo,1&eo.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return za(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),_i(eo,eo.current),r)break;return null;case 22:case 23:return t.lanes=0,Sa(e,t,n)}return Ha(e,t,n)}(e,t,n);xa=0!==(131072&e.flags)}else xa=!1,ss&&0!==(1048576&t.flags)&&es(t,Ki,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ba(e,t),e=t.pendingProps;var i=Pi(t,ki.current);As(t,n),i=yo(null,t,r,e,i,n);var o=vo();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Oi(r)?(o=!0,Di(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ds(t),i.updater=sa,t.stateNode=i,i._reactInternals=t,ca(t,r,e,n),t=ka(null,t,r,!0,o,n)):(t.tag=0,ss&&o&&ts(t),wa(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ba(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===R)return 14}return 2}(r),e=ra(r,e),i){case 0:t=_a(null,t,r,e,n);break e;case 1:t=Ca(null,t,r,e,n);break e;case 11:t=Ia(null,t,r,e,n);break e;case 14:t=Ea(null,t,r,ra(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,_a(e,t,r,i=t.elementType===r?i:ra(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ca(e,t,r,i=t.elementType===r?i:ra(r,i),n);case 3:e:{if(Aa(t),null===e)throw Error(s(387));r=t.pendingProps,i=(o=t.memoizedState).element,Fs(e,t),Bs(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ra(e,t,r,n,i=ua(Error(s(423)),t));break e}if(r!==i){t=Ra(e,t,r,n,i=ua(Error(s(424)),t));break e}for(is=ui(t.stateNode.containerInfo.firstChild),rs=t,ss=!0,os=null,n=Is(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ps(),r===i){t=Ha(e,t,n);break e}wa(e,t,r,n)}t=t.child}return t;case 5:return $s(t),null===e&&us(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,ri(r,i)?a=null:null!==o&&ri(r,o)&&(t.flags|=32),Ta(e,t),wa(e,t,a,n),t.child;case 6:return null===e&&us(t),null;case 13:return Da(e,t,n);case 4:return Js(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ws(t,null,r,n):wa(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Ia(e,t,r,i=t.elementType===r?i:ra(r,i),n);case 7:return wa(e,t,t.pendingProps,n),t.child;case 8:case 12:return wa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value,_i(Es,r._currentValue),r._currentValue=a,null!==o)if(lr(o.value,a)){if(o.children===i.children&&!Ai.current){t=Ha(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=qs(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),ks(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),ks(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}wa(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,As(t,n),r=r(i=Rs(i)),t.flags|=1,wa(e,t,r,n),t.child;case 14:return i=ra(r=t.type,t.pendingProps),Ea(e,t,r,i=ra(r.type,i),n);case 15:return Na(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ra(r,i),Ba(e,t),t.tag=1,Oi(r)?(e=!0,Di(t)):e=!1,As(t,n),aa(t,r,i),ca(t,r,i,n),ka(null,t,r,!0,e,n);case 19:return za(e,t,n);case 22:return Sa(e,t,n)}throw Error(s(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Qc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $c(){}function Zc(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof i){var a=i;i=function(){var e=Hc(o);a.call(e)}}Bc(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=Hc(o);s.call(e)}}var o=zc(t,r,e,0,null,!1,0,"",$c);return e._reactRootContainer=o,e[mi]=o.current,Br(8===e.nodeType?e.parentNode:e),uc(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=Hc(l);a.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",$c);return e._reactRootContainer=l,e[mi]=l.current,Br(8===e.nodeType?e.parentNode:e),uc(function(){Bc(t,l,n,r)}),l}(n,t,e,i,r);return Hc(o)}Qc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Bc(e,t,null,null)},Qc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){Bc(null,e,null,null)}),t[mi]=null}},Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Nt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&Dt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),rc(t,Xe()),0===(6&Cl)&&(zl=Xe()+500,Bi()))}break;case 13:uc(function(){var t=Ms(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),Wc(e,1)}},It=function(e){if(13===e.tag){var t=Ms(e,134217728);if(null!==t)nc(t,e,134217728,ec());Wc(e,134217728)}},Et=function(e){if(13===e.tag){var t=tc(e),n=Ms(e,t);if(null!==n)nc(n,e,t,ec());Wc(e,t)}},Nt=function(){return bt},St=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Ie=function(e,t,n){switch(t){case"input":if($(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Ii(r);if(!i)throw Error(s(90));K(r),$(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=cc,ke=uc;var eu={usingClientEntryPoint:!1,Events:[xi,wi,Ii,Te,_e,cc]},tu={findFiberByHostInstance:bi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{it=ru.inject(nu),st=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:I,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jc(e))throw Error(s(299));var n=!1,r="",i=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Uc(e,1,!1,null,0,n,0,r,i),e[mi]=t.current,Br(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Xc(t))throw Error(s(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jc(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",a=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=zc(t,null,e,1,null!=n?n:null,i,0,o,a),e[mi]=t.current,Br(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Qc(t)},t.render=function(e,t,n){if(!Xc(t))throw Error(s(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(s(40));return!!e._reactRootContainer&&(uc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[mi]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},784(e,t,n){n.d(t,{A:()=>h});var r=n(555),i=n(986),s=n(43);const o=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const c=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],u=(0,s.forwardRef)((e,t)=>{let{color:n="currentColor",size:o=24,strokeWidth:u=2,absoluteStrokeWidth:d,className:h="",children:f,iconNode:p}=e,m=(0,i.A)(e,c);return(0,s.createElement)("svg",(0,r.A)((0,r.A)((0,r.A)({ref:t},l),{},{width:o,height:o,stroke:n,strokeWidth:d?24*Number(u)/Number(o):u,className:a("lucide",h)},!f&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"}),m),[...p.map(e=>{let[t,n]=e;return(0,s.createElement)(t,n)}),...Array.isArray(f)?f:[f]])}),d=["className"],h=(e,t)=>{const n=(0,s.forwardRef)((n,l)=>{let{className:c}=n,h=(0,i.A)(n,d);return(0,s.createElement)(u,(0,r.A)({ref:l,iconNode:t,className:a("lucide-".concat((f=o(e),f.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(e),c)},h));var f});return n.displayName=o(e),n}},797(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]])},800(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("bug",[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]])},819(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},837(e,t,n){n.d(t,{getAllGames:()=>R,getCategories:()=>A,getGamesByCategory:()=>k,sW:()=>_});var r=n(555),i=n(797),s=n(12),o=n(73),a=n(629),l=n(784);const c=(0,l.A)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);var u=n(382),d=n(130),h=n(118),f=n(489),p=n(819),m=n(537),g=n(800),y=n(942);const v=(0,l.A)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]),b=(0,l.A)("syringe",[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]]),x=(0,l.A)("stethoscope",[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]),w=(0,l.A)("hospital",[["path",{d:"M12 7v4",key:"xawao1"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M14 9h-4",key:"1w2s2s"}],["path",{d:"M18 11h2a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-9a2 2 0 0 1 2-2h2",key:"1tthqt"}],["path",{d:"M18 21V5a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16",key:"dw4p4i"}]]),I=(0,l.A)("pill",[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]]),E=(0,l.A)("calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]),N=(0,l.A)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),S={games:[{id:"rn-mastery",title:"RN Mastery Quiz",description:"Chapter-based review with adaptive learning",icon:"GraduationCap",category:"study",color:"from-blue-500 to-indigo-600",enabled:!0,modes:["study","ranked"],supportsDynamicChapters:!0},{id:"flashcards",title:"Flashcard Study",description:"Flip cards with spaced repetition - mark as Know It, Review, or Learning",icon:"CreditCard",category:"study",color:"from-indigo-500 to-purple-600",enabled:!0,modes:["flashcard"],supportsDynamicChapters:!0},{id:"day-to-be-wrong",title:"A Day to be Wrong",description:"Clinical judgment - choose the least dangerous wrong answer",icon:"Scale",category:"clinical-judgment",color:"from-purple-500 to-pink-600",enabled:!0,modes:["ranked"],supportsDynamicChapters:!1,specialMode:!0},{id:"challenge-mode",title:"Challenge Scenarios",description:"Time-based resource management challenges",icon:"Zap",category:"challenge",color:"from-orange-500 to-red-600",enabled:!0,modes:["challenge"],supportsDynamicChapters:!1},{id:"instructor-mode",title:"Instructor Panel",description:"Live classroom management and judgment panel",icon:"Crown",category:"instructor",color:"from-yellow-500 to-amber-600",enabled:!0,modes:["instructor"],requiresAuth:!0}],categories:[{id:"study",title:"Study & Review",icon:"BookOpen",description:"Self-paced learning modules"},{id:"clinical-judgment",title:"Clinical Judgment",icon:"Brain",description:"Decision-making scenarios"},{id:"challenge",title:"Challenges",icon:"Trophy",description:"Timed competitive modes"},{id:"instructor",title:"Instructor Tools",icon:"Users",description:"Classroom management"}]},T={GraduationCap:i.A,Scale:s.A,Zap:o.A,Crown:a.A,BookOpen:c,Brain:u.A,Trophy:d.A,Users:h.A,Shield:f.A,AlertCircle:p.A,Activity:m.A,Bug:g.A,Bone:y.A,Heart:v,Syringe:b,Stethoscope:x,Hospital:w,Pill:I,Calculator:E,CreditCard:N};function _(e){return T[e]||u.A}function C(){return S&&S.games?S.games.filter(e=>e.enabled).map(e=>(0,r.A)((0,r.A)({},e),{},{IconComponent:_(e.icon)})):(console.warn("Games config not loaded"),[])}function k(e){return C().filter(t=>t.category===e)}function A(){return S&&S.categories?S.categories.map(e=>(0,r.A)((0,r.A)({},e),{},{IconComponent:_(e.icon),games:k(e.id)})):(console.warn("Categories config not loaded"),[])}function R(){return S.games.map(e=>(0,r.A)((0,r.A)({},e),{},{IconComponent:_(e.icon)}))}},853(e,t,n){e.exports=n(234)},942(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("bone",[["path",{d:"M17 10c.7-.7 1.69 0 2.5 0a2.5 2.5 0 1 0 0-5 .5.5 0 0 1-.5-.5 2.5 2.5 0 1 0-5 0c0 .81.7 1.8 0 2.5l-7 7c-.7.7-1.69 0-2.5 0a2.5 2.5 0 0 0 0 5c.28 0 .5.22.5.5a2.5 2.5 0 1 0 5 0c0-.81-.7-1.8 0-2.5Z",key:"w610uw"}]])},950(e,t,n){!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},986(e,t,n){function r(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}n.d(t,{A:()=>r})}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r=n(43),i=n(391),s=n(555),o=n(489),a=n(819),l=n(942),c=n(800),u=n(537),d=n(382),h=n(12),f=n(784);const p=(0,f.A)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]);var m=n(797),g=n(130);const y=(0,f.A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),v=(0,f.A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var b=n(629);const x=(0,f.A)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),w=(0,f.A)("flame",[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]]),I=(0,f.A)("split",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]]),E=(0,f.A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),N=(0,f.A)("timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);var S=n(73);const T=(0,f.A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),_=(0,f.A)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),C=(0,f.A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),k=(0,f.A)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),A=(0,f.A)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),R=(0,f.A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),P=(0,f.A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var O={};!function e(t,n,r,i){var s=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),o="function"===typeof Path2D&&"function"===typeof DOMMatrix;function a(){}function l(e){var r=n.exports.Promise,i=void 0!==r?r:t.Promise;return"function"===typeof i?new i(e):(e(a,a),null)}var c,u=function(e,t){return{transform:function(n){if(e)return n;if(t.has(n))return t.get(n);var r=new OffscreenCanvas(n.width,n.height);return r.getContext("2d").drawImage(n,0,0),t.set(n,r),r},clear:function(){t.clear()}}}(function(){if(!t.OffscreenCanvas)return!1;try{var e=new OffscreenCanvas(1,1),n=e.getContext("2d");n.fillRect(0,0,1,1);var r=e.transferToImageBitmap();n.createPattern(r,"no-repeat")}catch(i){return!1}return!0}(),new Map),d=function(){var e,t,n=Math.floor(1e3/60),r={},i=0;return"function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?(e=function(e){var t=Math.random();return r[t]=requestAnimationFrame(function s(o){i===o||i+n-1<o?(i=o,delete r[t],e()):r[t]=requestAnimationFrame(s)}),t},t=function(e){r[e]&&cancelAnimationFrame(r[e])}):(e=function(e){return setTimeout(e,n)},t=function(e){return clearTimeout(e)}),{frame:e,cancel:t}}(),h=function(){var t,n,i={};return function(){if(t)return t;if(!r&&s){var o=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join("\n");try{t=new Worker(URL.createObjectURL(new Blob([o])))}catch(a){return"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn("\ud83c\udf8a Could not load worker",a),null}!function(e){function t(t,n){e.postMessage({options:t||{},callback:n})}e.init=function(t){var n=t.transferControlToOffscreen();e.postMessage({canvas:n},[n])},e.fire=function(r,s,o){if(n)return t(r,null),n;var a=Math.random().toString(36).slice(2);return n=l(function(s){function l(t){t.data.callback===a&&(delete i[a],e.removeEventListener("message",l),n=null,u.clear(),o(),s())}e.addEventListener("message",l),t(r,a),i[a]=l.bind(null,{data:{callback:a}})})},e.reset=function(){for(var t in e.postMessage({reset:!0}),i)i[t](),delete i[t]}}(t)}return t}}(),f={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function p(e,t,n){return function(e,t){return t?t(e):e}(e&&(null!==(r=e[t])&&void 0!==r)?e[t]:f[t],n);var r}function m(e){return e<0?0:Math.floor(e)}function g(e,t){return Math.floor(Math.random()*(t-e))+e}function y(e){return parseInt(e,16)}function v(e){return e.map(b)}function b(e){var t=String(e).replace(/[^0-9a-f]/gi,"");return t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),{r:y(t.substring(0,2)),g:y(t.substring(2,4)),b:y(t.substring(4,6))}}function x(e){e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight}function w(e){var t=e.getBoundingClientRect();e.width=t.width,e.height=t.height}function I(e){var t=e.angle*(Math.PI/180),n=e.spread*(Math.PI/180);return{x:e.x,y:e.y,wobble:10*Math.random(),wobbleSpeed:Math.min(.11,.1*Math.random()+.05),velocity:.5*e.startVelocity+Math.random()*e.startVelocity,angle2D:-t+(.5*n-Math.random()*n),tiltAngle:(.5*Math.random()+.25)*Math.PI,color:e.color,shape:e.shape,tick:0,totalTicks:e.ticks,decay:e.decay,drift:e.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*e.gravity,ovalScalar:.6,scalar:e.scalar,flat:e.flat}}function E(e,t){t.x+=Math.cos(t.angle2D)*t.velocity+t.drift,t.y+=Math.sin(t.angle2D)*t.velocity+t.gravity,t.velocity*=t.decay,t.flat?(t.wobble=0,t.wobbleX=t.x+10*t.scalar,t.wobbleY=t.y+10*t.scalar,t.tiltSin=0,t.tiltCos=0,t.random=1):(t.wobble+=t.wobbleSpeed,t.wobbleX=t.x+10*t.scalar*Math.cos(t.wobble),t.wobbleY=t.y+10*t.scalar*Math.sin(t.wobble),t.tiltAngle+=.1,t.tiltSin=Math.sin(t.tiltAngle),t.tiltCos=Math.cos(t.tiltAngle),t.random=Math.random()+2);var n=t.tick++/t.totalTicks,r=t.x+t.random*t.tiltCos,i=t.y+t.random*t.tiltSin,s=t.wobbleX+t.random*t.tiltCos,a=t.wobbleY+t.random*t.tiltSin;if(e.fillStyle="rgba("+t.color.r+", "+t.color.g+", "+t.color.b+", "+(1-n)+")",e.beginPath(),o&&"path"===t.shape.type&&"string"===typeof t.shape.path&&Array.isArray(t.shape.matrix))e.fill(function(e,t,n,r,i,s,o){var a=new Path2D(e),l=new Path2D;l.addPath(a,new DOMMatrix(t));var c=new Path2D;return c.addPath(l,new DOMMatrix([Math.cos(o)*i,Math.sin(o)*i,-Math.sin(o)*s,Math.cos(o)*s,n,r])),c}(t.shape.path,t.shape.matrix,t.x,t.y,.1*Math.abs(s-r),.1*Math.abs(a-i),Math.PI/10*t.wobble));else if("bitmap"===t.shape.type){var l=Math.PI/10*t.wobble,c=.1*Math.abs(s-r),d=.1*Math.abs(a-i),h=t.shape.bitmap.width*t.scalar,f=t.shape.bitmap.height*t.scalar,p=new DOMMatrix([Math.cos(l)*c,Math.sin(l)*c,-Math.sin(l)*d,Math.cos(l)*d,t.x,t.y]);p.multiplySelf(new DOMMatrix(t.shape.matrix));var m=e.createPattern(u.transform(t.shape.bitmap),"no-repeat");m.setTransform(p),e.globalAlpha=1-n,e.fillStyle=m,e.fillRect(t.x-h/2,t.y-f/2,h,f),e.globalAlpha=1}else if("circle"===t.shape)e.ellipse?e.ellipse(t.x,t.y,Math.abs(s-r)*t.ovalScalar,Math.abs(a-i)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI):function(e,t,n,r,i,s,o,a,l){e.save(),e.translate(t,n),e.rotate(s),e.scale(r,i),e.arc(0,0,1,o,a,l),e.restore()}(e,t.x,t.y,Math.abs(s-r)*t.ovalScalar,Math.abs(a-i)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI);else if("star"===t.shape)for(var g=Math.PI/2*3,y=4*t.scalar,v=8*t.scalar,b=t.x,x=t.y,w=5,I=Math.PI/w;w--;)b=t.x+Math.cos(g)*v,x=t.y+Math.sin(g)*v,e.lineTo(b,x),g+=I,b=t.x+Math.cos(g)*y,x=t.y+Math.sin(g)*y,e.lineTo(b,x),g+=I;else e.moveTo(Math.floor(t.x),Math.floor(t.y)),e.lineTo(Math.floor(t.wobbleX),Math.floor(i)),e.lineTo(Math.floor(s),Math.floor(a)),e.lineTo(Math.floor(r),Math.floor(t.wobbleY));return e.closePath(),e.fill(),t.tick<t.totalTicks}function N(e,n){var o,a=!e,c=!!p(n||{},"resize"),f=!1,y=p(n,"disableForReducedMotion",Boolean),b=s&&!!p(n||{},"useWorker")?h():null,N=a?x:w,S=!(!e||!b)&&!!e.__confetti_initialized,T="function"===typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function _(t,n,s){for(var a=p(t,"particleCount",m),c=p(t,"angle",Number),h=p(t,"spread",Number),f=p(t,"startVelocity",Number),y=p(t,"decay",Number),b=p(t,"gravity",Number),x=p(t,"drift",Number),w=p(t,"colors",v),S=p(t,"ticks",Number),T=p(t,"shapes"),_=p(t,"scalar"),C=!!p(t,"flat"),k=function(e){var t=p(e,"origin",Object);return t.x=p(t,"x",Number),t.y=p(t,"y",Number),t}(t),A=a,R=[],P=e.width*k.x,O=e.height*k.y;A--;)R.push(I({x:P,y:O,angle:c,spread:h,startVelocity:f,color:w[A%w.length],shape:T[g(0,T.length)],ticks:S,decay:y,gravity:b,drift:x,scalar:_,flat:C}));return o?o.addFettis(R):(o=function(e,t,n,s,o){var a,c,h=t.slice(),f=e.getContext("2d"),p=l(function(t){function l(){a=c=null,f.clearRect(0,0,s.width,s.height),u.clear(),o(),t()}a=d.frame(function t(){!r||s.width===i.width&&s.height===i.height||(s.width=e.width=i.width,s.height=e.height=i.height),s.width||s.height||(n(e),s.width=e.width,s.height=e.height),f.clearRect(0,0,s.width,s.height),(h=h.filter(function(e){return E(f,e)})).length?a=d.frame(t):l()}),c=l});return{addFettis:function(e){return h=h.concat(e),p},canvas:e,promise:p,reset:function(){a&&d.cancel(a),c&&c()}}}(e,R,N,n,s),o.promise)}function C(n){var r=y||p(n,"disableForReducedMotion",Boolean),i=p(n,"zIndex",Number);if(r&&T)return l(function(e){e()});a&&o?e=o.canvas:a&&!e&&(e=function(e){var t=document.createElement("canvas");return t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=e,t}(i),document.body.appendChild(e)),c&&!S&&N(e);var s={width:e.width,height:e.height};function u(){if(b){var t={getBoundingClientRect:function(){if(!a)return e.getBoundingClientRect()}};return N(t),void b.postMessage({resize:{width:t.width,height:t.height}})}s.width=s.height=null}function d(){o=null,c&&(f=!1,t.removeEventListener("resize",u)),a&&e&&(document.body.contains(e)&&document.body.removeChild(e),e=null,S=!1)}return b&&!S&&b.init(e),S=!0,b&&(e.__confetti_initialized=!0),c&&!f&&(f=!0,t.addEventListener("resize",u,!1)),b?b.fire(n,s,d):_(n,s,d)}return C.reset=function(){b&&b.reset(),o&&o.reset()},C}function S(){return c||(c=N(null,{useWorker:!0,resize:!0})),c}n.exports=function(){return S().apply(this,arguments)},n.exports.reset=function(){S().reset()},n.exports.create=N,n.exports.shapeFromPath=function(e){if(!o)throw new Error("path confetti are not supported in this browser");var t,n;"string"===typeof e?t=e:(t=e.path,n=e.matrix);var r=new Path2D(t),i=document.createElement("canvas").getContext("2d");if(!n){for(var s,a,l=1e3,c=l,u=l,d=0,h=0,f=0;f<l;f+=2)for(var p=0;p<l;p+=2)i.isPointInPath(r,f,p,"nonzero")&&(c=Math.min(c,f),u=Math.min(u,p),d=Math.max(d,f),h=Math.max(h,p));s=d-c,a=h-u;var m=Math.min(10/s,10/a);n=[m,0,0,m,-Math.round(s/2+c)*m,-Math.round(a/2+u)*m]}return{type:"path",path:t,matrix:n}},n.exports.shapeFromText=function(e){var t,n=1,r="#000000",i='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';"string"===typeof e?t=e:(t=e.text,n="scalar"in e?e.scalar:n,i="fontFamily"in e?e.fontFamily:i,r="color"in e?e.color:r);var s=10*n,o=s+"px "+i,a=new OffscreenCanvas(s,s),l=a.getContext("2d");l.font=o;var c=l.measureText(t),u=Math.ceil(c.actualBoundingBoxRight+c.actualBoundingBoxLeft),d=Math.ceil(c.actualBoundingBoxAscent+c.actualBoundingBoxDescent),h=c.actualBoundingBoxLeft+2,f=c.actualBoundingBoxAscent+2;u+=4,d+=4,(l=(a=new OffscreenCanvas(u,d)).getContext("2d")).font=o,l.fillStyle=r,l.fillText(t,h,f);var p=1/n;return{type:"bitmap",bitmap:a.transferToImageBitmap(),matrix:[p,0,0,p,-u*p/2,-d*p/2]}}}(function(){return"undefined"!==typeof window?window:"undefined"!==typeof self?self:this||{}}(),O,!1);const L=O.exports;O.exports.create;const M=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},j={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0,c=t>>2,u=(3&t)<<4|o>>4;let d=(15&o)<<2|l>>6,h=63&l;a||(h=64,s||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(M(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==o||null==a)throw new D;const l=t<<2|s>>4;if(r.push(l),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class D extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const F=function(e){return function(e){const t=M(e);return j.encodeByteArray(t,!0)}(e).replace(/\./g,"")},q=function(e){try{return j.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};const U=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,V=()=>{try{return U()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/Term-3-Gaming",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&q(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},z=e=>{var t,n;return null===(n=null===(t=V())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},B=()=>{var e;return null===(e=V())||void 0===e?void 0:e.config},H=e=>{var t;return null===(t=V())||void 0===t?void 0:t["_".concat(e)]};class G{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function W(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function K(){return!function(){var e;const t=null===(e=V())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Y(){try{return"object"===typeof indexedDB}catch(e){return!1}}class Q extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Q.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,J.prototype.create)}}class J{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(X,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",s="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new Q(n,s,t)}}const X=/\{\$([^}]+)}/g;function $(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(Z(n)&&Z(s)){if(!$(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Z(e){return null!==e&&"object"===typeof e}function ee(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function te(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function ne(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class re{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=ie),void 0===r.error&&(r.error=ie),void 0===r.complete&&(r.complete=ie);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ie(){}function se(e){return e&&e._delegate?e._delegate:e}class oe{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ae="[DEFAULT]";class le{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new G;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:ae})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===ae?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(s){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae;return this.component?this.component.multipleInstances?e:ae:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class ce{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new le(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const ue=[];var de;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(de||(de={}));const he={debug:de.DEBUG,verbose:de.VERBOSE,info:de.INFO,warn:de.WARN,error:de.ERROR,silent:de.SILENT},fe=de.INFO,pe={[de.DEBUG]:"log",[de.VERBOSE]:"log",[de.INFO]:"info",[de.WARN]:"warn",[de.ERROR]:"error"},me=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=pe[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];console[r]("[".concat(n,"]  ").concat(e.name,":"),...s)};class ge{constructor(e){this.name=e,this._logLevel=fe,this._logHandler=me,this._userLogHandler=null,ue.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in de))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?he[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,de.DEBUG,...t),this._logHandler(this,de.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,de.VERBOSE,...t),this._logHandler(this,de.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,de.INFO,...t),this._logHandler(this,de.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,de.WARN,...t),this._logHandler(this,de.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,de.ERROR,...t),this._logHandler(this,de.ERROR,...t)}}let ye,ve;const be=new WeakMap,xe=new WeakMap,we=new WeakMap,Ie=new WeakMap,Ee=new WeakMap;let Ne={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return xe.get(e);if("objectStoreNames"===t)return e.objectStoreNames||we.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return _e(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Se(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(ve||(ve=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Ce(this),n),_e(be.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return _e(e.apply(Ce(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(Ce(this),t,...r);return we.set(s,t.sort?t.sort():[t]),_e(s)}}function Te(e){return"function"===typeof e?Se(e):(e instanceof IDBTransaction&&function(e){if(xe.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});xe.set(e,t)}(e),t=e,(ye||(ye=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,Ne):e);var t}function _e(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(_e(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&be.set(t,e)}).catch(()=>{}),Ee.set(t,e),t}(e);if(Ie.has(e))return Ie.get(e);const t=Te(e);return t!==e&&(Ie.set(e,t),Ee.set(t,e)),t}const Ce=e=>Ee.get(e);const ke=["get","getKey","getAll","getAllKeys","count"],Ae=["put","add","delete","clear"],Re=new Map;function Pe(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(Re.get(t))return Re.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Ae.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!ke.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&t.done]))[0]};return Re.set(t,s),s}Ne=(e=>(0,s.A)((0,s.A)({},e),{},{get:(t,n,r)=>Pe(t,n)||e.get(t,n,r),has:(t,n)=>!!Pe(t,n)||e.has(t,n)}))(Ne);class Oe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const Le="@firebase/app",Me="0.10.13",je=new ge("@firebase/app"),De="@firebase/app-compat",Fe="@firebase/analytics-compat",qe="@firebase/analytics",Ue="@firebase/app-check-compat",Ve="@firebase/app-check",ze="@firebase/auth",Be="@firebase/auth-compat",He="@firebase/database",Ge="@firebase/data-connect",We="@firebase/database-compat",Ke="@firebase/functions",Ye="@firebase/functions-compat",Qe="@firebase/installations",Je="@firebase/installations-compat",Xe="@firebase/messaging",$e="@firebase/messaging-compat",Ze="@firebase/performance",et="@firebase/performance-compat",tt="@firebase/remote-config",nt="@firebase/remote-config-compat",rt="@firebase/storage",it="@firebase/storage-compat",st="@firebase/firestore",ot="@firebase/vertexai-preview",at="@firebase/firestore-compat",lt="firebase",ct="[DEFAULT]",ut={[Le]:"fire-core",[De]:"fire-core-compat",[qe]:"fire-analytics",[Fe]:"fire-analytics-compat",[Ve]:"fire-app-check",[Ue]:"fire-app-check-compat",[ze]:"fire-auth",[Be]:"fire-auth-compat",[He]:"fire-rtdb",[Ge]:"fire-data-connect",[We]:"fire-rtdb-compat",[Ke]:"fire-fn",[Ye]:"fire-fn-compat",[Qe]:"fire-iid",[Je]:"fire-iid-compat",[Xe]:"fire-fcm",[$e]:"fire-fcm-compat",[Ze]:"fire-perf",[et]:"fire-perf-compat",[tt]:"fire-rc",[nt]:"fire-rc-compat",[rt]:"fire-gcs",[it]:"fire-gcs-compat",[st]:"fire-fst",[at]:"fire-fst-compat",[ot]:"fire-vertex","fire-js":"fire-js",[lt]:"fire-js-all"},dt=new Map,ht=new Map,ft=new Map;function pt(e,t){try{e.container.addComponent(t)}catch(n){je.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function mt(e){const t=e.name;if(ft.has(t))return je.debug("There were multiple attempts to register component ".concat(t,".")),!1;ft.set(t,e);for(const n of dt.values())pt(n,e);for(const n of ht.values())pt(n,e);return!0}function gt(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function yt(e){return void 0!==e.settings}const vt=new J("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class bt{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new oe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw vt.create("app-deleted",{appName:this._name})}}const xt="10.14.1";function wt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:ct,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw vt.create("bad-app-name",{appName:String(i)});if(n||(n=B()),!n)throw vt.create("no-options");const s=dt.get(i);if(s){if($(n,s.options)&&$(r,s.config))return s;throw vt.create("duplicate-app",{appName:i})}const o=new ce(i);for(const l of ft.values())o.addComponent(l);const a=new bt(n,r,o);return dt.set(i,a),a}function It(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct;const t=dt.get(e);if(!t&&e===ct&&B())return wt();if(!t)throw vt.create("no-app",{appName:e});return t}function Et(e,t,n){var r;let i=null!==(r=ut[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return s&&e.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),s&&o&&e.push("and"),o&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void je.warn(e.join(" "))}mt(new oe("".concat(i,"-version"),()=>({library:i,version:t}),"VERSION"))}const Nt="firebase-heartbeat-store";let St=null;function Tt(){return St||(St=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=_e(o);return r&&o.addEventListener("upgradeneeded",e=>{r(_e(o.result),e.oldVersion,e.newVersion,_e(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Nt)}catch(n){console.warn(n)}}}).catch(e=>{throw vt.create("idb-open",{originalErrorMessage:e.message})})),St}async function _t(e,t){try{const n=(await Tt()).transaction(Nt,"readwrite"),r=n.objectStore(Nt);await r.put(t,Ct(e)),await n.done}catch(n){if(n instanceof Q)je.warn(n.message);else{const e=vt.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});je.warn(e.message)}}}function Ct(e){return"".concat(e.name,"!").concat(e.options.appId)}class kt{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Rt(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=At();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache)}catch(n){je.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=At(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),Pt(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Pt(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=F(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return je.warn(t),""}}}function At(){return(new Date).toISOString().substring(0,10)}class Rt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Y()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await Tt()).transaction(Nt),n=await t.objectStore(Nt).get(Ct(e));return await t.done,n}catch(t){if(t instanceof Q)je.warn(t.message);else{const e=vt.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});je.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return _t(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return _t(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Pt(e){return F(JSON.stringify({version:2,heartbeats:e})).length}var Ot;Ot="",mt(new oe("platform-logger",e=>new Oe(e),"PRIVATE")),mt(new oe("heartbeat",e=>new kt(e),"PRIVATE")),Et(Le,Me,Ot),Et(Le,Me,"esm2017"),Et("fire-js","");var Lt,Mt,jt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Dt={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,s=this.h,o=0;o<t;){if(0==s)for(;o<=r;)n(this,e,o),o+=this.blockSize;if("string"===typeof e){for(;o<t;)if(i[s++]=e.charCodeAt(o++),s==this.blockSize){n(this,i),s=0;break}}else for(;o<t;)if(i[s++]=e[o++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var i={};function s(e){return-128<=e&&128>e?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],0>e?-1:0)}):new r([0|e],0>e?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return a;if(0>e)return h(o(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=4294967296;return new r(t,0)}var a=s(0),l=s(1),c=s(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function d(e){return-1==e.h}function h(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new r(n,~e.h).add(l)}function f(e,t){return e.add(h(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(a,a);if(d(e))return t=g(h(e),t),new m(h(t.g),h(t.h));if(d(t))return t=g(e,h(t)),new m(h(t.g),t.h);if(30<e.g.length){if(d(e)||d(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=y(n),r=y(r);var i=v(n,1),s=v(r,1);for(r=v(r,2),n=v(n,2);!u(r);){var c=s.add(r);0>=c.l(e)&&(i=i.add(n),s=c),r=v(r,1),n=v(n,1)}return t=f(e,i.j(t)),new m(i,t)}for(i=a;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),c=(s=o(n)).j(t);d(c)||0<c.l(e);)c=(s=o(n-=r)).j(t);u(s)&&(s=l),i=i.add(s),e=f(e,c)}return new m(i,e)}function y(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.i(i)<<1|e.i(i-1)>>>31;return new r(n,e.h)}function v(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,s=[],o=0;o<i;o++)s[o]=0<t?e.i(o+n)>>>t|e.i(o+n+1)<<32-t:e.i(o+n);return new r(s,e.h)}(e=r.prototype).m=function(){if(d(this))return-h(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(d(this))return"-"+h(this).toString(e);for(var t=o(Math.pow(e,6)),n=this,r="";;){var i=g(n,t).g,s=((0<(n=f(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return d(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return d(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,s=0;s<=t;s++){var o=i+(65535&this.i(s))+(65535&e.i(s)),a=(o>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);i=a>>>16,o&=65535,a&=65535,n[s]=a<<16|o}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return a;if(d(this))return d(e)?h(this).j(h(e)):h(h(this).j(e));if(d(e))return h(this.j(h(e)));if(0>this.l(c)&&0>e.l(c))return o(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var s=0;s<e.g.length;s++){var l=this.i(i)>>>16,f=65535&this.i(i),m=e.i(s)>>>16,g=65535&e.i(s);n[2*i+2*s]+=f*g,p(n,2*i+2*s),n[2*i+2*s+1]+=l*g,p(n,2*i+2*s+1),n[2*i+2*s+1]+=f*m,p(n,2*i+2*s+1),n[2*i+2*s+2]+=l*m,p(n,2*i+2*s+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new r(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)&e.i(i);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)|e.i(i);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)^e.i(i);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,Mt=Dt.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=o,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=o(Math.pow(n,8)),i=a,s=0;s<t.length;s+=8){var l=Math.min(8,t.length-s),c=parseInt(t.substring(s,s+l),n);8>l?(l=o(Math.pow(n,l)),i=i.j(l).add(o(c))):i=(i=i.j(r)).add(o(c))}return i},Lt=Dt.Integer=r}).apply("undefined"!==typeof jt?jt:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var Ft,qt,Ut,Vt,zt,Bt,Ht,Gt,Wt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Kt={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Wt&&Wt];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var o=e[s];if(!(o in i))break e;i=i[o]}(r=r(s=i[e=e[e.length-1]]))!=s&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,function(e,t){return t})}});var r=r||{},i=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function h(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(s(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var y=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function v(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function b(e){const t={};for(const n in e)t[n]=e[n];return t}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<x.length;t++)n=x[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function I(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function E(e){i.setTimeout(()=>{throw e},0)}function N(){var e=k;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var S=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new T,e=>e.reset());class T{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let _,C=!1,k=new class{constructor(){this.h=this.g=null}add(e,t){const n=S.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},A=()=>{const e=i.Promise.resolve(void 0);_=()=>{e.then(R)}};var R=()=>{for(var e;e=N();){try{e.h.call(e.g)}catch(n){E(n)}var t=S;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}C=!1};function P(){this.s=this.s,this.C=this.C}function O(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}P.prototype.s=!1,P.prototype.ma=function(){this.s||(this.s=!0,this.N())},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},O.prototype.h=function(){this.defaultPrevented=!0};var L=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(n){}return e}();function M(e,t){if(O.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(y){e:{try{g(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:j[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&M.aa.h.call(this)}}d(M,O);var j={2:"touch",3:"pen",4:"mouse"};M.prototype.h=function(){M.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var D="closure_listenable_"+(1e6*Math.random()|0),F=0;function q(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++F,this.da=this.fa=!1}function U(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function V(e){this.src=e,this.g={},this.h=0}function z(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(U(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function B(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}V.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=B(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new q(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var H="closure_lm_"+(1e6*Math.random()|0),G={};function W(e,t,n,r,i){if(r&&r.once)return Y(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)W(e,t[s],n,r,i);return null}return n=te(n),e&&e[D]?e.K(t,n,o(r)?!!r.capture:!!r,i):K(e,t,n,!1,r,i)}function K(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var a=o(i)?!!i.capture:!!i,l=Z(e);if(l||(e[H]=l=new V(e)),(n=l.add(t,n,r,a,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=$;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)L||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(X(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function Y(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)Y(e,t[s],n,r,i);return null}return n=te(n),e&&e[D]?e.L(t,n,o(r)?!!r.capture:!!r,i):K(e,t,n,!0,r,i)}function Q(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)Q(e,t[s],n,r,i);else r=o(r)?!!r.capture:!!r,n=te(n),e&&e[D]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=B(s=e.g[t],n,r,i))&&(U(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=B(t,n,r,i)),(n=-1<e?t[e]:null)&&J(n))}function J(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[D])z(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(X(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?(z(n,e),0==n.h&&(n.src=null,t[H]=null)):U(e)}}}function X(e){return e in G?G[e]:G[e]="on"+e}function $(e,t){if(e.da)e=!0;else{t=new M(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&J(e),e=n.call(r,t)}return e}function Z(e){return(e=e[H])instanceof V?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){P.call(this),this.i=new V(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new O(t,e);else if(t instanceof O)t.target=t.target||e;else{var i=t;w(t=new O(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=ie(o,r,!0,t)&&i}if(i=ie(o=t.g=e,r,!0,t)&&i,i=ie(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=ie(o=t.g=n[s],r,!1,t)&&i}function ie(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.da&&o.capture==n){var a=o.listener,l=o.ha||o.src;o.fa&&z(e.i,o),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}function se(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function oe(e){e.g=se(()=>{e.g=null,e.i&&(e.i=!1,oe(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}d(ne,P),ne.prototype[D]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Q(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)U(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class ae extends P{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:oe(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){P.call(this),this.h=e,this.g={}}d(le,P);var ce=[];function ue(e){v(e.g,function(e,t){this.g.hasOwnProperty(t)&&J(e)},e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var de=i.JSON.stringify,he=i.JSON.parse,fe=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function pe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}pe.prototype.h=null;var ye={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ve(){O.call(this,"d")}function be(){O.call(this,"c")}d(ve,O),d(be,O);var xe={},we=null;function Ie(){return we=we||new ne}function Ee(e){O.call(this,xe.La,e)}function Ne(e){const t=Ie();re(t,new Ee(t))}function Se(e,t){O.call(this,xe.STAT_EVENT,e),this.stat=t}function Te(e){const t=Ie();re(t,new Se(t,e))}function _e(e,t){O.call(this,xe.Ma,e),this.size=t}function Ce(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout(function(){e()},t)}function ke(){this.g=!0}function Ae(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return de(n)}catch(a){return t}}(e,n)+(r?" "+r:"")})}xe.La="serverreachability",d(Ee,O),xe.STAT_EVENT="statevent",d(Se,O),xe.Ma="timingevent",d(_e,O),ke.prototype.xa=function(){this.g=!1},ke.prototype.info=function(){};var Re,Pe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Oe={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Le(){}function Me(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new je}function je(){this.i=null,this.g="",this.h=!1}d(Le,pe),Le.prototype.g=function(){return new XMLHttpRequest},Le.prototype.i=function(){return{}},Re=new Le;var De={},Fe={};function qe(e,t,n){e.L=1,e.v=dt(ot(t)),e.m=n,e.P=!0,Ue(e,null)}function Ue(e,t){e.F=Date.now(),Be(e),e.A=ot(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),St(n.i,"t",r),e.C=0,n=e.j.J,e.h=new je,e.g=Sn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ae(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(ce[0]=i.toString()),i=ce);for(var s=0;s<i.length;s++){var o=W(n,i[s],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ne(),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");o=2<=d.length&&"type"==d[1]?o+(u+"=")+c+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.i,e.u,e.A,e.l,e.R,e.m)}function Ve(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function ze(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Fe:(n=Number(t.substring(n,r)),isNaN(n)?De:(r+=1)+n>t.length?Fe:(t=t.slice(r,r+n),e.C=r+n,t))}function Be(e){e.S=Date.now()+e.I,He(e,e.I)}function He(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ce(c(e.ba,e),t)}function Ge(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function We(e){0==e.j.G||e.J||xn(e.j,e)}function Ke(e){Ge(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ye(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;bn(n),cn(n)}gn(n),Te(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ce(c(n.Za,n),6e3));if(1>=$e(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else In(n,11)}else if((e.K||n.g==e)&&bn(n),!p(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=c[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(et(s,s.h),s.h=null))}if(r.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,ut(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=e;if((r=n).qa=Nn(r,r.J?r.ia:null,r.W),o.K){tt(r.h,o);var a=o,l=r.L;l&&(a.I=l),a.B&&(Ge(a),Be(a)),r.g=o}else mn(r);0<n.i.length&&dn(n)}else"stop"!=c[0]&&"close"!=c[0]||In(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?In(n,7):ln(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Ne()}catch(u){}}Me.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==rn(e)?t.j():this.Y(e)},Me.prototype.Y=function(e){try{if(e==this.g)e:{const h=rn(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||sn(this.g)))){this.J||4!=h||7==t||Ne(),Ge(this);var n=this.g.Z();this.X=n;t:if(Ve(this)){var r=sn(this.g);e="";var s=r.length,o=4==rn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ke(this),We(this);var a="";break t}this.h.i=new i.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(o&&t==s-1)});r.length=0,this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,s,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o})}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Te(12),Ke(this),We(this);break e}Ae(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ye(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<a.length;){if(e=ze(this,a),e==Fe){4==h&&(this.s=4,Te(14),n=!1),Ae(this.i,this.l,null,"[Incomplete Response]");break}if(e==De){this.s=4,Te(15),Ae(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}Ae(this.i,this.l,e,null),Ye(this,e)}if(Ve(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=a.length||this.h.h||(this.s=1,Te(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),yn(d),d.M=!0,Te(11))}}else Ae(this.i,this.l,a,"[Invalid Chunked Response]"),Ke(this),We(this)}else Ae(this.i,this.l,a,null),Ye(this,a);4==h&&Ke(this),this.o&&!this.J&&(4==h?xn(this.j,this):(this.o=!1,Be(this)))}else(function(e){const t={};e=(e.g&&2<=rn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var n=I(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,Te(12)):(this.s=0,Te(13)),Ke(this),We(this)}}}catch(Yt){}},Me.prototype.cancel=function(){this.J=!0,Ke(this)},Me.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(Ne(),Te(17)),Ke(this),this.s=2,We(this)):He(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Je(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Xe(e){return!!e.h||!!e.g&&e.g.size>=e.j}function $e(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return h(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}Je.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var it=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function st(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof st){this.h=e.h,at(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new wt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(it))?(this.h=!1,at(this,t[1]||"",!0),this.o=ht(t[2]||""),this.g=ht(t[3]||"",!0),lt(this,t[4]),this.l=ht(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=ht(t[7]||"")):(this.h=!1,this.i=new wt(null,this.h))}function ot(e){return new st(e)}function at(e,t,n){e.j=n?ht(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof wt?(e.i=t,function(e,t){t&&!e.j&&(It(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Et(this,t),St(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=ft(t,bt)),e.i=new wt(t,e.h))}function ut(e,t,n){e.i.set(t,n)}function dt(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ht(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ft(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,pt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}st.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ft(t,gt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ft(t,gt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ft(n,"/"==n.charAt(0)?vt:yt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ft(n,xt)),e.join("")};var mt,gt=/[#\/\?@]/g,yt=/[#\?:]/g,vt=/[#\?]/g,bt=/[#\?@]/g,xt=/#/g;function wt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function It(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function Et(e,t){It(e),t=Tt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Nt(e,t){return It(e),t=Tt(e,t),e.g.has(t)}function St(e,t,n){Et(e,t),0<n.length&&(e.i=null,e.g.set(Tt(e,t),h(n)),e.h+=n.length)}function Tt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function _t(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(s){}}function Ct(){this.g=new fe}function kt(e,t,n){const r=n||"";try{rt(e,function(e,n){let i=e;o(e)&&(i=de(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function At(e){this.l=e.Ub||null,this.j=e.eb||!1}function Rt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Pt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Ot(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Lt(e)}function Lt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Mt(e){let t="";return v(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function jt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Mt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ut(e,t,n))}function Dt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=wt.prototype).add=function(e,t){It(this),this.i=null,e=Tt(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){It(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.na=function(){It(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){It(this);let t=[];if("string"===typeof e)Nt(this,e)&&(t=t.concat(this.g.get(Tt(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return It(this),this.i=null,Nt(this,e=Tt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),o=this.V(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")},d(At,pe),At.prototype.g=function(){return new Rt(this.l,this.j)},At.prototype.i=(mt={},function(){return mt}),d(Rt,ne),(e=Rt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Lt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ot(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Lt(this)),this.g&&(this.readyState=3,Lt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Pt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ot(this):Lt(this),3==this.readyState&&Pt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Ot(this))},e.Qa=function(e){this.g&&(this.response=e,Ot(this))},e.ga=function(){this.g&&Ot(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Rt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),d(Dt,ne);var Qt=/^https?$/i,Jt=["POST","PUT"];function $t(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Zt(e),tn(e)}function Zt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function en(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=rn(e)||2!=e.Z()))if(e.u&&4==rn(e))se(e.Ea,0,e);else if(re(e,"readystatechange"),4==rn(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var s;if(s=0===r){var o=String(e.D).match(it)[1]||null;!o&&i.self&&i.self.location&&(o=i.self.location.protocol.slice(0,-1)),s=!Qt.test(o?o.toLowerCase():"")}n=s}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var a=2<rn(e)?e.g.statusText:""}catch(l){a=""}e.l=a+" ["+e.Z()+"]",Zt(e)}}finally{tn(e)}}}function tn(e,t){if(e.g){nn(e);const r=e.g,i=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{r.onreadystatechange=i}catch(n){}}}function nn(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function rn(e){return e.g?e.g.readyState:0}function sn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(Xt){return null}}function on(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function an(e){this.Aa=0,this.i=[],this.j=new ke,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=on("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=on("baseRetryDelayMs",5e3,e),this.cb=on("retryDelaySeedMs",1e4,e),this.Wa=on("forwardChannelMaxRetries",2,e),this.wa=on("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Je(e&&e.concurrentRequestLimit),this.Da=new Ct,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function ln(e){if(un(e),3==e.G){var t=e.U++,n=ot(e.I);if(ut(n,"SID",e.K),ut(n,"RID",t),ut(n,"TYPE","terminate"),fn(e,n),(t=new Me(e,e.j,t)).L=2,t.v=dt(ot(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&i.Image&&((new Image).src=t.v,n=!0),n||(t.g=Sn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),Be(t)}En(e)}function cn(e){e.g&&(yn(e),e.g.cancel(),e.g=null)}function un(e){cn(e),e.u&&(i.clearTimeout(e.u),e.u=null),bn(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function dn(e){if(!Xe(e.h)&&!e.s){e.s=!0;var t=e.Ga;_||A(),C||(_(),C=!0),k.add(t,e),e.B=0}}function hn(e,t){var n;n=t?t.l:e.U++;const r=ot(e.I);ut(r,"SID",e.K),ut(r,"RID",n),ut(r,"AID",e.T),fn(e,r),e.m&&e.o&&jt(r,e.m,e.o),n=new Me(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=pn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),qe(n,r,t)}function fn(e,t){e.H&&v(e.H,function(e,n){ut(t,n,e)}),e.l&&rt({},function(e,n){ut(t,n,e)})}function pn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].g;const a=i[o].map;if(n-=t,0>n)t=Math.max(0,i[o].g-100),s=!1;else try{kt(a,e,"req"+n+"_")}catch(Yt){r&&r(a)}}if(s){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function mn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;_||A(),C||(_(),C=!0),k.add(t,e),e.v=0}}function gn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ce(c(e.Fa,e),wn(e,e.v)),e.v++,!0)}function yn(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function vn(e){e.g=new Me(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=ot(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),fn(e,t),e.m&&e.o&&jt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=dt(ot(t)),n.m=null,n.P=!0,Ue(n,e)}function bn(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function xn(e,t){var n=null;if(e.g==t){bn(e),yn(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;re(r=Ie(),new _e(r,n)),dn(e)}else mn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!($e(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Ce(c(e.Ga,e,t),wn(e,e.B)),e.B++,!0))}(e,t)||2==r&&gn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:In(e,5);break;case 4:In(e,10);break;case 3:In(e,6);break;default:In(e,2)}}function wn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function In(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new st(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||at(r,"https"),dt(r),t?function(e,t){const n=new ke;if(i.Image){const r=new Image;r.onload=u(_t,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(_t,n,"TestLoadImage: error",!1,t,r),r.onabort=u(_t,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(_t,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new ke;const n=new AbortController,r=setTimeout(()=>{n.abort(),_t(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?_t(0,0,!0,t):_t(0,0,!1,t)}).catch(()=>{clearTimeout(r),_t(0,0,!1,t)})}(r.toString(),n)}else Te(2);e.G=0,e.l&&e.l.sa(t),En(e),un(e)}function En(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.ra()}}function Nn(e,t,n){var r=n instanceof st?ot(n):new st(n);if(""!=r.g)t&&(r.g=t+"."+r.g),lt(r,r.s);else{var s=i.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var o=new st(null);r&&at(o,r),t&&(o.g=t),s&&lt(o,s),n&&(o.l=n),r=o}return n=e.D,t=e.ya,n&&t&&ut(r,n,t),ut(r,"VER",e.la),fn(e,r),r}function Sn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Dt(new At({eb:n})):new Dt(e.pa)).Ha(e.J),t}function Tn(){}function _n(){}function Cn(e,t){ne.call(this),this.g=new an(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Rn(this)}function kn(e){ve.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function An(){be.call(this),this.status=1}function Rn(e){this.g=e}(e=Dt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Re.g(),this.v=this.o?me(this.o):me(Re),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(o){return void $t(this,o)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),s=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Jt,t,void 0))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,a]of n)this.g.setRequestHeader(i,a);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{nn(this),this.u=!0,this.g.send(e),this.u=!1}catch(o){$t(this,o)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),tn(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),tn(this,!0)),Dt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?en(this):this.bb())},e.bb=function(){en(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<rn(this)?this.g.status:-1}catch(mt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(mt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),he(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=an.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Te(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=Nn(this,null,this.W),dn(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new Me(this,this.j,e);let s=this.o;if(this.S&&(s?(s=b(s),w(s,this.S)):s=this.S),null!==this.m||this.O||(i.H=s,s=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=pn(this,i,t),ut(n=ot(this.I),"RID",e),ut(n,"CVER",22),this.D&&ut(n,"X-HTTP-Session-Id",this.D),fn(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Mt(s)))+"&"+t:this.m&&jt(n,this.m,s)),et(this.h,i),this.Ua&&ut(n,"TYPE","init"),this.P?(ut(n,"$req",t),ut(n,"SID","null"),i.T=!0,qe(i,n,null)):qe(i,n,t),this.G=2}}else 3==this.G&&(e?hn(this,e):0==this.i.length||Xe(this.h)||hn(this))},e.Fa=function(){if(this.u=null,vn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ce(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Te(10),cn(this),vn(this))},e.Za=function(){null!=this.C&&(this.C=null,cn(this),gn(this),Te(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Te(2)):(this.j.info("Failed to ping google.com"),Te(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=Tn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},_n.prototype.g=function(e,t){return new Cn(e,t)},d(Cn,ne),Cn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Cn.prototype.close=function(){ln(this.g)},Cn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=de(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&dn(t)},Cn.prototype.N=function(){this.g.l=null,delete this.j,ln(this.g),delete this.g,Cn.aa.N.call(this)},d(kn,ve),d(An,be),d(Rn,Tn),Rn.prototype.ua=function(){re(this.g,"a")},Rn.prototype.ta=function(e){re(this.g,new kn(e))},Rn.prototype.sa=function(e){re(this.g,new An)},Rn.prototype.ra=function(){re(this.g,"b")},_n.prototype.createWebChannel=_n.prototype.g,Cn.prototype.send=Cn.prototype.o,Cn.prototype.open=Cn.prototype.m,Cn.prototype.close=Cn.prototype.close,Gt=Kt.createWebChannelTransport=function(){return new _n},Ht=Kt.getStatEventTarget=function(){return Ie()},Bt=Kt.Event=xe,zt=Kt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Pe.NO_ERROR=0,Pe.TIMEOUT=8,Pe.HTTP_ERROR=6,Vt=Kt.ErrorCode=Pe,Oe.COMPLETE="complete",Ut=Kt.EventType=Oe,ge.EventType=ye,ye.OPEN="a",ye.CLOSE="b",ye.ERROR="c",ye.MESSAGE="d",ne.prototype.listen=ne.prototype.K,qt=Kt.WebChannel=ge,Kt.FetchXmlHttpFactory=At,Dt.prototype.listenOnce=Dt.prototype.L,Dt.prototype.getLastError=Dt.prototype.Ka,Dt.prototype.getLastErrorCode=Dt.prototype.Ba,Dt.prototype.getStatus=Dt.prototype.Z,Dt.prototype.getResponseJson=Dt.prototype.Oa,Dt.prototype.getResponseText=Dt.prototype.oa,Dt.prototype.send=Dt.prototype.ea,Dt.prototype.setWithCredentials=Dt.prototype.Ha,Ft=Kt.XhrIo=Dt}).apply("undefined"!==typeof Wt?Wt:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const Yt="@firebase/firestore";class Qt{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Qt.UNAUTHENTICATED=new Qt(null),Qt.GOOGLE_CREDENTIALS=new Qt("google-credentials-uid"),Qt.FIRST_PARTY=new Qt("first-party-uid"),Qt.MOCK_USER=new Qt("mock-user");let Jt="10.14.0";const Xt=new ge("@firebase/firestore");function $t(){return Xt.logLevel}function Zt(e){if(Xt.logLevel<=de.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(nn);Xt.debug("Firestore (".concat(Jt,"): ").concat(e),...i)}}function en(e){if(Xt.logLevel<=de.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(nn);Xt.error("Firestore (".concat(Jt,"): ").concat(e),...i)}}function tn(e){if(Xt.logLevel<=de.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(nn);Xt.warn("Firestore (".concat(Jt,"): ").concat(e),...i)}}function nn(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function rn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state";const t="FIRESTORE (".concat(Jt,") INTERNAL ASSERTION FAILED: ")+e;throw en(t),new Error(t)}function sn(e,t){e||rn()}function on(e,t){return e}const an={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ln extends Q{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class cn{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class un{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class dn{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Qt.UNAUTHENTICATED))}shutdown(){}}class hn{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class fn{constructor(e){this.t=e,this.currentUser=Qt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){sn(void 0===this.o);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new cn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new cn,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},o=e=>{Zt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(Zt("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new cn)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(Zt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(sn("string"==typeof t.accessToken),new un(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return sn(null===e||"string"==typeof e),new Qt(e)}}class pn{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Qt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class mn{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new pn(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Qt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class gn{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class yn{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){sn(void 0===this.o);const n=e=>{null!=e.error&&Zt("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.R;return this.R=e.token,Zt("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{Zt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):Zt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(sn("string"==typeof e.token),this.R=e.token,new gn(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function vn(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class bn{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=vn(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function xn(e,t){return e<t?-1:e>t?1:0}function wn(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}class In{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ln(an.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ln(an.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new ln(an.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ln(an.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return In.fromMillis(Date.now())}static fromDate(e){return In.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new In(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?xn(this.nanoseconds,e.nanoseconds):xn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class En{constructor(e){this.timestamp=e}static fromTimestamp(e){return new En(e)}static min(){return new En(new In(0,0))}static max(){return new En(new In(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Nn{constructor(e,t,n){void 0===t?t=0:t>e.length&&rn(),void 0===n?n=e.length-t:n>e.length-t&&rn(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Nn.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Nn?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Sn extends Nn{construct(e,t,n){return new Sn(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new ln(an.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));e.push(...i.split("/").filter(e=>e.length>0))}return new Sn(e)}static emptyPath(){return new Sn([])}}const Tn=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class _n extends Nn{construct(e,t,n){return new _n(e,t,n)}static isValidIdentifier(e){return Tn.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new _n(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new ln(an.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new ln(an.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new ln(an.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new ln(an.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new _n(t)}static emptyPath(){return new _n([])}}class Cn{constructor(e){this.path=e}static fromPath(e){return new Cn(Sn.fromString(e))}static fromName(e){return new Cn(Sn.fromString(e).popFirst(5))}static empty(){return new Cn(Sn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Sn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Sn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Cn(new Sn(e.slice()))}}class kn{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}kn.UNKNOWN_ID=-1;function An(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=En.fromTimestamp(1e9===r?new In(n+1,0):new In(n,r));return new Pn(i,Cn.empty(),t)}function Rn(e){return new Pn(e.readTime,e.key,-1)}class Pn{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Pn(En.min(),Cn.empty(),-1)}static max(){return new Pn(En.max(),Cn.empty(),-1)}}function On(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Cn.comparator(e.documentKey,t.documentKey),0!==n?n:xn(e.largestBatchId,t.largestBatchId))}const Ln="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Mn{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function jn(e){if(e.code!==an.FAILED_PRECONDITION||e.message!==Ln)throw e;Zt("LocalStore","Unexpectedly lost primary lease")}class Dn{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&rn(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Dn((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Dn?t:Dn.resolve(t)}catch(e){return Dn.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Dn.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Dn.reject(t)}static resolve(e){return new Dn((t,n)=>{t(e)})}static reject(e){return new Dn((t,n)=>{n(e)})}static waitFor(e){return new Dn((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=Dn.resolve(!1);for(const n of e)t=t.next(e=>e?Dn.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new Dn((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next(e=>{s[l]=e,++o,o===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new Dn((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}function Fn(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function qn(e){return"IndexedDbTransactionError"===e.name}class Un{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function Vn(e){return null==e}function zn(e){return 0===e&&1/e==-1/0}function Bn(e){return"number"==typeof e&&Number.isInteger(e)&&!zn(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}Un.oe=-1;const Hn=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Gn=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Wn=Gn,Kn=[...Wn,"indexConfiguration","indexState","indexEntries"];function Yn(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Qn(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Jn(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Xn{constructor(e,t){this.comparator=e,this.root=t||Zn.EMPTY}insert(e,t){return new Xn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Zn.BLACK,null,null))}remove(e){return new Xn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Zn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $n(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $n(this.root,e,this.comparator,!1)}getReverseIterator(){return new $n(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $n(this.root,e,this.comparator,!0)}}class $n{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Zn{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Zn.RED,this.left=null!=r?r:Zn.EMPTY,this.right=null!=i?i:Zn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Zn(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Zn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Zn.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Zn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Zn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw rn();if(this.right.isRed())throw rn();const e=this.left.check();if(e!==this.right.check())throw rn();return e+(this.isRed()?0:1)}}Zn.EMPTY=null,Zn.RED=!0,Zn.BLACK=!1,Zn.EMPTY=new class{constructor(){this.size=0}get key(){throw rn()}get value(){throw rn()}get color(){throw rn()}get left(){throw rn()}get right(){throw rn()}copy(e,t,n,r,i){return this}insert(e,t,n){return new Zn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class er{constructor(e){this.comparator=e,this.data=new Xn(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new tr(this.data.getIterator())}getIteratorFrom(e){return new tr(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof er))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new er(this.comparator);return t.data=e,t}}class tr{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class nr{constructor(e){this.fields=e,e.sort(_n.comparator)}static empty(){return new nr([])}unionWith(e){let t=new er(_n.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new nr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return wn(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class rr extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ir{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new rr("Invalid base64 string: "+e):e}}(e);return new ir(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new ir(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ir.EMPTY_BYTE_STRING=new ir("");const sr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function or(e){if(sn(!!e),"string"==typeof e){let t=0;const n=sr.exec(e);if(sn(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:ar(e.seconds),nanos:ar(e.nanos)}}function ar(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function lr(e){return"string"==typeof e?ir.fromBase64String(e):ir.fromUint8Array(e)}function cr(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ur(e){const t=e.mapValue.fields.__previous_value__;return cr(t)?ur(t):t}function dr(e){const t=or(e.mapValue.fields.__local_write_time__.timestampValue);return new In(t.seconds,t.nanos)}class hr{constructor(e,t,n,r,i,s,o,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l}}class fr{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new fr("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof fr&&e.projectId===this.projectId&&e.database===this.database}}const pr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function mr(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?cr(e)?4:Rr(e)?9007199254740991:kr(e)?10:11:rn()}function gr(e,t){if(e===t)return!0;const n=mr(e);if(n!==mr(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return dr(e).isEqual(dr(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=or(e.timestampValue),r=or(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return lr(e.bytesValue).isEqual(lr(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return ar(e.geoPointValue.latitude)===ar(t.geoPointValue.latitude)&&ar(e.geoPointValue.longitude)===ar(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return ar(e.integerValue)===ar(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=ar(e.doubleValue),r=ar(t.doubleValue);return n===r?zn(n)===zn(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return wn(e.arrayValue.values||[],t.arrayValue.values||[],gr);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Yn(n)!==Yn(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!gr(n[i],r[i])))return!1;return!0}(e,t);default:return rn()}}function yr(e,t){return void 0!==(e.values||[]).find(e=>gr(e,t))}function vr(e,t){if(e===t)return 0;const n=mr(e),r=mr(t);if(n!==r)return xn(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return xn(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=ar(e.integerValue||e.doubleValue),r=ar(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return br(e.timestampValue,t.timestampValue);case 4:return br(dr(e),dr(t));case 5:return xn(e.stringValue,t.stringValue);case 6:return function(e,t){const n=lr(e),r=lr(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=xn(n[i],r[i]);if(0!==e)return e}return xn(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=xn(ar(e.latitude),ar(t.latitude));return 0!==n?n:xn(ar(e.longitude),ar(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return xr(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,s;const o=e.fields||{},a=t.fields||{},l=null===(n=o.value)||void 0===n?void 0:n.arrayValue,c=null===(r=a.value)||void 0===r?void 0:r.arrayValue,u=xn((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(s=null==c?void 0:c.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:xr(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===pr.mapValue&&t===pr.mapValue)return 0;if(e===pr.mapValue)return 1;if(t===pr.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=xn(r[o],s[o]);if(0!==e)return e;const t=vr(n[r[o]],i[s[o]]);if(0!==t)return t}return xn(r.length,s.length)}(e.mapValue,t.mapValue);default:throw rn()}}function br(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return xn(e,t);const n=or(e),r=or(t),i=xn(n.seconds,r.seconds);return 0!==i?i:xn(n.nanos,r.nanos)}function xr(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=vr(n[i],r[i]);if(e)return e}return xn(n.length,r.length)}function wr(e){return Ir(e)}function Ir(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=or(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return lr(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Cn.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Ir(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+="".concat(i,":").concat(Ir(e.fields[i]));return n+"}"}(e.mapValue):rn()}function Er(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Nr(e){return!!e&&"integerValue"in e}function Sr(e){return!!e&&"arrayValue"in e}function Tr(e){return!!e&&"nullValue"in e}function _r(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Cr(e){return!!e&&"mapValue"in e}function kr(e){var t,n;return"__vector__"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ar(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Qn(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Ar(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Ar(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Rr(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class Pr{constructor(e){this.value=e}static empty(){return new Pr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Cr(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ar(t)}setAll(e){let t=_n.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Ar(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Cr(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return gr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Cr(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Qn(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new Pr(Ar(this.value))}}function Or(e){const t=[];return Qn(e.fields,(e,n)=>{const r=new _n([e]);if(Cr(n)){const e=Or(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new nr(t)}class Lr{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Lr(e,0,En.min(),En.min(),En.min(),Pr.empty(),0)}static newFoundDocument(e,t,n,r){return new Lr(e,1,t,En.min(),n,r,0)}static newNoDocument(e,t){return new Lr(e,2,t,En.min(),En.min(),Pr.empty(),0)}static newUnknownDocument(e,t){return new Lr(e,3,t,En.min(),En.min(),Pr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(En.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=En.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Lr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Lr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class Mr{constructor(e,t){this.position=e,this.inclusive=t}}function jr(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?Cn.comparator(Cn.fromName(o.referenceValue),n.key):vr(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Dr(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!gr(e.position[n],t.position[n]))return!1;return!0}class Fr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function qr(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Ur{}class Vr extends Ur{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Qr(e,t,n):"array-contains"===t?new Zr(e,n):"in"===t?new ei(e,n):"not-in"===t?new ti(e,n):"array-contains-any"===t?new ni(e,n):new Vr(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Jr(e,n):new Xr(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(vr(t,this.value)):null!==t&&mr(this.value)===mr(t)&&this.matchesComparison(vr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return rn()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zr extends Ur{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new zr(e,t)}matches(e){return Br(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Br(e){return"and"===e.op}function Hr(e){return Gr(e)&&Br(e)}function Gr(e){for(const t of e.filters)if(t instanceof zr)return!1;return!0}function Wr(e){if(e instanceof Vr)return e.field.canonicalString()+e.op.toString()+wr(e.value);if(Hr(e))return e.filters.map(e=>Wr(e)).join(",");{const t=e.filters.map(e=>Wr(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function Kr(e,t){return e instanceof Vr?function(e,t){return t instanceof Vr&&e.op===t.op&&e.field.isEqual(t.field)&&gr(e.value,t.value)}(e,t):e instanceof zr?function(e,t){return t instanceof zr&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&Kr(n,t.filters[r]),!0)}(e,t):void rn()}function Yr(e){return e instanceof Vr?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(wr(e.value))}(e):e instanceof zr?function(e){return e.op.toString()+" {"+e.getFilters().map(Yr).join(" ,")+"}"}(e):"Filter"}class Qr extends Vr{constructor(e,t,n){super(e,t,n),this.key=Cn.fromName(n.referenceValue)}matches(e){const t=Cn.comparator(e.key,this.key);return this.matchesComparison(t)}}class Jr extends Vr{constructor(e,t){super(e,"in",t),this.keys=$r("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Xr extends Vr{constructor(e,t){super(e,"not-in",t),this.keys=$r("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function $r(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>Cn.fromName(e.referenceValue))}class Zr extends Vr{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Sr(t)&&yr(t.arrayValue,this.value)}}class ei extends Vr{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&yr(this.value.arrayValue,t)}}class ti extends Vr{constructor(e,t){super(e,"not-in",t)}matches(e){if(yr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!yr(this.value.arrayValue,t)}}class ni extends Vr{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Sr(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>yr(this.value.arrayValue,e))}}class ri{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ue=null}}function ii(e){return new ri(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function si(e){const t=on(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Wr(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Vn(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>wr(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>wr(e)).join(",")),t.ue=e}return t.ue}function oi(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!qr(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Kr(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Dr(e.startAt,t.startAt)&&Dr(e.endAt,t.endAt)}function ai(e){return Cn.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class li{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function ci(e,t,n,r,i,s,o,a){return new li(e,t,n,r,i,s,o,a)}function ui(e){return new li(e)}function di(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function hi(e){return null!==e.collectionGroup}function fi(e){const t=on(e);if(null===t.ce){t.ce=[];const e=new Set;for(const i of t.explicitOrderBy)t.ce.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new er(_n.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.ce.push(new Fr(r,n))}),e.has(_n.keyField().canonicalString())||t.ce.push(new Fr(_n.keyField(),n))}return t.ce}function pi(e){const t=on(e);return t.le||(t.le=mi(t,fi(e))),t.le}function mi(e,t){if("F"===e.limitType)return ii(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new Fr(e.field,t)});const n=e.endAt?new Mr(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Mr(e.startAt.position,e.startAt.inclusive):null;return ii(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function gi(e,t){const n=e.filters.concat([t]);return new li(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function yi(e,t,n){return new li(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function vi(e,t){return oi(pi(e),pi(t))&&e.limitType===t.limitType}function bi(e){return"".concat(si(pi(e)),"|lt:").concat(e.limitType)}function xi(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>Yr(e)).join(", "),"]")),Vn(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>wr(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>wr(e)).join(",")),"Target(".concat(t,")")}(pi(e)),"; limitType=").concat(e.limitType,")")}function wi(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Cn.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of fi(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=jr(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,fi(e),t))&&!(e.endAt&&!function(e,t,n){const r=jr(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,fi(e),t))}(e,t)}function Ii(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Ei(e){return(t,n)=>{let r=!1;for(const i of fi(e)){const e=Ni(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Ni(e,t,n){const r=e.field.isKeyField()?Cn.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?vr(r,i):rn()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return rn()}}class Si{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Qn(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return Jn(this.inner)}size(){return this.innerSize}}const Ti=new Xn(Cn.comparator);function _i(){return Ti}const Ci=new Xn(Cn.comparator);function ki(){let e=Ci;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function Ai(e){let t=Ci;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Ri(){return Oi()}function Pi(){return Oi()}function Oi(){return new Si(e=>e.toString(),(e,t)=>e.isEqual(t))}const Li=new Xn(Cn.comparator),Mi=new er(Cn.comparator);function ji(){let e=Mi;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const Di=new er(xn);function Fi(){return Di}function qi(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zn(t)?"-0":t}}function Ui(e){return{integerValue:""+e}}function Vi(e,t){return Bn(t)?Ui(t):qi(e,t)}class zi{constructor(){this._=void 0}}function Bi(e,t,n){return e instanceof Wi?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&cr(t)&&(t=ur(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Ki?Yi(e,t):e instanceof Qi?Ji(e,t):function(e,t){const n=Gi(e,t),r=$i(n)+$i(e.Pe);return Nr(n)&&Nr(e.Pe)?Ui(r):qi(e.serializer,r)}(e,t)}function Hi(e,t,n){return e instanceof Ki?Yi(e,t):e instanceof Qi?Ji(e,t):n}function Gi(e,t){return e instanceof Xi?function(e){return Nr(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Wi extends zi{}class Ki extends zi{constructor(e){super(),this.elements=e}}function Yi(e,t){const n=Zi(t);for(const r of e.elements)n.some(e=>gr(e,r))||n.push(r);return{arrayValue:{values:n}}}class Qi extends zi{constructor(e){super(),this.elements=e}}function Ji(e,t){let n=Zi(t);for(const r of e.elements)n=n.filter(e=>!gr(e,r));return{arrayValue:{values:n}}}class Xi extends zi{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function $i(e){return ar(e.integerValue||e.doubleValue)}function Zi(e){return Sr(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class es{constructor(e,t){this.field=e,this.transform=t}}class ts{constructor(e,t){this.version=e,this.transformResults=t}}class ns{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ns}static exists(e){return new ns(void 0,e)}static updateTime(e){return new ns(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function rs(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class is{}function ss(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new ms(e.key,ns.none()):new us(e.key,e.data,ns.none());{const n=e.data,r=Pr.empty();let i=new er(_n.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new ds(e.key,r,new nr(i.toArray()),ns.none())}}function os(e,t,n){e instanceof us?function(e,t,n){const r=e.value.clone(),i=fs(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof ds?function(e,t,n){if(!rs(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=fs(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(hs(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function as(e,t,n,r){return e instanceof us?function(e,t,n,r){if(!rs(e.precondition,t))return n;const i=e.value.clone(),s=ps(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof ds?function(e,t,n,r){if(!rs(e.precondition,t))return n;const i=ps(e.fieldTransforms,r,t),s=t.data;return s.setAll(hs(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return rs(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function ls(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Gi(r.transform,e||null);null!=i&&(null===n&&(n=Pr.empty()),n.set(r.field,i))}return n||null}function cs(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&wn(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Ki&&t instanceof Ki||e instanceof Qi&&t instanceof Qi?wn(e.elements,t.elements,gr):e instanceof Xi&&t instanceof Xi?gr(e.Pe,t.Pe):e instanceof Wi&&t instanceof Wi}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class us extends is{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class ds extends is{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function hs(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function fs(e,t,n){const r=new Map;sn(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,Hi(o,a,n[i]))}return r}function ps(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,Bi(e,s,t))}return r}class ms extends is{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class gs extends is{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class ys{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&os(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=as(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=as(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Pi();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=ss(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(En.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ji())}isEqual(e){return this.batchId===e.batchId&&wn(this.mutations,e.mutations,(e,t)=>cs(e,t))&&wn(this.baseMutations,e.baseMutations,(e,t)=>cs(e,t))}}class vs{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){sn(e.mutations.length===n.length);let r=Li;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new vs(e,t,n,r)}}class bs{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class xs{constructor(e,t){this.count=e,this.unchangedNames=t}}var ws,Is;function Es(e){switch(e){default:return rn();case an.CANCELLED:case an.UNKNOWN:case an.DEADLINE_EXCEEDED:case an.RESOURCE_EXHAUSTED:case an.INTERNAL:case an.UNAVAILABLE:case an.UNAUTHENTICATED:return!1;case an.INVALID_ARGUMENT:case an.NOT_FOUND:case an.ALREADY_EXISTS:case an.PERMISSION_DENIED:case an.FAILED_PRECONDITION:case an.ABORTED:case an.OUT_OF_RANGE:case an.UNIMPLEMENTED:case an.DATA_LOSS:return!0}}function Ns(e){if(void 0===e)return en("GRPC error has no .code"),an.UNKNOWN;switch(e){case ws.OK:return an.OK;case ws.CANCELLED:return an.CANCELLED;case ws.UNKNOWN:return an.UNKNOWN;case ws.DEADLINE_EXCEEDED:return an.DEADLINE_EXCEEDED;case ws.RESOURCE_EXHAUSTED:return an.RESOURCE_EXHAUSTED;case ws.INTERNAL:return an.INTERNAL;case ws.UNAVAILABLE:return an.UNAVAILABLE;case ws.UNAUTHENTICATED:return an.UNAUTHENTICATED;case ws.INVALID_ARGUMENT:return an.INVALID_ARGUMENT;case ws.NOT_FOUND:return an.NOT_FOUND;case ws.ALREADY_EXISTS:return an.ALREADY_EXISTS;case ws.PERMISSION_DENIED:return an.PERMISSION_DENIED;case ws.FAILED_PRECONDITION:return an.FAILED_PRECONDITION;case ws.ABORTED:return an.ABORTED;case ws.OUT_OF_RANGE:return an.OUT_OF_RANGE;case ws.UNIMPLEMENTED:return an.UNIMPLEMENTED;case ws.DATA_LOSS:return an.DATA_LOSS;default:return rn()}}(Is=ws||(ws={}))[Is.OK=0]="OK",Is[Is.CANCELLED=1]="CANCELLED",Is[Is.UNKNOWN=2]="UNKNOWN",Is[Is.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Is[Is.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Is[Is.NOT_FOUND=5]="NOT_FOUND",Is[Is.ALREADY_EXISTS=6]="ALREADY_EXISTS",Is[Is.PERMISSION_DENIED=7]="PERMISSION_DENIED",Is[Is.UNAUTHENTICATED=16]="UNAUTHENTICATED",Is[Is.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Is[Is.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Is[Is.ABORTED=10]="ABORTED",Is[Is.OUT_OF_RANGE=11]="OUT_OF_RANGE",Is[Is.UNIMPLEMENTED=12]="UNIMPLEMENTED",Is[Is.INTERNAL=13]="INTERNAL",Is[Is.UNAVAILABLE=14]="UNAVAILABLE",Is[Is.DATA_LOSS=15]="DATA_LOSS";let Ss=null;function Ts(){return new TextEncoder}const _s=new Lt([4294967295,4294967295],0);function Cs(e){const t=Ts().encode(e),n=new Mt;return n.update(t),new Uint8Array(n.digest())}function ks(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Lt([n,r],0),new Lt([i,s],0)]}class As{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Rs("Invalid padding: ".concat(t));if(n<0)throw new Rs("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new Rs("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new Rs("Invalid padding when bitmap length is 0: ".concat(t));this.Ie=8*e.length-t,this.Te=Lt.fromNumber(this.Ie)}Ee(e,t,n){let r=e.add(t.multiply(Lt.fromNumber(n)));return 1===r.compare(_s)&&(r=new Lt([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=Cs(e),[n,r]=ks(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);if(!this.de(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new As(i,r,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.Ie)return;const t=Cs(e),[n,r]=ks(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Rs extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Ps{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Os.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Ps(En.min(),r,new Xn(xn),_i(),ji())}}class Os{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Os(n,t,ji(),ji(),ji())}}class Ls{constructor(e,t,n,r){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=r}}class Ms{constructor(e,t){this.targetId=e,this.me=t}}class js{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ir.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Ds{constructor(){this.fe=0,this.ge=Us(),this.pe=ir.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ji(),t=ji(),n=ji();return this.ge.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:rn()}}),new Os(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=Us()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,sn(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Fs{constructor(e){this.Le=e,this.Be=new Map,this.ke=_i(),this.qe=qs(),this.Qe=new Xn(xn)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:rn()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((e,n)=>{this.ze(n)&&t(n)})}He(e){const t=e.targetId,n=e.me.count,r=this.Je(t);if(r){const i=r.target;if(ai(i))if(0===n){const e=new Cn(i.path);this.Ue(t,e,Lr.newNoDocument(e,En.min()))}else sn(1===n);else{const r=this.Ye(t);if(r!==n){const n=this.Ze(e),i=n?this.Xe(n,e,r):1;if(0!==i){this.je(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==Ss||Ss.et(function(e,t,n,r,i){var s,o,a,l,c,u;const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===i,hashCount:null!==(s=null==h?void 0:h.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(l=null===(a=null===(o=null==h?void 0:h.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),d}(r,e.me,this.Le.tt(),n,i))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=lr(n).toUint8Array()}catch(e){if(e instanceof rr)return tn("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new As(s,r,i)}catch(e){return tn(e instanceof Rs?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.Ie?null:o}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const i=this.Le.tt(),s="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(n.path.canonicalString());e.mightContain(s)||(this.Ue(t,n,null),r++)}),r}rt(e){const t=new Map;this.Be.forEach((n,r)=>{const i=this.Je(r);if(i){if(n.current&&ai(i.target)){const t=new Cn(i.target.path);null!==this.ke.get(t)||this.it(r,t)||this.Ue(r,t,Lr.newNoDocument(t,e))}n.be&&(t.set(r,n.ve()),n.Ce())}});let n=ji();this.qe.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.ke.forEach((t,n)=>n.setReadTime(e));const r=new Ps(e,t,this.Qe,this.ke,n);return this.ke=_i(),this.qe=qs(),this.Qe=new Xn(xn),r}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Ds,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new er(xn),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||Zt("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ds),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function qs(){return new Xn(Cn.comparator)}function Us(){return new Xn(Cn.comparator)}const Vs={asc:"ASCENDING",desc:"DESCENDING"},zs={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Bs={and:"AND",or:"OR"};class Hs{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Gs(e,t){return e.useProto3Json||Vn(t)?t:{value:t}}function Ws(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Ks(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Ys(e,t){return Ws(e,t.toTimestamp())}function Qs(e){return sn(!!e),En.fromTimestamp(function(e){const t=or(e);return new In(t.seconds,t.nanos)}(e))}function Js(e,t){return Xs(e,t).canonicalString()}function Xs(e,t){const n=function(e){return new Sn(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function $s(e){const t=Sn.fromString(e);return sn(bo(t)),t}function Zs(e,t){return Js(e.databaseId,t.path)}function eo(e,t){const n=$s(t);if(n.get(1)!==e.databaseId.projectId)throw new ln(an.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new ln(an.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Cn(io(n))}function to(e,t){return Js(e.databaseId,t)}function no(e){const t=$s(e);return 4===t.length?Sn.emptyPath():io(t)}function ro(e){return new Sn(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function io(e){return sn(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function so(e,t,n){return{name:Zs(e,t),fields:n.value.mapValue.fields}}function oo(e,t){let n;if(t instanceof us)n={update:so(e,t.key,t.value)};else if(t instanceof ms)n={delete:Zs(e,t.key)};else if(t instanceof ds)n={update:so(e,t.key,t.data),updateMask:vo(t.fieldMask)};else{if(!(t instanceof gs))return rn();n={verify:Zs(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof Wi)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ki)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Qi)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Xi)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw rn()}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Ys(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:rn()}(e,t.precondition)),n}function ao(e,t){return{documents:[to(e,t.path)]}}function lo(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=to(e,i);const s=function(e){if(0!==e.length)return yo(zr.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:mo(e.field),direction:ho(e.dir)}}(e))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Gs(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:i}}function co(e){let t=no(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){sn(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=uo(e);return t instanceof zr&&Hr(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map(e=>function(e){return new Fr(go(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Vn(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Mr(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Mr(n,t)}(n.endAt)),ci(t,i,o,s,a,"F",l,c)}function uo(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=go(e.unaryFilter.field);return Vr.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=go(e.unaryFilter.field);return Vr.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=go(e.unaryFilter.field);return Vr.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=go(e.unaryFilter.field);return Vr.create(i,"!=",{nullValue:"NULL_VALUE"});default:return rn()}}(e):void 0!==e.fieldFilter?function(e){return Vr.create(go(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return rn()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return zr.create(e.compositeFilter.filters.map(e=>uo(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return rn()}}(e.compositeFilter.op))}(e):rn()}function ho(e){return Vs[e]}function fo(e){return zs[e]}function po(e){return Bs[e]}function mo(e){return{fieldPath:e.canonicalString()}}function go(e){return _n.fromServerFormat(e.fieldPath)}function yo(e){return e instanceof Vr?function(e){if("=="===e.op){if(_r(e.value))return{unaryFilter:{field:mo(e.field),op:"IS_NAN"}};if(Tr(e.value))return{unaryFilter:{field:mo(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(_r(e.value))return{unaryFilter:{field:mo(e.field),op:"IS_NOT_NAN"}};if(Tr(e.value))return{unaryFilter:{field:mo(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:mo(e.field),op:fo(e.op),value:e.value}}}(e):e instanceof zr?function(e){const t=e.getFilters().map(e=>yo(e));return 1===t.length?t[0]:{compositeFilter:{op:po(e.op),filters:t}}}(e):rn()}function vo(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function bo(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class xo{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:En.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:En.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ir.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new xo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new xo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new xo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new xo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class wo{constructor(e){this.ct=e}}function Io(e){const t=co({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?yi(t,t.limit,"L"):t}class Eo{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(ar(e.integerValue));else if("doubleValue"in e){const n=ar(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),zn(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),"string"==typeof n&&(n=or(n)),t.Rt("".concat(n.seconds||"")),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(lr(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?Rr(e)?this.dt(t,Number.MAX_SAFE_INTEGER):kr(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):rn()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const r of Object.keys(n))this.Vt(r,t),this.Tt(n[r],t)}wt(e,t){var n,r;const i=e.fields||{};this.dt(t,53);const s="value",o=(null===(r=null===(n=i[s].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.dt(t,15),t.At(ar(o)),this.Vt(s,t),this.Tt(i[s],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const r of n)this.Tt(r,t)}yt(e,t){this.dt(t,37),Cn.fromName(e).path.forEach(e=>{this.dt(t,60),this.Dt(e,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}Eo.vt=new Eo;class No{constructor(){this.un=new So}addToCollectionParentIndex(e,t){return this.un.add(t),Dn.resolve()}getCollectionParents(e,t){return Dn.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return Dn.resolve()}deleteFieldIndex(e,t){return Dn.resolve()}deleteAllFieldIndexes(e){return Dn.resolve()}createTargetIndexes(e,t){return Dn.resolve()}getDocumentsMatchingTarget(e,t){return Dn.resolve(null)}getIndexType(e,t){return Dn.resolve(0)}getFieldIndexes(e,t){return Dn.resolve([])}getNextCollectionGroupToUpdate(e){return Dn.resolve(null)}getMinOffset(e,t){return Dn.resolve(Pn.min())}getMinOffsetFromCollectionGroup(e,t){return Dn.resolve(Pn.min())}updateCollectionGroup(e,t,n){return Dn.resolve()}updateIndexEntries(e,t){return Dn.resolve()}}class So{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new er(Sn.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new er(Sn.comparator)).toArray()}}new Uint8Array(0);class To{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new To(e,To.DEFAULT_COLLECTION_PERCENTILE,To.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}To.DEFAULT_COLLECTION_PERCENTILE=10,To.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,To.DEFAULT=new To(41943040,To.DEFAULT_COLLECTION_PERCENTILE,To.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),To.DISABLED=new To(-1,0,0);class _o{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new _o(0)}static kn(){return new _o(-1)}}class Co{constructor(){this.changes=new Si(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Lr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Dn.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class ko{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Ao{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&as(n.mutation,e,nr.empty(),In.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,ji()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ji();const r=Ri();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=ki();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Ri();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,ji()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=_i();const s=Oi(),o=Oi();return t.forEach((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof ds)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),as(o.mutation,t,o.mutation.getFieldMask(),In.now())):s.set(t.key,nr.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new ko(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){const n=Oi();let r=new Xn((e,t)=>e-t),i=ji();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||nr.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||ji()).add(e);r=r.insert(i.batchId,a)})}).next(()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,l=r.value,c=Pi();l.forEach(e=>{if(!i.has(e)){const r=ss(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return Dn.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return Cn.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):hi(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Dn.resolve(Ri());let o=-1,a=i;return s.next(t=>Dn.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?Dn.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,a,t,ji())).next(e=>({batchId:o,changes:Ai(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Cn(t)).next(e=>{let t=ki();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=ki();return this.indexManager.getCollectionParents(e,i).next(o=>Dn.forEach(o,o=>{const a=function(e,t){return new li(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Lr.newInvalidDocument(r)))});let n=ki();return e.forEach((e,r)=>{const s=i.get(e);void 0!==s&&as(s.mutation,r,nr.empty(),In.now()),wi(t,r)&&(n=n.insert(e,r))}),n})}}class Ro{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return Dn.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Qs(e.createTime)}}(t)),Dn.resolve()}getNamedQuery(e,t){return Dn.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(e){return{name:e.name,query:Io(e.bundledQuery),readTime:Qs(e.readTime)}}(t)),Dn.resolve()}}class Po{constructor(){this.overlays=new Xn(Cn.comparator),this.Ir=new Map}getOverlay(e,t){return Dn.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Ri();return Dn.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.ht(e,t,r)}),Dn.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Ir.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.Ir.delete(n)),Dn.resolve()}getOverlaysForCollection(e,t,n){const r=Ri(),i=t.length+1,s=new Cn(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Dn.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Xn((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Ri(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Ri(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return Dn.resolve(o)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Ir.get(r.largestBatchId).delete(n.key);this.Ir.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new bs(t,n));let i=this.Ir.get(t);void 0===i&&(i=ji(),this.Ir.set(t,i)),this.Ir.set(t,i.add(n.key))}}class Oo{constructor(){this.sessionToken=ir.EMPTY_BYTE_STRING}getSessionToken(e){return Dn.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Dn.resolve()}}class Lo{constructor(){this.Tr=new er(Mo.Er),this.dr=new er(Mo.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new Mo(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Vr(new Mo(e,t))}mr(e,t){e.forEach(e=>this.removeReference(e,t))}gr(e){const t=new Cn(new Sn([])),n=new Mo(t,e),r=new Mo(t,e+1),i=[];return this.dr.forEachInRange([n,r],e=>{this.Vr(e),i.push(e.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new Cn(new Sn([])),n=new Mo(t,e),r=new Mo(t,e+1);let i=ji();return this.dr.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new Mo(e,0),n=this.Tr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Mo{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return Cn.comparator(e.key,t.key)||xn(e.wr,t.wr)}static Ar(e,t){return xn(e.wr,t.wr)||Cn.comparator(e.key,t.key)}}class jo{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new er(Mo.Er)}checkEmpty(e){return Dn.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new ys(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.br=this.br.add(new Mo(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Dn.resolve(s)}lookupMutationBatch(e,t){return Dn.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.vr(n),i=r<0?0:r;return Dn.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Dn.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return Dn.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Mo(t,0),r=new Mo(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,r],e=>{const t=this.Dr(e.wr);i.push(t)}),Dn.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new er(xn);return t.forEach(e=>{const t=new Mo(e,0),r=new Mo(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,r],e=>{n=n.add(e.wr)})}),Dn.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Cn.isDocumentKey(i)||(i=i.child(""));const s=new Mo(new Cn(i),0);let o=new er(xn);return this.br.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.wr)),!0)},s),Dn.resolve(this.Cr(o))}Cr(e){const t=[];return e.forEach(e=>{const n=this.Dr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){sn(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.br;return Dn.forEach(t.mutations,r=>{const i=new Mo(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,t){const n=new Mo(t,0),r=this.br.firstAfterOrEqual(n);return Dn.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Dn.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Do{constructor(e){this.Mr=e,this.docs=new Xn(Cn.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Dn.resolve(n?n.document.mutableCopy():Lr.newInvalidDocument(t))}getEntries(e,t){let n=_i();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Lr.newInvalidDocument(e))}),Dn.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=_i();const s=t.path,o=new Cn(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||On(Rn(o),n)<=0||(r.has(o.key)||wi(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return Dn.resolve(i)}getAllFromCollectionGroup(e,t,n,r){rn()}Or(e,t){return Dn.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Fo(this)}getSize(e){return Dn.resolve(this.size)}}class Fo extends Co{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(n)}),Dn.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class qo{constructor(e){this.persistence=e,this.Nr=new Si(e=>si(e),oi),this.lastRemoteSnapshotVersion=En.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Lo,this.targetCount=0,this.kr=_o.Bn()}forEachTarget(e,t){return this.Nr.forEach((e,n)=>t(n)),Dn.resolve()}getLastRemoteSnapshotVersion(e){return Dn.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Dn.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Dn.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),Dn.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new _o(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,Dn.resolve()}updateTargetData(e,t){return this.Kn(t),Dn.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,Dn.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Nr.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Nr.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),Dn.waitFor(i).next(()=>r)}getTargetCount(e){return Dn.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return Dn.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),Dn.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),Dn.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),Dn.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return Dn.resolve(n)}containsKey(e,t){return Dn.resolve(this.Br.containsKey(t))}}class Uo{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Un(0),this.Kr=!1,this.Kr=!0,this.$r=new Oo,this.referenceDelegate=e(this),this.Ur=new qo(this),this.indexManager=new No,this.remoteDocumentCache=function(e){return new Do(e)}(e=>this.referenceDelegate.Wr(e)),this.serializer=new wo(t),this.Gr=new Ro(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Po,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new jo(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){Zt("MemoryPersistence","Starting transaction:",e);const r=new Vo(this.Qr.next());return this.referenceDelegate.zr(),n(r).next(e=>this.referenceDelegate.jr(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Hr(e,t){return Dn.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,t)))}}class Vo extends Mn{constructor(e){super(),this.currentSequenceNumber=e}}class zo{constructor(e){this.persistence=e,this.Jr=new Lo,this.Yr=null}static Zr(e){return new zo(e)}get Xr(){if(this.Yr)return this.Yr;throw rn()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),Dn.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),Dn.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),Dn.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(e=>this.Xr.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.Xr.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Dn.forEach(this.Xr,n=>{const r=Cn.fromPath(n);return this.ei(e,r).next(e=>{e||t.removeEntry(r,En.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return Dn.or([()=>Dn.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class Bo{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=r}static Wi(e,t){let n=ji(),r=ji();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Bo(e,t.fromCache,n,r)}}class Ho{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Go{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=K()?8:Fn(W())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.Yi(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.Zi(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;const n=new Ho;return this.Xi(e,t,n).next(r=>{if(i.result=r,this.zi)return this.es(e,t,n,r.size)})}).next(()=>i.result)}es(e,t,n,r){return n.documentReadCount<this.ji?($t()<=de.DEBUG&&Zt("QueryEngine","SDK will not create cache indexes for query:",xi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Dn.resolve()):($t()<=de.DEBUG&&Zt("QueryEngine","Query:",xi(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Hi*r?($t()<=de.DEBUG&&Zt("QueryEngine","The SDK decides to create cache indexes for query:",xi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pi(t))):Dn.resolve())}Yi(e,t){if(di(t))return Dn.resolve(null);let n=pi(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=yi(t,null,"F"),n=pi(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=ji(...r);return this.Ji.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.ts(t,r);return this.ns(t,s,i,n.readTime)?this.Yi(e,yi(t,null,"F")):this.rs(e,s,t,n)}))})))}Zi(e,t,n,r){return di(t)||r.isEqual(En.min())?Dn.resolve(null):this.Ji.getDocuments(e,n).next(i=>{const s=this.ts(t,i);return this.ns(t,s,n,r)?Dn.resolve(null):($t()<=de.DEBUG&&Zt("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),xi(t)),this.rs(e,s,t,An(r,-1)).next(e=>e))})}ts(e,t){let n=new er(Ei(e));return t.forEach((t,r)=>{wi(e,r)&&(n=n.add(r))}),n}ns(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Xi(e,t,n){return $t()<=de.DEBUG&&Zt("QueryEngine","Using full collection scan to execute query:",xi(t)),this.Ji.getDocumentsMatchingQuery(e,t,Pn.min(),n)}rs(e,t,n,r){return this.Ji.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}class Wo{constructor(e,t,n,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new Xn(xn),this._s=new Si(e=>si(e),oi),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ao(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function Ko(e,t,n,r){return new Wo(e,t,n,r)}async function Yo(e,t){const n=on(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.ls(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let o=ji();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({hs:e,removedBatchIds:i,addedBatchIds:s}))})})}function Qo(e){const t=on(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Ur.getLastRemoteSnapshotVersion(e))}function Jo(e,t,n){let r=ji(),i=ji();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=_i();return n.forEach((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(En.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):Zt("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{Ps:r,Is:i}})}function Xo(e,t){const n=on(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function $o(e,t){const n=on(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Ur.getTargetData(e,t).next(i=>i?(r=i,Dn.resolve(r)):n.Ur.allocateTargetId(e).next(i=>(r=new xo(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Ur.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.os.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.os=n.os.insert(e.targetId,e),n._s.set(t,e.targetId)),e})}async function Zo(e,t,n){const r=on(e),i=r.os.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!qn(e))throw e;Zt("LocalStore","Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.os=r.os.remove(t),r._s.delete(i.target)}function ea(e,t,n){const r=on(e);let i=En.min(),s=ji();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=on(e),i=r._s.get(n);return void 0!==i?Dn.resolve(r.os.get(i)):r.Ur.getTargetData(t,n)}(r,e,pi(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.ss.getDocumentsMatchingQuery(e,t,n?i:En.min(),n?s:ji())).next(e=>(ta(r,Ii(t),e),{documents:e,Ts:s})))}function ta(e,t,n){let r=e.us.get(t)||En.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.us.set(t,r)}class na{constructor(){this.activeTargetIds=Fi()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ra{constructor(){this.so=new na,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new na,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class ia{_o(e){}shutdown(){}}class sa{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Zt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Zt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let oa=null;function aa(){return null===oa?oa=268435456+Math.round(2147483648*Math.random()):oa++,"0x"+oa.toString(16)}const la={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ca{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const ua="WebChannelConnection";class da extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo="projects/".concat(n,"/databases/").concat(r),this.Co="(default)"===this.databaseId.database?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}get Fo(){return!1}Mo(e,t,n,r,i){const s=aa(),o=this.xo(e,t.toUriEncodedString());Zt("RestConnection","Sending RPC '".concat(e,"' ").concat(s,":"),o,n);const a={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(a,r,i),this.No(e,o,a,n).then(t=>(Zt("RestConnection","Received RPC '".concat(e,"' ").concat(s,": "),t),t),t=>{throw tn("RestConnection","RPC '".concat(e,"' ").concat(s," failed with error: "),t,"url: ",o,"request:",n),t})}Lo(e,t,n,r,i,s){return this.Mo(e,t,n,r,i)}Oo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Jt,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}xo(e,t){const n=la[e];return"".concat(this.Do,"/v1/").concat(t,":").concat(n)}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,r){const i=aa();return new Promise((s,o)=>{const a=new Ft;a.setWithCredentials(!0),a.listenOnce(Ut.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Vt.NO_ERROR:const t=a.getResponseJson();Zt(ua,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(t)),s(t);break;case Vt.TIMEOUT:Zt(ua,"RPC '".concat(e,"' ").concat(i," timed out")),o(new ln(an.DEADLINE_EXCEEDED,"Request time out"));break;case Vt.HTTP_ERROR:const n=a.getStatus();if(Zt(ua,"RPC '".concat(e,"' ").concat(i," failed with status:"),n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(an).indexOf(t)>=0?t:an.UNKNOWN}(t.status);o(new ln(e,t.message))}else o(new ln(an.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new ln(an.UNAVAILABLE,"Connection failed."));break;default:rn()}}finally{Zt(ua,"RPC '".concat(e,"' ").concat(i," completed."))}});const l=JSON.stringify(r);Zt(ua,"RPC '".concat(e,"' ").concat(i," sending request:"),r),a.send(t,"POST",l,n,15)})}Bo(e,t,n){const r=aa(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Gt(),o=Ht(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Oo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const c=i.join("");Zt(ua,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),a);const u=s.createWebChannel(c,a);let d=!1,h=!1;const f=new ca({Io:t=>{h?Zt(ua,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(d||(Zt(ua,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),d=!0),Zt(ua,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},To:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(u,qt.EventType.OPEN,()=>{h||(Zt(ua,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),f.yo())}),p(u,qt.EventType.CLOSE,()=>{h||(h=!0,Zt(ua,"RPC '".concat(e,"' stream ").concat(r," transport closed")),f.So())}),p(u,qt.EventType.ERROR,t=>{h||(h=!0,tn(ua,"RPC '".concat(e,"' stream ").concat(r," transport errored:"),t),f.So(new ln(an.UNAVAILABLE,"The operation could not be completed")))}),p(u,qt.EventType.MESSAGE,t=>{var n;if(!h){const i=t.data[0];sn(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){Zt(ua,"RPC '".concat(e,"' stream ").concat(r," received error:"),o);const t=o.status;let n=function(e){const t=ws[e];if(void 0!==t)return Ns(t)}(t),i=o.message;void 0===n&&(n=an.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),h=!0,f.So(new ln(n,i)),u.close()}else Zt(ua,"RPC '".concat(e,"' stream ").concat(r," received:"),i),f.bo(i)}}),p(o,Bt.STAT_EVENT,t=>{t.stat===zt.PROXY?Zt(ua,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===zt.NOPROXY&&Zt(ua,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(()=>{f.wo()},0),f}}function ha(){return"undefined"!=typeof document?document:null}function fa(e){return new Hs(e,!0)}class pa{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ui=e,this.timerId=t,this.ko=n,this.qo=r,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-n);r>0&&Zt("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.Ko," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class ma{constructor(e,t,n,r,i,s,o,a){this.ui=e,this.Ho=n,this.Jo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new pa(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===an.RESOURCE_EXHAUSTED?(en(t.toString()),en("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===an.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.Yo===t&&this.P_(n,r)},t=>{e(()=>{const e=new ln(an.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)})})}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(e=>{n(()=>this.I_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.e_?this.E_(e):this.onNext(e))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Zt("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(Zt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class ga extends ma{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:rn()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(sn(void 0===t||"string"==typeof t),ir.fromBase64String(t||"")):(sn(void 0===t||t instanceof Buffer||t instanceof Uint8Array),ir.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?an.UNKNOWN:Ns(e.code);return new ln(t,e.message||"")}(o);n=new js(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=eo(e,r.document.name),s=Qs(r.document.updateTime),o=r.document.createTime?Qs(r.document.createTime):En.min(),a=new Pr({mapValue:{fields:r.document.fields}}),l=Lr.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Ls(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=eo(e,r.document),s=r.readTime?Qs(r.readTime):En.min(),o=Lr.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Ls([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=eo(e,r.document),s=r.removedTargetIds||[];n=new Ls([],s,i,null)}else{if(!("filter"in t))return rn();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new xs(r,i),o=e.targetId;n=new Ms(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return En.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?En.min():t.readTime?Qs(t.readTime):En.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=ro(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=ai(r)?{documents:ao(e,r)}:{query:lo(e,r)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Ks(e,t.resumeToken);const r=Gs(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(En.min())>0){n.readTime=Ws(e,t.snapshotVersion.toTimestamp());const r=Gs(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return rn()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=ro(this.serializer),t.removeTarget=e,this.a_(t)}}class ya extends ma{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return sn(!!e.streamToken),this.lastStreamToken=e.streamToken,sn(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){sn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(sn(void 0!==t),e.map(e=>function(e,t){let n=e.updateTime?Qs(e.updateTime):Qs(t);return n.isEqual(En.min())&&(n=Qs(t)),new ts(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Qs(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=ro(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>oo(this.serializer,e))};this.a_(t)}}class va extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new ln(an.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[s,o]=i;return this.connection.Mo(e,Xs(t,n),r,s,o)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===an.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new ln(an.UNKNOWN,e.toString())})}Lo(e,t,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[o,a]=s;return this.connection.Lo(e,Xs(t,n),r,o,a,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===an.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new ln(an.UNKNOWN,e.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class ba{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.D_?(en(t),this.D_=!1):Zt("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}class xa{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(e=>{n.enqueueAndForget(async()=>{ka(this)&&(Zt("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=on(e);t.L_.add(4),await Ia(t),t.q_.set("Unknown"),t.L_.delete(4),await wa(t)}(this))})}),this.q_=new ba(n,r)}}async function wa(e){if(ka(e))for(const t of e.B_)await t(!0)}async function Ia(e){for(const t of e.B_)await t(!1)}function Ea(e,t){const n=on(e);n.N_.has(t.targetId)||(n.N_.set(t.targetId,t),Ca(n)?_a(n):Ya(n).r_()&&Sa(n,t))}function Na(e,t){const n=on(e),r=Ya(n);n.N_.delete(t),r.r_()&&Ta(n,t),0===n.N_.size&&(r.r_()?r.o_():ka(n)&&n.q_.set("Unknown"))}function Sa(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(En.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Ya(e).A_(t)}function Ta(e,t){e.Q_.xe(t),Ya(e).R_(t)}function _a(e){e.Q_=new Fs({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),Ya(e).start(),e.q_.v_()}function Ca(e){return ka(e)&&!Ya(e).n_()&&e.N_.size>0}function ka(e){return 0===on(e).L_.size}function Aa(e){e.Q_=void 0}async function Ra(e){e.q_.set("Online")}async function Pa(e){e.N_.forEach((t,n)=>{Sa(e,t)})}async function Oa(e,t){Aa(e),Ca(e)?(e.q_.M_(t),_a(e)):e.q_.set("Unknown")}async function La(e,t,n){if(e.q_.set("Online"),t instanceof js&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.N_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.N_.delete(r),e.Q_.removeTarget(r))}(e,t)}catch(n){Zt("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Ma(e,n)}else if(t instanceof Ls?e.Q_.Ke(t):t instanceof Ms?e.Q_.He(t):e.Q_.We(t),!n.isEqual(En.min()))try{const t=await Qo(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Q_.rt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.N_.get(r);i&&e.N_.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.N_.get(t);if(!r)return;e.N_.set(t,r.withResumeToken(ir.EMPTY_BYTE_STRING,r.snapshotVersion)),Ta(e,t);const i=new xo(r.target,t,n,r.sequenceNumber);Sa(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Zt("RemoteStore","Failed to raise snapshot:",t),await Ma(e,t)}}async function Ma(e,t,n){if(!qn(t))throw t;e.L_.add(1),await Ia(e),e.q_.set("Offline"),n||(n=()=>Qo(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Zt("RemoteStore","Retrying IndexedDB access"),await n(),e.L_.delete(1),await wa(e)})}function ja(e,t){return t().catch(n=>Ma(e,n,t))}async function Da(e){const t=on(e),n=Qa(t);let r=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;Fa(t);)try{const e=await Xo(t.localStore,r);if(null===e){0===t.O_.length&&n.o_();break}r=e.batchId,qa(t,e)}catch(e){await Ma(t,e)}Ua(t)&&Va(t)}function Fa(e){return ka(e)&&e.O_.length<10}function qa(e,t){e.O_.push(t);const n=Qa(e);n.r_()&&n.V_&&n.m_(t.mutations)}function Ua(e){return ka(e)&&!Qa(e).n_()&&e.O_.length>0}function Va(e){Qa(e).start()}async function za(e){Qa(e).p_()}async function Ba(e){const t=Qa(e);for(const n of e.O_)t.m_(n.mutations)}async function Ha(e,t,n){const r=e.O_.shift(),i=vs.from(r,t,n);await ja(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await Da(e)}async function Ga(e,t){t&&Qa(e).V_&&await async function(e,t){if(function(e){return Es(e)&&e!==an.ABORTED}(t.code)){const n=e.O_.shift();Qa(e).s_(),await ja(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Da(e)}}(e,t),Ua(e)&&Va(e)}async function Wa(e,t){const n=on(e);n.asyncQueue.verifyOperationInProgress(),Zt("RemoteStore","RemoteStore received new credentials");const r=ka(n);n.L_.add(3),await Ia(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.L_.delete(3),await wa(n)}async function Ka(e,t){const n=on(e);t?(n.L_.delete(2),await wa(n)):t||(n.L_.add(2),await Ia(n),n.q_.set("Unknown"))}function Ya(e){return e.K_||(e.K_=function(e,t,n){const r=on(e);return r.w_(),new ga(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:Ra.bind(null,e),Ro:Pa.bind(null,e),mo:Oa.bind(null,e),d_:La.bind(null,e)}),e.B_.push(async t=>{t?(e.K_.s_(),Ca(e)?_a(e):e.q_.set("Unknown")):(await e.K_.stop(),Aa(e))})),e.K_}function Qa(e){return e.U_||(e.U_=function(e,t,n){const r=on(e);return r.w_(),new ya(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:za.bind(null,e),mo:Ga.bind(null,e),f_:Ba.bind(null,e),g_:Ha.bind(null,e)}),e.B_.push(async t=>{t?(e.U_.s_(),await Da(e)):(await e.U_.stop(),e.O_.length>0&&(Zt("RemoteStore","Stopping write stream with ".concat(e.O_.length," pending writes")),e.O_=[]))})),e.U_}class Ja{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new cn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new Ja(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ln(an.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Xa(e,t){if(en("AsyncQueue","".concat(t,": ").concat(e)),qn(e))return new ln(an.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class $a{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Cn.comparator(t.key,n.key):(e,t)=>Cn.comparator(e.key,t.key),this.keyedMap=ki(),this.sortedSet=new Xn(this.comparator)}static emptySet(e){return new $a(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof $a))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new $a;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Za{constructor(){this.W_=new Xn(Cn.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?0!==e.type&&3===n.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==n.type?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.W_=this.W_.remove(t):1===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):rn():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,n)=>{e.push(n)}),e}}class el{constructor(e,t,n,r,i,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new el(e,t,$a.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vi(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class tl{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class nl{constructor(){this.queries=rl(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const n=on(e),r=n.queries;n.queries=rl(),r.forEach((e,n)=>{for(const r of n.j_)r.onError(t)})}(this,new ln(an.ABORTED,"Firestore shutting down"))}}function rl(){return new Si(e=>bi(e),vi)}async function il(e,t){const n=on(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.H_()&&t.J_()&&(r=2):(s=new tl,r=t.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=Xa(e,"Initialization of query '".concat(xi(t.query),"' failed"));return void t.onError(n)}n.queries.set(i,s),s.j_.push(t),t.Z_(n.onlineState),s.z_&&t.X_(s.z_)&&ll(n)}async function sl(e,t){const n=on(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.j_.indexOf(t);e>=0&&(s.j_.splice(e,1),0===s.j_.length?i=t.J_()?0:1:!s.H_()&&t.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function ol(e,t){const n=on(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.j_)e.X_(i)&&(r=!0);t.z_=i}}r&&ll(n)}function al(e,t,n){const r=on(e),i=r.queries.get(t);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(t)}function ll(e){e.Y_.forEach(e=>{e.next()})}var cl,ul;(ul=cl||(cl={})).ea="default",ul.Cache="cache";class dl{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new el(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache)return!0;if(!this.J_())return!0;const n="Offline"!==t;return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}oa(e){e=el.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==cl.Cache}}class hl{constructor(e){this.key=e}}class fl{constructor(e){this.key=e}}class pl{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ji(),this.mutatedKeys=ji(),this.Aa=Ei(e),this.Ra=new $a(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new Za,r=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=wi(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),f=!0):this.ga(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.Aa(u,a)>0||l&&this.Aa(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),i=h?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Ra:s,fa:n,ns:o,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const s=e.fa.G_();s.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return rn()}};return n(e)-n(t)}(e.type,t.type)||this.Aa(e.doc,t.doc)),this.pa(n),r=null!=r&&r;const o=t&&!r?this.ya():[],a=0===this.da.size&&this.current&&!r?1:0,l=a!==this.Ea;return this.Ea=a,0!==s.length||l?{snapshot:new el(this.query,e.Ra,i,s,e.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Za,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(e=>this.Ta=this.Ta.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ta=this.Ta.delete(e)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ji(),this.Ra.forEach(e=>{this.Sa(e.key)&&(this.da=this.da.add(e.key))});const t=[];return e.forEach(e=>{this.da.has(e)||t.push(new fl(e))}),this.da.forEach(n=>{e.has(n)||t.push(new hl(n))}),t}ba(e){this.Ta=e.Ts,this.da=ji();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return el.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class ml{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class gl{constructor(e){this.key=e,this.va=!1}}class yl{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new Si(e=>bi(e),vi),this.Ma=new Map,this.xa=new Set,this.Oa=new Xn(Cn.comparator),this.Na=new Map,this.La=new Lo,this.Ba={},this.ka=new Map,this.qa=_o.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}async function vl(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=ql(e);let i;const s=r.Fa.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await xl(r,t,n,!0),i}async function bl(e,t){const n=ql(e);await xl(n,t,!0,!1)}async function xl(e,t,n,r){const i=await $o(e.localStore,pi(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await wl(e,t,s,"current"===o,i.resumeToken)),e.isPrimaryClient&&n&&Ea(e.remoteStore,i),a}async function wl(e,t,n,r,i){e.Ka=(t,n,r)=>async function(e,t,n,r){let i=t.view.ma(n);i.ns&&(i=await ea(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ma(n,i)}));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return Ol(e,t.targetId,a.wa),a.snapshot}(e,t,n,r);const s=await ea(e.localStore,t,!0),o=new pl(t,s.Ts),a=o.ma(s.documents),l=Os.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=o.applyChanges(a,e.isPrimaryClient,l);Ol(e,n,c.wa);const u=new ml(t,n,o);return e.Fa.set(t,u),e.Ma.has(n)?e.Ma.get(n).push(t):e.Ma.set(n,[t]),c.snapshot}async function Il(e,t,n){const r=on(e),i=r.Fa.get(t),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(e=>!vi(e,t))),void r.Fa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Zo(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Na(r.remoteStore,i.targetId),Rl(r,i.targetId)}).catch(jn)):(Rl(r,i.targetId),await Zo(r.localStore,i.targetId,!0))}async function El(e,t){const n=on(e),r=n.Fa.get(t),i=n.Ma.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Na(n.remoteStore,r.targetId))}async function Nl(e,t){const n=on(e);try{const e=await function(e,t){const n=on(e),r=t.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const o=[];t.targetChanges.forEach((s,a)=>{const l=i.get(a);if(!l)return;o.push(n.Ur.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.Ur.addMatchingKeys(e,s.addedDocuments,a)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(ir.EMPTY_BYTE_STRING,En.min()).withLastLimboFreeSnapshotVersion(En.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(a,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,s)&&o.push(n.Ur.updateTargetData(e,c))});let a=_i(),l=ji();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(Jo(e,s,t.documentUpdates).next(e=>{a=e.Ps,l=e.Is})),!r.isEqual(En.min())){const t=n.Ur.getLastRemoteSnapshotVersion(e).next(t=>n.Ur.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return Dn.waitFor(o).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,l)).next(()=>a)}).then(e=>(n.os=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Na.get(t);r&&(sn(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.va=!0:e.modifiedDocuments.size>0?sn(r.va):e.removedDocuments.size>0&&(sn(r.va),r.va=!1))}),await jl(n,e,t)}catch(e){await jn(e)}}function Sl(e,t,n){const r=on(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Fa.forEach((n,r)=>{const i=r.view.Z_(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=on(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.j_)i.Z_(t)&&(r=!0)}),r&&ll(n)}(r.eventManager,t),e.length&&r.Ca.d_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Tl(e,t,n){const r=on(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Na.get(t),s=i&&i.key;if(s){let e=new Xn(Cn.comparator);e=e.insert(s,Lr.newNoDocument(s,En.min()));const n=ji().add(s),i=new Ps(En.min(),new Map,new Xn(xn),e,n);await Nl(r,i),r.Oa=r.Oa.remove(s),r.Na.delete(t),Ml(r)}else await Zo(r.localStore,t,!1).then(()=>Rl(r,t,n)).catch(jn)}async function _l(e,t){const n=on(e),r=t.batch.batchId;try{const e=await function(e,t){const n=on(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=Dn.resolve();return s.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);sn(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=ji();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);Al(n,r,null),kl(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await jl(n,e)}catch(e){await jn(e)}}async function Cl(e,t,n){const r=on(e);try{const e=await function(e,t){const n=on(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(sn(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);Al(r,t,n),kl(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await jl(r,e)}catch(n){await jn(n)}}function kl(e,t){(e.ka.get(t)||[]).forEach(e=>{e.resolve()}),e.ka.delete(t)}function Al(e,t,n){const r=on(e);let i=r.Ba[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Ba[r.currentUser.toKey()]=i}}function Rl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Ma.get(t))e.Fa.delete(r),n&&e.Ca.$a(r,n);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach(t=>{e.La.containsKey(t)||Pl(e,t)})}function Pl(e,t){e.xa.delete(t.path.canonicalString());const n=e.Oa.get(t);null!==n&&(Na(e.remoteStore,n),e.Oa=e.Oa.remove(t),e.Na.delete(n),Ml(e))}function Ol(e,t,n){for(const r of n)r instanceof hl?(e.La.addReference(r.key,t),Ll(e,r)):r instanceof fl?(Zt("SyncEngine","Document no longer in limbo: "+r.key),e.La.removeReference(r.key,t),e.La.containsKey(r.key)||Pl(e,r.key)):rn()}function Ll(e,t){const n=t.key,r=n.path.canonicalString();e.Oa.get(n)||e.xa.has(r)||(Zt("SyncEngine","New document in limbo: "+n),e.xa.add(r),Ml(e))}function Ml(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const n=new Cn(Sn.fromString(t)),r=e.qa.next();e.Na.set(r,new gl(n)),e.Oa=e.Oa.insert(n,r),Ea(e.remoteStore,new xo(pi(ui(n.path)),r,"TargetPurposeLimboResolution",Un.oe))}}async function jl(e,t,n){const r=on(e),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((e,a)=>{o.push(r.Ka(a,t,n).then(e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(a.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(a.targetId,i?"current":"not-current")}if(e){i.push(e);const t=Bo.Wi(a.targetId,e);s.push(t)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(e,t){const n=on(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Dn.forEach(t,t=>Dn.forEach(t.$i,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>Dn.forEach(t.Ui,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!qn(e))throw e;Zt("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.os.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.os=n.os.insert(e,i)}}}(r.localStore,s))}async function Dl(e,t){const n=on(e);if(!n.currentUser.isEqual(t)){Zt("SyncEngine","User change. New user:",t.toKey());const e=await Yo(n.localStore,t);n.currentUser=t,function(e,t){e.ka.forEach(e=>{e.forEach(e=>{e.reject(new ln(an.CANCELLED,t))})}),e.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await jl(n,e.hs)}}function Fl(e,t){const n=on(e),r=n.Na.get(t);if(r&&r.va)return ji().add(r.key);{let e=ji();const r=n.Ma.get(t);if(!r)return e;for(const t of r){const r=n.Fa.get(t);e=e.unionWith(r.view.Va)}return e}}function ql(e){const t=on(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Nl.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Fl.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Tl.bind(null,t),t.Ca.d_=ol.bind(null,t.eventManager),t.Ca.$a=al.bind(null,t.eventManager),t}function Ul(e){const t=on(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=_l.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Cl.bind(null,t),t}class Vl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=fa(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return Ko(this.persistence,new Go,e.initialUser,this.serializer)}Ga(e){return new Uo(zo.Zr,this.serializer)}Wa(e){return new ra}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Vl.provider={build:()=>new Vl};class zl{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Sl(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Dl.bind(null,this.syncEngine),await Ka(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new nl}createDatastore(e){const t=fa(e.databaseInfo.databaseId),n=function(e){return new da(e)}(e.databaseInfo);return function(e,t,n,r){return new va(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new xa(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,e=>Sl(this.syncEngine,e,0),sa.D()?new sa:new ia)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new yl(e,t,n,r,i,s);return o&&(a.Qa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=on(e);Zt("RemoteStore","RemoteStore shutting down."),t.L_.add(5),await Ia(t),t.k_.shutdown(),t.q_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}zl.provider={build:()=>new zl};class Bl{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):en("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class Hl{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Qt.UNAUTHENTICATED,this.clientId=bn.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{Zt("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(Zt("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new cn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Xa(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Gl(e,t){e.asyncQueue.verifyOperationInProgress(),Zt("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Yo(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Wl(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Kl(e);Zt("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>Wa(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>Wa(t.remoteStore,n)),e._onlineComponents=t}async function Kl(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Zt("FirestoreClient","Using user provided OfflineComponentProvider");try{await Gl(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===an.FAILED_PRECONDITION||e.code===an.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;tn("Error using user provided cache. Falling back to memory cache: "+n),await Gl(e,new Vl)}}else Zt("FirestoreClient","Using default OfflineComponentProvider"),await Gl(e,new Vl);return e._offlineComponents}async function Yl(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Zt("FirestoreClient","Using user provided OnlineComponentProvider"),await Wl(e,e._uninitializedComponentsProvider._online)):(Zt("FirestoreClient","Using default OnlineComponentProvider"),await Wl(e,new zl))),e._onlineComponents}function Ql(e){return Yl(e).then(e=>e.syncEngine)}async function Jl(e){const t=await Yl(e),n=t.eventManager;return n.onListen=vl.bind(null,t.syncEngine),n.onUnlisten=Il.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=bl.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=El.bind(null,t.syncEngine),n}function Xl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new cn;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new Bl({next:n=>{s.Za(),t.enqueueAndForget(()=>sl(e,o)),n.fromCache&&"server"===r.source?i.reject(new ln(an.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new dl(n,s,{includeMetadataChanges:!0,_a:!0});return il(e,o)}(await Jl(e),e.asyncQueue,t,n,r)),r.promise}function $l(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Zl=new Map;function ec(e,t,n){if(!n)throw new ln(an.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function tc(e){if(!Cn.isDocumentKey(e))throw new ln(an.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function nc(e){if(Cn.isDocumentKey(e))throw new ln(an.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function rc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":rn()}function ic(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new ln(an.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=rc(e);throw new ln(an.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function sc(e,t){if(t<=0)throw new ln(an.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}class oc{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new ln(an.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new ln(an.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new ln(an.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$l(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new ln(an.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new ln(an.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new ln(an.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ac{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new oc({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ln(an.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new ln(an.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new oc(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new dn;switch(e.type){case"firstParty":return new mn(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new ln(an.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Zl.get(e);t&&(Zt("ComponentProvider","Removing Datastore"),Zl.delete(e),t.terminate())}(this),Promise.resolve()}}function lc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const s=(e=ic(e,ac))._getSettings(),o="".concat(t,":").concat(n);if("firestore.googleapis.com"!==s.host&&s.host!==o&&tn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Qt.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[F(JSON.stringify({alg:"none",type:"JWT"})),F(JSON.stringify(s)),""].join(".")}(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new ln(an.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Qt(s)}e._authCredentials=new hn(new un(t,n))}}class cc{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new cc(this.firestore,e,this._query)}}class uc{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new dc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new uc(this.firestore,e,this._key)}}class dc extends cc{constructor(e,t,n){super(e,t,ui(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new uc(this.firestore,null,new Cn(e))}withConverter(e){return new dc(this.firestore,e,this._path)}}function hc(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=se(e),ec("collection","path",t),e instanceof ac){const n=Sn.fromString(t,...r);return nc(n),new dc(e,null,n)}{if(!(e instanceof uc||e instanceof dc))throw new ln(an.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Sn.fromString(t,...r));return nc(n),new dc(e.firestore,null,n)}}function fc(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=se(e),1===arguments.length&&(t=bn.newId()),ec("doc","path",t),e instanceof ac){const n=Sn.fromString(t,...r);return tc(n),new uc(e,null,new Cn(n))}{if(!(e instanceof uc||e instanceof dc))throw new ln(an.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Sn.fromString(t,...r));return tc(n),new uc(e.firestore,e instanceof dc?e.converter:null,new Cn(n))}}class pc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new pa(this,"async_queue_retry"),this.Vu=()=>{const e=ha();e&&Zt("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=ha();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=ha();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new cn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(0!==this.Pu.length){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!qn(e))throw e;Zt("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(e=>{this.Eu=e,this.du=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw en("INTERNAL UNHANDLED ERROR: ",t),e}).then(e=>(this.du=!1,e))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const r=Ja.createAndSchedule(this,e,t,n,e=>this.yu(e));return this.Tu.push(r),r}fu(){this.Eu&&rn()}verifyOperationInProgress(){}async wu(){let e;do{e=this.mu,await e}while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function mc(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class gc extends ac{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new pc,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new pc(e),this._firestoreClient=void 0,await e}}}function yc(e){if(e._terminated)throw new ln(an.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||vc(e),e._firestoreClient}function vc(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new hr(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,$l(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new Hl(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class bc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new bc(ir.fromBase64String(e))}catch(e){throw new ln(an.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new bc(ir.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class xc{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new ln(an.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new _n(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class wc{constructor(e){this._methodName=e}}class Ic{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ln(an.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ln(an.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return xn(this._lat,e._lat)||xn(this._long,e._long)}}class Ec{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const Nc=/^__.*__$/;class Sc{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new ds(e,this.data,this.fieldMask,t,this.fieldTransforms):new us(e,this.data,t,this.fieldTransforms)}}class Tc{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new ds(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function _c(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rn()}}class Cc{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Cc(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.Ou(e),r}Nu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Hc(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(_c(this.Cu)&&Nc.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class kc{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||fa(e)}Qu(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Cc({Cu:e,methodName:t,qu:n,path:_n.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ac(e){const t=e._freezeSettings(),n=fa(e._databaseId);return new kc(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Rc(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.Qu(s.merge||s.mergeFields?2:0,t,n,i);Uc("Data must be an object, but it was:",o,r);const a=Fc(r,o);let l,c;if(s.merge)l=new nr(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=Vc(t,r,n);if(!o.contains(i))throw new ln(an.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));Gc(e,i)||e.push(i)}l=new nr(e),c=o.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=o.fieldTransforms;return new Sc(new Pr(a),l,c)}class Pc extends wc{_toFieldTransform(e){if(2!==e.Cu)throw 1===e.Cu?e.Bu("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Bu("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Pc}}class Oc extends wc{_toFieldTransform(e){return new es(e.path,new Wi)}isEqual(e){return e instanceof Oc}}function Lc(e,t,n,r){const i=e.Qu(1,t,n);Uc("Data must be an object, but it was:",i,r);const s=[],o=Pr.empty();Qn(r,(e,r)=>{const a=Bc(t,e,n);r=se(r);const l=i.Nu(a);if(r instanceof Pc)s.push(a);else{const e=Dc(r,l);null!=e&&(s.push(a),o.set(a,e))}});const a=new nr(s);return new Tc(o,a,i.fieldTransforms)}function Mc(e,t,n,r,i,s){const o=e.Qu(1,t,n),a=[Vc(t,r,n)],l=[i];if(s.length%2!=0)throw new ln(an.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let h=0;h<s.length;h+=2)a.push(Vc(t,s[h])),l.push(s[h+1]);const c=[],u=Pr.empty();for(let h=a.length-1;h>=0;--h)if(!Gc(c,a[h])){const e=a[h];let t=l[h];t=se(t);const n=o.Nu(e);if(t instanceof Pc)c.push(e);else{const r=Dc(t,n);null!=r&&(c.push(e),u.set(e,r))}}const d=new nr(c);return new Tc(u,d,o.fieldTransforms)}function jc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Dc(n,e.Qu(r?4:3,t))}function Dc(e,t){if(qc(e=se(e)))return Uc("Unsupported field value:",t,e),Fc(e,t);if(e instanceof wc)return function(e,t){if(!_c(t.Cu))throw t.Bu("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Bu("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=Dc(i,t.Lu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=se(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Vi(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=In.fromDate(e);return{timestampValue:Ws(t.serializer,n)}}if(e instanceof In){const n=new In(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Ws(t.serializer,n)}}if(e instanceof Ic)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof bc)return{bytesValue:Ks(t.serializer,e._byteString)};if(e instanceof uc){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Bu("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:Js(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Ec)return function(e,t){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Bu("VectorValues must only contain numeric values.");return qi(t.serializer,e)})}}}}}}(e,t);throw t.Bu("Unsupported field value: ".concat(rc(e)))}(e,t)}function Fc(e,t){const n={};return Jn(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Qn(e,(e,r)=>{const i=Dc(r,t.Mu(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function qc(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof In||e instanceof Ic||e instanceof bc||e instanceof uc||e instanceof wc||e instanceof Ec)}function Uc(e,t,n){if(!qc(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=rc(n);throw"an object"===r?t.Bu(e+" a custom object"):t.Bu(e+" "+r)}}function Vc(e,t,n){if((t=se(t))instanceof xc)return t._internalPath;if("string"==typeof t)return Bc(e,t);throw Hc("Field path arguments must be of type string or ",e,!1,void 0,n)}const zc=new RegExp("[~\\*/\\[\\]]");function Bc(e,t,n){if(t.search(zc)>=0)throw Hc("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new xc(...t.split("."))._internalPath}catch(r){throw Hc("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function Hc(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a="Function ".concat(t,"() called with invalid data");n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=" in field ".concat(r)),o&&(l+=" in document ".concat(i)),l+=")"),new ln(an.INVALID_ARGUMENT,a+e+l)}function Gc(e,t){return e.some(e=>e.isEqual(t))}class Wc{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new uc(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Kc(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Yc("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Kc extends Wc{data(){return super.data()}}function Yc(e,t){return"string"==typeof t?Bc(e,t):t instanceof xc?t._internalPath:t._delegate._internalPath}function Qc(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new ln(an.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Jc{}class Xc extends Jc{}function $c(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof Jc&&n.push(t),n=n.concat(i),function(e){const t=e.filter(e=>e instanceof eu).length,n=e.filter(e=>e instanceof Zc).length;if(t>1||t>0&&n>0)throw new ln(an.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)e=o._apply(e);return e}class Zc extends Xc{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Zc(e,t,n)}_apply(e){const t=this._parse(e);return ou(e._query,t),new cc(e.firestore,e.converter,gi(e._query,t))}_parse(e){const t=Ac(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new ln(an.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){su(o,s);const t=[];for(const n of o)t.push(iu(r,e,n));a={arrayValue:{values:t}}}else a=iu(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||su(o,s),a=jc(n,t,o,"in"===s||"not-in"===s);return Vr.create(i,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class eu extends Jc{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new eu(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:zr.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)ou(n,i),n=gi(n,i)}(e._query,t),new cc(e.firestore,e.converter,gi(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class tu extends Xc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new tu(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new ln(an.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new ln(an.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Fr(t,n)}(e._query,this._field,this._direction);return new cc(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new li(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function nu(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=Yc("orderBy",e);return tu._create(n,t)}class ru extends Xc{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new ru(e,t,n)}_apply(e){return new cc(e.firestore,e.converter,yi(e._query,this._limit,this._limitType))}}function iu(e,t,n){if("string"==typeof(n=se(n))){if(""===n)throw new ln(an.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!hi(t)&&-1!==n.indexOf("/"))throw new ln(an.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(Sn.fromString(n));if(!Cn.isDocumentKey(r))throw new ln(an.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Er(e,new Cn(r))}if(n instanceof uc)return Er(e,n._key);throw new ln(an.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(rc(n),"."))}function su(e,t){if(!Array.isArray(e)||0===e.length)throw new ln(an.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function ou(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new ln(an.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new ln(an.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class au{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(mr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ar(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(lr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw rn()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return Qn(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map(e=>ar(e.doubleValue));return new Ec(i)}convertGeoPoint(e){return new Ic(ar(e.latitude),ar(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=ur(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(dr(e));default:return null}}convertTimestamp(e){const t=or(e);return new In(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Sn.fromString(e);sn(bo(n));const r=new fr(n.get(1),n.get(3)),i=new Cn(n.popFirst(5));return r.isEqual(t)||en("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}function lu(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class cu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class uu extends Wc{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new du(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Yc("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class du extends uu{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class hu{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new cu(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new du(this._firestore,this._userDataWriter,n.key,n,new cu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new ln(an.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new du(e._firestore,e._userDataWriter,n.doc.key,n.doc,new cu(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new du(e._firestore,e._userDataWriter,t.doc.key,t.doc,new cu(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:fu(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function fu(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return rn()}}class pu extends au{constructor(e){super(),this.firestore=e}convertBytes(e){return new bc(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new uc(this.firestore,null,t)}}function mu(e){e=ic(e,cc);const t=ic(e.firestore,gc),n=yc(t),r=new pu(t);return Qc(e._query),Xl(n,e._query).then(n=>new hu(t,r,e,n))}function gu(e,t){const n=ic(e.firestore,gc),r=fc(e),i=lu(e.converter,t);return yu(n,[Rc(Ac(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,ns.exists(!1))]).then(()=>r)}function yu(e,t){return function(e,t){const n=new cn;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=Ul(e);try{const e=await function(e,t){const n=on(e),r=In.now(),i=t.reduce((e,t)=>e.add(t.key),ji());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=_i(),l=ji();return n.cs.getEntries(e,i).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(i=>{s=i;const o=[];for(const e of t){const t=ls(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new ds(e.key,t,Or(t.value.mapValue),ns.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)}).next(t=>{o=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:o.batchId,changes:Ai(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ba[e.currentUser.toKey()];r||(r=new Xn(xn)),r=r.insert(t,n),e.Ba[e.currentUser.toKey()]=r}(r,e.batchId,n),await jl(r,e.changes),await Da(r.remoteStore)}catch(e){const t=Xa(e,"Failed to persist write");n.reject(t)}}(await Ql(e),t,n)),n.promise}(yc(e),t)}function vu(e,t,n){const r=n.docs.get(t._key),i=new pu(e);return new uu(e,i,t._key,r,new cu(n.hasPendingWrites,n.fromCache),t.converter)}function bu(){return new Oc("serverTimestamp")}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Jt=e}(xt),mt(new oe("firestore",(e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),o=new gc(new fn(e.getProvider("auth-internal")),new yn(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new ln(an.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new fr(e.options.projectId,t)}(s,r),s);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Et(Yt,"4.7.3",e),Et(Yt,"4.7.3","esm2017")}();function xu(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function wu(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Iu=wu,Eu=new J("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Nu=new ge("@firebase/auth");function Su(e){if(Nu.logLevel<=de.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Nu.error("Auth (".concat(xt,"): ").concat(e),...n)}}function Tu(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Au(e,...n)}function _u(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Au(e,...n)}function Cu(e,t,n){const r=Object.assign(Object.assign({},Iu()),{[t]:n});return new J("auth","Firebase",r).create(t,{appName:e.name})}function ku(e){return Cu(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Au(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return Eu.create(e,...n)}function Ru(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw Au(t,...r)}}function Pu(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Su(t),new Error(t)}function Ou(e,t){e||Pu(t)}function Lu(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Mu(){return"http:"===ju()||"https:"===ju()}function ju(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function Du(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Mu()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class Fu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ou(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(W())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return Du()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function qu(e,t){Ou(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class Uu{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void Pu("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void Pu("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void Pu("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Vu={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},zu=new Fu(3e4,6e4);function Bu(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Hu(e,t,n,r){return Gu(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=ee(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:a},i);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),Uu.fetch()(Ku(e,e.config.apiHost,n,o),l)})}async function Gu(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Vu),t);try{const t=new Qu(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw Ju(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Ju(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Ju(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw Ju(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw Cu(e,a,o);Tu(e,a)}}catch(i){if(i instanceof Q)throw i;Tu(e,"network-request-failed",{message:String(i)})}}async function Wu(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await Hu(e,t,n,r,i);return"mfaPendingCredential"in s&&Tu(e,"multi-factor-auth-required",{_serverResponse:s}),s}function Ku(e,t,n,r){const i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?qu(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}function Yu(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Qu{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(_u(this.auth,"network-request-failed")),zu.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ju(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=_u(e,t,r);return i.customData._tokenResponse=n,i}function Xu(e){return void 0!==e&&void 0!==e.enterprise}class $u{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Yu(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function Zu(e,t){return Hu(e,"GET","/v2/recaptchaConfig",Bu(e,t))}async function ed(e,t){return Hu(e,"POST","/v1/accounts:lookup",t)}function td(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function nd(e){return 1e3*Number(e)}function rd(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Su("JWT malformed, contained fewer than 3 sections"),null;try{const e=q(n);return e?JSON.parse(e):(Su("Failed to decode base64 JWT payload"),null)}catch(i){return Su("Caught error parsing JWT payload as JSON",null===i||void 0===i?void 0:i.toString()),null}}function id(e){const t=rd(e);return Ru(t,"internal-error"),Ru("undefined"!==typeof t.exp,"internal-error"),Ru("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function sd(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof Q&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class od{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void((null===e||void 0===e?void 0:e.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class ad{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=td(this.lastLoginAt),this.creationTime=td(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ld(e){var t;const n=e.auth,r=await e.getIdToken(),i=await sd(e,ed(n,{idToken:r}));Ru(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?cd(s.providerUserInfo):[],a=(l=e.providerData,c=o,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const u=e.isAnonymous,d=!(e.email&&s.passwordHash)&&!(null===a||void 0===a?void 0:a.length),h=!!u&&d,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new ad(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(e,f)}function cd(e){return e.map(e=>{var{providerId:t}=e,n=xu(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class ud{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ru(e.idToken,"internal-error"),Ru("undefined"!==typeof e.idToken,"internal-error"),Ru("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):id(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ru(0!==e.length,"internal-error");const t=id(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(Ru(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await Gu(e,{},async()=>{const n=ee({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=Ku(e,r,"/v1/token","key=".concat(i)),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Uu.fetch()(s,{method:"POST",headers:o,body:n})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new ud;return n&&(Ru("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(Ru("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(Ru("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ud,this.toJSON())}_performRefresh(){return Pu("not implemented")}}function dd(e,t){Ru("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class hd{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=xu(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new od(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new ad(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await sd(this,this.stsTokenManager.getToken(this.auth,e));return Ru(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=se(e),r=await n.getIdToken(t),i=rd(r);Ru(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"===typeof i.firebase?i.firebase:void 0,o=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:td(nd(i.auth_time)),issuedAtTime:td(nd(i.iat)),expirationTime:td(nd(i.exp)),signInProvider:o||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=se(e);await ld(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Ru(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new hd(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ru(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await ld(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(yt(this.auth.app))return Promise.reject(ku(this.auth));const e=await this.getIdToken();return await sd(this,async function(e,t){return Hu(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,y=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:b,isAnonymous:x,providerData:w,stsTokenManager:I}=t;Ru(v&&I,e,"internal-error");const E=ud.fromJSON(this.name,I);Ru("string"===typeof v,e,"internal-error"),dd(u,e.name),dd(d,e.name),Ru("boolean"===typeof b,e,"internal-error"),Ru("boolean"===typeof x,e,"internal-error"),dd(h,e.name),dd(f,e.name),dd(p,e.name),dd(m,e.name),dd(g,e.name),dd(y,e.name);const N=new hd({uid:v,auth:e,email:d,emailVerified:b,displayName:u,isAnonymous:x,photoURL:f,phoneNumber:h,tenantId:p,stsTokenManager:E,createdAt:g,lastLoginAt:y});return w&&Array.isArray(w)&&(N.providerData=w.map(e=>Object.assign({},e))),m&&(N._redirectEventId=m),N}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new ud;r.updateFromServerResponse(t);const i=new hd({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await ld(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Ru(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?cd(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length),o=new ud;o.updateFromIdToken(n);const a=new hd({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:s}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new ad(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length)};return Object.assign(a,l),a}}const fd=new Map;function pd(e){Ou(e instanceof Function,"Expected a class definition");let t=fd.get(e);return t?(Ou(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,fd.set(e,t),t)}class md{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}md.type="NONE";const gd=md;function yd(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class vd{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=yd(this.userKey,r.apiKey,i),this.fullPersistenceKey=yd("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?hd._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new vd(pd(gd),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=r[0]||pd(gd);const s=yd(n,e.config.apiKey,e.name);let o=null;for(const c of t)try{const t=await c._get(s);if(t){const n=hd._fromJSON(e,t);c!==i&&(o=n),i=c;break}}catch(l){}const a=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch(l){}})),new vd(i,e,n)):new vd(i,e,n)}}function bd(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Ed(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(xd(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Sd(t))return"Blackberry";if(Td(t))return"Webos";if(wd(t))return"Safari";if((t.includes("chrome/")||Id(t))&&!t.includes("edge/"))return"Chrome";if(Nd(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function xd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W();return/firefox\//i.test(e)}function wd(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:W()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Id(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W();return/crios\//i.test(e)}function Ed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W();return/iemobile/i.test(e)}function Nd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W();return/android/i.test(e)}function Sd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W();return/blackberry/i.test(e)}function Td(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W();return/webos/i.test(e)}function _d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Cd(){return function(){const e=W();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function kd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W();return _d(e)||Nd(e)||Td(e)||Sd(e)||/windows phone/i.test(e)||Ed(e)}function Ad(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=bd(W());break;case"Worker":t="".concat(bd(W()),"-").concat(e);break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(xt,"/").concat(r)}class Rd{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(i){r(i)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class Pd{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Od{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Md(this),this.idTokenSubscription=new Md(this),this.beforeStateQueue=new Rd(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Eu,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=pd(t)),this._initializationPromise=this.queue(async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await vd.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(i){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await ed(this,{idToken:e}),n=await hd._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(yt(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null===r||void 0===r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null===o||void 0===o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ru(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ld(e)}catch(t){if((null===t||void 0===t?void 0:t.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(yt(this.app))return Promise.reject(ku(this));const t=e?se(e):null;return t&&Ru(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Ru(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return yt(this.app)?Promise.reject(ku(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return yt(this.app)?Promise.reject(ku(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(pd(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return Hu(e,"GET","/v2/passwordPolicy",Bu(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Pd(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new J("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Hu(e,"POST","/v2/accounts:revokeToken",Bu(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&pd(e)||this._popupRedirectResolver;Ru(t,this,"argument-error"),this.redirectPersistenceManager=await vd.create(this,[pd(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ru(o,this,"internal-error"),o.then(()=>{s||i(this.currentUser)}),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ru(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ad(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(Nu.logLevel<=de.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Nu.warn("Auth (".concat(xt,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function Ld(e){return se(e)}class Md{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new re(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return Ru(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let jd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Dd(e){return jd.loadJS(e)}function Fd(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class qd{constructor(e){this.type="recaptcha-enterprise",this.auth=Ld(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;Xu(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n("NO_RECAPTCHA")})}):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{Zu(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new $u(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(i=>{if(!t&&Xu(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=jd.recaptchaEnterpriseScript;0!==t.length&&(t+=i),Dd(t).then(()=>{n(i,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function Ud(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new qd(e);let s;try{s=await i.verify(n)}catch(a){s=await i.verify(n,!0)}const o=Object.assign({},t);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Vd(e,t,n,r){var i;if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Ud(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch(async i=>{if(i.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const i=await Ud(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)})}function zd(e,t,n){const r=Ld(e);Ru(r._canInitEmulator,r,"emulator-config-failed"),Ru(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),s=Bd(t),{host:o,port:a}=function(e){const t=Bd(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Hd(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Hd(t)}}}(t),l=null===a?"":":".concat(a);r.config.emulator={url:"".concat(s,"//").concat(o).concat(l,"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Bd(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Hd(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Gd{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Pu("not implemented")}_getIdTokenResponse(e){return Pu("not implemented")}_linkToIdToken(e,t){return Pu("not implemented")}_getReauthenticationResolver(e){return Pu("not implemented")}}async function Wd(e,t){return Hu(e,"POST","/v1/accounts:signUp",t)}async function Kd(e,t){return Wu(e,"POST","/v1/accounts:signInWithPassword",Bu(e,t))}class Yd extends Gd{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Yd(e,t,"password")}static _fromEmailAndCode(e,t){return new Yd(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Vd(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Kd);case"emailLink":return async function(e,t){return Wu(e,"POST","/v1/accounts:signInWithEmailLink",Bu(e,t))}(e,{email:this._email,oobCode:this._password});default:Tu(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Vd(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Wd);case"emailLink":return async function(e,t){return Wu(e,"POST","/v1/accounts:signInWithEmailLink",Bu(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Tu(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Qd(e,t){return Wu(e,"POST","/v1/accounts:signInWithIdp",Bu(e,t))}class Jd extends Gd{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Jd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Tu("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=xu(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new Jd(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Qd(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Qd(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Qd(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ee(t)}return e}}const Xd={USER_NOT_FOUND:"user-not-found"};class $d extends Gd{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new $d({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new $d({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Wu(e,"POST","/v1/accounts:signInWithPhoneNumber",Bu(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Wu(e,"POST","/v1/accounts:signInWithPhoneNumber",Bu(e,t));if(n.temporaryProof)throw Ju(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Wu(e,"POST","/v1/accounts:signInWithPhoneNumber",Bu(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Xd)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new $d({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Zd{constructor(e){var t,n,r,i,s,o;const a=te(ne(e)),l=null!==(t=a.apiKey)&&void 0!==t?t:null,c=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);Ru(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=te(ne(e)).link,n=t?te(ne(t)).deep_link_id:null,r=te(ne(e)).deep_link_id;return(r?te(ne(r)).link:null)||r||n||t||e}(e);try{return new Zd(t)}catch(n){return null}}}class eh{constructor(){this.providerId=eh.PROVIDER_ID}static credential(e,t){return Yd._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Zd.parseLink(t);return Ru(n,"argument-error"),Yd._fromEmailAndCode(e,n.code,n.tenantId)}}eh.PROVIDER_ID="password",eh.EMAIL_PASSWORD_SIGN_IN_METHOD="password",eh.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class th{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class nh extends th{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class rh extends nh{constructor(){super("facebook.com")}static credential(e){return Jd._fromParams({providerId:rh.PROVIDER_ID,signInMethod:rh.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return rh.credentialFromTaggedObject(e)}static credentialFromError(e){return rh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return rh.credential(t.oauthAccessToken)}catch(n){return null}}}rh.FACEBOOK_SIGN_IN_METHOD="facebook.com",rh.PROVIDER_ID="facebook.com";class ih extends nh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Jd._fromParams({providerId:ih.PROVIDER_ID,signInMethod:ih.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ih.credentialFromTaggedObject(e)}static credentialFromError(e){return ih.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return ih.credential(n,r)}catch(i){return null}}}ih.GOOGLE_SIGN_IN_METHOD="google.com",ih.PROVIDER_ID="google.com";class sh extends nh{constructor(){super("github.com")}static credential(e){return Jd._fromParams({providerId:sh.PROVIDER_ID,signInMethod:sh.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return sh.credentialFromTaggedObject(e)}static credentialFromError(e){return sh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return sh.credential(t.oauthAccessToken)}catch(n){return null}}}sh.GITHUB_SIGN_IN_METHOD="github.com",sh.PROVIDER_ID="github.com";class oh extends nh{constructor(){super("twitter.com")}static credential(e,t){return Jd._fromParams({providerId:oh.PROVIDER_ID,signInMethod:oh.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return oh.credentialFromTaggedObject(e)}static credentialFromError(e){return oh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return oh.credential(n,r)}catch(i){return null}}}async function ah(e,t){return Wu(e,"POST","/v1/accounts:signUp",Bu(e,t))}oh.TWITTER_SIGN_IN_METHOD="twitter.com",oh.PROVIDER_ID="twitter.com";class lh{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await hd._fromIdTokenResponse(e,n,r),s=ch(n);return new lh({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=ch(n);return new lh({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function ch(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class uh extends Q{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,uh.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new uh(e,t,n,r)}}function dh(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw uh._fromErrorAndOperation(e,n,t,r);throw n})}async function hh(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await sd(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return lh._forOperation(e,"link",r)}async function fh(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(yt(r.app))return Promise.reject(ku(r));const i="reauthenticate";try{const s=await sd(e,dh(r,i,t,e),n);Ru(s.idToken,r,"internal-error");const o=rd(s.idToken);Ru(o,r,"internal-error");const{sub:a}=o;return Ru(e.uid===a,r,"user-mismatch"),lh._forOperation(e,i,s)}catch(s){throw(null===s||void 0===s?void 0:s.code)==="auth/".concat("user-not-found")&&Tu(r,"user-mismatch"),s}}async function ph(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(yt(e.app))return Promise.reject(ku(e));const r="signIn",i=await dh(e,r,t),s=await lh._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function mh(e,t){if(yt(e.app))return Promise.reject(ku(e));const n=Ld(e),r=await async function(e,t){return Wu(e,"POST","/v1/accounts:signInWithCustomToken",Bu(e,t))}(n,{token:t,returnSecureToken:!0}),i=await lh._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}new WeakMap;const gh="__sak";class yh{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(gh,"1"),this.storage.removeItem(gh),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class vh extends yh{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=kd(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);Cd()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}vh.type="LOCAL";const bh=vh;class xh extends yh{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}xh.type="SESSION";const wh=xh;class Ih{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Ih(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map(async e=>e(t.origin,i)),a=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Eh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Ih.receivers=[];class Nh{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise((o,a)=>{const l=Eh("",20);r.port1.start();const c=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(c),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Sh(){return window}function Th(){return"undefined"!==typeof Sh().WorkerGlobalScope&&"function"===typeof Sh().importScripts}const _h="firebaseLocalStorageDb",Ch="firebaseLocalStorage",kh="fbase_key";class Ah{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Rh(e,t){return e.transaction([Ch],t?"readwrite":"readonly").objectStore(Ch)}function Ph(){const e=indexedDB.open(_h,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(Ch,{keyPath:kh})}catch(r){n(r)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Ch)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(_h);return new Ah(e).toPromise()}(),t(await Ph()))})})}async function Oh(e,t,n){const r=Rh(e,!0).put({[kh]:t,value:n});return new Ah(r).toPromise()}function Lh(e,t){const n=Rh(e,!0).delete(t);return new Ah(n).toPromise()}class Mh{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Ph()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Th()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ih._getInstance(Th()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Nh(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ph();return await Oh(e,gh,"1"),await Lh(e,gh),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Oh(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Rh(e,!1).get(t),r=await new Ah(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Lh(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Rh(e,!1).getAll();return new Ah(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Mh.type="LOCAL";const jh=Mh;Fd("rcb"),new Fu(3e4,6e4);const Dh="recaptcha";async function Fh(e,t,n){var r;const i=await n.verify();try{let s;if(Ru("string"===typeof i,e,"argument-error"),Ru(n.type===Dh,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){Ru("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Hu(e,"POST","/v2/accounts/mfaEnrollment:start",Bu(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{Ru("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;Ru(n,e,"missing-multi-factor-info");const o=await function(e,t){return Hu(e,"POST","/v2/accounts/mfaSignIn:start",Bu(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Hu(e,"POST","/v1/accounts:sendVerificationCode",Bu(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class qh{constructor(e){this.providerId=qh.PROVIDER_ID,this.auth=Ld(e)}verifyPhoneNumber(e,t){return Fh(this.auth,e,se(t))}static credential(e,t){return $d._fromVerification(e,t)}static credentialFromResult(e){const t=e;return qh.credentialFromTaggedObject(t)}static credentialFromError(e){return qh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?$d._fromTokenResponse(n,r):null}}function Uh(e,t){return t?pd(t):(Ru(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}qh.PROVIDER_ID="phone",qh.PHONE_SIGN_IN_METHOD="phone";class Vh extends Gd{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qd(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Qd(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Qd(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function zh(e){return ph(e.auth,new Vh(e),e.bypassAuthState)}function Bh(e){const{auth:t,user:n}=e;return Ru(n,t,"internal-error"),fh(n,new Vh(e),e.bypassAuthState)}async function Hh(e){const{auth:t,user:n}=e;return Ru(n,t,"internal-error"),hh(n,new Vh(e),e.bypassAuthState)}class Gh{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return zh;case"linkViaPopup":case"linkViaRedirect":return Hh;case"reauthViaPopup":case"reauthViaRedirect":return Bh;default:Tu(this.auth,"internal-error")}}resolve(e){Ou(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ou(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Wh=new Fu(2e3,1e4);class Kh extends Gh{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Kh.currentPopupAction&&Kh.currentPopupAction.cancel(),Kh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ru(e,this.auth,"internal-error"),e}async onExecution(){Ou(1===this.filter.length,"Popup operations only handle one event");const e=Eh();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(_u(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(_u(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Kh.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_u(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Wh.get())};e()}}Kh.currentPopupAction=null;const Yh=new Map;class Qh extends Gh{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Yh.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=$h(t),r=Xh(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Yh.set(this.auth._key(),e)}return this.bypassAuthState||Yh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Jh(e,t){Yh.set(e._key(),t)}function Xh(e){return pd(e._redirectPersistence)}function $h(e){return yd("pendingRedirect",e.config.apiKey,e.name)}async function Zh(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(yt(e.app))return Promise.reject(ku(e));const r=Ld(e),i=Uh(r,t),s=new Qh(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class ef{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return nf(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!nf(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(_u(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(tf(e))}saveEventToCache(e){this.cachedEventUids.add(tf(e)),this.lastProcessedEventTime=Date.now()}}function tf(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function nf(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const rf=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,sf=/^https?/;async function of(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return Hu(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(af(r))return}catch(n){}Tu(e,"unauthorized-domain")}function af(e){const t=Lu(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!sf.test(n))return!1;if(rf.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const lf=new Fu(3e4,6e4);function cf(){const e=Sh().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function uf(e){return new Promise((t,n)=>{var r,i,s;function o(){cf(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{cf(),n(_u(e,"network-request-failed"))},timeout:lf.get()})}if(null===(i=null===(r=Sh().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Sh().gapi)||void 0===s?void 0:s.load)){const t=Fd("iframefcb");return Sh()[t]=()=>{gapi.load?o():n(_u(e,"network-request-failed"))},Dd("".concat(jd.gapiScript,"?onload=").concat(t)).catch(e=>n(e))}o()}}).catch(e=>{throw df=null,e})}let df=null;const hf=new Fu(5e3,15e3),ff={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},pf=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mf(e){const t=e.config;Ru(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?qu(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:xt},i=pf.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),"".concat(n,"?").concat(ee(r).slice(1))}async function gf(e){const t=await function(e){return df=df||uf(e),df}(e),n=Sh().gapi;return Ru(n,e,"internal-error"),t.open({where:document.body,url:mf(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ff,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=_u(e,"network-request-failed"),s=Sh().setTimeout(()=>{r(i)},hf.get());function o(){Sh().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{r(i)})}))}const yf={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class vf{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function bf(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},yf),{width:r.toString(),height:i.toString(),top:s,left:o}),c=W().toLowerCase();n&&(a=Id(c)?"_blank":n),xd(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")},"");if(function(){var e;return _d(arguments.length>0&&void 0!==arguments[0]?arguments[0]:W())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new vf(null);const d=window.open(t||"",a,u);Ru(d,e,"popup-blocked");try{d.focus()}catch(h){}return new vf(d)}const xf="__/auth/handler",wf="emulator/auth/handler",If=encodeURIComponent("fac");async function Ef(e,t,n,r,i,s){Ru(e.config.authDomain,e,"auth-domain-config-required"),Ru(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:xt,eventId:i};if(t instanceof th){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof nh){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const u of Object.keys(a))void 0===a[u]&&delete a[u];const l=await e._getAppCheckToken(),c=l?"#".concat(If,"=").concat(encodeURIComponent(l)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(xf);return qu(t,wf)}(e),"?").concat(ee(a).slice(1)).concat(c)}const Nf="webStorageSupport";const Sf=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=wh,this._completeRedirectFn=Zh,this._overrideRedirectResult=Jh}async _openPopup(e,t,n,r){var i;Ou(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return bf(e,await Ef(e,t,n,Lu(),r),Eh())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Sh().location.href=e}(await Ef(e,t,n,Lu(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Ou(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await gf(e),n=new ef(e);return t.register("authEvent",t=>{Ru(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Nf,{type:Nf},n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[Nf];void 0!==i&&t(!!i),Tu(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=of(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return kd()||wd()||_d()}};var Tf="@firebase/auth",_f="1.7.9";class Cf{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ru(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const kf=H("authIdTokenMaxAge")||300;let Af=null;var Rf;jd={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=_u("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Rf="Browser",mt(new oe("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Ru(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:Rf,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ad(Rf)},c=new Od(r,i,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(pd);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),mt(new oe("auth-internal",e=>(e=>new Cf(e))(Ld(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),Et(Tf,_f,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Rf)),Et(Tf,_f,"esm2017");Et("firebase","10.14.1","app");let Pf={apiKey:"AIzaSyCUDuHefWAoVrG6Gf4mDVaxnKuZzkdtBAw",authDomain:"term3-rn.firebaseapp.com",projectId:"term3-rn",storageBucket:"term3-rn.firebasestorage.app",messagingSenderId:"494666669692",appId:"1:494666669692:web:67b5a9b3ad9dd65b7a33f9",measurementId:"G-B13V3P1WEH"};if("undefined"!==typeof window&&window.__firebase_config)try{Pf=JSON.parse(window.__firebase_config),console.log("Using injected Firebase config")}catch(Fp){console.warn("Failed to parse window.__firebase_config, using default")}const Of=wt(Pf),Lf=function(e,t){const n="string"==typeof e?e:t||"(default)",r=gt("object"==typeof e?e:It(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=(e=>{const t=z(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&lc(r,...e)}return r}(Of),Mf=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:It();const t=gt(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=gt(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if($(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;Tu(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Sf,persistence:[jh,bh,wh]}),r=H("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>kf)return;const r=null===t||void 0===t?void 0:t.token;Af!==r&&(Af=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:"Bearer ".concat(r)}:{}}))});!function(e,t,n){se(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){se(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}var i;const s=z("auth");return s&&zd(n,"http://".concat(s)),n}(Of),jf={id:"string",text:"string",options:"array",correctIndex:"number",rationale:"string"},Df={id:"string",title:"string",prompt:"string",stem:"string",choices:"array",correctIndex:"number|array",rationaleCorrect:"string",rationaleWrong:"array",difficulty:"number",timerSeconds:"number"},Ff={id:"string",text:"string",scenario:"string",options:"array",correctIndex:"number|array",timeLimit:"number",rationale:"string",skill:"array",bloom:"string",difficulty:"number"};function qf(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"standard";switch(n.toLowerCase()){case"challenge":t=Df;break;case"clinical":case"clinical-judgment":t=Ff;break;default:t=jf}const r={totalQuestions:e.length,valid:0,invalid:0,questionResults:[]};return e.forEach((e,n)=>{const i=function(e,t){const n=[],r=[];for(const[s,o]of Object.entries(t)){if(!(s in e)){n.push("Missing required field: ".concat(s));continue}const t=e[s],r=o.split("|");let i=!1;for(const e of r){if("array"===e&&Array.isArray(t)){i=!0;break}if("number"===e&&"number"===typeof t){i=!0;break}if("string"===e&&"string"===typeof t){i=!0;break}}i||n.push("Field ".concat(s," has wrong type. Expected: ").concat(o,", got: ").concat(typeof t))}const i=e.options||e.choices;if(i&&Array.isArray(i)&&(i.length<2&&n.push("Must have at least 2 answer choices"),i.some(e=>!e||"string"===typeof e&&""===e.trim())&&n.push("All answer choices must have content")),"correctIndex"in e){const t=e.correctIndex,r=i?i.length:0;Array.isArray(t)?(0===t.length&&n.push("SATA question must have at least one correct answer"),t.forEach(e=>{(e<0||e>=r)&&n.push("correctIndex ".concat(e," out of range (0-").concat(r-1,")"))})):"number"===typeof t&&(t<0||t>=r)&&n.push("correctIndex ".concat(t," out of range (0-").concat(r-1,")"))}return e.rationale||e.rationaleCorrect||r.push("No rationale provided - students won't learn from mistakes"),{valid:0===n.length,errors:n,warnings:r}}(e,t);i.valid?r.valid++:r.invalid++,r.questionResults.push((0,s.A)({questionId:e.id||"Question ".concat(n+1),index:n},i))}),r}function Uf(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log("\ud83d\udccb QUESTION VALIDATION RESULTS"),console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log("Total Questions: ".concat(e.totalQuestions)),console.log("\u2705 Valid: ".concat(e.valid)),console.log("\u274c Invalid: ".concat(e.invalid)),console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n"),(e.invalid>0||t)&&e.questionResults.forEach(e=>{e.valid&&!t||(console.log("\n\ud83d\udd0d ".concat(e.questionId," (Index: ").concat(e.index,")")),e.errors.length>0&&(console.log("  \u274c Errors:"),e.errors.forEach(e=>console.log("     - ".concat(e)))),e.warnings.length>0&&(console.log("  \u26a0\ufe0f  Warnings:"),e.warnings.forEach(e=>console.log("     - ".concat(e)))))}),0===e.invalid&&console.log("\u2728 All questions passed validation!\n")}const Vf=new class{constructor(){this._chapters=null,this._questionCache=new Map,this._initialized=!1}async initialize(){if(this._initialized)console.warn("QuestionLoader already initialized");else try{const e=await fetch("/data/chapters.json");if(!e.ok)throw new Error("Failed to load chapters: ".concat(e.statusText));this._chapters=await e.json(),console.log("\ud83d\udcda Loaded ".concat(this._chapters.length," chapters")),await this._loadAllQuestions(),this._initialized=!0,console.log("\u2705 QuestionLoader initialized successfully")}catch(e){throw console.error("\u274c Failed to initialize QuestionLoader:",e),e}}async _loadAllQuestions(){const e={ch18:"/data/ch18-questions.json",ch19:"/data/ch19-questions.json",ch20:"/data/ch20-questions.json",ch21:"/data/ch21-questions.json",ch22:"/data/ch22-questions.json",quiz1:"/data/quiz1-questions.json",challenge:"/data/challenge-scenarios.json","clinical-judgment":"/data/clinical-judgment-scenarios.json","day-to-be-wrong":"/data/clinical-judgment-scenarios.json"};for(const[n,r]of Object.entries(e))try{const e=await fetch(r);if(!e.ok){console.warn("\u26a0\ufe0f  Could not load ".concat(r,": ").concat(e.statusText));continue}const t=await e.json(),i=qf(t,n);i.invalid>0?(console.warn("\u26a0\ufe0f  ".concat(r," has ").concat(i.invalid," invalid questions")),Uf(i)):console.log("\u2705 ".concat(r,": ").concat(i.valid," valid questions")),this._questionCache.set(n,Object.freeze(t))}catch(t){console.error("\u274c Error loading ".concat(r,":"),t)}}getChapters(){return this._ensureInitialized(),JSON.parse(JSON.stringify(this._chapters))}getChapter(e){this._ensureInitialized();const t=this._chapters.find(t=>t.id===e);return t?JSON.parse(JSON.stringify(t)):null}getRawQuestions(e){this._ensureInitialized();const t=this._getCacheKey(e),n=this._questionCache.get(t);return n||(console.warn("No questions found for chapter: ".concat(e)),[])}getQuestionsForChapter(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._ensureInitialized();const n=this.getRawQuestions(e),r=JSON.parse(JSON.stringify(n));return t&&this._shuffleArray(r),r}getRandomQuestions(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this.getQuestionsForChapter(e,n);return r.slice(0,Math.min(t,r.length))}getQuestionCount(e){return this.getRawQuestions(e).length}validateAllQuestions(){this._ensureInitialized();const e={total:0,valid:0,invalid:0,byChapter:{}};for(const[t,n]of this._questionCache.entries()){const r=qf(n,t);e.total+=r.totalQuestions,e.valid+=r.valid,e.invalid+=r.invalid,e.byChapter[t]=r,r.invalid>0&&(console.log("\n\ud83d\udce6 Validation for: ".concat(t)),Uf(r))}return e}_getCacheKey(e){return"day-to-be-wrong"===e?"clinical-judgment":e.startsWith("challenge")?"challenge":e}_shuffleArray(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}_ensureInitialized(){if(!this._initialized)throw new Error("QuestionLoader not initialized. Call initialize() first.")}getStats(){this._ensureInitialized();const e={chapters:this._chapters.length,questionBanks:this._questionCache.size,totalQuestions:0,questionsByBank:{}};for(const[t,n]of this._questionCache.entries()){const r=n.length;e.totalQuestions+=r,e.questionsByBank[t]=r}return e}},zf=Vf;var Bf=n(579);const Hf={Shield:o.A,AlertCircle:a.A,Activity:u.A,Bug:c.A,Brain:d.A,Scale:h.A,Bone:u.A};function Gf(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{return"challenge-mode"===e?zf.getQuestionsForChapter("challenge",t):"day-to-be-wrong"===e?zf.getQuestionsForChapter("clinical-judgment",t):zf.getQuestionsForChapter(e,t)}catch(n){return console.error("Error loading questions for ".concat(e,":"),n),[]}}function Wf(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(){try{return zf.getChapters().map(e=>({id:e.id,title:e.title,icon:Kf(e.iconName),description:e.description,questions:[]}))}catch(e){return console.error("Error loading chapters:",e),[]}}().map(t=>{const n=Gf(t.id,e);return(0,s.A)((0,s.A)({},t),{},{questions:n})})}function Kf(e){const t=Hf[e]||d.A;return(0,Bf.jsx)(t,{className:"w-6 h-6"})}(async()=>{await async function(){try{await zf.initialize(),console.log("\u2705 Question system initialized"),console.log("\ud83d\udcca Stats:",zf.getStats());const e=zf.validateAllQuestions();return e.invalid>0&&console.warn("\u26a0\ufe0f  ".concat(e.invalid," invalid questions found")),!0}catch(e){return console.error("\u274c Failed to initialize questions:",e),!1}}(),Wf()})();const Yf=(0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)({},{ch18_q01:{concept:"FIRST_LINE_DEFENSE",skill:["DIFFERENTIATION","TEACHING_ERROR"],bloom:"APPLICATION"},ch18_q02:{concept:"IMMUNE_ORGANS",skill:["RECALL"],bloom:"KNOWLEDGE"},ch18_q03:{concept:"LEUKOCYTES",skill:["DIFFERENTIATION","RECALL"],bloom:"KNOWLEDGE"},ch18_q04:{concept:"LEUKOCYTOSIS",skill:["PRIORITY","CLINICAL_REASONING"],bloom:"APPLICATION"},ch18_q05:{concept:"IMMUNITY_TYPES",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch18_q06:{concept:"AGING_IMMUNE_SYSTEM",skill:["CLINICAL_REASONING"],bloom:"COMPREHENSION"},ch18_q07:{concept:"DIAGNOSTIC_TESTS",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch18_q08:{concept:"IMMUNE_ASSESSMENT",skill:["PRIORITY","CLINICAL_REASONING"],bloom:"APPLICATION"},ch18_q09:{concept:"IMMUNE_ORGANS",skill:["RECALL"],bloom:"KNOWLEDGE"},ch18_q10:{concept:"IMMUNOGLOBULINS",skill:["RECALL"],bloom:"KNOWLEDGE"},ch18_q11:{concept:"IMMUNE_ASSESSMENT",skill:["CLINICAL_REASONING","DIFFERENTIATION"],bloom:"APPLICATION"},ch18_q12:{concept:"DIAGNOSTIC_TESTS",skill:["LAB_INTERPRETATION","DIFFERENTIATION"],bloom:"COMPREHENSION"},ch18_q13:{concept:"IMMUNE_FUNCTION",skill:["RECALL","TEACHING"],bloom:"COMPREHENSION"},ch18_q14:{concept:"LEUKOCYTES",skill:["RECALL"],bloom:"KNOWLEDGE"},ch18_q15:{concept:"INFLAMMATION",skill:["RECALL"],bloom:"KNOWLEDGE"},ch18_q16:{concept:"IMMUNITY_TYPES",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch18_q17:{concept:"LEUKOCYTES",skill:["PRIORITY","RECALL"],bloom:"COMPREHENSION"},ch18_q18:{concept:"IMMUNE_FUNCTION",skill:["RECALL"],bloom:"KNOWLEDGE"},ch18_q19:{concept:"IMMUNITY_TYPES",skill:["RECALL"],bloom:"COMPREHENSION"},ch18_q20:{concept:"IMMUNE_ASSESSMENT",skill:["CLINICAL_REASONING","PRIORITY"],bloom:"APPLICATION"},ch18_q21:{concept:"DIAGNOSTIC_TESTS",skill:["LAB_INTERPRETATION","PRIORITY"],bloom:"APPLICATION"},ch18_q22:{concept:"LEUKOCYTES",skill:["RECALL"],bloom:"KNOWLEDGE"},ch18_q23:{concept:"DIAGNOSTIC_TESTS",skill:["LAB_INTERPRETATION","DIFFERENTIATION"],bloom:"COMPREHENSION"},ch18_q24:{concept:"IMMUNE_FUNCTION",skill:["RECALL","DIFFERENTIATION"],bloom:"KNOWLEDGE"},ch18_q25:{concept:"LEUKOCYTES",skill:["RECALL"],bloom:"KNOWLEDGE"}}),{ch19_q01:{concept:"HYPERSENSITIVITY",skill:["RECALL"],bloom:"KNOWLEDGE"},ch19_q02:{concept:"LATEX_ALLERGY",skill:["TEACHING","MED_SAFETY"],bloom:"COMPREHENSION"},ch19_q03:{concept:"ANAPHYLAXIS",skill:["PRIORITY","CLINICAL_REASONING"],bloom:"APPLICATION"},ch19_q04:{concept:"TYPE_II",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch19_q05:{concept:"TYPE_III",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch19_q06:{concept:"ANAPHYLAXIS",skill:["PRIORITY","MED_SAFETY"],bloom:"APPLICATION"},ch19_q07:{concept:"TYPE_IV",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch19_q08:{concept:"ANAPHYLAXIS",skill:["PRIORITY","MED_SAFETY"],bloom:"APPLICATION"},ch19_q09:{concept:"AUTOIMMUNITY",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch19_q10:{concept:"IMMUNODEFICIENCY",skill:["MED_SAFETY","TEACHING_ERROR"],bloom:"APPLICATION"},ch19_q11:{concept:"TYPE_III",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch19_q12:{concept:"HYPERSENSITIVITY",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch19_q13:{concept:"HYPERSENSITIVITY",skill:["TEACHING","MED_SAFETY"],bloom:"APPLICATION"},ch19_q14:{concept:"TRANSPLANT",skill:["RECALL"],bloom:"KNOWLEDGE"},ch19_q15:{concept:"TYPE_IV",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch19_q16:{concept:"HYPERSENSITIVITY",skill:["MED_SAFETY"],bloom:"COMPREHENSION"},ch19_q17:{concept:"TYPE_II",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch19_q18:{concept:"TYPE_IV",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch19_q19:{concept:"AUTOIMMUNITY",skill:["CLINICAL_REASONING"],bloom:"COMPREHENSION"},ch19_q20:{concept:"ANAPHYLAXIS",skill:["PRIORITY","MED_SAFETY"],bloom:"APPLICATION"},ch19_q21:{concept:"IMMUNOSUPPRESSION",skill:["MED_SAFETY","TEACHING"],bloom:"APPLICATION"},ch19_q22:{concept:"AUTOIMMUNITY",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch19_q23:{concept:"TRANSPLANT",skill:["RECALL"],bloom:"KNOWLEDGE"},ch19_q24:{concept:"HYPERSENSITIVITY",skill:["RECALL"],bloom:"KNOWLEDGE"},ch19_q25:{concept:"LATEX_ALLERGY",skill:["TEACHING","MED_SAFETY"],bloom:"APPLICATION"}}),{ch20_q01:{concept:"OSTEOARTHRITIS",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch20_q02:{concept:"LUPUS",skill:["TEACHING","MED_SAFETY"],bloom:"APPLICATION"},ch20_q03:{concept:"RHEUMATOID_ARTHRITIS",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch20_q04:{concept:"GOUT",skill:["MED_SAFETY","DIFFERENTIATION"],bloom:"APPLICATION"},ch20_q05:{concept:"SCLERODERMA",skill:["RECALL"],bloom:"KNOWLEDGE"},ch20_q06:{concept:"GOUT",skill:["TEACHING"],bloom:"APPLICATION"},ch20_q07:{concept:"ARTHRITIS_MANAGEMENT",skill:["MED_SAFETY"],bloom:"APPLICATION"},ch20_q08:{concept:"OSTEOARTHRITIS",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch20_q09:{concept:"FIBROMYALGIA",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch20_q10:{concept:"SJOGREN",skill:["RECALL"],bloom:"KNOWLEDGE"},ch20_q11:{concept:"LUPUS",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch20_q12:{concept:"SCLERODERMA",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch20_q13:{concept:"OSTEOARTHRITIS",skill:["TEACHING"],bloom:"APPLICATION"},ch20_q14:{concept:"RAYNAUDS",skill:["TEACHING","MED_SAFETY"],bloom:"APPLICATION"},ch20_q15:{concept:"ARTHRITIS_MANAGEMENT",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch20_q16:{concept:"RHEUMATOID_ARTHRITIS",skill:["MED_SAFETY"],bloom:"APPLICATION"},ch20_q17:{concept:"RHEUMATOID_ARTHRITIS",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch20_q18:{concept:"ARTHRITIS_MANAGEMENT",skill:["TEACHING","MED_SAFETY"],bloom:"APPLICATION"},ch20_q19:{concept:"GOUT",skill:["RECALL"],bloom:"KNOWLEDGE"},ch20_q20:{concept:"OSTEOARTHRITIS",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch20_q21:{concept:"GOUT",skill:["MED_SAFETY","TEACHING_ERROR"],bloom:"APPLICATION"},ch20_q22:{concept:"GOUT",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch20_q23:{concept:"OSTEOARTHRITIS",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch20_q24:{concept:"LUPUS",skill:["TEACHING","PRIORITY"],bloom:"APPLICATION"},ch20_q25:{concept:"RHEUMATOID_ARTHRITIS",skill:["MED_SAFETY"],bloom:"APPLICATION"}}),{ch21_q01:{concept:"TRANSMISSION",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch21_q02:{concept:"TRANSMISSION",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch21_q03:{concept:"TRANSMISSION",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch21_q04:{concept:"MRSA",skill:["INFECTION_CONTROL","RECALL"],bloom:"COMPREHENSION"},ch21_q05:{concept:"C_DIFF",skill:["PRIORITY","INFECTION_CONTROL"],bloom:"APPLICATION"},ch21_q06:{concept:"VRE",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch21_q07:{concept:"MDRO_RISK",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch21_q08:{concept:"ACINETOBACTER",skill:["RECALL"],bloom:"KNOWLEDGE"},ch21_q09:{concept:"ANTIBIOTIC_STEWARDSHIP",skill:["RECALL"],bloom:"COMPREHENSION"},ch21_q10:{concept:"PPE",skill:["SEQUENCING"],bloom:"APPLICATION"},ch21_q11:{concept:"PPE",skill:["SEQUENCING","INFECTION_CONTROL"],bloom:"APPLICATION"},ch21_q12:{concept:"CRE",skill:["RECALL","MED_SAFETY"],bloom:"COMPREHENSION"},ch21_q13:{concept:"ISOLATION",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch21_q14:{concept:"HAND_HYGIENE",skill:["PRIORITY"],bloom:"APPLICATION"},ch21_q15:{concept:"STANDARD_PRECAUTIONS",skill:["RECALL"],bloom:"COMPREHENSION"},ch21_q16:{concept:"TB",skill:["DIFFERENTIATION","INFECTION_CONTROL"],bloom:"APPLICATION"},ch21_q17:{concept:"PPE",skill:["SEQUENCING"],bloom:"APPLICATION"},ch21_q18:{concept:"DROPLET_PRECAUTIONS",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch21_q19:{concept:"ESBL",skill:["RECALL","MED_SAFETY"],bloom:"COMPREHENSION"},ch21_q20:{concept:"CONTACT_PRECAUTIONS",skill:["INFECTION_CONTROL"],bloom:"COMPREHENSION"},ch21_q21:{concept:"CRE",skill:["RECALL"],bloom:"KNOWLEDGE"},ch21_q22:{concept:"TB",skill:["INFECTION_CONTROL"],bloom:"APPLICATION"},ch21_q23:{concept:"EXPOSURE_PROTOCOL",skill:["PRIORITY","MED_SAFETY"],bloom:"APPLICATION"},ch21_q24:{concept:"ANTIBIOTIC_RESISTANCE",skill:["RECALL"],bloom:"COMPREHENSION"},ch21_q25:{concept:"PROTECTIVE_ENVIRONMENT",skill:["DIFFERENTIATION","CLINICAL_REASONING"],bloom:"APPLICATION"}}),{ch22_q01:{concept:"HIV_PROGRESSION",skill:["SEQUENCING"],bloom:"COMPREHENSION"},ch22_q02:{concept:"HIV_PROGRESSION",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch22_q03:{concept:"PREP",skill:["DIFFERENTIATION","TEACHING"],bloom:"COMPREHENSION"},ch22_q04:{concept:"AIDS_DIAGNOSIS",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch22_q05:{concept:"OPPORTUNISTIC_INFECTIONS",skill:["RECALL"],bloom:"KNOWLEDGE"},ch22_q06:{concept:"ANTIRETROVIRAL_THERAPY",skill:["TEACHING"],bloom:"COMPREHENSION"},ch22_q07:{concept:"OPPORTUNISTIC_INFECTIONS",skill:["CLINICAL_REASONING"],bloom:"COMPREHENSION"},ch22_q08:{concept:"PEP",skill:["PRIORITY","MED_SAFETY"],bloom:"APPLICATION"},ch22_q09:{concept:"VIRAL_LOAD",skill:["TEACHING"],bloom:"COMPREHENSION"},ch22_q10:{concept:"OPPORTUNISTIC_INFECTIONS",skill:["CLINICAL_REASONING"],bloom:"COMPREHENSION"},ch22_q11:{concept:"HIV_TESTING",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch22_q12:{concept:"ANTIRETROVIRAL_THERAPY",skill:["MED_SAFETY"],bloom:"COMPREHENSION"},ch22_q13:{concept:"HIV_TRANSMISSION",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch22_q14:{concept:"ADHERENCE",skill:["TEACHING","MED_SAFETY"],bloom:"APPLICATION"},ch22_q15:{concept:"OPPORTUNISTIC_INFECTIONS",skill:["PRIORITY","CLINICAL_REASONING"],bloom:"APPLICATION"},ch22_q16:{concept:"HIV_TESTING",skill:["TEACHING"],bloom:"COMPREHENSION"},ch22_q17:{concept:"ANTIRETROVIRAL_THERAPY",skill:["MED_SAFETY"],bloom:"COMPREHENSION"},ch22_q18:{concept:"PREP",skill:["TEACHING","DIFFERENTIATION"],bloom:"COMPREHENSION"},ch22_q19:{concept:"CD4_COUNT",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch22_q20:{concept:"OPPORTUNISTIC_INFECTIONS",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch22_q21:{concept:"ADHERENCE",skill:["TEACHING","MED_SAFETY"],bloom:"APPLICATION"},ch22_q22:{concept:"HIV_PROGRESSION",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch22_q23:{concept:"ANTIRETROVIRAL_THERAPY",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch22_q24:{concept:"ADHERENCE",skill:["TEACHING","MED_SAFETY"],bloom:"APPLICATION"},ch22_q25:{concept:"HIV_DISCLOSURE",skill:["TEACHING","RECALL"],bloom:"COMPREHENSION"}}),{quiz1_q01:{concept:"IMMUNOGLOBULINS",skill:["RECALL"],bloom:"KNOWLEDGE"},quiz1_q02:{concept:"TYPE_IV",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},quiz1_q03:{concept:"OSTEOARTHRITIS",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},quiz1_q04:{concept:"C_DIFF",skill:["PRIORITY","INFECTION_CONTROL"],bloom:"APPLICATION"},quiz1_q05:{concept:"AIDS_DIAGNOSIS",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},quiz1_q06:{concept:"LEUKOCYTES",skill:["RECALL"],bloom:"KNOWLEDGE"},quiz1_q07:{concept:"LUPUS",skill:["CLINICAL_REASONING"],bloom:"COMPREHENSION"},quiz1_q08:{concept:"ANAPHYLAXIS",skill:["PRIORITY","MED_SAFETY"],bloom:"APPLICATION"},quiz1_q09:{concept:"MRSA",skill:["INFECTION_CONTROL"],bloom:"COMPREHENSION"},quiz1_q10:{concept:"ANTIRETROVIRAL_THERAPY",skill:["TEACHING"],bloom:"COMPREHENSION"},quiz1_q11:{concept:"INFLAMMATION",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},quiz1_q12:{concept:"TYPE_III",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},quiz1_q13:{concept:"GOUT",skill:["MED_SAFETY","DIFFERENTIATION"],bloom:"APPLICATION"},quiz1_q14:{concept:"HAND_HYGIENE",skill:["PRIORITY"],bloom:"APPLICATION"},quiz1_q15:{concept:"OPPORTUNISTIC_INFECTIONS",skill:["CLINICAL_REASONING"],bloom:"COMPREHENSION"},quiz1_q16:{concept:"IMMUNOGLOBULINS",skill:["RECALL"],bloom:"KNOWLEDGE"},quiz1_q17:{concept:"HYPERSENSITIVITY",skill:["RECALL"],bloom:"KNOWLEDGE"},quiz1_q18:{concept:"LUPUS",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},quiz1_q19:{concept:"STANDARD_PRECAUTIONS",skill:["RECALL"],bloom:"COMPREHENSION"},quiz1_q20:{concept:"VIRAL_LOAD",skill:["TEACHING"],bloom:"COMPREHENSION"},quiz1_q21:{concept:"IMMUNITY_TYPES",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},quiz1_q22:{concept:"RHEUMATOID_ARTHRITIS",skill:["MED_SAFETY"],bloom:"APPLICATION"},quiz1_q23:{concept:"PPE",skill:["SEQUENCING"],bloom:"APPLICATION"},quiz1_q24:{concept:"PEP",skill:["PRIORITY","MED_SAFETY"],bloom:"APPLICATION"},quiz1_q25:{concept:"LEUKOCYTES",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"}});function Qf(e){return e.map(e=>{var t;const n=Yf[e.id]||{},r=(null===(t=e.id)||void 0===t?void 0:t.split("_")[0])||"unknown";return(0,s.A)((0,s.A)({},e),{},{chapter:r,concept:n.concept||null,skill:n.skill||[],bloom:n.bloom||null})})}var Jf=n(986);const Xf=(0,f.A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),$f=(0,f.A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);var Zf=n(118);const ep=(0,f.A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),tp=(0,f.A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),np=(0,f.A)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),rp=(0,f.A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),ip=(0,f.A)("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),sp=["id"],op=e=>{let{unlockedChapters:t,onToggleLock:n,loading:r}=e;return(0,Bf.jsxs)("div",{children:[(0,Bf.jsx)("p",{className:"text-gray-600 mb-6",children:"Control which chapters students can access. Locked chapters will show a \ud83d\udd12 badge and cannot be clicked."}),(0,Bf.jsx)("div",{className:"grid gap-3",children:[{id:"ch18",title:"Chapter 18: Immune Assessment",icon:"\ud83d\udee1\ufe0f"},{id:"ch19",title:"Chapter 19: Immune Disorders",icon:"\ud83d\udc1b"},{id:"ch20",title:"Chapter 20: Connective Tissue",icon:"\ud83e\uddb4"},{id:"ch21",title:"Chapter 21: MDROs",icon:"\ud83e\udda0"},{id:"ch22",title:"Chapter 22: HIV/AIDS",icon:"\ud83d\udd2c"},{id:"quiz1",title:"Quiz 1 Review",icon:"\ud83c\udfaf"},{id:"day-to-be-wrong",title:"\u2696\ufe0f A Day to be Wrong",icon:"\u2696\ufe0f"}].map(e=>{const i=t.includes(e.id);return(0,Bf.jsxs)("div",{className:"flex items-center justify-between p-4 border-2 rounded-lg hover:border-purple-300 transition-colors",children:[(0,Bf.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Bf.jsx)("span",{className:"text-3xl",children:e.icon}),(0,Bf.jsxs)("div",{children:[(0,Bf.jsx)("h3",{className:"font-bold text-lg",children:e.title}),(0,Bf.jsxs)("p",{className:"text-sm text-gray-500",children:["ID: ",e.id]})]})]}),(0,Bf.jsx)("button",{onClick:()=>n(e.id),disabled:r,className:"flex items-center gap-2 px-6 py-3 rounded-lg font-semibold transition-all disabled:opacity-50 ".concat(i?"bg-green-500 text-white hover:bg-green-600":"bg-red-500 text-white hover:bg-red-600"),children:i?(0,Bf.jsxs)(Bf.Fragment,{children:[(0,Bf.jsx)(ip,{className:"w-5 h-5"}),"Unlocked"]}):(0,Bf.jsxs)(Bf.Fragment,{children:[(0,Bf.jsx)(v,{className:"w-5 h-5"}),"Locked"]})})]},e.id)})})]})},ap=e=>{let{chapter:t,onSave:n,onCancel:i,loading:o}=e;const[a,l]=(0,r.useState)({chapterId:t.chapterId||"",title:t.title||"",description:t.description||"",icon:t.icon||"\ud83d\udcda",questions:t.questions||[]}),[c,u]=(0,r.useState)({id:"",question:"",options:["","","",""],correct:0,rationale:""});return(0,Bf.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-4 overflow-y-auto",children:(0,Bf.jsxs)("div",{className:"max-w-4xl mx-auto bg-white rounded-xl shadow-2xl p-8",children:[(0,Bf.jsx)("h2",{className:"text-3xl font-bold mb-6",children:t.id?"Edit Chapter":"New Chapter"}),(0,Bf.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a.chapterId&&a.title&&0!==a.questions.length?n((0,s.A)((0,s.A)({},t),a)):alert("Please fill in chapter ID, title, and add at least one question")},className:"space-y-6",children:[(0,Bf.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Bf.jsxs)("div",{children:[(0,Bf.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Chapter ID"}),(0,Bf.jsx)("input",{type:"text",value:a.chapterId,onChange:e=>l((0,s.A)((0,s.A)({},a),{},{chapterId:e.target.value})),className:"w-full px-4 py-2 border rounded-lg",placeholder:"ch23",required:!0})]}),(0,Bf.jsxs)("div",{children:[(0,Bf.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Icon"}),(0,Bf.jsx)("input",{type:"text",value:a.icon,onChange:e=>l((0,s.A)((0,s.A)({},a),{},{icon:e.target.value})),className:"w-full px-4 py-2 border rounded-lg",placeholder:"\ud83d\udcda"})]})]}),(0,Bf.jsxs)("div",{children:[(0,Bf.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Title"}),(0,Bf.jsx)("input",{type:"text",value:a.title,onChange:e=>l((0,s.A)((0,s.A)({},a),{},{title:e.target.value})),className:"w-full px-4 py-2 border rounded-lg",placeholder:"Chapter 23: Advanced Topics",required:!0})]}),(0,Bf.jsxs)("div",{children:[(0,Bf.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Description"}),(0,Bf.jsx)("textarea",{value:a.description,onChange:e=>l((0,s.A)((0,s.A)({},a),{},{description:e.target.value})),className:"w-full px-4 py-2 border rounded-lg",rows:"2",placeholder:"What this chapter covers..."})]}),(0,Bf.jsxs)("div",{className:"border-t pt-6",children:[(0,Bf.jsxs)("h3",{className:"text-xl font-bold mb-4",children:["Questions (",a.questions.length,")"]}),(0,Bf.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-4 space-y-4",children:[(0,Bf.jsxs)("div",{children:[(0,Bf.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Question"}),(0,Bf.jsx)("textarea",{value:c.question,onChange:e=>u((0,s.A)((0,s.A)({},c),{},{question:e.target.value})),className:"w-full px-4 py-2 border rounded-lg",rows:"3",placeholder:"Enter question text..."})]}),c.options.map((e,t)=>(0,Bf.jsxs)("div",{children:[(0,Bf.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["Option ",t+1," ",t===c.correct&&"(Correct)"]}),(0,Bf.jsx)("input",{type:"text",value:e,onChange:e=>{const n=[...c.options];n[t]=e.target.value,u((0,s.A)((0,s.A)({},c),{},{options:n}))},className:"w-full px-4 py-2 border rounded-lg",placeholder:"Option ".concat(t+1)})]},t)),(0,Bf.jsxs)("div",{children:[(0,Bf.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Correct Answer"}),(0,Bf.jsxs)("select",{value:c.correct,onChange:e=>u((0,s.A)((0,s.A)({},c),{},{correct:parseInt(e.target.value)})),className:"w-full px-4 py-2 border rounded-lg",children:[(0,Bf.jsx)("option",{value:0,children:"Option 1"}),(0,Bf.jsx)("option",{value:1,children:"Option 2"}),(0,Bf.jsx)("option",{value:2,children:"Option 3"}),(0,Bf.jsx)("option",{value:3,children:"Option 4"})]})]}),(0,Bf.jsxs)("div",{children:[(0,Bf.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Rationale"}),(0,Bf.jsx)("textarea",{value:c.rationale,onChange:e=>u((0,s.A)((0,s.A)({},c),{},{rationale:e.target.value})),className:"w-full px-4 py-2 border rounded-lg",rows:"2",placeholder:"Explain why this is the correct answer..."})]}),(0,Bf.jsx)("button",{type:"button",onClick:()=>{if(!c.question||c.options.some(e=>!e))return void alert("Please fill in question and all options");const e=(0,s.A)((0,s.A)({},c),{},{id:c.id||"".concat(a.chapterId,"_q").concat(a.questions.length+1).padStart(2,"0")});l((0,s.A)((0,s.A)({},a),{},{questions:[...a.questions,e]})),u({id:"",question:"",options:["","","",""],correct:0,rationale:""})},className:"w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700",children:"Add Question"})]}),a.questions.length>0&&(0,Bf.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:a.questions.map((e,t)=>(0,Bf.jsxs)("div",{className:"border p-3 rounded-lg flex justify-between items-start",children:[(0,Bf.jsxs)("div",{className:"flex-1",children:[(0,Bf.jsxs)("p",{className:"font-medium",children:["Q",t+1,": ",e.question.substring(0,80),"..."]}),(0,Bf.jsxs)("p",{className:"text-sm text-green-600",children:["\u2713 ",e.options[e.correct]]})]}),(0,Bf.jsx)("button",{type:"button",onClick:()=>{return e=t,void l((0,s.A)((0,s.A)({},a),{},{questions:a.questions.filter((t,n)=>n!==e)}));var e},className:"text-red-600 hover:bg-red-50 p-2 rounded",children:(0,Bf.jsx)(rp,{className:"w-4 h-4"})})]},t))})]}),(0,Bf.jsxs)("div",{className:"flex gap-4 pt-6 border-t",children:[(0,Bf.jsxs)("button",{type:"submit",disabled:o,className:"flex-1 flex items-center justify-center gap-2 bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 disabled:opacity-50",children:[(0,Bf.jsx)(P,{className:"w-5 h-5"}),o?"Saving...":"Save Chapter"]}),(0,Bf.jsx)("button",{type:"button",onClick:i,disabled:o,className:"flex-1 border-2 border-gray-300 py-3 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Cancel"})]})]})]})})},lp=e=>{let{scores:t,loading:n,onRefresh:r}=e;const i={};t.forEach(e=>{i[e.playerName]||(i[e.playerName]={name:e.playerName,uid:e.uid,attempts:[],totalScore:0,chaptersCompleted:new Set}),i[e.playerName].attempts.push(e),i[e.playerName].totalScore+=e.score,i[e.playerName].chaptersCompleted.add(e.chapterTitle)});const o=Object.values(i).map(e=>(0,s.A)((0,s.A)({},e),{},{chaptersCompleted:e.chaptersCompleted.size,avgScore:Math.round(e.totalScore/e.attempts.length),totalAttempts:e.attempts.length})).sort((e,t)=>t.totalScore-e.totalScore);return(0,Bf.jsxs)("div",{children:[(0,Bf.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Bf.jsx)("div",{children:(0,Bf.jsxs)("p",{className:"text-gray-600",children:["Total Students: ",(0,Bf.jsx)("span",{className:"font-bold",children:o.length})," | Total Submissions: ",(0,Bf.jsx)("span",{className:"font-bold",children:t.length})]})}),(0,Bf.jsx)("button",{onClick:r,disabled:n,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:n?"Loading...":"Refresh"})]}),0===o.length?(0,Bf.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,Bf.jsx)(Zf.A,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),(0,Bf.jsx)("p",{className:"text-lg",children:"No student data yet."}),(0,Bf.jsx)("p",{className:"text-sm",children:"Scores will appear here once students submit ranked attempts."})]}):(0,Bf.jsx)("div",{className:"space-y-4",children:o.map((e,t)=>(0,Bf.jsxs)("div",{className:"border-2 border-gray-200 rounded-lg p-4 hover:border-purple-300 transition-colors",children:[(0,Bf.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Bf.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Bf.jsxs)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center font-bold text-white ".concat(0===t?"bg-yellow-500":1===t?"bg-gray-400":2===t?"bg-orange-600":"bg-purple-600"),children:["#",t+1]}),(0,Bf.jsxs)("div",{children:[(0,Bf.jsx)("h3",{className:"text-lg font-bold",children:e.name}),(0,Bf.jsxs)("p",{className:"text-xs text-gray-500",children:["UID: ",e.uid.substring(0,8),"..."]})]})]}),(0,Bf.jsxs)("div",{className:"text-right",children:[(0,Bf.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:e.totalScore}),(0,Bf.jsx)("div",{className:"text-xs text-gray-500",children:"Total Points"})]})]}),(0,Bf.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,Bf.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3",children:[(0,Bf.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:e.chaptersCompleted}),(0,Bf.jsx)("div",{className:"text-xs text-gray-600",children:"Chapters"})]}),(0,Bf.jsxs)("div",{className:"bg-green-50 rounded-lg p-3",children:[(0,Bf.jsx)("div",{className:"text-2xl font-bold text-green-600",children:e.avgScore}),(0,Bf.jsx)("div",{className:"text-xs text-gray-600",children:"Avg Score"})]}),(0,Bf.jsxs)("div",{className:"bg-purple-50 rounded-lg p-3",children:[(0,Bf.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:e.totalAttempts}),(0,Bf.jsx)("div",{className:"text-xs text-gray-600",children:"Attempts"})]})]}),(0,Bf.jsxs)("details",{className:"mt-3",children:[(0,Bf.jsxs)("summary",{className:"cursor-pointer text-sm text-gray-600 hover:text-gray-800 font-semibold",children:["View Attempts (",e.attempts.length,")"]}),(0,Bf.jsx)("div",{className:"mt-2 space-y-2",children:e.attempts.map((e,t)=>{var n;return(0,Bf.jsxs)("div",{className:"flex justify-between items-center text-sm bg-gray-50 p-2 rounded",children:[(0,Bf.jsx)("span",{className:"font-medium",children:e.chapterTitle}),(0,Bf.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Bf.jsxs)("span",{className:"text-purple-600 font-bold",children:[e.score," pts"]}),(0,Bf.jsx)("span",{className:"text-gray-500 text-xs",children:null!==(n=e.timestamp)&&void 0!==n&&n.toDate?e.timestamp.toDate().toLocaleString():"N/A"})]})]},t)})})]})]},e.uid))})]})},cp=e=>{let{analyticsData:t,loading:n,onRefresh:r}=e;const i={};t.forEach(e=>{const t=e.questionId;if(!t)return;i[t]||(i[t]={questionId:t,chapter:e.chapterTitle||"Unknown",totalAttempts:0,correctAttempts:0,incorrectAttempts:0,avgTimeSpent:0,timeData:[],rationaleCorrect:0,rationaleIncorrect:0,incorrectOptions:{}});const n=i[t];n.totalAttempts++,e.isCorrect?n.correctAttempts++:n.incorrectAttempts++,e.timeSpent&&n.timeData.push(e.timeSpent),"correct"===e.rationaleTier?n.rationaleCorrect++:"incorrect"!==e.rationaleTier&&"weak"!==e.rationaleTier||n.rationaleIncorrect++}),Object.values(i).forEach(e=>{e.percentCorrect=Math.round(e.correctAttempts/e.totalAttempts*100),e.avgTimeSpent=e.timeData.length>0?Math.round(e.timeData.reduce((e,t)=>e+t,0)/e.timeData.length):0,e.percentCorrect>90?e.flag="Too Easy":e.percentCorrect<40?e.flag="Too Hard":e.flag="Good"});const s=Object.values(i).sort((e,t)=>e.percentCorrect-t.percentCorrect);return n?(0,Bf.jsx)("div",{className:"text-center py-12 text-gray-500",children:"Loading analytics..."}):0===t.length?(0,Bf.jsxs)("div",{className:"text-center py-12",children:[(0,Bf.jsx)("p",{className:"text-gray-600 mb-4",children:"No question analytics available yet."}),(0,Bf.jsx)("p",{className:"text-sm text-gray-500",children:"Analytics are collected when students answer questions in ranked mode."})]}):(0,Bf.jsxs)("div",{children:[(0,Bf.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Bf.jsxs)("div",{children:[(0,Bf.jsx)("h3",{className:"text-xl font-bold",children:"Item Analysis Dashboard"}),(0,Bf.jsx)("p",{className:"text-sm text-gray-600",children:"Question performance metrics across all students"})]}),(0,Bf.jsx)("button",{onClick:r,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm",children:"Refresh Data"})]}),(0,Bf.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,Bf.jsxs)("div",{className:"bg-blue-50 rounded-xl p-4",children:[(0,Bf.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:s.length}),(0,Bf.jsx)("div",{className:"text-sm text-gray-600",children:"Questions Analyzed"})]}),(0,Bf.jsxs)("div",{className:"bg-green-50 rounded-xl p-4",children:[(0,Bf.jsx)("div",{className:"text-3xl font-bold text-green-600",children:s.filter(e=>"Good"===e.flag).length}),(0,Bf.jsx)("div",{className:"text-sm text-gray-600",children:"Good Difficulty"})]}),(0,Bf.jsxs)("div",{className:"bg-red-50 rounded-xl p-4",children:[(0,Bf.jsx)("div",{className:"text-3xl font-bold text-red-600",children:s.filter(e=>"Too Easy"===e.flag||"Too Hard"===e.flag).length}),(0,Bf.jsx)("div",{className:"text-sm text-gray-600",children:"Need Review"})]})]}),(0,Bf.jsx)("div",{className:"overflow-x-auto",children:(0,Bf.jsxs)("table",{className:"w-full border-collapse",children:[(0,Bf.jsx)("thead",{children:(0,Bf.jsxs)("tr",{className:"bg-gray-100",children:[(0,Bf.jsx)("th",{className:"p-3 text-left text-sm font-bold",children:"Question ID"}),(0,Bf.jsx)("th",{className:"p-3 text-left text-sm font-bold",children:"Chapter"}),(0,Bf.jsx)("th",{className:"p-3 text-center text-sm font-bold",children:"Attempts"}),(0,Bf.jsx)("th",{className:"p-3 text-center text-sm font-bold",children:"% Correct"}),(0,Bf.jsx)("th",{className:"p-3 text-center text-sm font-bold",children:"Avg Time"}),(0,Bf.jsx)("th",{className:"p-3 text-center text-sm font-bold",children:"Rationale Acc"}),(0,Bf.jsx)("th",{className:"p-3 text-center text-sm font-bold",children:"Flag"})]})}),(0,Bf.jsx)("tbody",{children:s.map(e=>{const t=e.rationaleCorrect+e.rationaleIncorrect>0?Math.round(e.rationaleCorrect/(e.rationaleCorrect+e.rationaleIncorrect)*100):null;return(0,Bf.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,Bf.jsx)("td",{className:"p-3 text-sm font-mono",children:e.questionId}),(0,Bf.jsx)("td",{className:"p-3 text-sm",children:e.chapter}),(0,Bf.jsx)("td",{className:"p-3 text-center text-sm",children:e.totalAttempts}),(0,Bf.jsx)("td",{className:"p-3 text-center",children:(0,Bf.jsxs)("span",{className:"px-2 py-1 rounded font-bold text-sm ".concat(e.percentCorrect>=70?"bg-green-100 text-green-700":e.percentCorrect>=50?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:[e.percentCorrect,"%"]})}),(0,Bf.jsxs)("td",{className:"p-3 text-center text-sm",children:[e.avgTimeSpent,"s"]}),(0,Bf.jsx)("td",{className:"p-3 text-center text-sm",children:null!==t?"".concat(t,"%"):"N/A"}),(0,Bf.jsx)("td",{className:"p-3 text-center",children:(0,Bf.jsx)("span",{className:"px-2 py-1 rounded text-xs font-bold ".concat("Good"===e.flag?"bg-blue-100 text-blue-700":"Too Easy"===e.flag?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:e.flag})})]},e.questionId)})})]})}),(0,Bf.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-xl",children:[(0,Bf.jsx)("h4",{className:"font-bold text-blue-900 mb-2",children:"Recommendations:"}),(0,Bf.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,Bf.jsxs)("li",{children:["\u2022 ",(0,Bf.jsxs)("strong",{children:["Too Easy (",">","90%):"]})," Consider adding distractors or increasing complexity"]}),(0,Bf.jsxs)("li",{children:["\u2022 ",(0,Bf.jsxs)("strong",{children:["Too Hard (","<","40%):"]})," Review question clarity and review concept with students"]}),(0,Bf.jsxs)("li",{children:["\u2022 ",(0,Bf.jsx)("strong",{children:"Good (40-90%):"})," These questions effectively assess understanding"]}),(0,Bf.jsxs)("li",{children:["\u2022 ",(0,Bf.jsx)("strong",{children:"Low Rationale Accuracy:"})," Question may have confusing reasoning options"]})]})]})]})},up=e=>{let{onExit:t}=e;const[n,i]=(0,r.useState)(!1),[o,a]=(0,r.useState)(""),[l,c]=(0,r.useState)([]),[u,d]=(0,r.useState)(null),[h,f]=(0,r.useState)(!1),[p,m]=(0,r.useState)("chapters"),[g,y]=(0,r.useState)([]),[b,x]=(0,r.useState)([]),[w,I]=(0,r.useState)([]);(0,r.useEffect)(()=>{n&&(T(),S(),N(),E())},[n]);const E=async()=>{if(Lf)try{const e=$c(hc(Lf,"artifacts","rn-mastery-game","public","data","analytics"),nu("timestamp","desc")),t=await mu(e),n=[];t.forEach(e=>{n.push((0,s.A)({id:e.id},e.data()))}),I(n)}catch(e){console.error("Error loading analytics:",e)}},N=async()=>{if(Lf)try{const e=$c(hc(Lf,"artifacts","rn-mastery-game","public","data","scores"),nu("timestamp","desc")),t=await mu(e),n=[];t.forEach(e=>{n.push((0,s.A)({id:e.id},e.data()))}),x(n)}catch(e){console.error("Error loading student scores:",e)}},S=async()=>{if(Lf)try{const e=(await mu(hc(Lf,"settings"))).docs.find(e=>"chapterAccess"===e.id);e&&y(e.data().unlocked||[])}catch(e){console.error("Error loading locks:",e)}},T=async()=>{try{if(f(!0),!Lf)return console.error("Firebase not initialized"),void c([]);const e=await mu(hc(Lf,"customChapters")),t=[];e.forEach(e=>{t.push((0,s.A)({id:e.id},e.data()))}),c(t)}catch(e){console.error("Error loading chapters:",e),c([])}finally{f(!1)}},_=e=>{e.preventDefault(),"nursing2024"===o?i(!0):alert("Incorrect password")},C=async e=>{try{if(f(!0),e.id){const t=fc(Lf,"customChapters",e.id);await function(e,t,n){e=ic(e,uc);const r=ic(e.firestore,gc),i=Ac(r);let s;for(var o=arguments.length,a=new Array(o>3?o-3:0),l=3;l<o;l++)a[l-3]=arguments[l];return s="string"==typeof(t=se(t))||t instanceof xc?Mc(i,"updateDoc",e._key,t,n,a):Lc(i,"updateDoc",e._key,t),yu(r,[s.toMutation(e._key,ns.exists(!0))])}(t,e),alert("Chapter updated!")}else await gu(hc(Lf,"customChapters"),e),alert("Chapter added!");await T(),d(null)}catch(t){console.error("Error saving chapter:",t),alert("Error saving chapter: "+t.message)}finally{f(!1)}},k=async e=>{var t;if(window.confirm("Delete this chapter? This cannot be undone."))try{f(!0),await(t=fc(Lf,"customChapters",e),yu(ic(t.firestore,gc),[new ms(t._key,ns.none())])),alert("Chapter deleted!"),await T()}catch(n){console.error("Error deleting chapter:",n),alert("Error deleting chapter: "+n.message)}finally{f(!1)}};return n?null!==u?(0,Bf.jsx)(ap,{chapter:u,onSave:C,onCancel:()=>d(null),loading:h}):(0,Bf.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-4",children:(0,Bf.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,Bf.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl p-8",children:[(0,Bf.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Bf.jsx)("h2",{className:"text-3xl font-bold",children:"Instructor Mode"}),(0,Bf.jsxs)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2 border-2 border-gray-300 rounded-lg hover:bg-gray-50",children:[(0,Bf.jsx)(Xf,{className:"w-4 h-4"}),"Exit"]})]}),(0,Bf.jsxs)("div",{className:"flex gap-2 mb-6 border-b",children:[(0,Bf.jsx)("button",{onClick:()=>m("chapters"),className:"px-6 py-3 font-semibold transition-colors ".concat("chapters"===p?"text-purple-600 border-b-2 border-purple-600":"text-gray-500 hover:text-gray-700"),children:"Chapter Management"}),(0,Bf.jsxs)("button",{onClick:()=>m("itemAnalysis"),className:"px-6 py-3 font-semibold transition-colors ".concat("itemAnalysis"===p?"text-purple-600 border-b-2 border-purple-600":"text-gray-500 hover:text-gray-700"),children:[(0,Bf.jsx)($f,{className:"w-4 h-4 inline mr-2"}),"Item Analysis"]}),(0,Bf.jsxs)("button",{onClick:()=>m("locks"),className:"px-6 py-3 font-semibold transition-colors ".concat("locks"===p?"text-purple-600 border-b-2 border-purple-600":"text-gray-500 hover:text-gray-700"),children:[(0,Bf.jsx)(v,{className:"w-4 h-4 inline mr-2"}),"Chapter Locks"]}),(0,Bf.jsxs)("button",{onClick:()=>m("analytics"),className:"px-6 py-3 font-semibold transition-colors ".concat("analytics"===p?"text-purple-600 border-b-2 border-purple-600":"text-gray-500 hover:text-gray-700"),children:[(0,Bf.jsx)(Zf.A,{className:"w-4 h-4 inline mr-2"}),"Student Analytics"]})]}),"chapters"===p&&(0,Bf.jsxs)(Bf.Fragment,{children:[(0,Bf.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,Bf.jsxs)("button",{onClick:()=>d({}),className:"flex items-center gap-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,Bf.jsx)(ep,{className:"w-5 h-5"}),"Add New Chapter"]}),(0,Bf.jsxs)("button",{onClick:()=>{const e=JSON.stringify(l,null,2),t=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="chapters-backup-".concat(Date.now(),".json"),r.click()},className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,Bf.jsx)(R,{className:"w-5 h-5"}),"Export All"]}),(0,Bf.jsxs)("label",{className:"flex items-center gap-2 px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 cursor-pointer",children:[(0,Bf.jsx)(tp,{className:"w-5 h-5"}),"Import",(0,Bf.jsx)("input",{type:"file",accept:".json",onChange:e=>{const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=async e=>{try{const t=JSON.parse(e.target.result);if(!Array.isArray(t))return void alert("Invalid format. Expected an array of chapters.");f(!0);for(const e of t){const{id:t}=e,n=(0,Jf.A)(e,sp);await gu(hc(Lf,"customChapters"),n)}alert("Imported ".concat(t.length," chapters!")),await T()}catch(t){console.error("Error importing:",t),alert("Error importing chapters: "+t.message)}finally{f(!1)}},n.readAsText(t)},className:"hidden"})]})]}),h&&(0,Bf.jsxs)("div",{className:"text-center py-8",children:[(0,Bf.jsx)("div",{className:"animate-spin w-12 h-12 border-4 border-purple-600 border-t-transparent rounded-full mx-auto"}),(0,Bf.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]}),!h&&0===l.length&&(0,Bf.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,Bf.jsx)("p",{className:"text-lg",children:"No custom chapters yet."}),(0,Bf.jsx)("p",{className:"text-sm",children:'Click "Add New Chapter" to get started.'})]}),!h&&l.length>0&&(0,Bf.jsx)("div",{className:"grid gap-4",children:l.map(e=>{var t;return(0,Bf.jsx)("div",{className:"border-2 border-gray-200 rounded-lg p-4 hover:border-purple-300 transition-colors",children:(0,Bf.jsxs)("div",{className:"flex items-start justify-between",children:[(0,Bf.jsxs)("div",{className:"flex-1",children:[(0,Bf.jsx)("h3",{className:"text-xl font-bold mb-2",children:e.title}),(0,Bf.jsx)("p",{className:"text-gray-600 mb-2",children:e.description}),(0,Bf.jsxs)("div",{className:"flex gap-4 text-sm text-gray-500",children:[(0,Bf.jsxs)("span",{children:["ID: ",e.chapterId]}),(0,Bf.jsxs)("span",{children:[(null===(t=e.questions)||void 0===t?void 0:t.length)||0," questions"]})]})]}),(0,Bf.jsxs)("div",{className:"flex gap-2",children:[(0,Bf.jsx)("button",{onClick:()=>d(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",children:(0,Bf.jsx)(np,{className:"w-5 h-5"})}),(0,Bf.jsx)("button",{onClick:()=>k(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:(0,Bf.jsx)(rp,{className:"w-5 h-5"})})]})]})},e.id)})})]}),"locks"===p&&(0,Bf.jsx)(op,{unlockedChapters:g,onToggleLock:async e=>{try{f(!0);const t=g.includes(e)?g.filter(t=>t!==e):[...g,e];await function(e,t,n){e=ic(e,uc);const r=ic(e.firestore,gc),i=lu(e.converter,t,n);return yu(r,[Rc(Ac(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,ns.none())])}(fc(Lf,"settings","chapterAccess"),{unlocked:t}),y(t)}catch(t){console.error("Error toggling lock:",t),alert("Error updating chapter lock: "+t.message)}finally{f(!1)}},loading:h}),"itemAnalysis"===p&&(0,Bf.jsx)(cp,{analyticsData:w,loading:h,onRefresh:E}),"analytics"===p&&(0,Bf.jsx)(lp,{scores:b,loading:h,onRefresh:N})]})})}):(0,Bf.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4",children:(0,Bf.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl p-8 w-full max-w-md",children:[(0,Bf.jsx)("div",{className:"flex items-center justify-center mb-6",children:(0,Bf.jsx)(v,{className:"w-12 h-12 text-purple-600"})}),(0,Bf.jsx)("h2",{className:"text-2xl font-bold text-center mb-6",children:"Instructor Mode"}),(0,Bf.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,Bf.jsxs)("div",{children:[(0,Bf.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,Bf.jsx)("input",{type:"password",value:o,onChange:e=>a(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Enter instructor password"})]}),(0,Bf.jsx)("button",{type:"submit",className:"w-full bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 transition-colors font-semibold",children:"Login"}),(0,Bf.jsx)("button",{type:"button",onClick:t,className:"w-full border-2 border-gray-300 text-gray-700 py-3 rounded-lg hover:bg-gray-50 transition-colors font-semibold",children:"Back to Game"})]})]})})},dp=(0,f.A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),hp=(0,f.A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),fp=(0,f.A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);function pp(e){var t;let{gameState:n,onJudge:i,onReveal:s}=e;const[a,l]=(0,r.useState)(null),[c,u]=(0,r.useState)("");if(!n)return null;const{phase:d,currentScenario:h,teams:f,submissions:p,challenges:m,judgeDecision:g}=n;if("JUDGE"!==d)return null;const v=function(e){i({type:e,challengerTeamId:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,targetTeamId:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,note:c}),u("")};return(0,Bf.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-6",children:(0,Bf.jsxs)("div",{className:"bg-slate-900 border-2 border-purple-500 rounded-2xl max-w-5xl w-full max-h-[90vh] overflow-y-auto",children:[(0,Bf.jsxs)("div",{className:"bg-purple-900/30 border-b border-purple-500 p-6",children:[(0,Bf.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,Bf.jsx)(o.A,{className:"w-8 h-8 text-purple-400"}),(0,Bf.jsx)("h2",{className:"text-3xl font-black text-white",children:"Judge Panel"})]}),(0,Bf.jsx)("p",{className:"text-slate-300",children:"Review submissions and challenges to make your judgment"})]}),(0,Bf.jsxs)("div",{className:"p-6 space-y-6",children:[(0,Bf.jsxs)("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:[(0,Bf.jsx)("h3",{className:"text-xl font-bold text-white mb-3",children:"Current Question"}),(0,Bf.jsx)("div",{className:"text-slate-300 mb-4",children:null===h||void 0===h?void 0:h.prompt}),(0,Bf.jsx)("div",{className:"grid gap-2",children:null===h||void 0===h||null===(t=h.choices)||void 0===t?void 0:t.map((e,t)=>(0,Bf.jsxs)("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-3 text-sm text-slate-200",children:[(0,Bf.jsxs)("span",{className:"font-bold text-cyan-400",children:["Option ",t+1,":"]})," ",e]},t))})]}),(0,Bf.jsxs)("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:[(0,Bf.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Team Submissions"}),(0,Bf.jsx)("div",{className:"grid md:grid-cols-2 gap-4",children:f.map(e=>{const t=p[e.id];return(0,Bf.jsxs)("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4",children:[(0,Bf.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Bf.jsx)("span",{className:"font-bold text-white",children:e.name}),(0,Bf.jsxs)("span",{className:"text-sm text-slate-400",children:["Score: ",e.score]})]}),t?(0,Bf.jsxs)("div",{className:"bg-cyan-500/20 border border-cyan-500 rounded-lg p-2 text-cyan-300 text-sm",children:["Submitted: Option ",t.choiceIndex+1]}):(0,Bf.jsx)("div",{className:"text-slate-500 text-sm italic",children:"No submission"})]},e.id)})})]}),m.length>0?(0,Bf.jsxs)("div",{className:"bg-slate-800 border border-red-500 rounded-xl p-6",children:[(0,Bf.jsxs)("h3",{className:"text-xl font-bold text-red-400 mb-4 flex items-center gap-2",children:[(0,Bf.jsx)(dp,{className:"w-6 h-6"}),"Challenges Submitted (",m.length,")"]}),(0,Bf.jsx)("div",{className:"space-y-4",children:m.map((e,t)=>{const n=f.find(t=>t.id===e.challengerTeamId),r=f.find(t=>t.id===e.targetTeamId),i=a===t;return(0,Bf.jsxs)("div",{className:"border-2 rounded-xl p-4 cursor-pointer transition-all ".concat(i?"border-yellow-500 bg-yellow-500/10":"border-slate-600 bg-slate-700/50 hover:border-slate-500"),onClick:()=>l(i?null:t),children:[(0,Bf.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Bf.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Bf.jsx)("span",{className:"font-bold text-orange-400",children:null===n||void 0===n?void 0:n.name}),(0,Bf.jsx)("span",{className:"text-slate-400",children:"\u2192 challenges \u2192"}),(0,Bf.jsx)("span",{className:"font-bold text-purple-400",children:null===r||void 0===r?void 0:r.name})]}),i&&(0,Bf.jsx)(hp,{className:"w-5 h-5 text-yellow-400"})]}),(0,Bf.jsxs)("div",{className:"bg-slate-800 rounded-lg p-3 mb-2",children:[(0,Bf.jsx)("div",{className:"text-xs text-slate-400 mb-1",children:"Trap Explanation:"}),(0,Bf.jsx)("div",{className:"text-slate-200 text-sm",children:e.trapText})]}),(0,Bf.jsxs)("div",{className:"text-sm text-cyan-400",children:["Alternative Proposed: Option ",e.alternativeIndex+1]}),i&&(0,Bf.jsxs)("div",{className:"mt-4 pt-4 border-t border-slate-600 flex gap-3",children:[(0,Bf.jsxs)("button",{onClick:t=>{t.stopPropagation(),v("CHALLENGE_SUCCESS",e.challengerTeamId,e.targetTeamId)},className:"flex-1 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg font-bold transition flex items-center justify-center gap-2",children:[(0,Bf.jsx)(y,{className:"w-5 h-5"}),"Accept Challenge"]}),(0,Bf.jsxs)("button",{onClick:t=>{t.stopPropagation(),v("CHALLENGE_FAIL",e.challengerTeamId,e.targetTeamId)},className:"flex-1 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg font-bold transition flex items-center justify-center gap-2",children:[(0,Bf.jsx)(E,{className:"w-5 h-5"}),"Reject Challenge"]})]})]},t)})})]}):(0,Bf.jsx)("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6 text-center",children:(0,Bf.jsx)("p",{className:"text-slate-400",children:"No challenges submitted"})}),(0,Bf.jsxs)("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:[(0,Bf.jsx)("h3",{className:"text-lg font-bold text-white mb-3",children:"Judge Notes (Optional)"}),(0,Bf.jsx)("textarea",{value:c,onChange:e=>u(e.target.value),placeholder:"Add notes about your decision...",className:"w-full h-24 px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-purple-500 resize-none"})]}),g&&(0,Bf.jsxs)("div",{className:"bg-green-900/30 border-2 border-green-500 rounded-xl p-6",children:[(0,Bf.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,Bf.jsx)(y,{className:"w-6 h-6 text-green-400"}),(0,Bf.jsx)("h3",{className:"text-xl font-bold text-green-400",children:"Judgment Recorded"})]}),(0,Bf.jsxs)("div",{className:"text-slate-200",children:[(0,Bf.jsxs)("div",{className:"mb-2",children:[(0,Bf.jsx)("span",{className:"font-bold",children:"Decision:"})," ",g.type.replace(/_/g," ")]}),g.note&&(0,Bf.jsxs)("div",{className:"bg-slate-800 rounded-lg p-3 mt-2",children:[(0,Bf.jsx)("div",{className:"text-xs text-slate-400 mb-1",children:"Notes:"}),(0,Bf.jsx)("div",{className:"text-sm",children:g.note})]})]})]}),(0,Bf.jsx)("div",{className:"flex gap-4",children:g?(0,Bf.jsxs)("button",{onClick:s,className:"flex-1 py-4 bg-purple-600 hover:bg-purple-500 text-white rounded-xl font-bold transition flex items-center justify-center gap-2 animate-pulse",children:[(0,Bf.jsx)(fp,{className:"w-6 h-6"}),"Reveal Answer & Score Round"]}):(0,Bf.jsx)("button",{onClick:()=>v("NO_CHALLENGE"),className:"flex-1 py-4 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-bold transition",children:"No Valid Challenges - Proceed to Score"})})]})]})})}function mp(e){const{text:t,options:n,correctIndex:r,rationale:i,concept:o,skill:a,bloom:l}=e,c=Math.random()<.2,u=c?function(e){const{concept:t,skill:n,correctIndex:r,options:i}=e;return["This addresses the most immediate physiological need based on nursing priorities (ABCs - Airway, Breathing, Circulation). While other options are appropriate, they can be delayed until the patient is stabilized.","This intervention is important for ongoing care, but does not address the most urgent need. Patient safety and physiological stability take precedence over this action.","While this is clinically appropriate and should be completed, it represents a secondary priority. The immediate threat to patient well-being must be addressed first.","This action is part of comprehensive nursing care but can be safely delayed. The highest priority intervention focuses on preventing immediate complications or harm."]}(e):function(e){const{concept:t,skill:n,bloom:r,correctIndex:i,options:s}=e;s[i];return[vp(e),bp(e),"This option addresses a different priority in ".concat(t||"care"),"While related to ".concat((null===n||void 0===n?void 0:n[0])||"the concept",", this doesn't address the immediate need")]}(e),d=c?function(e,t){const n=["A patient with ".concat(t||"this condition"," requires multiple interventions. Which action should the nurse complete first?"),"The nurse is caring for a patient with ".concat(t||"this condition",". All of the following are appropriate, but which is the highest priority?"),"When caring for a patient with ".concat(t||"this condition",", the nurse recognizes several needs. Which intervention is most important initially?"),"A patient presents with ".concat(t||"this condition",". The nurse plans care. Which action should take priority?")];return n[Math.floor(Math.random()*n.length)]}(0,o):function(e,t,n){if(e.includes("nurse")&&(e.includes("patient")||e.includes("client")))return gp(e);return function(e,t,n){if(null!==n&&void 0!==n&&n.includes("TEACHING_ERROR")||e.toLowerCase().includes("teaching")||e.toLowerCase().includes("indicates the need for further"))return function(e,t){const n=["A patient with ".concat(t||"this condition"," makes the following statement. Which indicates a misunderstanding that could lead to complications?"),"During discharge teaching for ".concat(t||"this condition",", which patient statement requires immediate intervention to prevent adverse outcomes?"),"The nurse is evaluating understanding of ".concat(t||"this condition",". Which statement suggests the patient is at risk for poor outcomes?")];return n[Math.floor(Math.random()*n.length)]}(0,t);if(e.toLowerCase().includes("correlates")||e.toLowerCase().includes("function of"))return function(e,t){const n=["A patient presents with abnormal ".concat(t||"findings",". The nurse anticipates which clinical manifestation will require priority intervention?"),"During assessment of ".concat(t||"this system",", which finding indicates the most urgent need for intervention?"),"The nurse notes changes in ".concat(t||"function",". Which assessment finding suggests immediate risk to the patient?")];return n[Math.floor(Math.random()*n.length)]}(0,t);if(e.toLowerCase().includes("which type")||e.toLowerCase().includes("which is"))return function(e,t){const n=["A patient shows signs consistent with ".concat(t||"this process",". Which assessment finding requires the nurse to act first?"),"In a patient experiencing ".concat(t||"this condition",", which finding indicates the highest priority for immediate intervention?"),"The nurse is caring for multiple patients. Which assessment finding related to ".concat(t||"this system"," requires immediate attention?")];return n[Math.floor(Math.random()*n.length)]}(0,t);if(null!==n&&void 0!==n&&n.includes("PRIORITY")||e.toLowerCase().includes("most appropriate"))return function(e,t){const n=["To prevent complications in a patient with ".concat(t||"this condition",", the nurse's priority action is:"),"A patient with ".concat(t||"this condition"," is at risk for deterioration. Which intervention should the nurse implement first?"),"The nurse identifies early signs of ".concat(t||"complications",". Which action will prevent further decline?")];return n[Math.floor(Math.random()*n.length)]}(0,t);if(null!==n&&void 0!==n&&n.includes("LAB_INTERPRETATION")||e.toLowerCase().includes("lab")||e.toLowerCase().includes("test"))return function(e,t){const n=["A patient's lab results show abnormalities related to ".concat(t||"this system",". Which finding requires immediate notification of the provider?"),"During review of diagnostic tests for ".concat(t||"this condition",", which result indicates the need for urgent intervention?"),"The nurse receives critical lab values related to ".concat(t||"function",". Which finding poses the greatest immediate threat?")];return n[Math.floor(Math.random()*n.length)]}(0,t);return gp("In caring for a patient with ".concat(t||"this condition",", ").concat(e.charAt(0).toLowerCase()).concat(e.slice(1)))}(e,t,n)}(t,o,a),h=c?function(e,t,n){return e.map((e,r)=>{if(r===t)return yp(e,"immediate",n);return yp(e,r%3===0?"urgent":r%3===1?"important":"routine",n)})}(n,r,o):function(e){const t=Math.floor(3*Math.random());if(0===t)return e.map(e=>function(e){if(e.length>60||e.includes("BP")||e.includes("within"))return e;const t=[" within the next 5 minutes"," immediately to prevent deterioration"," while monitoring vital signs"," before condition worsens"," as first priority"];if(Math.random()>.5)return e+t[Math.floor(Math.random()*t.length)];return e}(e));if(1===t)return e.map(e=>function(e){if(e.length>60)return e;const t=["considering patient history","noting recent lab changes","observing current symptoms","based on assessment findings"];if(Math.random()>.6){const n=t[Math.floor(Math.random()*t.length)];return"".concat(e," - ").concat(n)}return e}(e));return e.map(e=>function(e){if(e.length>60)return e;const t=["to prevent complications","to stabilize condition","to ensure safety","to reduce risk"];if(Math.random()>.7)return"".concat(e," ").concat(t[Math.floor(Math.random()*t.length)]);return e}(e))}(n),{newOptions:f,newCorrectIndex:p}=function(e,t){e[t];const n=e.map((e,t)=>t);for(let s=n.length-1;s>0;s--){const e=Math.floor(Math.random()*(s+1));[n[s],n[e]]=[n[e],n[s]]}const r=n.map(t=>e[t]),i=n.indexOf(t);return{newOptions:r,newCorrectIndex:i}}(h,r);return(0,s.A)((0,s.A)({},e),{},{originalText:t,text:d,options:f,correctIndex:p,rationaleOptions:u,requiresRationale:!0,correctRationaleIndex:0,timeLimit:30,isTransformed:!0,isPriorityQuestion:c})}function gp(e){const t=["PRIORITY: ","The nurse must first: ","The most important action is: ","To prevent complications, the nurse should: "];return t[Math.floor(Math.random()*t.length)]+e.charAt(0).toLowerCase()+e.slice(1)}function yp(e,t,n){let r=e.replace(/\b(always|never|must|only|all)\b/gi,"").replace(/\s{2,}/g," ").trim();const i={immediate:[r,"".concat(r," to stabilize condition"),"".concat(r," as priority intervention")],urgent:["".concat(r," after initial assessment"),"".concat(r," following stabilization"),"".concat(r," once safety is ensured")],important:["".concat(r," when condition permits"),"".concat(r," during ongoing care"),"".concat(r," as part of comprehensive plan")],routine:["".concat(r," before discharge"),"".concat(r," during follow-up care"),"".concat(r," when time allows")]},s=i[t]||i.important;return s[Math.floor(Math.random()*s.length)]}function vp(e){const{concept:t,skill:n,bloom:r,rationale:i}=e;if(i&&i.trim()){const e=i.split(".").map(e=>e.trim()).filter(e=>e.length>0);if(e.length>0)return e[0]+"."}return null!==n&&void 0!==n&&n.includes("PRIORITY")?"This addresses the most critical need based on ".concat(t||"nursing priorities","."):"APPLICATION"===r||"CLINICAL_JUDGMENT"===r?"This option requires analyzing the situation and applying clinical judgment based on ".concat(t||"the scenario","."):t?"This is the correct action based on evidence-based practice for ".concat(t,"."):"This option demonstrates proper clinical judgment and evidence-based practice."}function bp(e){const{concept:t,skill:n,rationale:r}=e;if(r&&r.trim()){const e=r.split(".").map(e=>e.trim()).filter(e=>e.length>0);if(e.length>1)return e[1]+"."}const i=["This option is mentioned in the textbook about ".concat(t||"this topic","."),"This is commonly recommended for ".concat(t||"this condition","."),"This intervention is part of standard nursing care.","This action appears in the care guidelines."];return i[Math.floor(Math.random()*i.length)]}function xp(e){if(e.length<5)return!1;if(e.every(t=>t===e[0]))return!0;let t=!0;for(let r=1;r<e.length;r++)if(e[r]===e[r-1]){t=!1;break}if(t)return!0;let n=!0;for(let r=1;r<e.length;r++)if((e[r]-e[r-1]+4)%4!==1){n=!1;break}return n}const wp={id:"day-to-be-wrong",title:"\u2696\ufe0f A Day to be Wrong",icon:"\u2696\ufe0f",description:"Every answer is wrong. Pick the least dangerous risk.",questions:[{id:"ld_q01_mdro_moral_injury",text:"\ud83e\ude78 COMPETING PRIORITIES: You are charge nurse. ONE negative-pressure room. THREE patients arrive. You must answer: (1) Where do you go FIRST? (2) What gets worse because of it?",scenario:'**Patient A:** "Feeling off" \u2022 Recent antibiotic \u2022 Some GI symptoms\n\n**Patient B:** ICU transfer \u2022 "Fever" \u2022 History of resistant infection\n\n**Patient C:** Known colonization \u2022 Wound actively draining \u2022 Roommate with "low immunity"\n\n\u26a0\ufe0f NO FULL LABS \u2022 NO VITALS \u2022 NO DIAGNOSIS CONFIRMATION',options:["Patient A","Patient B","Patient C","Try to share the room between patients"],correctIndex:2,timeLimit:45,requiresConsequence:!0,hardMode:!0,evolutionTrigger:!0,penalties:{wrong:-15,delayed:-5,secondaryHarm:-10},consequences:{0:"\u26a0\ufe0f **You chose A.** C. diff contained BUT: Immunocompromised patient now colonized with MRSA. Cost: One infection prevented, one created.",1:"\u26a0\ufe0f **You chose B.** CRE monitored BUT: C. diff now spreading. 3 patients in hallway exposed. Cost: Saved one, infected three.",2:"\u2713 **Least dangerous.** Immunocompromised protected BUT: You delayed CRE protocols. Cost: Best choice still has consequences.",3:"\u274c **Unit disaster.** You tried to be fair. Cost: 2 cross-contaminated patients + 3 exposed staff + outbreak investigation."},costOfChoice:{description:"EVERY ANSWER HAS A COST. The game will track what you sacrificed.",trackSacrifices:!0},rationale:"**Best choice: Patient C** (though still not ideal)\n\n**SCORING:**\n\u2713 Correct priority = +10 points\n\u2713 Quick decision (< 30s) = +5 bonus\n\u274c Wrong choice = -15 points + secondary harm penalty\n\u23f1\ufe0f Delayed decision = -5 points\n\n**Why C is least dangerous:**\n- MRSA + draining wound + immunocompromised roommate = HIGH transmission risk\n- Prevents transmission to vulnerable patient\n- Contact precautions can be enforced\n\n**Why the others are worse:**\n\n**Patient A (C. diff):**\n- C. diff needs CONTACT precautions + soap/water, NOT negative pressure\n- Negative pressure is wasted on this patient\n- Can be managed in regular room with proper handwashing\n\n**Patient B (CRE):**\n- CRE is a mortality risk but NOT airborne\n- Contact precautions are sufficient\n- Negative pressure doesn't add protection value\n\n**Patient D (rotation):**\n- Resource allocation based on need, not equality\n- Increases transmission risk by moving infected patients\n- Logistically impossible and clinically unsound\n\n**NCLEX Teaching Point:**\n\"NCLEX doesn't test what's right. It tests whether you can explain why the others are worse.\"\n\n\u26a0\ufe0f **NOTE:** In reality, none of these patients need negative pressure for their conditions. This tests resource allocation under imperfect circumstances.",skill:["CLINICAL_JUDGMENT","PRIORITY","INFECTION_CONTROL"],concept:"RESOURCE_ALLOCATION",bloom:"EVALUATE",difficulty:5,examTip:"Negative-pressure rooms are for AIRBORNE precautions (TB, measles, varicella). None of these patients technically need it, but you must choose who benefits most from isolation."},{id:"ld_q02_hiv_labs_lie",text:"HIV patient presents to clinic with the following data:",scenario:'**CD4:** 240\n**Viral load:** Undetectable\n**Symptoms:** New SOB, dry cough\n**ART adherence:** "Pretty good"',options:["ART failure","PCP pneumonia","Anxiety","Medication side effects"],correctIndex:1,timeLimit:60,hardMode:!0,evolutionTrigger:!0,penalties:{wrong:-20,delayed:-10,secondaryHarm:-15},consequences:{0:"\u274c **Delayed diagnosis!** Viral load rebounds to 50,000 in 2 weeks. Patient was actually adherent.",1:"\u2705 **Life saved.** Started on Bactrim. Chest X-ray confirms PCP. Patient hospitalized but stable.",2:"\u274c **Patient deteriorates.** Dismissed as anxiety. Now in ICU with respiratory failure. PCP diagnosis missed for 48 hours.",3:"\u274c **Critical delay.** Respiratory symptoms worsened. Emergency intubation required. Should have suspected OI first."},rationale:'**Best choice: PCP pneumonia**\n\n**Why PCP is the priority concern:**\n- CD4 count 240 (near the critical 200 threshold for PCP risk)\n- Classic PCP symptoms: SOB + dry cough\n- PCP can develop even with undetectable viral load\n- Life-threatening if not treated immediately\n\n**Why the others are worse:**\n\n**ART failure:**\n- Viral load is UNDETECTABLE - ART is working\n- "Pretty good" adherence is enough to maintain viral suppression\n- Not the immediate concern\n\n**Anxiety:**\n- Dismisses potentially life-threatening symptoms\n- Psychological symptoms don\'t cause SOB and dry cough\n- Dangerous assumption\n\n**Medication side effects:**\n- While possible, respiratory symptoms are NOT common ART side effects\n- Too risky to attribute serious symptoms to medications\n- Must rule out infection first\n\n**NCLEX Teaching Point:**\n"Undetectable doesn\'t mean invincible. CD4 count determines opportunistic infection risk."\n\n**Clinical Pearl:**\n- Viral load = how well ART is working\n- CD4 count = immune system strength and OI risk\n- Symptoms OVERRIDE reassuring labs',skill:["CLINICAL_JUDGMENT","LAB_INTERPRETATION","PRIORITY"],concept:"HIV_COMPLICATIONS",bloom:"ANALYZE",difficulty:5,examTip:"Viral load and CD4 count tell different stories. CD4 < 200 = PCP risk, regardless of viral suppression."},{id:"ld_q03_ranking_priority",text:"\u23f1\ufe0f LEAST WRONG: Needlestick 90min ago. All 4 actions below are correct. Which prevents the MOST irreversible harm FIRST? (Choose highest priority only)",scenario:"**HIV+ Patient Post-Exposure:**\n- Needlestick injury 90 minutes ago\n- Source patient unknown status\n- Employee terrified, no PEP started\n- Window closing\n\n\u26a0\ufe0f CHOOSE ONE - SEQUENCE DETERMINES OUTCOME",options:["Start PEP immediately","Obtain source patient labs first","Provide emotional support","Complete incident documentation"],correctIndex:0,timeLimit:30,hardMode:!0,evolutionTrigger:!0,penalties:{wrong:-25,delayed:-15,secondaryHarm:-20},consequences:{0:"\u2705 **PEP started within window.** COST: Employee still anxious but protected. Could have been gentler.",1:"\u274c **Labs ordered.** COST: PEP delayed 3 hours. Effectiveness dropped from 95% to 70%. Preventable risk.",2:"\u274c **Employee calmed.** COST: PEP delayed 2 hours talking. Now only 50% effective. Feelings > survival?",3:"\u274c **Documentation perfect.** COST: PEP started 4 hours late. Nearly useless now. Great paperwork, poor outcome."},rationale:'**Required actions: HIV test, Hepatitis B screening, Renal function labs, Condom counseling**\n\n**Why each is required or not:**\n\n\u2705 **HIV test** - REQUIRED\n- Must confirm patient is HIV-negative before starting PrEP\n- PrEP is for prevention, not treatment\n- Starting PrEP on HIV+ patient causes resistance\n\n\u2705 **Hepatitis B screening** - REQUIRED\n- Tenofovir (in PrEP) treats HBV\n- Stopping PrEP can cause HBV flare in infected patients\n- Must know HBV status before starting\n\n\u2705 **Renal function labs** - REQUIRED\n- PrEP can cause kidney damage\n- Need baseline creatinine/eGFR\n- Monitor throughout treatment\n\n\u274c **CD4 count** - NOT required\n- CD4 is for monitoring HIV disease progression\n- Patient is HIV-negative (taking PrEP for prevention)\n- This is the trap answer - sounds important but irrelevant\n\n\u2705 **Condom counseling** - REQUIRED\n- PrEP doesn\'t prevent other STIs\n- Patient education on comprehensive prevention\n- Required counseling component\n\n\u274c **ART resistance testing** - NOT required\n- Resistance testing is for HIV+ patients on ART\n- Not relevant for HIV-negative person on PrEP\n- Another trap answer\n\n**NCLEX Teaching Point:**\n"Know what doesn\'t matter. Distinguish prevention vs treatment."\n\n**Student Trap:**\nStudents pick CD4 because it "sounds important" for HIV. This tests understanding of WHEN tests are indicated.',skill:["CLINICAL_JUDGMENT","TEACHING","MED_SAFETY"],concept:"HIV_PREVENTION",bloom:"APPLY",difficulty:5,examTip:"PrEP = Prevention for HIV-negative patients. CD4 count is only for HIV-positive patients. Don't get trapped by 'sounds important' answers."},{id:"ld_q04_priority_flip",text:"You have FOUR patients. Who do you see FIRST?",scenario:"**Patient A:** HIV, CD4 180 \u2022 Missed ART doses \u2022 No symptoms\n\n**Patient B:** HIV, CD4 350 \u2022 Severe headache + photophobia\n\n**Patient C:** HIV, CD4 90 \u2022 Stable, on prophylaxis\n\n**Patient D:** HIV-negative partner asking about PrEP",options:["Patient A","Patient B","Patient C","Patient D"],correctIndex:1,timeLimit:45,consequences:{0:"\u274c **Patient B seizes in hallway!** Focused on labs instead of acute neuro symptoms. Now emergent intubation needed.",1:"\u2705 **Crisis averted.** LP shows cryptococcal meningitis. Amphotericin started. Patient stabilized in ICU.",2:"\u274c **Patient B found unresponsive!** CD4 90 is chronic; acute neuro symptoms were the emergency. Delayed care = poor outcome.",3:"\u274c **Patient B codes!** PrEP education can wait. Severe headache + photophobia = meningitis until proven otherwise."},rationale:'**Best choice: Patient B**\n\n**Why Patient B is the priority:**\n- Severe headache + photophobia = classic signs of meningitis\n- CNS infection is IMMEDIATELY life-threatening\n- CD4 350 is high enough for cryptococcal meningitis or toxoplasmosis\n- Symptoms indicate CURRENT emergency\n\n**Why the others are worse priorities:**\n\n**Patient A (CD4 180, missed doses):**\n- Low CD4 but NO symptoms = not immediate emergency\n- ART adherence counseling is important but not urgent\n- Can wait for acute patient\n\n**Patient C (CD4 90):**\n- Critically low CD4 BUT stable on prophylaxis\n- No acute symptoms described\n- Chronic management, not emergency\n\n**Patient D (PrEP education):**\n- Important preventive care\n- NOT an emergency\n- Can be scheduled/delayed\n\n**NCLEX Teaching Point:**\n"The sickest patient is not always the one with the worst labs."\n\n**Priority Framework:**\n1. **Acute symptoms** > Chronic labs\n2. **Neurological changes** = emergency\n3. **Stability** matters more than numbers\n\n**Classic NCLEX Trap:**\nStudents reflexively choose "lowest CD4" without reading symptoms. This tests clinical judgment over numbers.',skill:["CLINICAL_JUDGMENT","PRIORITY","ASSESSMENT"],concept:"HIV_COMPLICATIONS",bloom:"EVALUATE",difficulty:5,examTip:"Don't get distracted by the 'worst lab value'. Read the SYMPTOMS. Neuro changes = see first."},{id:"ld_q05_needlestick_time",text:"Nurse reports a needle stick 2 hours ago but says: 'I wanted to finish my assignment first.' What is the MOST serious issue now?",options:["Documentation delay - incident wasn't reported immediately","Emotional distress - nurse needs psychological support","Missed PEP window - time-sensitive intervention delayed","Exposure severity - need to determine source patient's status"],correctIndex:2,timeLimit:30,consequences:{0:"\u26a0\ufe0f **Documentation delayed but PEP started.** Better late than never, but golden window narrowing.",1:"\u274c **Emotional support given.** But PEP window continues to close. Now 3+ hours post-exposure. Effectiveness dropping.",2:"\u2705 **PEP initiated immediately.** Started within ideal window despite delay. Source patient testing underway.",3:"\u274c **Waiting for source labs!** PEP not started. Now 4+ hours post-exposure. Critical time wasted."},rationale:'**Best choice: Missed PEP window**\n\n**Why PEP delay is the priority:**\n- PEP (Post-Exposure Prophylaxis) must start within 72 hours (ideally <2 hours)\n- Every hour of delay reduces effectiveness\n- 2-hour delay is already significant\n- Time-sensitive medication must be given NOW\n\n**Why the others are less urgent:**\n\n**Documentation delay:**\n- Important for legal/tracking purposes\n- But doesn\'t affect health outcome\n- Can be done after PEP is started\n- Not a clinical priority\n\n**Emotional distress:**\n- Valid concern\n- But physical protection comes first\n- Psychological support can follow\n- ABCs before emotions\n\n**Exposure severity:**\n- Important to assess\n- But PEP should start while investigating\n- Don\'t delay treatment waiting for source patient labs\n- Treatment is more urgent than diagnosis\n\n**NCLEX Teaching Point:**\n"NCLEX punishes delayed urgency. Time-sensitive interventions > investigation."\n\n**PEP Window Rules:**\n- Ideal: <2 hours\n- Acceptable: <72 hours\n- After 72 hours: Usually not effective\n\n**Priority Order:**\n1. Start PEP immediately\n2. Test source patient\n3. Document incident\n4. Provide emotional support\n\n**Student Trap:**\nStudents think "we need to know the source first" - NO. Start PEP while investigating.',skill:["CLINICAL_JUDGMENT","PRIORITY","MED_SAFETY"],concept:"OCCUPATIONAL_SAFETY",bloom:"EVALUATE",difficulty:5,examTip:"Time-sensitive interventions can't wait for complete information. PEP now, investigate later."},{id:"ld_q06_final_boss_defend_wrong",text:"\u2620\ufe0f FINAL BOSS: Defend the WRONG answer. Patient with 'low immunity' exposed to draining wound. You chose NOT to isolate them. Defend your choice.",scenario:"**What Happened:**\n- You were charge nurse\n- ONE isolation room available\n- Patient C (draining MRSA wound) needed room\n- Immunocompromised roommate was at risk\n- You chose DIFFERENTLY\n\n**NOW DEFEND IT:**\n\nInfection control is demanding an explanation. Your manager is standing here. The family is asking questions.\n\n\u26a0\ufe0f You must make a CLINICAL ARGUMENT for why NOT isolating was defensible, despite the obvious risk.",options:["Resource scarcity","MRSA colonization vs infection","Patient autonomy","Cost-benefit analysis"],correctIndex:1,timeLimit:90,hardMode:!0,finalBoss:!0,requiresDefense:!0,consequences:{0:"\u26a0\ufe0f **Defensible but weak.** Admin accepts 'higher mortality' reasoning. But family is filing complaint about transparency.",1:"\u2705 **Strongest defense.** MRSA colonization + proper contact precautions CAN be managed without isolation. Clinically sound.",2:"\u274c **Ethical violation.** 'Patient understood risk' doesn't protect YOU from negligence. Informed consent \u2260 adequate precautions.",3:"\u274c **Admin rejects this.** Psychological harm doesn't override infection control. You're being reassigned pending investigation."},rationale:'**FINAL BOSS RULES: DEFEND THE WRONG ANSWER**\n\nThis round tests whether you can:\n1. Recognize nuance in "wrong" decisions\n2. Construct clinical arguments under pressure\n3. Distinguish between wrong vs defensible\n\n**Why Option B (MRSA colonization) is most defensible:**\n\n- MRSA **colonization** \u2260 active infection\n- Contact precautions (gloves/gown) ARE evidence-based for colonization\n- Isolation is for **airborne** or **droplet** spread\n- Draining wound can be managed with proper technique\n\n**Why the others fail:**\n\n**A (Resource scarcity):**\n- Legally risky - suggests you gambled with patient safety\n- Admin might accept but family won\'t\n- Opens you to malpractice claims\n\n**C (Patient autonomy):**\n- Informed consent doesn\'t absolve you of duty\n- Immunocompromised patient can\'t truly "consent" to preventable infection\n- This is ethically and legally indefensible\n\n**D (Psychological harm):**\n- Isolation has side effects BUT\n- Infection control > psychological comfort\n- This argument will get you reassigned\n\n**THE LESSON:**\nEven "wrong" answers have DEGREES of defensibility. The game forces you to think like a charge nurse under investigation.\n\n**NCLEX Teaching Point:**\n"There is no perfect answer, but some wrong answers are less wrong than others. Know which battles you can defend."',skill:["CLINICAL_JUDGMENT","INFECTION_CONTROL","ETHICS","LEADERSHIP"],concept:"RESOURCE_ALLOCATION",bloom:"CREATE",difficulty:5,examTip:"Final Boss tests meta-cognition: Can you defend an imperfect choice with clinical reasoning? This is charge nurse reality."}]},Ip={cdiff_outbreak:{id:"ld_escalation_cdiff",text:"\ud83d\udea8 ESCALATION: Two more patients now have diarrhea. Administration demands an action plan. What do you do FIRST?",scenario:"**New Development:**\n- Patients D & E: Acute watery diarrhea started 24h after ED visit\n- Both were in hallway beds near Patient A\n- Lab confirms: Patient A positive for C. diff\n- Infection control called emergency meeting",options:["Close the unit to new admissions","Use your EMERGENCY PASS","Send mass email to all staff","Call provider to order empiric vancomycin"],correctIndex:1,timeLimit:45,requiresResource:"emergencyPasses",consequences:{0:"\u274c **Unit closed!** Administration furious. -20 beds = patients diverted. Your manager is now being questioned.",1:"\u2705 **EMERGENCY PASS used wisely.** Rapid bleach cleaning prevents further spread. Outbreak contained at 3 cases.",2:"\u274c **Email ignored.** C. diff spores survive alcohol sanitizer. Six patients now infected.",3:"\u274c **Provider refuses.** 'I'm not treating email notifications.' Outbreak continues. Seven cases by week end."},rationale:"Emergency passes exist for outbreaks. Rapid environmental disinfection (bleach) is the priority for C. diff spores. Closing units is administrative last resort.",skill:["CLINICAL_JUDGMENT","INFECTION_CONTROL"],bloom:"EVALUATE"},hiv_crisis:{id:"ld_escalation_hiv_crisis",text:"\ud83d\udea8 ESCALATION: Patient with CD4 count 12 now has seizures. You delayed care. What NOW?",scenario:"**Crisis:**\n- Patient seizing in hallway\n- No bed available in ICU\n- You have ONE PROVIDER CALL available\n- Code team is at another emergency",options:["Use PROVIDER CALL","Start seizure precautions and wait","Transfer to ICU immediately","Give lorazepam"],correctIndex:0,timeLimit:30,requiresResource:"providerCalls",consequences:{0:"\u2705 **PROVIDER CALL justified.** MD orders STAT MRI and antifungals. Cryptococcal meningitis confirmed. Patient survives with deficits.",1:"\u274c **Patient falls during seizure.** Head injury. Now intubated. Family considering lawsuit.",2:"\u274c **No ICU bed available!** Transfer request denied. Patient continues seizing. Permanent brain damage.",3:"\u274c **Seizure stops... then recurs.** Lorazepam bought 20 minutes. Not enough. Patient codes."},rationale:"Provider calls are for emergencies. CD4 of 12 + seizures = life-threatening opportunistic infection needing immediate specialist intervention.",skill:["CLINICAL_JUDGMENT","NEURO_ASSESSMENT"],bloom:"EVALUATE"},priority_code:{id:"ld_escalation_priority_code",text:"\ud83d\udea8 ESCALATION: Patient B is coding from unrecognized meningitis. Code team needs direction. What's your call?",scenario:"**Code Blue:**\n- Patient B unresponsive, seizure \u2192 cardiac arrest\n- Code team running ACLS\n- You're charge nurse - they need post-ROSC plan\n- One ISOLATION ROOM available for post-code care",options:["ICU admission with isolation room","Post-code monitoring in ED","Transfer to outside hospital","Continue code"],correctIndex:0,timeLimit:30,requiresResource:"isolationRooms",consequences:{0:"\u2705 **ISOLATION ROOM used appropriately.** ROSC achieved. Amphotericin started. Critical but alive.",1:"\u274c **Staff exposure!** Cryptococcal meningitis now exposed entire ED. Three nurses out sick. Public health investigating.",2:"\u274c **Transfer denied.** 'Too unstable to move.' Patient dies during preparation. Medical examiner case.",3:"\u274c **Code called.** Family devastated. Your initial priority error led here. Preventable death."},rationale:"Post-ROSC care for infectious meningitis requires isolation. Staff safety + patient care. This is when resources get used.",skill:["CLINICAL_JUDGMENT","CODE_MANAGEMENT"],bloom:"EVALUATE"},needlestick_disaster:{id:"ld_escalation_needlestick",text:"\ud83d\udea8 ESCALATION: 4 hours post-exposure. PEP effectiveness dropping. Employee health closed. What now?",scenario:"**Critical Window:**\n- Now 4 hours since needle stick\n- Source patient: HIV+ (uncontrolled), HCV+, HBsAg unknown\n- Employee health closed until 8am (4 more hours)\n- You have one EMERGENCY PASS to override protocols",options:["Use EMERGENCY PASS","Wait for employee health in morning","Send RN to ED for PEP","Give leftover HIV meds from pharmacy"],correctIndex:0,timeLimit:30,requiresResource:"emergencyPasses",consequences:{0:"\u2705 **EMERGENCY PASS justified.** On-call MD orders PEP within 30 min. Optimal window maintained.",1:"\u274c **8 hours total delay.** PEP effectiveness significantly reduced. RN's anxiety through the roof. Risk counseling fails.",2:"\u274c **ED refuses.** 'This is occupational exposure, wrong department.' Now 6 hours delayed. Nurses' union filing grievance.",3:"\u274c **Medication error report filed.** Wrong PEP regimen given. Now need correct meds + report incident. Trust destroyed."},rationale:"PEP works best within 2 hours. Emergency passes exist for staff safety emergencies. This is textbook appropriate use.",skill:["CLINICAL_JUDGMENT","OCCUPATIONAL_SAFETY"],bloom:"EVALUATE"}};const Ep=Object.freeze({LOBBY:"LOBBY",QUESTION:"QUESTION",ANSWER_LOCKED:"ANSWER_LOCKED",CHALLENGE:"CHALLENGE",JUDGE:"JUDGE",REVEAL:"REVEAL"});function Np(e){if("string"!==typeof e)return"";let t=e.replace(/\*\*(.*?)\*\*/g,"$1");return t=t.replace(/\*\*/g,""),t.trim()}const Sp=[{id:"mdro_cd_01",title:"C. diff or just diarrhea?",prompt:"Pick the least dangerous FIRST action.",stem:"76-year-old from LTC. Loose stools x2 today. Completed clindamycin 9 days ago. Afebrile. Vitals stable.",choices:["Obtain stool sample","Start IV fluids","Initiate contact precautions + soap & water","Administer loperamide"],correctIndex:2,rationaleCorrect:"Suspected C. diff = isolate immediately + soap/water; do not wait for labs.",rationaleWrong:["Labs can come after containment; test punishes delay.","Fluids help the patient but do not protect the unit first.","Correct.","Antidiarrheals increase risk of toxic megacolon."],consequenceIfWrong:"Diarrhea worsens \u2192 hypotension develops; secondary exposure occurs.",difficulty:4,timerSeconds:60},{id:"hiv_cd4_02",title:"CD4 count interpretation",prompt:"Which CD4 level is MOST dangerous right now?",stem:"Four HIV patients in clinic today. All on ART. Which needs immediate intervention?",choices:["Patient A: CD4 = 12, viral load undetectable","Patient B: CD4 = 180, viral load 45,000","Patient C: CD4 = 520, viral load 180,000","Patient D: CD4 = 350, viral load undetectable"],correctIndex:1,rationaleCorrect:"CD4 180 + high viral load = active replication. Medication failure. Adjust regimen immediately.",rationaleWrong:["CD4 is critically low BUT viral suppression = treatment working. Monitor closely but not most urgent.","Correct.","CD4 is great; viral load spike may be temporary or medication adherence issue.","Both values stable and improving. Routine follow-up."],consequenceIfWrong:"Patient B develops PCP pneumonia within 2 weeks due to delayed intervention.",difficulty:5,timerSeconds:60},{id:"prep_risk_03",title:"PrEP candidacy assessment",prompt:"Select ALL who need PrEP discussion (SATA)",stem:"Which patients should be offered pre-exposure prophylaxis?",choices:["22-year-old MSM with 3+ partners in past year","35-year-old woman whose partner has HIV (undetectable)","28-year-old injection drug user sharing needles","41-year-old monogamous heterosexual couple (both negative)"],correctIndex:[0,2],rationaleCorrect:"MSM with multiple partners + IDU sharing needles = high-risk behaviors requiring PrEP.",rationaleWrong:["Correct - high-risk sexual behavior.","Partner with undetectable HIV has zero transmission risk (U=U). PrEP unnecessary if truly undetectable.","Correct - needle sharing is highest risk.","Monogamous couple both negative = no indication for PrEP."],consequenceIfWrong:"Patient D receives unnecessary PrEP prescription; patient B becomes infected due to partner's unreported viral blip.",difficulty:6,timerSeconds:90},{id:"priority_triage_04",title:"Four patients, one nurse",prompt:"Who do you assess FIRST?",stem:"You arrive on shift. Four patients need attention.",choices:["Patient on droplet precautions requesting lunch tray","New admission with suspected bacterial meningitis","Post-op patient complaining of 6/10 incision pain","Diabetic patient with blood sugar 250 mg/dL"],correctIndex:1,rationaleCorrect:"Bacterial meningitis = life-threatening. Immediate assessment and isolation before it spreads.",rationaleWrong:["Can delegate to unlicensed staff; not urgent.","Correct.","Pain is expected post-op; can wait 15-20 minutes.","Elevated but not critical; address after life-threatening situation."],consequenceIfWrong:"Meningitis patient seizes due to increased ICP; staff exposed before isolation.",difficulty:4,timerSeconds:45},{id:"needlestick_pep_05",title:"Needlestick aftermath",prompt:"What is the FIRST priority?",stem:"You sustain needlestick from HIV+ patient (detectable viral load). Blood exposure confirmed.",choices:["Wash site with soap & water","Report to employee health immediately","Draw baseline HIV test","Squeeze puncture site to express blood"],correctIndex:0,rationaleCorrect:"Wash immediately reduces viral load at site. Do this FIRST, then report within 2 hours for PEP.",rationaleWrong:["Correct.","Important but do AFTER washing site. PEP must start within 72 hours (ideally <2 hours).","Baseline testing comes after immediate decontamination.","NEVER squeeze; increases tissue damage and viral exposure."],consequenceIfWrong:"Delay in washing increases infection risk. Squeezing causes deeper tissue exposure.",difficulty:5,timerSeconds:30}];console.log("Firebase initialized:",{db:!!Lf,auth:!!Mf});const Tp=async e=>{const t={NODE_ENV:"production",PUBLIC_URL:"/Term-3-Gaming",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_GEMINI_API_KEY||"AIzaSyAT-wsupPN4ROtkDzkYVJ9yRJiGa4LvvV8",n=[1e3,2e3,4e3,8e3,16e3];for(let c=0;c<=n.length;c++)try{var r,i,s,o,a;const n=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:e}]}]})});if(!n.ok)throw new Error("API Error: ".concat(n.status));return(null===(r=(await n.json()).candidates)||void 0===r||null===(i=r[0])||void 0===i||null===(s=i.content)||void 0===s||null===(o=s.parts)||void 0===o||null===(a=o[0])||void 0===a?void 0:a.text)||"Could not generate response."}catch(l){if(c===n.length)return"Sorry, the AI tutor is currently offline. Please try again later.";await new Promise(e=>setTimeout(e,n[c]))}};let _p="rn-mastery-game";"undefined"!==typeof window&&"undefined"!==typeof window.__app_id&&(_p=window.__app_id);const Cp=[{id:"ch18",title:"Ch 18: Immune Assessment",icon:(0,Bf.jsx)(o.A,{className:"w-6 h-6"}),description:"Anatomy, function, and assessment.",questions:[{id:"ch18_q01",text:"The nurse is teaching a group of patients about first-line defense against infection. Which patient statement indicates the need for further education?",options:["The skin is a first-line defense.","A sneeze is a mechanical defense.","My saliva is a biochemical defense.","A cut with pus is a mechanical first-line defense."],correctIndex:3,rationale:"A cut with pus indicates an inflammatory response (second-line defense), not a first-line defense."},{id:"ch18_q02",text:"The nurse correlates the function of the thymus gland to which outcome?",options:["WBC development","T-cell development","Cytokine production","B-cell production"],correctIndex:1,rationale:"The thymus gland is the primary site for the maturation and development of T-cells."},{id:"ch18_q03",text:"Which type of leukocyte releases heparin as part of the inflammatory response?",options:["Basophil","Eosinophil","Monocyte","Neutrophil"],correctIndex:0,rationale:"Basophils release histamine and heparin during the inflammatory response."},{id:"ch18_q04",text:"A nurse is caring for a patient who is experiencing leukocytosis. Which action is most appropriate?",options:["Assessing for source of infection","Assessing for bleeding","Reverse isolation","Electric razor use"],correctIndex:0,rationale:"Leukocytosis (elevated WBC) is a sign of infection. The priority is to find the cause."},{id:"ch18_q05",text:"Breastfeeding provides which type of immunity?",options:["Natural Active","Artificial Active","Natural Passive","Artificial Passive"],correctIndex:2,rationale:"Natural Passive Immunity occurs when antibodies are passed from mother to baby (placenta/breastmilk)."},{id:"ch18_q06",text:"Which age-related change increases an older adult's susceptibility to cancer?",options:["Thymus involution","Increased autoantibodies","Decreased Cytotoxic T-cell surveillance","Increased vaccine response"],correctIndex:2,rationale:"Decreased surveillance by Cytotoxic T-cells allows malignant cells to proliferate."},{id:"ch18_q07",text:"A 'Left Shift' in WBC differential indicates:",options:["Viral infection","Acute bacterial infection","Parasitic infection","Allergy"],correctIndex:1,rationale:"A 'Left Shift' means increased immature neutrophils (bands), a sign of acute bacterial infection."},{id:"ch18_q08",text:"Which finding suggests potential immune deficiency?",options:["BP 120/80","Frequent, recurrent infections","Seasonal allergies","Mild fatigue"],correctIndex:1,rationale:"Frequent, severe, or recurrent infections are the hallmark of immune deficiency."},{id:"ch18_q09",text:"Which organ filters old blood cells and foreign antigens from the blood?",options:["Thymus","Spleen","Tonsils","Bone Marrow"],correctIndex:1,rationale:"The spleen filters blood and mounts immune responses to blood-borne pathogens."},{id:"ch18_q10",text:"Which immunoglobulin crosses the placenta?",options:["IgM","IgA","IgG","IgE"],correctIndex:2,rationale:"IgG is the most abundant and the only Ig that crosses the placenta."},{id:"ch18_q11",text:"A hard, fixed, non-tender lymph node suggests:",options:["Infection","Malignancy","Aging","Inflammation"],correctIndex:1,rationale:"Malignant nodes are hard, fixed, and non-tender. Infected nodes are soft and tender."},{id:"ch18_q12",text:"Elevated Eosinophils indicate:",options:["Bacterial infection","Viral infection","Parasitic infection/Allergy","Autoimmune flare"],correctIndex:2,rationale:"Eosinophils rise during allergic reactions and parasitic infections."},{id:"ch18_q13",text:"Which nutrient is critical for antibody synthesis?",options:["Protein","Carbs","Fats","Fiber"],correctIndex:0,rationale:"Protein is essential for antibody production. Malnutrition compromises immunity."},{id:"ch18_q14",text:"Primary function of B-Lymphocytes?",options:["Cellular attack","Phagocytosis","Humoral immunity (Antibodies)","Histamine release"],correctIndex:2,rationale:"B-cells produce antibodies (Humoral Immunity)."},{id:"ch18_q15",text:"Inflammation causes which vascular change?",options:["Vasoconstriction","Vasodilation & permeability","Decreased flow","Decreased permeability"],correctIndex:1,rationale:"Vasodilation (heat/redness) and permeability (swelling) allow immune cells to reach the site."},{id:"ch18_q16",text:"Natural Killer (NK) cells are part of which immunity?",options:["Adaptive","Innate","Passive","Artificial"],correctIndex:1,rationale:"NK cells provide immediate, non-specific defense as part of innate immunity."},{id:"ch18_q17",text:"Which WBC is the 'first responder' to bacterial infection?",options:["Lymphocyte","Monocyte","Neutrophil","Basophil"],correctIndex:2,rationale:"Neutrophils are the most abundant and first to arrive at infection sites."},{id:"ch18_q18",text:"Complement system activation results in:",options:["Decreased inflammation","Pathogen lysis","Antibody suppression","WBC destruction"],correctIndex:1,rationale:"Complement creates membrane attack complexes that lyse pathogens."},{id:"ch18_q19",text:"Memory B-cells provide:",options:["Immediate response","Long-term immunity","Phagocytosis","Inflammation"],correctIndex:1,rationale:"Memory cells enable faster, stronger responses upon re-exposure."},{id:"ch18_q20",text:"Which finding suggests lymphoma?",options:["Painful, mobile nodes","Painless, fixed lymphadenopathy","Fever only","Normal CBC"],correctIndex:1,rationale:"Painless, fixed nodes that don't resolve are concerning for malignancy."},{id:"ch18_q21",text:"Neutropenia increases risk for:",options:["Bleeding","Infection","Allergy","Clotting"],correctIndex:1,rationale:"Low neutrophils (<1500) significantly increase infection risk."},{id:"ch18_q22",text:"Monocytes differentiate into:",options:["Neutrophils","Macrophages","T-cells","Platelets"],correctIndex:1,rationale:"Monocytes leave blood and become tissue macrophages."},{id:"ch18_q23",text:"IgM indicates:",options:["Past infection","Active/recent infection","Vaccine response","Allergy"],correctIndex:1,rationale:"IgM is the first antibody produced during acute infection."},{id:"ch18_q24",text:"Interferons are released in response to:",options:["Bacteria","Viruses","Parasites","Allergens"],correctIndex:1,rationale:"Interferons 'interfere' with viral replication."},{id:"ch18_q25",text:"CD4 cells are also called:",options:["Killer T-cells","Helper T-cells","B-cells","NK cells"],correctIndex:1,rationale:"CD4+ T-cells are helper cells that coordinate immune responses."}]},{id:"ch19",title:"Ch 19: Immune Disorders",icon:(0,Bf.jsx)(a.A,{className:"w-6 h-6"}),description:"Hypersensitivities & Autoimmunity.",questions:[{id:"ch19_q01",text:"Which Ig is a mediator in allergic responses?",options:["IgA","IgD","IgE","IgG"],correctIndex:2,rationale:"IgE binds to mast cells and triggers histamine release in allergies."},{id:"ch19_q02",text:"Latex sensitivity is cross-reactive with:",options:["Strawberries","Shellfish","Bananas/Avocados","Peanuts"],correctIndex:2,rationale:"Bananas, avocados, and kiwis share similar proteins with latex."},{id:"ch19_q03",text:"Signs of Anaphylaxis (Type I) include:",options:["Delayed rash","Jaundice","Stridor, wheezing, hypotension","Joint pain"],correctIndex:2,rationale:"Stridor and hypotension indicate life-threatening airway constriction and shock."},{id:"ch19_q04",text:"A hemolytic transfusion reaction is which type?",options:["Type I","Type II (Cytotoxic)","Type III","Type IV"],correctIndex:1,rationale:"Antibodies attacking donor RBCs is a Type II Cytotoxic reaction."},{id:"ch19_q05",text:"SLE (Lupus) is which type of hypersensitivity?",options:["Type I","Type II","Type III (Immune Complex)","Type IV"],correctIndex:2,rationale:"SLE involves immune complex deposition in tissues (Type III)."},{id:"ch19_q06",text:"Priority for a severe bee sting reaction?",options:["Oral antihistamine","Epinephrine IM","Ice","Drive to hospital"],correctIndex:1,rationale:"Epinephrine is the life-saving priority to reverse anaphylaxis."},{id:"ch19_q07",text:"The TB skin test (PPD) is which reaction type?",options:["Type I","Type II","Type III","Type IV (Delayed)"],correctIndex:3,rationale:"PPD is a T-cell mediated Delayed (Type IV) reaction."},{id:"ch19_q08",text:"First-line drug for angioedema of the lips/tongue?",options:["Fluids","Epinephrine","Steroids","Benadryl"],correctIndex:1,rationale:"Airway compromise requires Epinephrine immediately."},{id:"ch19_q09",text:"Goodpasture's syndrome (antibodies attack lung/kidney) is:",options:["Autoimmunity","Immunodeficiency","Gammopathy","Alloimmunity"],correctIndex:0,rationale:"Autoimmunity is the loss of self-tolerance attacking own tissues."},{id:"ch19_q10",text:"Crucial intervention for B-cell deficiency?",options:["Avoid live vaccines","Daily steroids","Plasmapheresis","High potassium"],correctIndex:0,rationale:"Without antibodies, live vaccines can cause the actual disease."},{id:"ch19_q11",text:"Serum Sickness is which type of reaction?",options:["Type I","Type II","Type III","Type IV"],correctIndex:2,rationale:"Serum sickness is a Type III immune complex reaction."},{id:"ch19_q12",text:"Sign of allergic reaction to antibiotics?",options:["HR 72","Diffuse pruritus/urticaria","Hunger","Low urine output"],correctIndex:1,rationale:"Itching and hives are classic signs of allergy."},{id:"ch19_q13",text:"Important instruction before allergy skin testing?",options:["Stop antihistamines 48-72h prior","Fast 12h","Apply lotion","Double allergy meds"],correctIndex:0,rationale:"Antihistamines suppress the skin response and cause false negatives."},{id:"ch19_q14",text:"Hyperacute transplant rejection occurs:",options:["Minutes to hours","6 months","Years","If meds stopped"],correctIndex:0,rationale:"Hyperacute rejection is immediate and antibody-mediated."},{id:"ch19_q15",text:"Cell type responsible for Type IV reactions?",options:["B-cells","Sensitized T-cells","Neutrophils","Mast cells"],correctIndex:1,rationale:"Type IV is cell-mediated by T-cells, not antibodies."},{id:"ch19_q16",text:"Which medication suppresses Type I allergic reactions?",options:["Antihistamines","NSAIDs","ACE inhibitors","Beta blockers"],correctIndex:0,rationale:"Antihistamines block histamine release from mast cells in Type I reactions."},{id:"ch19_q17",text:"Hemolytic transfusion reaction is which type?",options:["Type I","Type II","Type III","Type IV"],correctIndex:1,rationale:"Type II cytotoxic reaction occurs when antibodies attack transfused RBCs."},{id:"ch19_q18",text:"Contact dermatitis from poison ivy is which type?",options:["Type I","Type II","Type III","Type IV"],correctIndex:3,rationale:"Poison ivy causes a delayed Type IV cell-mediated hypersensitivity."},{id:"ch19_q19",text:"Classic sign of Systemic Lupus Erythematosus (SLE)?",options:["Butterfly rash","Spider veins","Clubbing","Pallor"],correctIndex:0,rationale:"Malar (butterfly) rash across cheeks and nose is characteristic of SLE."},{id:"ch19_q20",text:"Priority nursing action during anaphylaxis?",options:["Establish IV access","Administer epinephrine","Get vital signs","Call physician"],correctIndex:1,rationale:"Epinephrine is the first-line treatment to reverse bronchospasm and vasodilation."},{id:"ch19_q21",text:"Which immunosuppressant requires monitoring for nephrotoxicity?",options:["Azathioprine","Prednisone","Cyclosporine","Methotrexate"],correctIndex:2,rationale:"Cyclosporine can damage kidneys; monitor creatinine and BUN levels."},{id:"ch19_q22",text:"Positive ANA test suggests which condition?",options:["Diabetes","Hypertension","Autoimmune disorder","Bacterial infection"],correctIndex:2,rationale:"Antinuclear antibodies (ANA) indicate autoimmune conditions like SLE."},{id:"ch19_q23",text:"Chronic transplant rejection time frame?",options:["Minutes","Hours to days","Months to years","Never occurs"],correctIndex:2,rationale:"Chronic rejection is a slow progressive process occurring months to years post-transplant."},{id:"ch19_q24",text:"Food most commonly causing Type I allergies in children?",options:["Wheat","Peanuts","Corn","Rice"],correctIndex:1,rationale:"Peanuts cause severe IgE-mediated allergic reactions and anaphylaxis in children."},{id:"ch19_q25",text:"Teaching point for clients with latex allergy?",options:["Only avoid powdered gloves","Report to healthcare providers","Allergy decreases over time","Safe to use latex at home"],correctIndex:1,rationale:"Clients must inform all healthcare providers to ensure latex-free equipment and gloves."}]},{id:"ch20",title:"Ch 20: Connective Tissue",icon:(0,Bf.jsx)(l.A,{className:"w-6 h-6"}),description:"RA, Lupus, Gout, Scleroderma.",questions:[{id:"ch20_q01",text:"Highest risk for Osteoarthritis (OA)?",options:["40yo admin","45yo construction","55yo obese female machinist","60yo accountant"],correctIndex:2,rationale:"Risk factors: Age >55, Female, Obesity, Repetitive motion."},{id:"ch20_q02",text:"Non-pharm therapy for Lupus?",options:["Avoid sun/Use sunscreen","Increase sun","Limit fluids","High protein only"],correctIndex:0,rationale:"Sun exposure triggers SLE flares (photosensitivity)."},{id:"ch20_q03",text:"Finding associated with RA (not OA)?",options:["Asymmetrical pain","Heberden's nodes","Symmetrical pain/Morning stiffness >1hr","Crepitus"],correctIndex:2,rationale:"RA is systemic, symmetrical, and causes prolonged morning stiffness."},{id:"ch20_q04",text:"Medication for ACUTE Gout flare?",options:["Allopurinol","Colchicine","Febuxostat","Methotrexate"],correctIndex:1,rationale:"Colchicine treats acute inflammation. Allopurinol prevents future attacks."},{id:"ch20_q05",text:"In CREST syndrome, 'R' stands for:",options:["Rash","Raynaud's Phenomenon","Renal","Rigidity"],correctIndex:1,rationale:"Calcinosis, Raynaud's, Esophageal dysfunction, Sclerodactyly, Telangiectasia."},{id:"ch20_q06",text:"Dietary modification for Gout?",options:["High protein","Low purine (no organ meat/alcohol)","Gluten-free","Fluid restriction"],correctIndex:1,rationale:"Purines break down into uric acid, which causes Gout."},{id:"ch20_q07",text:"Adverse effect of Methotrexate?",options:["Weight gain","Bone marrow suppression","Insomnia","Hyperactivity"],correctIndex:1,rationale:"Methotrexate causes immunosuppression/bone marrow suppression."},{id:"ch20_q08",text:"Heberden's nodes are a sign of:",options:["RA","Osteoarthritis","Gout","Lupus"],correctIndex:1,rationale:"Bony overgrowths on distal joints (Heberden's) are classic OA."},{id:"ch20_q09",text:"Fibromyalgia involves:",options:["Inflammation","Autoimmunity","Central sensitization/Amplified pain","Uric acid"],correctIndex:2,rationale:"Fibromyalgia is a non-inflammatory chronic pain syndrome."},{id:"ch20_q10",text:"Hallmark of Sj\xf6gren's syndrome?",options:["Dry eyes/mouth","Weakness","Kidney stones","Tremors"],correctIndex:0,rationale:"Sj\xf6gren's attacks moisture glands (eyes/mouth)."},{id:"ch20_q11",text:"Specific lab for SLE (Lupus)?",options:["RF","Anti-dsDNA","Uric Acid","CRP"],correctIndex:1,rationale:"Anti-dsDNA and Anti-Smith are highly specific for Lupus."},{id:"ch20_q12",text:"Scleroderma patient with swallowing difficulty?",options:["Esophageal dysfunction","Infection","Anxiety","Side effect"],correctIndex:0,rationale:"Esophageal hardening causes dysphagia (CREST)."},{id:"ch20_q13",text:"Best exercise for knee OA?",options:["Jogging","Heavy weights","Swimming/Water aerobics","Bed rest"],correctIndex:2,rationale:"Low-impact water exercise reduces joint stress."},{id:"ch20_q14",text:"Raynaud's trigger to avoid?",options:["Warmth","Cold & Stress","Water","Elevation"],correctIndex:1,rationale:"Cold and stress trigger vasospasm in digits."},{id:"ch20_q15",text:"Indication for Arthroplasty (Joint Replacement)?",options:["Diagnosis","Uncontrolled pain/mobility loss","Age <40","Cream failure"],correctIndex:1,rationale:"Surgery is the last resort for severe pain/loss of function."},{id:"ch20_q16",text:"First-line DMARD for Rheumatoid Arthritis?",options:["Prednisone","Methotrexate","Ibuprofen","Acetaminophen"],correctIndex:1,rationale:"Methotrexate is the gold standard DMARD to slow RA progression."},{id:"ch20_q17",text:"Lab value elevated in Rheumatoid Arthritis?",options:["Glucose","Rheumatoid Factor (RF)","Hemoglobin","Sodium"],correctIndex:1,rationale:"Rheumatoid Factor is an autoantibody present in 70-80% of RA patients."},{id:"ch20_q18",text:"Teaching for patient on Methotrexate?",options:["Take with grapefruit juice","Avoid folic acid","Avoid alcohol","Double dose if missed"],correctIndex:2,rationale:"Alcohol increases hepatotoxicity risk with Methotrexate."},{id:"ch20_q19",text:"Joint most commonly affected by Gout?",options:["Hip","Shoulder","Great toe (MTP joint)","Elbow"],correctIndex:2,rationale:"Gout classically presents in the first metatarsophalangeal joint (big toe)."},{id:"ch20_q20",text:"Complication of untreated Osteoarthritis?",options:["Increased flexibility","Joint deformity & disability","Hyperglycemia","Anemia"],correctIndex:1,rationale:"Progressive cartilage loss leads to deformity and loss of function."},{id:"ch20_q21",text:"Medication that can trigger Gout attack?",options:["Thiazide diuretics","Beta blockers","Calcium channel blockers","ACE inhibitors"],correctIndex:0,rationale:"Diuretics increase uric acid levels by reducing renal excretion."},{id:"ch20_q22",text:"Lab test to confirm diagnosis of Gout?",options:["CBC","Synovial fluid analysis for urate crystals","Chest X-ray","EKG"],correctIndex:1,rationale:"Needle-shaped urate crystals in joint fluid confirm Gout."},{id:"ch20_q23",text:"Expected X-ray finding in Osteoarthritis?",options:["Joint space widening","Joint space narrowing & bone spurs","Fractures","Soft tissue swelling only"],correctIndex:1,rationale:"OA shows decreased joint space and osteophytes (bone spurs)."},{id:"ch20_q24",text:"Priority teaching for Lupus patient about pregnancy?",options:["Safe to get pregnant anytime","High-risk; requires specialist care","Stop all medications","Avoid prenatal vitamins"],correctIndex:1,rationale:"SLE pregnancies are high-risk due to flares and complications; need MFM specialist."},{id:"ch20_q25",text:"Biologic therapy for severe Rheumatoid Arthritis?",options:["Aspirin","TNF inhibitors (Etanercept)","Tylenol","Vitamin D"],correctIndex:1,rationale:"TNF-alpha inhibitors target specific immune pathways in RA."}]},{id:"ch21",title:"Ch 21: MDROs",icon:(0,Bf.jsx)(c.A,{className:"w-6 h-6"}),description:"Transmission & Infection Control.",questions:[{id:"ch21_q01",text:"Contact Transmission involves:",options:["Insect bite","Direct/Indirect contact","Airborne particles","Ingestion"],correctIndex:1,rationale:"Direct contact or contact with contaminated surfaces."},{id:"ch21_q02",text:"Vector-Borne Transmission involves:",options:["Insects (ticks/mosquitoes)","Direct contact","Breathing","Food"],correctIndex:0,rationale:"Vectors are living organisms (insects) that transmit disease."},{id:"ch21_q03",text:"Airborne Transmission involves:",options:["Doorknobs","Breathing small suspended particles","Food","Droplets >5 microns"],correctIndex:1,rationale:"Airborne pathogens remain suspended in air for long periods."},{id:"ch21_q04",text:"Common MDRO requiring Contact Precautions?",options:["Strep","MRSA","Flu","Shingles"],correctIndex:1,rationale:"MRSA is a resistant organism spread by contact."},{id:"ch21_q05",text:"Priority for C. diff?",options:["Mask","Soap & Water hand wash","Negative pressure","Open door"],correctIndex:1,rationale:"Alcohol does not kill C. diff spores; mechanical washing is required."},{id:"ch21_q06",text:"VRE is spread via:",options:["Contact","Airborne","Water","Mosquitoes"],correctIndex:0,rationale:"VRE survives on surfaces/hands; spread by contact."},{id:"ch21_q07",text:"Highest risk for MDRO?",options:["Broken arm","ICU with central line/antibiotics","Cold","Outpatient"],correctIndex:1,rationale:"Invasive devices and antibiotic use increase MDRO risk."},{id:"ch21_q08",text:"Acinetobacter baumannii is associated with:",options:["Food","VAP/Wound infections in ICU","Sore throat","Ticks"],correctIndex:1,rationale:"Opportunistic pathogen common in ICUs/ventilators."},{id:"ch21_q09",text:"Antibiotic Stewardship means:",options:["Antibiotics for all","Right drug/dose/duration","Creating drugs","No antibiotics"],correctIndex:1,rationale:"Optimizing use to prevent resistance."},{id:"ch21_q10",text:"Donning PPE order?",options:["Gloves first","Gown -> Gloves","Mask -> Gloves","Gloves -> Mask"],correctIndex:1,rationale:"Gown first, then gloves over cuffs."},{id:"ch21_q11",text:"Most contaminated PPE item (remove first)?",options:["Mask","Gown","Gloves","Goggles"],correctIndex:2,rationale:"Gloves are most contaminated."},{id:"ch21_q12",text:"CRE are dangerous because:",options:["Viral","Resistant to carbapenems","Affect kids","Waterborne"],correctIndex:1,rationale:"Resistant to last-resort antibiotics."},{id:"ch21_q13",text:"Cohort isolation involves:",options:["Same organism roommates","Any roommate","Home","Negative pressure"],correctIndex:0,rationale:"Patients with the SAME active infection can share a room."},{id:"ch21_q14",text:"Best way to break transmission?",options:["Diagnosis","Hand Hygiene","Nutrition","Vaccines"],correctIndex:1,rationale:"Hand hygiene is #1 for preventing spread."},{id:"ch21_q15",text:"Standard Precautions apply to:",options:["Infected only","HIV only","All patients","Surgical only"],correctIndex:2,rationale:"Universal standard for all patients."},{id:"ch21_q16",text:"Transmission-based precaution for active TB?",options:["Contact","Droplet","Airborne","Standard only"],correctIndex:2,rationale:"TB requires airborne precautions with N95 respirator."},{id:"ch21_q17",text:"PPE removal (doffing) order?",options:["Mask first","Gloves -> Gown -> Mask -> Goggles","Gown first","Goggles first"],correctIndex:1,rationale:"Remove most contaminated items first (gloves) before touching face."},{id:"ch21_q18",text:"Type of precaution for Influenza?",options:["Contact","Airborne","Droplet","Protective environment"],correctIndex:2,rationale:"Influenza spreads via large droplets; requires surgical mask."},{id:"ch21_q19",text:"ESBL organisms are resistant to:",options:["All antibiotics","Beta-lactam antibiotics","Antifungals","Antivirals"],correctIndex:1,rationale:"Extended-spectrum beta-lactamase breaks down penicillins and cephalosporins."},{id:"ch21_q20",text:"Contact precautions require:",options:["N95 mask","Gown and gloves","Negative pressure room","PAPR"],correctIndex:1,rationale:"Gown and gloves prevent transmission via direct contact."},{id:"ch21_q21",text:"CRE stands for:",options:["Carbapenem-Resistant Enterobacteriaceae","Common Respiratory Enterococcus","Chronic Renal Encephalopathy","Continuous Renal Excretion"],correctIndex:0,rationale:"CRE are 'superbugs' resistant to carbapenem antibiotics."},{id:"ch21_q22",text:"Negative pressure room is required for:",options:["MRSA","C. diff","Tuberculosis","VRE"],correctIndex:2,rationale:"Negative pressure prevents airborne particles from escaping the room."},{id:"ch21_q23",text:"Priority action if exposed to blood/bodily fluids?",options:["Document later","Wash area immediately & report","Continue working","Wait until end of shift"],correctIndex:1,rationale:"Immediate washing and reporting enables timely post-exposure prophylaxis."},{id:"ch21_q24",text:"MDROs develop resistance primarily due to:",options:["Proper antibiotic use","Overuse and misuse of antibiotics","Handwashing","Vaccination"],correctIndex:1,rationale:"Inappropriate antibiotic use drives selection of resistant strains."},{id:"ch21_q25",text:"Which patient requires protective environment (reverse isolation)?",options:["MRSA infection","Neutropenic cancer patient","Diabetic","Post-op day 1"],correctIndex:1,rationale:"Immunocompromised patients need protection from environmental pathogens."}]},{id:"ch22",title:"Ch 22: HIV/AIDS",icon:(0,Bf.jsx)(u.A,{className:"w-6 h-6"}),description:"Etiology, Progression, Management.",questions:[{id:"ch22_q01",text:"Correct HIV progression?",options:["Acute->AIDS","Viral transmission -> Seroconversion -> Acute -> Chronic -> AIDS","AIDS first","Transmission->AIDS"],correctIndex:1,rationale:"Transmission > Antibodies > Acute Sx > Latency > AIDS."},{id:"ch22_q02",text:"Sign of deterioration in HIV?",options:["Undetectable load","Weight loss >10%","Night sweats","CD4 600"],correctIndex:1,rationale:"Wasting syndrome (>10% loss) indicates progression."},{id:"ch22_q03",text:"PrEP is:",options:["Vaccine","Daily med to prevent HIV","After sex","Cure"],correctIndex:1,rationale:"Pre-Exposure Prophylaxis prevents acquisition."},{id:"ch22_q04",text:"CD4 count of 180 indicates:",options:["Acute HIV","AIDS","Adherence","Normal"],correctIndex:1,rationale:"AIDS < 200 CD4 cells."},{id:"ch22_q05",text:"Opportunistic Infection (OI) in AIDS?",options:["Strep","PCP Pneumonia","Flu","Eczema"],correctIndex:1,rationale:"PCP is a classic OI."},{id:"ch22_q06",text:"Goal of ART?",options:["Cure","Undetectable viral load","Increase virus","Decrease CD4"],correctIndex:1,rationale:"Suppress virus to undetectable levels."},{id:"ch22_q07",text:"Kaposi's Sarcoma presents as:",options:["Purple/red skin lesions","White patches","Diarrhea","Blindness"],correctIndex:0,rationale:"Cancer of blood vessels causing purple lesions."},{id:"ch22_q08",text:"Needle stick priority?",options:["Wait","PEP within 72h","Antibiotics","Retire"],correctIndex:1,rationale:"Post-Exposure Prophylaxis ASAP (max 72h)."},{id:"ch22_q09",text:"Undetectable viral load means:",options:["Cured","Gone","Untransmittable (U=U)","Stop meds"],correctIndex:2,rationale:"Cannot transmit sexually, but must keep taking meds."},{id:"ch22_q10",text:"Oral Thrush presents as:",options:["Blisters","Creamy white patches","Bleeding","Taste loss"],correctIndex:1,rationale:"Fungal infection, white patches."},{id:"ch22_q11",text:"HIV Screening/Confirmation test?",options:["CBC","CXR","4th Gen Antigen/Antibody","UA"],correctIndex:2,rationale:"Detects p24 antigen and antibodies early."},{id:"ch22_q12",text:"IRIS is:",options:["Collapse","Immune recovery causing inflammation","Stop meds","Mutation"],correctIndex:1,rationale:"Recovering immune system attacks old infections."},{id:"ch22_q13",text:"Vertical Transmission:",options:["Sex","Needles","Mother-to-child","Blood"],correctIndex:2,rationale:"Perinatal transmission."},{id:"ch22_q14",text:"ART Adherence requirement:",options:["When sick","95%+","Double dose","Stop if side effects"],correctIndex:1,rationale:"Strict adherence prevents resistance."},{id:"ch22_q15",text:"TB in HIV:",options:["Rare","Leading cause of death","Untreatable","No isolation"],correctIndex:1,rationale:"Major coinfection and killer."},{id:"ch22_q16",text:"Window period for HIV testing refers to:",options:["Treatment duration","Time between infection and detectable antibodies","CD4 recovery time","Viral load doubling time"],correctIndex:1,rationale:"It takes 2-12 weeks for antibodies to develop; tests may be negative during this time."},{id:"ch22_q17",text:"Common side effect of Efavirenz (NNRTI)?",options:["Weight gain","Vivid dreams/CNS effects","Hair loss","Diarrhea"],correctIndex:1,rationale:"Efavirenz commonly causes neuropsychiatric side effects including vivid dreams."},{id:"ch22_q18",text:"PrEP (Pre-Exposure Prophylaxis) is for:",options:["Treating HIV infection","Preventing HIV in high-risk individuals","Curing AIDS","Treating opportunistic infections"],correctIndex:1,rationale:"PrEP (Truvada/Descovy) reduces HIV acquisition risk by >90% when taken consistently."},{id:"ch22_q19",text:"CD4 count indicating severe immunosuppression/AIDS?",options:[">500","350-500","200-350","<200"],correctIndex:3,rationale:"CD4 <200 defines AIDS and dramatically increases opportunistic infection risk."},{id:"ch22_q20",text:"Cryptococcal meningitis in AIDS patients presents with:",options:["Rash","Severe headache & altered mental status","Cough","Diarrhea"],correctIndex:1,rationale:"Fungal meningitis causes headache, fever, and neurological changes."},{id:"ch22_q21",text:"Adherence requirement for ART effectiveness?",options:["50%","75%",">95%","Take when sick"],correctIndex:2,rationale:"Strict adherence >95% prevents resistance and maintains viral suppression."},{id:"ch22_q22",text:"Wasting syndrome (HIV-associated) is defined as:",options:["Weight gain",">10% unintentional weight loss","Increased muscle mass","Fluid retention"],correctIndex:1,rationale:"AIDS wasting involves severe involuntary weight loss with muscle depletion."},{id:"ch22_q23",text:"Integrase inhibitor example?",options:["Raltegravir","Efavirenz","Lamivudine","Ritonavir"],correctIndex:0,rationale:"Raltegravir (Isentress) blocks HIV integration into host DNA."},{id:"ch22_q24",text:"Patient education about ART resistance?",options:["Missing doses has no effect","Resistance develops with inconsistent use","Double dose if missed","Stop meds if feeling better"],correctIndex:1,rationale:"Inconsistent dosing allows viral replication and mutation to resistant strains."},{id:"ch22_q25",text:"Legal requirement for HIV status disclosure?",options:["Must tell everyone","Varies by state; often required to inform sexual partners","Never required","Only employers need to know"],correctIndex:1,rationale:"Laws vary; many states criminalize non-disclosure to sexual partners."}]},{id:"quiz1",title:"Review for Quiz 1",icon:(0,Bf.jsx)(d.A,{className:"w-6 h-6"}),description:"Mixed Review: Chapters 18-22.",questions:[{id:"quiz1_q01",text:"Which antibody provides passive immunity in breast milk?",options:["IgG","IgM","IgA","IgE"],correctIndex:2,rationale:"IgA is secreted in mucous membranes and breast milk."},{id:"quiz1_q02",text:"Contact dermatitis is which hypersensitivity type?",options:["Type I","Type II","Type III","Type IV"],correctIndex:3,rationale:"Type IV delayed cell-mediated reaction (e.g., poison ivy)."},{id:"quiz1_q03",text:"Heberden's nodes are found in:",options:["Rheumatoid Arthritis","Osteoarthritis","Gout","Lupus"],correctIndex:1,rationale:"Bony enlargements at DIP joints characteristic of OA."},{id:"quiz1_q04",text:"Why is soap and water required for C. diff?",options:["Smells better","Alcohol doesn't kill spores","Faster","Required by law"],correctIndex:1,rationale:"Mechanical action of soap and water removes C. diff spores; alcohol doesn't."},{id:"quiz1_q05",text:"CD4 count at AIDS diagnosis?",options:[">500","350-500","200-350","<200"],correctIndex:3,rationale:"AIDS is defined by CD4 <200 or opportunistic infections."},{id:"quiz1_q06",text:"Which cell type produces antibodies?",options:["T-cells","Plasma cells (B-cells)","Neutrophils","Basophils"],correctIndex:1,rationale:"B-cells differentiate into plasma cells that secrete antibodies."},{id:"quiz1_q07",text:"Butterfly rash is associated with:",options:["RA","OA","SLE (Lupus)","Gout"],correctIndex:2,rationale:"Malar rash across cheeks/nose is classic for Systemic Lupus Erythematosus."},{id:"quiz1_q08",text:"Priority action during anaphylaxis?",options:["Call physician","Administer epinephrine","Start IV","Take vital signs"],correctIndex:1,rationale:"Epinephrine IM is the first-line life-saving treatment."},{id:"quiz1_q09",text:"MRSA requires which precautions?",options:["Standard only","Contact","Airborne","Droplet"],correctIndex:1,rationale:"MRSA spreads via direct contact; gown and gloves required."},{id:"quiz1_q10",text:"Goal of antiretroviral therapy (ART)?",options:["Cure HIV","Increase CD4","Undetectable viral load","Kill all T-cells"],correctIndex:2,rationale:"ART suppresses HIV replication to undetectable levels."},{id:"quiz1_q11",text:"Inflammation is part of which immunity?",options:["Adaptive","Innate","Passive","Artificial"],correctIndex:1,rationale:"Inflammation is a non-specific innate immune response."},{id:"quiz1_q12",text:"Serum sickness is which type of reaction?",options:["Type I","Type II","Type III","Type IV"],correctIndex:2,rationale:"Type III immune complex-mediated hypersensitivity."},{id:"quiz1_q13",text:"Which medication prevents Gout attacks long-term?",options:["Colchicine","Allopurinol","Prednisone","NSAIDs"],correctIndex:1,rationale:"Allopurinol reduces uric acid production to prevent future flares."},{id:"quiz1_q14",text:"Hand hygiene is most effective at preventing:",options:["Aging","MDRO transmission","Genetic diseases","Cancer"],correctIndex:1,rationale:"Proper handwashing is the #1 method to break infection chain."},{id:"quiz1_q15",text:"Kaposi's Sarcoma appears as:",options:["White patches","Purple skin lesions","Yellow nodules","Clear blisters"],correctIndex:1,rationale:"Vascular cancer causing purple/red lesions in AIDS patients."},{id:"quiz1_q16",text:"Which antibody is first to respond in infection?",options:["IgA","IgE","IgG","IgM"],correctIndex:3,rationale:"IgM appears first during acute infection ('M for iMmediate')."},{id:"quiz1_q17",text:"Anaphylaxis involves which antibody?",options:["IgA","IgE","IgG","IgM"],correctIndex:1,rationale:"IgE binds to allergens and triggers mast cell degranulation."},{id:"quiz1_q18",text:"Lab most specific for SLE?",options:["CBC","Anti-dsDNA","CRP","Uric acid"],correctIndex:1,rationale:"Anti-dsDNA and Anti-Smith antibodies are highly specific for Lupus."},{id:"quiz1_q19",text:"Standard precautions apply to:",options:["Infected patients only","HIV patients only","All patients","Surgical patients only"],correctIndex:2,rationale:"Standard precautions are used universally for all patient care."},{id:"quiz1_q20",text:"Undetectable = Untransmittable (U=U) means:",options:["HIV is cured","Cannot transmit HIV sexually","Can stop medications","CD4 is restored"],correctIndex:1,rationale:"Sustained viral suppression prevents sexual transmission of HIV."},{id:"quiz1_q21",text:"Which immunity provides immediate, non-specific defense?",options:["Adaptive","Innate","Passive","Humoral"],correctIndex:1,rationale:"Innate immunity (barriers, inflammation, phagocytes) responds immediately."},{id:"quiz1_q22",text:"First-line DMARD for Rheumatoid Arthritis?",options:["Prednisone","Methotrexate","Ibuprofen","Tylenol"],correctIndex:1,rationale:"Methotrexate is the gold-standard DMARD to slow RA progression."},{id:"quiz1_q23",text:"PPE doffing order (removal)?",options:["Mask first","Gloves -> Gown -> Mask","Gown first","Random order"],correctIndex:1,rationale:"Remove most contaminated items (gloves) first, mask last."},{id:"quiz1_q24",text:"PEP (Post-Exposure Prophylaxis) must start within:",options:["1 week","72 hours","1 month","No time limit"],correctIndex:1,rationale:"PEP is most effective when started within 72 hours of HIV exposure."},{id:"quiz1_q25",text:"Neutrophils primarily fight which infections?",options:["Viral","Bacterial","Parasitic","Fungal"],correctIndex:1,rationale:"Neutrophils are first responders to bacterial infections."}]},{id:"day-to-be-wrong",title:"\u2696\ufe0f A Day to be Wrong",icon:(0,Bf.jsx)(h.A,{className:"w-6 h-6"}),description:"\ud83d\udd25\ud83d\udd25\ud83d\udd25\ud83d\udd25\ud83d\udd25 Every answer is wrong - pick the least dangerous",questions:wp.questions.map(e=>(0,s.A)((0,s.A)({},e),{},{chapter:"day-to-be-wrong",chapterId:"day-to-be-wrong",skill:e.skill||["CLINICAL_JUDGMENT"],bloom:e.bloom||"EVALUATE",difficulty:5}))}];function kp(e){let{onBackToHub:t,initialMode:n="study"}=e;const[i,o]=(0,r.useState)("menu"),[l,c]=(0,r.useState)(n),[u,f]=(0,r.useState)(()=>{const e=localStorage.getItem("rnMasteryStudyScores");return e?JSON.parse(e):{}}),[O,M]=(0,r.useState)(100),[j,D]=(0,r.useState)(null),[F,q]=(0,r.useState)([]),[U,V]=(0,r.useState)(0),[z,B]=(0,r.useState)(null),[H,G]=(0,r.useState)(!1),[W,K]=(0,r.useState)(0),[Y,Q]=(0,r.useState)(0),[J,X]=(0,r.useState)(0),[$,Z]=(0,r.useState)(0),[ee,te]=(0,r.useState)([]),[ne,re]=(0,r.useState)(!1),[ie,oe]=(0,r.useState)([]),[ae,le]=(0,r.useState)(null),[ce,ue]=(0,r.useState)(30),[de,he]=(0,r.useState)(0),[fe,pe]=(0,r.useState)(null),[me,ge]=(0,r.useState)(!1),[ye,ve]=(0,r.useState)([]),[be,xe]=(0,r.useState)(null),[we,Ie]=(0,r.useState)(0),[Ee,Ne]=(0,r.useState)(0),[Se,Te]=(0,r.useState)(0),[_e,Ce]=(0,r.useState)(100),[ke,Ae]=(0,r.useState)(!1),[Re,Pe]=(0,r.useState)([]),[Oe,Le]=(0,r.useState)([]),[Me,je]=(0,r.useState)(()=>{const e=localStorage.getItem("rnMasteryWeakness");return e?JSON.parse(e):{missedBySkill:{},missedByConcept:{},missedByBloom:{}}}),[De,Fe]=(0,r.useState)(()=>{const e=localStorage.getItem("rnMasteryConceptMissCount");return e?JSON.parse(e):{}}),[qe,Ue]=(0,r.useState)([]),[Ve,ze]=(0,r.useState)(!1),[Be,He]=(0,r.useState)(null),[Ge,We]=(0,r.useState)(()=>{const e=localStorage.getItem("rnMasteryRemediationCompleted");return e?JSON.parse(e):{}}),[Ke,Ye]=(0,r.useState)(()=>{const e=localStorage.getItem("rnMasteryQuestionHistory");return e?JSON.parse(e):{}}),[Qe,Je]=(0,r.useState)(0),[Xe,$e]=(0,r.useState)(null),[Ze,et]=(0,r.useState)({isolationRooms:1,emergencyPasses:1,providerCalls:1}),[tt,nt]=(0,r.useState)(0),[rt,it]=(0,r.useState)([]),[st,ot]=(0,r.useState)("solo"),[at,lt]=(0,r.useState)(""),[ct,ut]=(0,r.useState)([]),[dt,ht]=(0,r.useState)(!1),[ft,pt]=(0,r.useState)(1),[mt,gt]=(0,r.useState)([]),[vt,bt]=(0,r.useState)(!1),[xt,wt]=(0,r.useState)(null),[It,Et]=(0,r.useState)([]),[Nt,St]=(0,r.useState)(!1),[Tt,_t]=(0,r.useState)(""),[Ct,kt]=(0,r.useState)(()=>{const e=localStorage.getItem("rnMasteryAnalytics");return e?JSON.parse(e):{totalAttempts:0,correctCount:0,missedCount:0,confidenceStats:{sureCorrect:0,sureWrong:0,guessCorrect:0,guessWrong:0}}}),[At,Rt]=(0,r.useState)(null),[Pt,Ot]=(0,r.useState)(!1),[Lt,Mt]=(0,r.useState)(null),[jt,Dt]=(0,r.useState)(!1),[Ft,qt]=(0,r.useState)(null),[Ut,Vt]=(0,r.useState)(""),[zt,Bt]=(0,r.useState)(!1),[Ht,Gt]=(0,r.useState)([]),[Wt,Kt]=(0,r.useState)({connected:!!Lf&&!!Mf,authenticated:!1,initializing:!0});(0,r.useEffect)(()=>{(async()=>{if(Lf)try{const e=await mu(hc(Lf,"customChapters")),t=[];e.forEach(e=>{t.push((0,s.A)((0,s.A)({},e.data()),{},{id:e.id}))}),Pe(t)}catch(e){console.error("Error loading custom chapters:",e)}})();(async()=>{if(Lf)try{const e=(await mu(hc(Lf,"settings"))).docs.find(e=>"chapterAccess"===e.id);if(e){const t=e.data().unlocked||[];t.includes("day-to-be-wrong")||t.push("day-to-be-wrong"),Le(t)}else Le(["ch18","ch19","ch20","ch21","ch22","quiz1","day-to-be-wrong"])}catch(e){console.error("Error loading chapter locks:",e),Le(["ch18","ch19","ch20","ch21","ch22","quiz1","day-to-be-wrong"])}})()},[]),(0,r.useEffect)(()=>{if("ranked"!==l||"playing"!==i||H)return;const e=F[U],t=("day-to-be-wrong"===(null===j||void 0===j?void 0:j.id)&&null!==e&&void 0!==e&&e.timeLimit&&e.timeLimit,setInterval(()=>{ue(e=>e<=1?(clearInterval(t),en(z,"TIMEOUT"),0):e-1),he(e=>e+1)},1e3));return()=>clearInterval(t)},[l,i,H,U]),(0,r.useEffect)(()=>{if(!Mf||!Lf)return console.error("Firebase not initialized properly"),void Kt({connected:!1,authenticated:!1,initializing:!1});Kt({connected:!0,authenticated:!1,initializing:!0});const e=function(e,t,n,r){return se(e).onAuthStateChanged(t,n,r)}(Mf,async e=>{if(console.log("Auth state changed:",e?"User logged in: ".concat(e.uid):"No user"),qt(e),Kt({connected:!0,authenticated:!!e,initializing:!1}),e&&Lf)try{const t=$c(hc(Lf,"artifacts",_p,"public","data","scores"),function(e,t,n){const r=t,i=Yc("where",e);return Zc._create(i,r,n)}("uid","==",e.uid)),n=(await mu(t)).docs.map(e=>e.data().chapterTitle);Gt([...new Set(n)]),console.log("Loaded submitted chapters:",n)}catch(Fp){console.error("Error fetching submitted chapters:",Fp)}});return(async()=>{try{if(console.log("Starting auth initialization..."),"undefined"!==typeof window&&window.__initial_auth_token)console.log("Signing in with custom token"),await mh(Mf,window.__initial_auth_token);else{console.log("Attempting anonymous sign in...");const e=await async function(e){var t;if(yt(e.app))return Promise.reject(ku(e));const n=Ld(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new lh({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await ah(n,{returnSecureToken:!0}),i=await lh._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}(Mf);console.log("Anonymous sign in successful:",e.user.uid)}}catch(e){console.error("Auth initialization FAILED:",e),console.error("Error code:",e.code),console.error("Error message:",e.message),"auth/operation-not-allowed"===e.code?alert("\u26a0\ufe0f Anonymous authentication is disabled.\n\nPlease enable it in:\nFirebase Console \u2192 Authentication \u2192 Sign-in method \u2192 Anonymous \u2192 Enable"):alert("Authentication failed: "+e.message),Kt({connected:!0,authenticated:!1,initializing:!1})}})(),()=>e()},[]);const Yt=e=>{const t=u[e];return t&&t.percentage>=85},Qt=e=>{var t;return(null===(t=u[e])||void 0===t?void 0:t.percentage)||0},Jt=()=>{if("ranked"!==l||0===F.length)return null;const e=Math.round(J/F.length*40),t=we+Ee+$,n=t>0?Math.round((1*we+.5*Ee)/t*40):0,r=Se/F.length;let i=20;i=r<5?Math.round(10):r>25?Math.round(14):r>=10&&r<=20?20:Math.round(17);return{total:e+n+i,accuracy:e,rationale:n,time:i,avgTime:Math.round(r)}},Xt=function(e){const t=e.id||e.chapterId;if("day-to-be-wrong"===t)return void bt(!0);if("ranked"===l&&qe.length>0)return void alert("\u26a0\ufe0f Remediation Required\n\nYou must complete remediation for these concepts before accessing Rank Mode:\n\n".concat(qe.map(e=>"\u2022 ".concat(e)).join("\n"),'\n\nClick the "\ud83d\udcda Remediation" button to strengthen your understanding.'));if("ranked"===l&&!Yt(t)){const e=Qt(t);return void alert("\ud83d\udd12 Rank Mode Locked\n\nYou need 85% in Study Mode to unlock Rank Mode.\n\nCurrent Study Mode score: ".concat(e,"%\n\nComplete Study Mode first to demonstrate mastery!"))}let n=Qf(e.questions);if(0!==n.length){if("ranked"===l){const e=["APPLICATION","ANALYSIS","PRIORITIZATION","CLINICAL_JUDGMENT","EVALUATE","SYNTHESIS"],r=n.filter(t=>t.bloom&&e.some(e=>t.bloom.toUpperCase().includes(e)));n=r.length>=5?r:n;const i=n.filter(e=>{const t=(e=>{const t=Ke[e];if(!t||!t.lastAttempt)return{isRecent:!1};const n=new Date(t.lastAttempt),r=(Date.now()-n.getTime())/36e5;return{isRecent:r<24,hoursSince:Math.round(r),attemptCount:t.attemptCount||0}})(e.id);return!t.isRecent||t.attemptCount<3});if(i.length<5)return void alert("\u26a0\ufe0f Anti-Memorization Protection\n\nYou've recently attempted most questions in this chapter.\n\nWait 24 hours or try a different chapter to ensure valid assessment.");n=i,"day-to-be-wrong"!==t&&(n=n.map(e=>mp(e)))}D(e),q(n),V(0),K(0),Q(0),X(0),Z(0),te([]),ve([]),"ranked"===l&&(Ie(0),Ne(0),Te(0),Ce(100),Je(0)),o("playing"),$t(),"ranked"===l&&(ue(30),he(0))}else alert("No questions found for this chapter.")},$t=()=>{const e=F[U+1];if(B(null!==e&&void 0!==e&&e.isMultiSelect?[]:null),le(null),pe(null),ge(!1),xe(null),$e(null),"ranked"===l){const e=F[U+1],t="day-to-be-wrong"===(null===j||void 0===j?void 0:j.id)&&null!==e&&void 0!==e&&e.timeLimit?e.timeLimit:30;ue(t),he(0)}G(!1),Rt(null),re(!1),oe([])},Zt=()=>{if(ne||H)return;const e=F[U],t=Array.isArray(e.correctIndex)?e.correctIndex:[e.correctIndex],n=e.options.map((e,t)=>t).filter(e=>!t.includes(e)).sort(()=>Math.random()-.5).slice(0,2);oe(n),re(!0)},en=(e,t)=>{if(!F||0===F.length||U>=F.length)return void console.warn("\u26a0\ufe0f handleAnswer called but no valid question available");const n=F[U];if(!n)return void console.warn("\u26a0\ufe0f handleAnswer called but question is undefined");if(B(e),le(t),"TIMEOUT"!==t&&"ranked"===l&&n.requiresRationale&&!me)return void ge(!0);let r;if(n.isMultiSelect&&Array.isArray(n.correctIndex)){const t=Array.isArray(e)?e.sort((e,t)=>e-t):[],i=[...n.correctIndex].sort((e,t)=>e-t);r=t.length===i.length&&t.every((e,t)=>e===i[t])}else r=null!==e&&e===n.correctIndex;let i=0,a="";n.hardMode&&n.penalties&&(r?(i=10,de<.66*n.timeLimit&&(i+=5,a=" (+5 quick decision bonus)")):(i=n.penalties.wrong||-15,a=" (".concat(n.penalties.wrong," priority error)"),de>.75*n.timeLimit&&(i+=n.penalties.delayed||-5,a+=" (".concat(n.penalties.delayed," delayed)")),n.penalties.secondaryHarm&&null!==e&&(i+=n.penalties.secondaryHarm||-10,a+=" (".concat(n.penalties.secondaryHarm," secondary harm)"))));const c="day-to-be-wrong"===(null===j||void 0===j?void 0:j.id)||"day-to-be-wrong"===(null===j||void 0===j?void 0:j.chapterId);if(c&&n.consequences&&null!==e&&$e(n.consequences[e]||null),c&&n.requiresResource&&r){const e=n.requiresResource;console.log("\ud83d\udcb3 Resource check:",{resourceType:e,currentAmount:Ze[e],isCorrect:r}),Ze[e]>0?(console.log("\u2705 Consuming resource:",e),et((0,s.A)((0,s.A)({},Ze),{},{[e]:Ze[e]-1}))):console.log("\u26a0\ufe0f Resource already used:",e)}let u=!1;if("ranked"===l&&de<3&&(u=!0,Je(Qe+1)),"ranked"===l&&((e,t,n)=>{const r=(0,s.A)({},Ke);r[e]||(r[e]={attemptCount:0,lastAttempt:null,averageTime:0,correctCount:0});const i=r[e];i.attemptCount++,i.lastAttempt=(new Date).toISOString(),i.averageTime=(i.averageTime*(i.attemptCount-1)+t)/i.attemptCount,n&&i.correctCount++,Ye(r),localStorage.setItem("rnMasteryQuestionHistory",JSON.stringify(r))})(n.id,de,r),"ranked"===l){const t=[...ye,e].slice(-5);ve(t),xp(t)&&console.warn("Answer pattern detected - possible guessing")}let d=0,h=1,f=null,p=null;if("TIMEOUT"===t){if(Z($+1),Q(0),te([...ee,{question:n,selectedAnswer:e,questionNumber:U+1,timeSpent:"ranked"===l?de:null,selectedRationale:null,reason:"timeout"}]),n.skill||n.concept){const e=(0,s.A)({},Me),t=(0,s.A)({},De);Array.isArray(n.skill)&&n.skill.forEach(t=>{e.missedBySkill=e.missedBySkill||{},e.missedBySkill[t]=(e.missedBySkill[t]||0)+1}),n.concept&&(e.missedByConcept=e.missedByConcept||{},e.missedByConcept[n.concept]=(e.missedByConcept[n.concept]||0)+1,t[n.concept]=(t[n.concept]||0)+1,t[n.concept]>=2&&!Ge[n.concept]&&(qe.includes(n.concept)||Ue([...qe,n.concept])),Fe(t),localStorage.setItem("rnMasteryConceptMissCount",JSON.stringify(t))),n.bloom&&(e.missedByBloom=e.missedByBloom||{},e.missedByBloom[n.bloom]=(e.missedByBloom[n.bloom]||0)+1),je(e),localStorage.setItem("rnMasteryWeakness",JSON.stringify(e))}d=0}else if(r)if(X(J+1),c)d=de>45?3:10,Q(Y+1);else if("ranked"===l)if(n.requiresRationale&&null!==fe){const e=(m=fe,n.correctRationaleIndex,0===m?{score:100,tier:"correct"}:1===m?{score:50,tier:"weak"}:{score:0,tier:"incorrect"});f=e.score,p=e.tier,xe(p),"correct"===p?Ie(we+1):"weak"===p&&Ne(Ee+1),Te(Se+de),"incorrect"===p?(d=0,Q(0)):(d="SURE"===t?150:100,d+=50*Y,h=function(e,t){return e<3?.5:e<=15?1.3:e<=22?1:e<=t?.9:.7}(de,n.timeLimit||30),d=Math.round(d*h),"weak"===p&&(d=Math.round(.5*d)),u&&de<3&&(d=Math.round(.3*d)),xp(ye)&&(d=Math.round(.5*d)),Q(Y+1))}else d="SURE"===t?150:100,Q(Y+1);else Q(Y+1);else{if(Z($+1),Q(0),dt&&!r)return pt(0),K(W+d),G(!0),void setTimeout(()=>{alert("\ud83d\udc80 SUDDEN DEATH ELIMINATION!\n\nYou answered incorrectly on Question ".concat(U+1,".\n\nFinal Score: ").concat(W+d,"\nQuestions Survived: ").concat(U,"/").concat(F.length,"\n\nOnly the perfect survive in Sudden Death mode!")),o("summary")},2e3);if(c&&(d=-10),te([...ee,{question:n,selectedAnswer:e,questionNumber:U+1,timeSpent:"ranked"===l?de:null,selectedRationale:"ranked"===l?fe:null}]),n.skill||n.concept){const e=(0,s.A)({},Me),t=(0,s.A)({},De);Array.isArray(n.skill)&&n.skill.forEach(t=>{e.missedBySkill=e.missedBySkill||{},e.missedBySkill[t]=(e.missedBySkill[t]||0)+1}),n.concept&&(e.missedByConcept=e.missedByConcept||{},e.missedByConcept[n.concept]=(e.missedByConcept[n.concept]||0)+1,t[n.concept]=(t[n.concept]||0)+1,t[n.concept]>=2&&!Ge[n.concept]&&(qe.includes(n.concept)||Ue([...qe,n.concept])),Fe(t),localStorage.setItem("rnMasteryConceptMissCount",JSON.stringify(t))),n.bloom&&(e.missedByBloom=e.missedByBloom||{},e.missedByBloom[n.bloom]=(e.missedByBloom[n.bloom]||0)+1),je(e),localStorage.setItem("rnMasteryWeakness",JSON.stringify(e))}}var m;K(W+d);const g="SURE"===t?r?"sureCorrect":"sureWrong":r?"guessCorrect":"guessWrong",y=(0,s.A)((0,s.A)({},Ct),{},{totalAttempts:Ct.totalAttempts+1,correctCount:Ct.correctCount+(r?1:0),missedCount:Ct.missedCount+(r?0:1),confidenceStats:(0,s.A)((0,s.A)({},Ct.confidenceStats),{},{[g]:Ct.confidenceStats[g]+1})});if(kt(y),localStorage.setItem("rnMasteryAnalytics",JSON.stringify(y)),Ft&&Lf)try{const e=F[U];gu(hc(Lf,"artifacts",_p,"public","data","analytics"),{uid:Ft.uid,questionId:e.id,chapterTitle:j.title,isCorrect:r,confidence:t,timeSpent:"ranked"===l?de:null,timeMultiplier:"ranked"===l?h:null,rationaleCorrect:"ranked"===l&&e.requiresRationale?fe===(e.correctRationaleIndex||0):null,rationaleTier:"ranked"===l&&e.requiresRationale?p:null,timestamp:bu()}).catch(e=>console.error("Analytics save error:",e))}catch(Fp){console.error("Analytics error:",Fp)}if(G(!0),console.log("\ud83d\udd0d Escalation Check:",{isDayToBeWrong:c,isCorrect:r,confLevel:t,suddenDeathActive:dt,competitiveMode:st,questionId:n.id,activeChapter:(null===j||void 0===j?void 0:j.id)||(null===j||void 0===j?void 0:j.chapterId),triggeredEscalations:rt}),c&&!r&&"TIMEOUT"!==t&&!dt&&"solo"===st){const e=tn(n.id);if(console.log("\ud83d\udea8 Escalation triggered:",e),e&&!rt.includes(e)){console.log("\u2705 Inserting escalation into question queue:",e);const t=Ip[e];if(t){const e=[...F.slice(0,U+1),t,...F.slice(U+1)];console.log("\ud83d\udccb Questions updated from",F.length,"to",e.length),q(e)}it([...rt,e]),nt(tt+1)}}dt&&!r&&"TIMEOUT"!==t&&(console.log("\ud83d\udc80 SUDDEN DEATH: Wrong answer - Game Over"),setTimeout(()=>{alert("\ud83d\udc80 SUDDEN DEATH\n\nOne mistake ends it all.\n\nFinal Score: "+W),o("summary")},2e3)),"team"!==st||r||console.log("\ud83d\udc65 TEAM MODE: Wrong answer affects team score")},tn=e=>({ld_q01_mdro_moral_injury:"cdiff_outbreak",ld_q02_hiv_cd4_vs_viral_load:"hiv_crisis",ld_q04_priority_flip:"priority_code",ld_q05_needlestick_time:"needlestick_disaster"}[e]),nn=()=>{if(console.log("\ud83d\udd04 nextQuestion called, moving to question",U+1,"of",F.length),U<F.length-1){if(V(U+1),$t(),"ranked"===l&&U>0){const e=Math.round(J/(U+1)*100);if(M(e),e<70&&U>=4)return alert("\u26a0\ufe0f Performance Alert\n\nYour current Rank Mode score is ".concat(e,"%.\n\nReturning to Study Mode to strengthen your understanding.\n\nCome back when you're ready to score 85%+!")),o("menu"),void c("study")}}else{const e=Math.round(J/F.length*100);if(Ve&&Be){if(e>=80){const t=(0,s.A)((0,s.A)({},Ge),{},{[Be]:!0});We(t),localStorage.setItem("rnMasteryRemediationCompleted",JSON.stringify(t)),Ue(qe.filter(e=>e!==Be)),alert("\u2705 Remediation Complete!\n\nYou scored ".concat(e,"% on ").concat(Be,".\n\n").concat(qe.length>1?"Complete remaining remediation tasks to unlock Rank Mode.":"You can now access Rank Mode!"))}else alert("\ud83d\udcda Keep Practicing\n\nYou scored ".concat(e,"% on ").concat(Be," remediation.\n\nYou need 80% to complete remediation. Review the material and try again!"));return ze(!1),He(null),void o("menu")}if("study"===l&&j){const t=j.id||j.chapterId,n=(0,s.A)((0,s.A)({},u),{},{[t]:{percentage:e,correctCount:J,totalQuestions:F.length,timestamp:(new Date).toISOString()}});f(n),localStorage.setItem("rnMasteryStudyScores",JSON.stringify(n)),e>=85&&setTimeout(()=>{alert("\ud83c\udf89 Rank Mode Unlocked!\n\nYou scored ".concat(e,"% in Study Mode.\n\nYou can now attempt Rank Mode for this chapter!"))},1500)}e>=70&&(L({particleCount:100,spread:70,origin:{y:.6},colors:["#FFD700","#FFA500","#FF6B6B","#4ECDC4","#45B7D1"]}),100===e&&setTimeout(()=>{L({particleCount:150,spread:100,origin:{y:.5},colors:["#FFD700","#FFA500"]})},300)),o("summary")}},rn=async()=>{if(!({NODE_ENV:"production",PUBLIC_URL:"/Term-3-Gaming",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_GEMINI_API_KEY||""))return Rt("\ud83d\udca1 AI Tutor Feature\n\nTo enable AI-powered mnemonics and clinical pearls, set up a Google Gemini API key.\n\nGet your free API key at: https://aistudio.google.com/app/apikey\n\nFor now, review the rationale provided above to understand this concept!"),void Ot(!1);Ot(!0);const e=F[U],t='Context: Nursing Student Game - Clinical Pearls Focus. Question: "'.concat(e.text,'". Answer: "').concat(e.options[e.correctIndex],'". Rationale: "').concat(e.rationale,'". Task: Give a very short, memorable mnemonic AND a clinical pearl (real-world nursing insight) to help remember this concept in practice.'),n=await Tp(t);Rt(n),Ot(!1)},sn=async()=>{if(!({NODE_ENV:"production",PUBLIC_URL:"/Term-3-Gaming",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_GEMINI_API_KEY||""))return void Mt("\ud83d\udcda AI Study Guide Feature\n\nTo enable AI-generated study guides, you need to set up a Google Gemini API key:\n\n1. Get a free API key at: https://aistudio.google.com/app/apikey\n2. Add it to your .env file:\n   REACT_APP_GEMINI_API_KEY=your_key_here\n3. Rebuild and redeploy\n\nFor the deployed version, the instructor needs to add the API key directly to the code or use a backend service.\n\nIn the meantime, use the download feature to export your quiz results and create your own study guide!");Dt(!0);const e='Create a high-yield study guide for: "'.concat(j.title,'". Include key concepts, clinical pearls, and NCLEX-style tips. Keep it concise (300 words max).'),t=await Tp(e);Mt(t),Dt(!1)},on=()=>{if(!Lt)return;const e="AI STUDY GUIDE - ".concat(j.title,"\nGenerated: ").concat((new Date).toLocaleString(),"\n\n==============================================\nCHAPTER SUMMARY\n==============================================\n").concat(j.title,"\nScore: ").concat(W," | Accuracy: ").concat(Math.round(J/F.length*100),"%\nQuestions Correct: ").concat(J,"/").concat(F.length,"\n\n==============================================\nAI-GENERATED STUDY NOTES\n==============================================\n\n").concat(Lt,"\n\n==============================================\nMISSED QUESTIONS REVIEW\n==============================================\n\n").concat(ee.length>0?ee.map((e,t)=>"\nQuestion ".concat(e.questionNumber,":\n").concat(e.question.text,"\n\nYour Answer: ").concat(e.question.options[e.selectedAnswer],"\nCorrect Answer: ").concat(e.question.options[e.question.correctIndex],"\n\nRationale: ").concat(e.question.rationale,"\n\n---\n")).join("\n"):"No missed questions - Perfect score!","\n\n==============================================\n"),t=new Blob([e],{type:"text/plain"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="".concat(j.title.replace(/\s+/g,"_"),"_Study_Guide.txt"),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},an=async()=>{if(Ut.trim())if(Ft)if(Ht.includes(j.title))alert("You have already submitted a score for this chapter!");else{Bt(!0);try{const t=Jt();console.log("Saving score to leaderboard:",{playerName:Ut.trim(),score:W,chapterTitle:j.title,uid:Ft.uid,clinicalReasoningScore:null===t||void 0===t?void 0:t.total});const n={playerName:Ut.trim(),score:W,chapterTitle:j.title,rank:(e=W,e<1e3?"Novice":e<2e3?"Apprentice":e<3e3?"Expert RN":"Clinical Legend \ud83d\udc51"),timestamp:bu(),uid:Ft.uid};"day-to-be-wrong"===j.id&&(n.mode=st,n.escalationLevel=tt,n.resourcesPreserved=Object.values(Ze).reduce((e,t)=>e+t,0),"sudden-death"===st&&(n.survived=ft>0,n.questionsSurvived=J),"team"===st&&at&&(n.teamName=at)),"ranked"===l&&t&&(n.clinicalReasoningScore=t.total,n.crsAccuracy=t.accuracy,n.crsRationale=t.rationale,n.crsTime=t.time),await gu(hc(Lf,"artifacts",_p,"public","data","scores"),n),console.log("Score saved successfully!"),Gt([...Ht,j.title]),Bt(!1),alert("Score submitted successfully! \ud83c\udf89"),o("leaderboard")}catch(t){console.error("Error saving score:",t),alert("Failed to save score: ".concat(t.message,". Please check your internet connection and try again.")),Bt(!1)}var e}else alert("Authentication required. Please wait a moment and try again.");else alert("Please enter your name before submitting!")},ln=()=>(0,Bf.jsx)("div",{className:"min-h-screen bg-slate-900 text-white p-6 flex flex-col items-center justify-center font-sans",children:(0,Bf.jsxs)("div",{className:"max-w-5xl w-full animate-in fade-in zoom-in-95 duration-500",children:[t&&(0,Bf.jsxs)("button",{onClick:t,className:"mb-4 px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg flex items-center gap-2 transition",children:[(0,Bf.jsx)(p,{className:"w-4 h-4"}),"Back to Hub"]}),(0,Bf.jsxs)("header",{className:"text-center mb-8",children:[(0,Bf.jsxs)("h1",{className:"text-6xl font-black mb-2 tracking-tighter",children:[(0,Bf.jsx)("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-500",children:"RN"}),(0,Bf.jsx)("span",{className:"text-white",children:" MASTERY"})]}),(0,Bf.jsx)("p",{className:"text-slate-400 text-xl font-medium",children:"Classroom Edition v5.0"}),(0,Bf.jsxs)("div",{className:"flex justify-center mt-6 gap-4",children:[(0,Bf.jsxs)("button",{onClick:()=>c("study"),className:"px-6 py-2 rounded-full font-bold flex items-center transition-all ".concat("study"===l?"bg-emerald-500 text-white shadow-lg shadow-emerald-500/20":"bg-slate-800 text-slate-400 hover:text-white"),children:[(0,Bf.jsx)(m.A,{className:"w-4 h-4 mr-2"})," Study Mode"]}),(0,Bf.jsxs)("button",{onClick:()=>c("ranked"),className:"px-6 py-2 rounded-full font-bold flex items-center transition-all ".concat("ranked"===l?"bg-purple-600 text-white shadow-lg shadow-purple-500/20":"bg-slate-800 text-slate-400 hover:text-white"),children:[(0,Bf.jsx)(g.A,{className:"w-4 h-4 mr-2"})," Ranked Mode"]})]}),"ranked"===l&&(0,Bf.jsx)("p",{className:"text-slate-500 text-sm mt-3",children:"\ud83d\udd12 One-shot submission \u2022 High stakes scoring"})]}),qe.length>0&&"ranked"===l&&(0,Bf.jsx)("div",{className:"mb-6 p-5 bg-gradient-to-r from-red-900/30 to-orange-900/30 border-2 border-red-500/50 rounded-2xl",children:(0,Bf.jsxs)("div",{className:"flex items-start gap-4",children:[(0,Bf.jsx)("div",{className:"w-12 h-12 bg-red-500/20 rounded-full flex items-center justify-center flex-shrink-0",children:(0,Bf.jsx)(a.A,{className:"w-6 h-6 text-red-400"})}),(0,Bf.jsxs)("div",{className:"flex-1",children:[(0,Bf.jsx)("h3",{className:"text-xl font-bold text-red-300 mb-2",children:"\u26a0\ufe0f Remediation Required"}),(0,Bf.jsx)("p",{className:"text-red-200 text-sm mb-3",children:"You've missed these concepts multiple times. Complete remediation to unlock Rank Mode:"}),(0,Bf.jsx)("div",{className:"space-y-2",children:qe.map(e=>(0,Bf.jsxs)("div",{className:"flex items-center justify-between bg-slate-900/50 p-3 rounded-lg",children:[(0,Bf.jsx)("span",{className:"text-white font-semibold",children:e}),(0,Bf.jsx)("button",{onClick:()=>(e=>{const t=[...Cp,...Re].flatMap(e=>Qf(e.questions||[])).filter(t=>t.concept===e);if(0===t.length)return void alert("No questions found for concept: ".concat(e));const n=Math.min(5,Math.max(3,t.length)),r=t.sort(()=>Math.random()-.5).slice(0,n);ze(!0),He(e),q(r),V(0),K(0),Q(0),X(0),Z(0),te([]),o("playing"),$t(),alert("\ud83d\udcda Remediation: ".concat(e,"\n\nYou'll answer ").concat(n," questions to strengthen this concept.\n\nScore 80% or higher to complete remediation and unlock Rank Mode."))})(e),className:"px-4 py-2 bg-orange-600 hover:bg-orange-500 text-white rounded-lg font-bold text-sm transition-colors flex items-center gap-2",children:"\ud83d\udcda Start Remediation"})]},e))})]})]})}),(0,Bf.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Cp,...Re].filter(e=>"day-to-be-wrong"!==(e.id||e.chapterId)||"ranked"===l).map(e=>{var t;const n=e.id||e.chapterId,r=Ht.includes(e.title),i="day-to-be-wrong"!==n&&!Oe.includes(n),s=Yt(n),o=Qt(n),a=i||("day-to-be-wrong"===n?r:"ranked"===l&&(!s||r));return(0,Bf.jsxs)("button",{disabled:a,onClick:()=>Xt(e),className:"p-6 rounded-2xl border flex flex-col items-center text-center transition-all group relative overflow-hidden ".concat(a?"bg-slate-800/50 border-slate-700 opacity-50 cursor-not-allowed":"bg-slate-800 border-slate-700 hover:border-cyan-500 hover:bg-slate-750"),children:[r&&(0,Bf.jsxs)("div",{className:"absolute top-2 right-2 bg-green-500/20 text-green-400 px-2 py-1 rounded-full text-xs font-bold flex items-center",children:[(0,Bf.jsx)(y,{className:"w-3 h-3 mr-1"})," Ranked"]}),i&&(0,Bf.jsxs)("div",{className:"absolute top-2 left-2 bg-red-500/20 text-red-400 px-2 py-1 rounded-full text-xs font-bold flex items-center",children:[(0,Bf.jsx)(v,{className:"w-3 h-3 mr-1"})," Locked"]}),(0,Bf.jsx)("div",{className:"p-4 rounded-xl mb-4 transition-transform group-hover:scale-110 ".concat("ranked"===l?"bg-purple-500/20 text-purple-400":"bg-emerald-500/20 text-emerald-400"),children:e.icon}),(0,Bf.jsx)("h3",{className:"font-bold text-lg text-white",children:e.title}),(0,Bf.jsxs)("div",{className:"text-xs text-slate-400 mt-1",children:[(null===(t=e.questions)||void 0===t?void 0:t.length)||25," Questions"]}),"ranked"===l&&(0,Bf.jsx)("div",{className:"mt-2 text-xs",children:"day-to-be-wrong"===n?(0,Bf.jsx)("span",{className:"text-cyan-400 font-semibold",children:"\ud83d\udd25 Always Available"}):s?(0,Bf.jsxs)("span",{className:"text-green-400 font-semibold",children:["\u2713 Unlocked (",o,"%)"]}):(0,Bf.jsxs)("span",{className:"text-yellow-400 font-semibold",children:["\ud83d\udd12 Need 85% (",o,"%)"]})})]},n)})}),(0,Bf.jsxs)("div",{className:"mt-8 flex justify-center gap-4",children:[(0,Bf.jsxs)("button",{onClick:()=>o("leaderboard"),className:"text-slate-400 hover:text-white flex items-center text-sm transition",children:[(0,Bf.jsx)(b.A,{className:"w-4 h-4 mr-2"})," View Leaderboard"]}),(0,Bf.jsxs)("button",{onClick:()=>Ae(!0),className:"text-slate-400 hover:text-white flex items-center text-sm transition",children:[(0,Bf.jsx)(x,{className:"w-4 h-4 mr-2"})," Instructor Mode"]})]})]})}),cn=()=>{if("challenge"===st&&xt){const e=xt.getState(),t=e.phase,n=e.currentScenario;return n?t===Ep.JUDGE?(0,Bf.jsx)("div",{className:"min-h-screen bg-slate-900 text-white p-6",children:(0,Bf.jsx)(pp,{gameState:e,onJudge:e=>{xt.judge(e),wt((0,s.A)({},xt))},onReveal:()=>{xt.revealAndScore(),wt((0,s.A)({},xt))}})}):t===Ep.REVEAL?(0,Bf.jsx)("div",{className:"min-h-screen bg-slate-900 text-white p-6",children:(0,Bf.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,Bf.jsxs)("h2",{className:"text-3xl font-black mb-6",children:["\ud83d\udcca Round ",e.round," Results"]}),(0,Bf.jsxs)("div",{className:"mb-6 p-6 bg-green-900/30 border-2 border-green-500 rounded-xl",children:[(0,Bf.jsx)("h3",{className:"text-xl font-bold text-green-400 mb-3",children:"\u2705 Correct Answer"}),(0,Bf.jsx)("p",{className:"text-lg mb-3",children:n.choices[n.correctIndex]}),(0,Bf.jsx)("p",{className:"text-slate-300",children:n.rationaleCorrect})]}),(0,Bf.jsxs)("div",{className:"mb-6 p-6 bg-slate-800 rounded-xl",children:[(0,Bf.jsx)("h3",{className:"text-xl font-bold mb-4",children:"\ud83c\udfc6 Current Standings"}),(0,Bf.jsx)("div",{className:"space-y-3",children:e.teams.sort((e,t)=>t.score-e.score).map((e,t)=>(0,Bf.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-700 rounded-lg",children:[(0,Bf.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Bf.jsx)("span",{className:"text-2xl",children:["\ud83e\udd47","\ud83e\udd48","\ud83e\udd49","4\ufe0f\u20e3"][t]}),(0,Bf.jsx)("span",{className:"font-bold",children:e.name})]}),(0,Bf.jsx)("span",{className:"text-2xl font-mono font-bold",children:e.score})]},e.id))})]}),(0,Bf.jsx)("button",{onClick:()=>{e.round<Sp.length?(xt.nextScenario(),wt((0,s.A)({},xt))):o("summary")},className:"w-full py-4 bg-yellow-500 hover:bg-yellow-400 rounded-xl font-black text-xl text-slate-900 transition",children:e.round<Sp.length?"\u27a1\ufe0f Next Round":"\ud83c\udfc1 View Final Results"})]})}):(0,Bf.jsx)("div",{className:"min-h-screen bg-slate-900 text-white p-6",children:(0,Bf.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,Bf.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,Bf.jsxs)("div",{children:[(0,Bf.jsx)("h2",{className:"text-2xl font-black",children:"\u2694\ufe0f Challenge Mode"}),(0,Bf.jsxs)("p",{className:"text-slate-400",children:["Round ",e.round," / ",Sp.length]})]}),(0,Bf.jsx)("button",{onClick:()=>{window.confirm("Exit Challenge Mode? Progress will be lost.")&&(wt(null),St(!1),o("menu"))},className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition",children:"Exit"})]}),(0,Bf.jsx)("div",{className:"mb-6 p-4 bg-slate-800 rounded-xl",children:(0,Bf.jsx)("div",{className:"flex justify-around",children:e.teams.map(e=>(0,Bf.jsxs)("div",{className:"text-center",children:[(0,Bf.jsx)("div",{className:"font-bold",children:e.name}),(0,Bf.jsx)("div",{className:"text-2xl font-mono font-black",children:e.score})]},e.id))})}),(0,Bf.jsxs)("div",{className:"mb-6 p-6 bg-slate-800 rounded-xl",children:[(0,Bf.jsx)("h3",{className:"text-xl font-bold mb-4",children:n.prompt}),(0,Bf.jsx)("div",{className:"p-4 bg-slate-700 rounded-lg mb-4",children:(0,Bf.jsx)("p",{className:"text-slate-300",children:n.stem})}),t===Ep.QUESTION&&(0,Bf.jsxs)(Bf.Fragment,{children:[(0,Bf.jsx)("div",{className:"space-y-3 mb-6",children:n.choices.map((e,t)=>(0,Bf.jsxs)("div",{className:"w-full p-4 bg-slate-700 rounded-lg text-left",children:[(0,Bf.jsxs)("span",{className:"font-bold mr-3",children:[String.fromCharCode(65+t),"."]}),e]},t))}),(0,Bf.jsx)("div",{className:"text-center text-slate-400 text-sm",children:"\ud83d\udcf1 Teams: Submit your answers (simulated - click button below to proceed)"}),(0,Bf.jsx)("button",{onClick:()=>{xt.submitAnswer(e.teams[0].id,0),wt((0,s.A)({},xt))},className:"mt-4 w-full px-6 py-3 bg-blue-500 hover:bg-blue-400 rounded-lg font-bold transition",children:"Simulate Team Submissions (Testing)"})]}),t===Ep.ANSWER_LOCKED&&(0,Bf.jsxs)("div",{className:"text-center py-8",children:[(0,Bf.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\udd12"}),(0,Bf.jsx)("p",{className:"text-xl font-bold mb-2",children:"Answers Submitted"}),(0,Bf.jsx)("p",{className:"text-slate-400",children:"Instructor will open challenge window"}),(0,Bf.jsx)("button",{onClick:()=>{xt.openChallengeWindow(),wt((0,s.A)({},xt))},className:"mt-6 px-6 py-3 bg-yellow-500 hover:bg-yellow-400 rounded-lg font-bold text-slate-900 transition",children:"Open Challenge Window"})]}),t===Ep.CHALLENGE&&(0,Bf.jsxs)("div",{className:"text-center py-8",children:[(0,Bf.jsx)("div",{className:"text-4xl mb-4",children:"\u2694\ufe0f"}),(0,Bf.jsx)("p",{className:"text-xl font-bold mb-2",children:"Challenge Window Open"}),(0,Bf.jsx)("p",{className:"text-slate-400 mb-6",children:"Teams can submit challenges (simulated)"}),(0,Bf.jsx)("button",{onClick:()=>{xt.lockChallenges(),wt((0,s.A)({},xt))},className:"px-6 py-3 bg-red-500 hover:bg-red-400 rounded-lg font-bold transition",children:"Lock Challenges & Review"})]})]})]})}):(0,Bf.jsx)("div",{className:"min-h-screen bg-slate-900 text-white p-6 flex items-center justify-center",children:(0,Bf.jsxs)("div",{className:"text-center",children:[(0,Bf.jsx)("div",{className:"text-6xl mb-4",children:"\u2694\ufe0f"}),(0,Bf.jsx)("p",{className:"text-xl font-bold",children:"Loading Challenge Mode..."}),(0,Bf.jsxs)("p",{className:"text-sm text-slate-400 mt-2",children:["Debug: Phase = ",t]})]})})}if(!F||0===F.length||U>=F.length)return(0,Bf.jsx)("div",{className:"min-h-screen bg-slate-900 text-white p-6 flex items-center justify-center",children:(0,Bf.jsxs)("div",{className:"text-center",children:[(0,Bf.jsx)("div",{className:"text-4xl mb-4",children:"\u23f3"}),(0,Bf.jsx)("p",{className:"text-xl",children:"Loading questions..."})]})});const e=F[U],t=function(e){const{skill:t,concept:n}=e;return null!==t&&void 0!==t&&t.includes("TEACHING_ERROR")?"\ud83d\udca1 Exam Tip: 'Further teaching needed' = find the UNSAFE or INCORRECT statement.":null!==t&&void 0!==t&&t.includes("MED_SAFETY")?"\ud83d\udca1 Exam Tip: Medication questions are SAFETY questions. Think harm prevention first.":null!==t&&void 0!==t&&t.includes("PRIORITY")?"\ud83d\udca1 Exam Tip: Use ABC, Maslow, Safety first. Prevent harm > Comfort.":null!==t&&void 0!==t&&t.includes("SEQUENCING")?"\ud83d\udca1 Exam Tip: Follow proper order: Assessment before intervention, emergencies first.":null!==t&&void 0!==t&&t.includes("LAB_INTERPRETATION")?"\ud83d\udca1 Exam Tip: Know normal ranges. High/Low triggers action. Relate labs to symptoms.":null!==t&&void 0!==t&&t.includes("INFECTION_CONTROL")?"\ud83d\udca1 Exam Tip: Hand hygiene is #1. Know isolation types. PPE order matters.":"ANAPHYLAXIS"===n?"\ud83d\udca1 Exam Tip: Anaphylaxis = EPINEPHRINE first, always. Airway is life.":"C_DIFF"===n?"\ud83d\udca1 Exam Tip: C. diff = SOAP & WATER only. Alcohol doesn't kill spores.":"HIV_PROGRESSION"===n||"ANTIRETROVIRAL_THERAPY"===n?"\ud83d\udca1 Exam Tip: ART adherence >95%. Undetectable = Untransmittable (U=U).":"GOUT"===n?"\ud83d\udca1 Exam Tip: Gout = uric acid crystals. Colchicine for acute, Allopurinol prevents.":"RHEUMATOID_ARTHRITIS"===n?"\ud83d\udca1 Exam Tip: RA = symmetrical, morning stiffness >1hr, systemic. Methotrexate is gold standard.":"APPLICATION"===e.bloom?"\ud83d\udca1 Exam Tip: Application questions test your clinical judgment. Think 'What would I do?'":"\ud83d\udca1 Exam Tip: Read carefully, eliminate wrong answers, trust your nursing judgment."}(e);return(0,Bf.jsxs)("div",{className:"min-h-screen bg-slate-900 text-white flex flex-col font-sans",children:[(0,Bf.jsxs)("div",{className:"p-6 flex justify-between items-center border-b border-slate-800 bg-slate-900/90 backdrop-blur sticky top-0 z-10",children:[(0,Bf.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Bf.jsx)("button",{onClick:()=>o("menu"),className:"text-slate-400 hover:text-white transition",children:"Exit"}),Ve&&(0,Bf.jsxs)("div",{className:"px-3 py-1 rounded-full bg-orange-500/20 border border-orange-500 text-xs font-bold text-orange-300 flex items-center gap-2",children:["\ud83d\udcda Remediation: ",Be]}),e.concept&&!Ve&&(0,Bf.jsx)("div",{className:"px-3 py-1 rounded-full bg-slate-800 border border-slate-700 text-xs font-bold text-slate-300",children:e.concept.replace(/_/g," ")}),"ranked"===l&&!Ve&&(0,Bf.jsxs)("div",{className:"px-3 py-1 rounded-full border text-xs font-bold ".concat(ce<=10?"bg-red-500/20 border-red-500 text-red-400 animate-pulse":ce<=20?"bg-yellow-500/20 border-yellow-500 text-yellow-400":"bg-slate-800 border-slate-700 text-slate-300"),children:["\u23f1\ufe0f ",ce,"s"]}),dt&&(0,Bf.jsx)("div",{className:"px-3 py-1 rounded-full bg-red-500/30 border-2 border-red-500 text-xs font-bold text-red-300 flex items-center gap-2 animate-pulse",children:"\ud83d\udc80 SUDDEN DEATH - 1 LIFE"}),"team"===st&&at&&(0,Bf.jsxs)("div",{className:"px-3 py-1 rounded-full bg-purple-500/20 border border-purple-500 text-xs font-bold text-purple-300 flex items-center gap-2",children:["\ud83d\udc65 Team: ",at]}),("day-to-be-wrong"===(null===j||void 0===j?void 0:j.id)||"day-to-be-wrong"===(null===j||void 0===j?void 0:j.chapterId))&&!dt&&(0,Bf.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Bf.jsxs)("div",{className:"px-2 py-1 rounded-md border text-xs font-bold ".concat(Ze.isolationRooms>0?"bg-blue-500/20 border-blue-500 text-blue-300":"bg-slate-700/50 border-slate-600 text-slate-500 line-through"),children:["\ud83d\udeaa ISO: ",Ze.isolationRooms]}),(0,Bf.jsxs)("div",{className:"px-2 py-1 rounded-md border text-xs font-bold ".concat(Ze.emergencyPasses>0?"bg-red-500/20 border-red-500 text-red-300":"bg-slate-700/50 border-slate-600 text-slate-500 line-through"),children:["\ud83d\udea8 PASS: ",Ze.emergencyPasses]}),(0,Bf.jsxs)("div",{className:"px-2 py-1 rounded-md border text-xs font-bold ".concat(Ze.providerCalls>0?"bg-purple-500/20 border-purple-500 text-purple-300":"bg-slate-700/50 border-slate-600 text-slate-500 line-through"),children:["\ud83d\udcde MD: ",Ze.providerCalls]})]})]}),(0,Bf.jsxs)("div",{className:"flex items-center gap-6",children:[(0,Bf.jsxs)("div",{className:"flex items-center font-bold ".concat(Y>2?"text-orange-400 animate-pulse":"text-slate-500"),children:[(0,Bf.jsx)(w,{className:"w-5 h-5 mr-1"})," ",Y]}),(0,Bf.jsx)("div",{className:"font-mono text-xl font-black text-white",children:W})]})]}),(0,Bf.jsxs)("div",{className:"flex-1 max-w-3xl mx-auto w-full p-8 flex flex-col justify-center",children:[(0,Bf.jsxs)("div",{className:"mb-2 text-slate-500 text-sm font-bold",children:["Question ",U+1," / ",F.length,tt>0&&(0,Bf.jsxs)("span",{className:"ml-2 px-2 py-0.5 bg-red-500/20 border border-red-500 text-red-400 rounded text-xs font-bold",children:["\ud83d\udea8 ESCALATION LEVEL ",tt]})]}),e.requiresResource&&0===Ze[e.requiresResource]&&(0,Bf.jsx)("div",{className:"mb-4 p-4 bg-red-900/30 border-2 border-red-500 rounded-xl",children:(0,Bf.jsxs)("div",{className:"flex items-center gap-3 text-red-300",children:[(0,Bf.jsx)(a.A,{className:"w-5 h-5 shrink-0"}),(0,Bf.jsxs)("div",{className:"text-sm font-semibold",children:["\u26a0\ufe0f This question requires a ",(0,Bf.jsx)("span",{className:"font-bold",children:e.requiresResource.replace(/([A-Z])/g," $1").toUpperCase()})," but you've already used it! Choose the best alternative."]})]})}),(0,Bf.jsx)("h2",{className:"text-2xl md:text-3xl font-bold leading-relaxed mb-2",children:e.text}),e.isMultiSelect&&(0,Bf.jsx)("div",{className:"mb-6",children:(0,Bf.jsx)("span",{className:"text-sm font-semibold bg-purple-500/20 text-purple-300 px-3 py-1.5 rounded-full border border-purple-500/30 inline-block",children:"\u2713 SELECT ALL THAT APPLY"})}),e.scenario&&(0,Bf.jsx)("div",{className:"mb-6 p-4 bg-slate-800/50 border border-slate-700 rounded-xl",children:(0,Bf.jsx)("div",{className:"text-sm text-slate-300 whitespace-pre-line leading-relaxed",children:e.scenario})}),(0,Bf.jsx)("div",{className:"grid gap-3 mb-8",children:e.options.map((t,n)=>{if(ie.includes(n))return null;const r="string"===typeof t?t:String(t),i=e.isMultiSelect?Array.isArray(z)&&z.includes(n):z===n;let s="p-5 rounded-xl border-2 text-left font-medium transition-all w-full flex items-center ";if(H){s+=(e.isMultiSelect?Array.isArray(e.correctIndex)&&e.correctIndex.includes(n):n===e.correctIndex)?"bg-green-500/20 border-green-500 text-green-100":i?"bg-red-500/20 border-red-500 text-red-100":"bg-slate-800 border-slate-700 opacity-50"}else s+=i?"bg-cyan-500/20 border-cyan-500 text-white":"bg-slate-800 border-slate-700 hover:border-cyan-500 hover:bg-slate-750";const o="ranked"===l&&me;return(0,Bf.jsxs)("button",{disabled:H||o,onClick:()=>{if(!o)if(e.isMultiSelect){const e=Array.isArray(z)?z:[];e.includes(n)?B(e.filter(e=>e!==n)):B([...e,n])}else B(n)},className:s+(o?" cursor-not-allowed opacity-75":""),children:[(0,Bf.jsx)("div",{className:"w-8 h-8 rounded-".concat(e.isMultiSelect?"lg":"full"," bg-slate-700 flex items-center justify-center mr-4 text-sm font-bold text-slate-300 shrink-0 ").concat(i&&!H?"bg-cyan-500 text-white":""),children:e.isMultiSelect&&i?"\u2713":String.fromCharCode(65+n)}),r]},n)})}),H?(0,Bf.jsxs)("div",{className:"bg-slate-800 border border-slate-700 rounded-2xl p-6 animate-in fade-in zoom-in-95",children:[(0,Bf.jsxs)("div",{className:"flex items-start gap-4 mb-6",children:[z===e.correctIndex?(0,Bf.jsx)(y,{className:"w-8 h-8 text-green-400 shrink-0"}):(0,Bf.jsx)(E,{className:"w-8 h-8 text-red-400 shrink-0"}),(0,Bf.jsxs)("div",{className:"flex-1",children:[(0,Bf.jsx)("h3",{className:"text-lg font-bold mb-1 ".concat(z===e.correctIndex?"text-green-400":"text-red-400"),children:z===e.correctIndex?"Correct!":null===z?"Time's Up!":"Incorrect"}),"ranked"===l&&"TIMEOUT"===ae&&(0,Bf.jsx)("div",{className:"mb-3",children:(0,Bf.jsxs)("div",{className:"flex items-center gap-2 text-orange-400 text-sm bg-orange-500/10 border border-orange-500/30 rounded-lg p-3",children:[(0,Bf.jsx)(N,{className:"w-4 h-4"}),(0,Bf.jsx)("span",{className:"font-semibold",children:"\u23f1\ufe0f Time expired - No points awarded. Try to answer faster next time!"})]})}),Xe&&("day-to-be-wrong"===(null===j||void 0===j?void 0:j.id)||"day-to-be-wrong"===(null===j||void 0===j?void 0:j.chapterId))&&(0,Bf.jsx)("div",{className:"mb-4",children:(0,Bf.jsx)("div",{className:"p-4 rounded-xl border-2 ".concat(z===e.correctIndex?"bg-green-900/20 border-green-500/40 text-green-100":"bg-red-900/30 border-red-500/50 text-red-100"),children:(0,Bf.jsxs)("div",{className:"flex items-start gap-3",children:[(0,Bf.jsx)(h.A,{className:"w-5 h-5 shrink-0 mt-0.5"}),(0,Bf.jsxs)("div",{className:"flex-1",children:[(0,Bf.jsx)("div",{className:"text-xs font-bold uppercase tracking-wider mb-1 opacity-80",children:"Consequence"}),(0,Bf.jsx)("div",{className:"text-sm leading-relaxed whitespace-pre-line",children:Xe}),e.hardMode&&e.penalties&&z!==e.correctIndex&&(0,Bf.jsxs)("div",{className:"mt-3 pt-3 border-t border-red-500/30",children:[(0,Bf.jsx)("div",{className:"text-xs font-bold uppercase tracking-wider mb-2 text-red-200",children:"Penalty Breakdown:"}),(0,Bf.jsxs)("div",{className:"text-xs space-y-1",children:[(0,Bf.jsxs)("div",{children:["\u274c Wrong Priority: ",e.penalties.wrong," points"]}),de>.75*e.timeLimit&&(0,Bf.jsxs)("div",{children:["\u23f1\ufe0f Delayed Decision: ",e.penalties.delayed," points"]}),e.penalties.secondaryHarm&&(0,Bf.jsxs)("div",{children:["\u26a0\ufe0f Secondary Harm: ",e.penalties.secondaryHarm," points"]}),(0,Bf.jsxs)("div",{className:"pt-2 border-t border-red-500/20 font-bold text-red-300",children:["Total Impact: ",(e.penalties.wrong||0)+(de>.75*e.timeLimit&&e.penalties.delayed||0)+(e.penalties.secondaryHarm||0)," points"]})]})]}),e.requiresResource&&z===e.correctIndex&&(0,Bf.jsx)("div",{className:"mt-3 pt-3 border-t border-green-500/30",children:(0,Bf.jsxs)("div",{className:"flex items-center gap-2 text-xs font-bold text-green-300",children:[(0,Bf.jsx)(y,{className:"w-4 h-4"}),(0,Bf.jsxs)("span",{children:["Used: ",e.requiresResource.replace(/([A-Z])/g," $1").toUpperCase()]})]})})]})]})})}),"ranked"===l&&z===e.correctIndex&&"TIMEOUT"!==ae&&(0,Bf.jsx)("div",{className:"mb-3",children:de<3?(0,Bf.jsxs)("div",{className:"flex items-center gap-2 text-red-400 text-sm bg-red-500/10 border border-red-500/30 rounded-lg p-3",children:[(0,Bf.jsx)(a.A,{className:"w-4 h-4"}),(0,Bf.jsxs)("span",{className:"font-semibold",children:["\u26a0\ufe0f RUSH ANSWER! (",de,"s) - Severe 70% penalty applied. Read carefully!"]})]}):de<=15?(0,Bf.jsxs)("div",{className:"flex items-center gap-2 text-green-400 text-sm",children:[(0,Bf.jsx)(S.A,{className:"w-4 h-4"}),(0,Bf.jsxs)("span",{className:"font-semibold",children:["Excellent timing! (",de,"s) - Bonus points earned \ud83c\udfaf"]})]}):de<=22?(0,Bf.jsxs)("div",{className:"flex items-center gap-2 text-blue-400 text-sm",children:[(0,Bf.jsx)(T,{className:"w-4 h-4"}),(0,Bf.jsxs)("span",{className:"font-semibold",children:["Good pace (",de,"s) - Full points awarded"]})]}):de<=30?(0,Bf.jsxs)("div",{className:"flex items-center gap-2 text-orange-400 text-sm",children:[(0,Bf.jsx)(T,{className:"w-4 h-4"}),(0,Bf.jsxs)("span",{className:"font-semibold",children:["Close call (",de,"s) - Small time penalty"]})]}):(0,Bf.jsxs)("div",{className:"flex items-center gap-2 text-red-400 text-sm",children:[(0,Bf.jsx)(T,{className:"w-4 h-4"}),(0,Bf.jsxs)("span",{className:"font-semibold",children:["Overtime (",de,"s) - Score penalty applied"]})]})}),"ranked"===l&&be&&(0,Bf.jsx)("div",{className:"mb-3",children:"correct"===be?(0,Bf.jsxs)("div",{className:"flex items-center gap-2 text-green-400 text-sm bg-green-500/10 border border-green-500/30 rounded-lg p-3",children:[(0,Bf.jsx)(y,{className:"w-4 h-4"}),(0,Bf.jsx)("span",{className:"font-semibold",children:"Excellent reasoning! Full points for clinical judgment \u2713"})]}):"weak"===be?(0,Bf.jsxs)("div",{className:"flex items-center gap-2 text-yellow-400 text-sm bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-3",children:[(0,Bf.jsx)(a.A,{className:"w-4 h-4"}),(0,Bf.jsx)("span",{className:"font-semibold",children:"Partial credit - Reasoning shows surface understanding but lacks depth"})]}):(0,Bf.jsxs)("div",{className:"flex items-center gap-2 text-red-400 text-sm bg-red-500/10 border border-red-500/30 rounded-lg p-3",children:[(0,Bf.jsx)(E,{className:"w-4 h-4"}),(0,Bf.jsx)("span",{className:"font-semibold",children:"Incorrect reasoning - Zero points. Right answer requires right rationale!"})]})}),"ranked"===l&&be&&(0,Bf.jsx)("div",{className:"mb-3",children:"correct"===be?(0,Bf.jsxs)("div",{className:"flex items-center gap-2 text-green-400 text-sm bg-green-500/10 border border-green-500/30 rounded-lg p-3",children:[(0,Bf.jsx)(y,{className:"w-4 h-4"}),(0,Bf.jsx)("span",{className:"font-semibold",children:"Excellent reasoning! Full points for clinical judgment \u2713"})]}):"weak"===be?(0,Bf.jsxs)("div",{className:"flex items-center gap-2 text-yellow-400 text-sm bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-3",children:[(0,Bf.jsx)(a.A,{className:"w-4 h-4"}),(0,Bf.jsx)("span",{className:"font-semibold",children:"Partial credit - Reasoning shows surface understanding but lacks depth"})]}):(0,Bf.jsxs)("div",{className:"flex items-center gap-2 text-red-400 text-sm bg-red-500/10 border border-red-500/30 rounded-lg p-3",children:[(0,Bf.jsx)(E,{className:"w-4 h-4"}),(0,Bf.jsx)("span",{className:"font-semibold",children:"Incorrect reasoning - Zero points. Right answer requires right rationale!"})]})}),(0,Bf.jsx)("p",{className:"text-slate-300 leading-relaxed mb-4",children:e.rationale}),t&&(0,Bf.jsxs)("div",{className:"bg-blue-900/20 border border-blue-500/30 p-4 rounded-xl flex gap-3 items-start",children:[(0,Bf.jsx)(_,{className:"w-5 h-5 text-blue-400 shrink-0 mt-0.5"}),(0,Bf.jsxs)("div",{children:[(0,Bf.jsx)("div",{className:"text-xs font-bold text-blue-400 uppercase tracking-wider mb-1",children:"NCLEX Strategy"}),(0,Bf.jsx)("p",{className:"text-sm text-blue-200 font-medium",children:t})]})]})]})]}),(0,Bf.jsxs)("div",{className:"flex justify-between items-center pt-4 border-t border-slate-700",children:["ranked"!==l&&(0,Bf.jsx)(Bf.Fragment,{children:At?(0,Bf.jsxs)("div",{className:"text-sm text-purple-300 flex items-start",children:[(0,Bf.jsx)(k,{className:"w-3 h-3 mr-1 mt-0.5 shrink-0"}),(0,Bf.jsx)("span",{children:At})]}):(0,Bf.jsxs)("button",{onClick:rn,disabled:Pt,className:"text-sm text-purple-400 hover:text-purple-300 flex items-center transition",children:[Pt?(0,Bf.jsx)(C,{className:"w-4 h-4 mr-2 animate-spin"}):(0,Bf.jsx)(k,{className:"w-4 h-4 mr-2"}),"Get Mnemonic"]})}),"ranked"===l&&(0,Bf.jsx)("div",{})," ",(0,Bf.jsxs)("button",{onClick:nn,className:"px-6 py-3 bg-white text-slate-900 font-bold rounded-xl hover:bg-slate-200 transition-colors flex items-center ml-auto",children:["Next ",(0,Bf.jsx)(A,{className:"ml-2 w-4 h-4"})]})]})]}):(0,Bf.jsxs)(Bf.Fragment,{children:[me&&"ranked"===l&&e.rationaleOptions&&e.rationaleOptions.length>0&&(0,Bf.jsxs)("div",{className:"mb-6 p-6 bg-purple-900/20 border border-purple-500/30 rounded-xl",children:[(0,Bf.jsx)("h3",{className:"text-lg font-bold text-purple-300 mb-4",children:"Select Your Reasoning:"}),(0,Bf.jsx)("div",{className:"grid gap-2",children:e.rationaleOptions.map((e,t)=>(0,Bf.jsxs)("button",{onClick:()=>pe(t),className:"p-3 rounded-lg text-left text-sm border-2 transition-all ".concat(fe===t?"bg-purple-500/20 border-purple-500 text-white":"bg-slate-800 border-slate-700 hover:border-purple-500 text-slate-300"),children:[String.fromCharCode(65+t),". ",e]},t))})]}),(0,Bf.jsxs)("div",{className:"flex gap-4",children:["ranked"!==l&&(0,Bf.jsx)("button",{onClick:Zt,disabled:ne,className:"p-4 bg-slate-800 hover:bg-slate-700 text-purple-400 border border-slate-700 rounded-xl font-bold transition-all disabled:opacity-50 disabled:cursor-not-allowed",title:"50/50 Lifeline",children:(0,Bf.jsx)(I,{className:"w-6 h-6"})}),me&&null===fe?(0,Bf.jsx)("div",{className:"flex-1 py-4 bg-purple-600/20 border-2 border-purple-500 text-purple-300 rounded-xl font-bold text-center",children:"Select a rationale to continue"}):(0,Bf.jsxs)(Bf.Fragment,{children:[(0,Bf.jsx)("button",{onClick:()=>en(z,"GUESS"),disabled:e.isMultiSelect?!Array.isArray(z)||0===z.length:null===z,className:"flex-1 py-4 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded-xl font-bold transition-all disabled:opacity-50",children:"I'm Guessing \ud83e\udd14"}),(0,Bf.jsx)("button",{onClick:()=>en(z,"SURE"),disabled:e.isMultiSelect?!Array.isArray(z)||0===z.length:null===z,className:"flex-1 py-4 bg-blue-600 hover:bg-blue-500 text-white rounded-xl font-bold transition-all shadow-lg shadow-blue-900/20 disabled:opacity-50",children:"I'm Sure! \ud83d\ude80"})]})]})]})]})]})},un=()=>{const e=Math.round(J/F.length*100),t=Ht.includes(j.title),n=Jt();return(0,Bf.jsx)("div",{className:"min-h-screen bg-slate-900 text-white flex flex-col items-center justify-center p-6 font-sans",children:(0,Bf.jsxs)("div",{className:"max-w-md w-full bg-slate-800 border border-slate-700 rounded-3xl p-8 text-center shadow-2xl animate-in fade-in zoom-in-95",children:[(0,Bf.jsx)("div",{className:"w-20 h-20 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg shadow-orange-500/50",children:(0,Bf.jsx)(g.A,{className:"w-10 h-10 text-white"})}),(0,Bf.jsx)("h2",{className:"text-3xl font-black mb-2",children:"MODULE COMPLETE"}),(0,Bf.jsx)("div",{className:"text-slate-400 mb-8 font-bold",children:j.title}),(0,Bf.jsxs)("div",{className:"grid ".concat("ranked"===l?"grid-cols-3":"grid-cols-2"," gap-4 mb-8"),children:[(0,Bf.jsxs)("div",{className:"p-4 bg-slate-900 rounded-2xl border border-slate-700",children:[(0,Bf.jsx)("div",{className:"text-4xl font-black text-white",children:W}),(0,Bf.jsx)("div",{className:"text-xs font-bold text-slate-500 uppercase mt-1",children:"Score"})]}),(0,Bf.jsxs)("div",{className:"p-4 bg-slate-900 rounded-2xl border border-slate-700",children:[(0,Bf.jsxs)("div",{className:"text-4xl font-black ".concat(e>=80?"text-green-400":e>=70?"text-yellow-400":"text-orange-400"),children:[e,"%"]}),(0,Bf.jsx)("div",{className:"text-xs font-bold text-slate-500 uppercase mt-1",children:"Accuracy"})]}),"ranked"===l&&n&&(0,Bf.jsxs)("div",{className:"p-4 bg-gradient-to-br from-purple-900/30 to-blue-900/30 rounded-2xl border-2 border-purple-500/50",children:[(0,Bf.jsx)("div",{className:"text-4xl font-black ".concat(n.total>=80?"text-purple-300":n.total>=70?"text-blue-300":"text-slate-300"),children:n.total}),(0,Bf.jsx)("div",{className:"text-xs font-bold text-purple-400 uppercase mt-1",children:"CRS"})]})]}),"ranked"===l&&n&&(0,Bf.jsxs)("div",{className:"mb-6 p-4 bg-purple-900/10 border border-purple-500/30 rounded-xl",children:[(0,Bf.jsxs)("div",{className:"text-sm font-bold text-purple-300 mb-3 flex items-center justify-center gap-2",children:[(0,Bf.jsx)(d.A,{className:"w-4 h-4"}),"Clinical Reasoning Score Breakdown"]}),(0,Bf.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[(0,Bf.jsxs)("div",{className:"p-2 bg-slate-900/50 rounded-lg",children:[(0,Bf.jsxs)("div",{className:"font-bold text-green-400",children:[n.accuracy,"/40"]}),(0,Bf.jsx)("div",{className:"text-slate-400",children:"Accuracy"})]}),(0,Bf.jsxs)("div",{className:"p-2 bg-slate-900/50 rounded-lg",children:[(0,Bf.jsxs)("div",{className:"font-bold text-blue-400",children:[n.rationale,"/40"]}),(0,Bf.jsx)("div",{className:"text-slate-400",children:"Reasoning"})]}),(0,Bf.jsxs)("div",{className:"p-2 bg-slate-900/50 rounded-lg",children:[(0,Bf.jsxs)("div",{className:"font-bold text-purple-400",children:[n.time,"/20"]}),(0,Bf.jsx)("div",{className:"text-slate-400",children:"Timing"})]})]}),(0,Bf.jsxs)("div",{className:"text-xs text-slate-400 mt-2",children:["Avg time: ",n.avgTime,"s/question"]})]}),"ranked"===l&&Qe>=3&&(0,Bf.jsx)("div",{className:"mb-6 p-4 bg-red-900/20 border border-red-500/50 rounded-xl",children:(0,Bf.jsxs)("div",{className:"flex items-center gap-3 text-red-300",children:[(0,Bf.jsx)(a.A,{className:"w-5 h-5 flex-shrink-0"}),(0,Bf.jsxs)("div",{className:"text-sm",children:[(0,Bf.jsx)("div",{className:"font-bold mb-1",children:"\u26a0\ufe0f Anti-Memorization Alert"}),(0,Bf.jsxs)("div",{className:"text-red-200",children:["You rushed through ",Qe," questions (","<","3s each). Slow down and read carefully to demonstrate true understanding."]})]})]})}),(0,Bf.jsx)("div",{className:"mb-6",children:Lt?(0,Bf.jsxs)(Bf.Fragment,{children:[(0,Bf.jsxs)("div",{className:"bg-purple-900/20 border border-purple-500/30 p-4 rounded-xl text-left max-h-40 overflow-y-auto mb-3",children:[(0,Bf.jsx)("div",{className:"text-xs text-purple-300 font-bold mb-2",children:"AI STUDY NOTES:"}),(0,Bf.jsx)("p",{className:"text-sm text-slate-300 whitespace-pre-wrap",children:Lt})]}),(0,Bf.jsxs)("button",{onClick:on,className:"w-full py-3 bg-blue-600/20 border border-blue-500/50 text-blue-300 rounded-xl font-bold hover:bg-blue-600/30 transition-colors flex items-center justify-center",children:[(0,Bf.jsx)(R,{className:"w-4 h-4 mr-2"}),"\ud83d\udcbe Download Study Guide"]})]}):(0,Bf.jsxs)("button",{onClick:sn,disabled:jt,className:"w-full py-3 bg-purple-600/20 border border-purple-500/50 text-purple-300 rounded-xl font-bold hover:bg-purple-600/30 transition-colors flex items-center justify-center",children:[jt?(0,Bf.jsx)(C,{className:"w-4 h-4 mr-2 animate-spin"}):(0,Bf.jsx)(k,{className:"w-4 h-4 mr-2"}),"Generate Study Guide"]})}),"ranked"===l&&(0,Bf.jsxs)("div",{className:"mb-4",children:[(0,Bf.jsxs)("div",{className:"mb-3 flex items-center justify-center gap-2 text-xs",children:[(0,Bf.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(Wt.authenticated?"bg-green-400":Wt.initializing?"bg-yellow-400 animate-pulse":Wt.connected?"bg-yellow-400":"bg-red-400")}),(0,Bf.jsx)("span",{className:"text-slate-400",children:Wt.authenticated?"Ready to submit":Wt.initializing?"Connecting to server...":Wt.connected?"Authenticating...":"Offline - scores cannot be saved"})]}),t?(0,Bf.jsxs)("div",{className:"bg-yellow-500/10 border border-yellow-500/30 p-4 rounded-xl",children:[(0,Bf.jsx)(v,{className:"w-5 h-5 text-yellow-400 mx-auto mb-2"}),(0,Bf.jsx)("p",{className:"text-yellow-400 font-bold text-sm",children:"Score already submitted"})]}):(0,Bf.jsxs)("div",{className:"bg-slate-900 border border-slate-700 p-4 rounded-xl",children:[(0,Bf.jsx)("h3",{className:"text-white font-bold mb-3 text-sm",children:"Submit to Leaderboard"}),Wt.initializing&&(0,Bf.jsxs)("p",{className:"text-yellow-400 text-xs mb-2 flex items-center justify-center gap-2",children:[(0,Bf.jsx)(C,{className:"w-3 h-3 animate-spin"}),"Initializing connection..."]}),!Wt.authenticated&&!Wt.initializing&&Wt.connected&&(0,Bf.jsx)("p",{className:"text-yellow-400 text-xs mb-2",children:"\u23f3 Authenticating..."}),!Wt.connected&&(0,Bf.jsx)("p",{className:"text-red-400 text-xs mb-2",children:"\u26a0\ufe0f Not connected to server. Check your internet connection."}),(0,Bf.jsxs)("div",{className:"flex gap-2",children:[(0,Bf.jsx)("input",{type:"text",placeholder:"Your Name",value:Ut,onChange:e=>Vt(e.target.value),className:"flex-1 bg-slate-800 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-cyan-500 text-sm",disabled:!Wt.authenticated}),(0,Bf.jsx)("button",{onClick:an,disabled:zt||!Ut.trim()||!Wt.authenticated,className:"bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg px-4 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed transition",title:Wt.initializing?"Connecting...":Wt.authenticated?Ut.trim()?"Submit score":"Enter your name first":"Waiting for authentication...",children:zt?(0,Bf.jsx)(C,{className:"w-4 h-4 animate-spin"}):(0,Bf.jsx)(P,{className:"w-4 h-4"})})]})]})]}),(0,Bf.jsx)("button",{onClick:()=>o("menu"),className:"w-full py-4 bg-slate-700 hover:bg-slate-600 text-white font-bold rounded-xl transition-all",children:"Return to Menu"})]})})},dn=()=>{const[e,t]=(0,r.useState)([]),[n,i]=(0,r.useState)("all");(0,r.useEffect)(()=>{if(!Lf)return;var e;const n=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,s,o;e=se(e);let a={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||mc(n[l])||(a=n[l],l++);const c={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(mc(n[l])){const e=n[l];n[l]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[l+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),n[l+2]=null===(o=e.complete)||void 0===o?void 0:o.bind(e)}let u,d,h;if(e instanceof uc)d=ic(e.firestore,gc),h=ui(e._key.path),u={next:t=>{n[l]&&n[l](vu(d,e,t))},error:n[l+1],complete:n[l+2]};else{const t=ic(e,cc);d=ic(t.firestore,gc),h=t._query;const r=new pu(d);u={next:e=>{n[l]&&n[l](new hu(d,r,t,e))},error:n[l+1],complete:n[l+2]},Qc(e._query)}return function(e,t,n,r){const i=new Bl(r),s=new dl(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>il(await Jl(e),s)),()=>{i.Za(),e.asyncQueue.enqueueAndForget(async()=>sl(await Jl(e),s))}}(yc(d),h,c,u)}($c(hc(Lf,"artifacts",_p,"public","data","scores"),(sc("limit",e=100),ru._create("limit",e,"F"))),e=>{const n=e.docs.map(e=>(0,s.A)({id:e.id},e.data()));n.sort((e,t)=>t.score-e.score),t(n)});return()=>n()},[]);const a=(()=>{let t=e.filter(e=>"\u2696\ufe0f A Day to be Wrong"===e.chapterTitle);switch(n){case"safest-unit":return t.filter(e=>void 0!==e.escalationLevel).sort((e,t)=>e.escalationLevel===t.escalationLevel?t.score-e.score:e.escalationLevel-t.escalationLevel).slice(0,20);case"resource-master":return t.filter(e=>void 0!==e.resourcesPreserved).sort((e,t)=>e.resourcesPreserved===t.resourcesPreserved?t.score-e.score:t.resourcesPreserved-e.resourcesPreserved).slice(0,20);case"sudden-death":return t.filter(e=>"sudden-death"===e.mode&&!0===e.survived).sort((e,t)=>t.questionsSurvived-e.questionsSurvived).slice(0,20);default:return t.slice(0,50)}})();return(0,Bf.jsx)("div",{className:"min-h-screen bg-slate-900 text-white p-6 flex flex-col items-center font-sans",children:(0,Bf.jsxs)("div",{className:"max-w-4xl w-full",children:[(0,Bf.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,Bf.jsxs)("h2",{className:"text-3xl font-black flex items-center",children:[(0,Bf.jsx)(b.A,{className:"w-8 h-8 mr-3 text-yellow-400"})," LEADERBOARD"]}),(0,Bf.jsx)("button",{onClick:()=>o("menu"),className:"text-slate-400 hover:text-white transition",children:"Back"})]}),(0,Bf.jsxs)("div",{className:"mb-6 flex gap-3 flex-wrap",children:[(0,Bf.jsx)("button",{onClick:()=>i("all"),className:"px-4 py-2 rounded-lg font-bold text-sm transition ".concat("all"===n?"bg-cyan-500 text-white":"bg-slate-800 text-slate-400 hover:bg-slate-700"),children:"\ud83c\udfc6 All Scores"}),(0,Bf.jsx)("button",{onClick:()=>i("safest-unit"),className:"px-4 py-2 rounded-lg font-bold text-sm transition ".concat("safest-unit"===n?"bg-green-500 text-white":"bg-slate-800 text-slate-400 hover:bg-slate-700"),children:"\ud83d\udee1\ufe0f Safest Unit"}),(0,Bf.jsx)("button",{onClick:()=>i("resource-master"),className:"px-4 py-2 rounded-lg font-bold text-sm transition ".concat("resource-master"===n?"bg-blue-500 text-white":"bg-slate-800 text-slate-400 hover:bg-slate-700"),children:"\ud83d\udc8e Resource Master"}),(0,Bf.jsx)("button",{onClick:()=>i("sudden-death"),className:"px-4 py-2 rounded-lg font-bold text-sm transition ".concat("sudden-death"===n?"bg-red-500 text-white":"bg-slate-800 text-slate-400 hover:bg-slate-700"),children:"\ud83d\udc80 Sudden Death Survivors"})]}),(0,Bf.jsxs)("div",{className:"mb-4 p-4 bg-slate-800/50 border border-slate-700 rounded-xl text-sm text-slate-300",children:["all"===n&&"\ud83c\udfc6 Top scores across all game modes","safest-unit"===n&&"\ud83d\udee1\ufe0f Players who triggered the fewest escalations","resource-master"===n&&"\ud83d\udc8e Players who preserved the most resources","sudden-death"===n&&"\ud83d\udc80 Hall of Fame: Players who survived all 5 questions without a single mistake"]}),(0,Bf.jsx)("div",{className:"space-y-2",children:0===a.length?(0,Bf.jsxs)("div",{className:"text-center py-12 text-slate-400",children:[(0,Bf.jsx)("p",{className:"text-lg",children:"No scores yet in this category"}),(0,Bf.jsx)("p",{className:"text-sm mt-2",children:"Be the first to make the leaderboard!"})]}):a.map((e,t)=>(0,Bf.jsxs)("div",{className:"bg-slate-800 p-4 rounded-xl flex items-center border border-slate-700 hover:border-slate-600 transition",children:[(0,Bf.jsxs)("div",{className:"w-8 font-bold ".concat(0===t?"text-yellow-400":1===t?"text-slate-400":2===t?"text-orange-600":"text-slate-500"),children:["#",t+1]}),(0,Bf.jsxs)("div",{className:"flex-1 ml-4",children:[(0,Bf.jsxs)("div",{className:"font-bold text-white flex items-center gap-2",children:[e.playerName,"sudden-death"===e.mode&&(0,Bf.jsx)("span",{className:"text-red-400 text-xs",children:"\ud83d\udc80"}),"team"===e.mode&&(0,Bf.jsx)("span",{className:"text-purple-400 text-xs",children:"\ud83d\udc65"})]}),(0,Bf.jsxs)("div",{className:"text-xs text-slate-400 flex items-center gap-3 mt-1",children:[(0,Bf.jsx)("span",{children:e.chapterTitle}),"safest-unit"===n&&void 0!==e.escalationLevel&&(0,Bf.jsxs)("span",{className:"text-green-400",children:["\ud83d\udee1\ufe0f ",e.escalationLevel," escalations"]}),"resource-master"===n&&void 0!==e.resourcesPreserved&&(0,Bf.jsxs)("span",{className:"text-blue-400",children:["\ud83d\udc8e ",e.resourcesPreserved,"/3 resources"]}),"sudden-death"===n&&void 0!==e.questionsSurvived&&(0,Bf.jsxs)("span",{className:"text-red-400",children:["\ud83d\udc80 ",e.questionsSurvived,"/5 perfect"]})]})]}),(0,Bf.jsx)("div",{className:"text-cyan-400 font-mono font-bold text-lg",children:e.score})]},e.id))})]})})};if(ke)return(0,Bf.jsx)(up,{onExit:()=>{Ae(!1),Lf&&(mu(hc(Lf,"customChapters")).then(e=>{const t=[];e.forEach(e=>{t.push((0,s.A)((0,s.A)({},e.data()),{},{id:e.id}))}),Pe(t)}),mu(hc(Lf,"settings")).then(e=>{const t=e.docs.find(e=>"chapterAccess"===e.id);t&&Le(t.data().unlocked||[])}))}});const hn=()=>{const[e,t]=(0,r.useState)(""),[n,i]=(0,r.useState)(!1),s=t=>{var r;if("team"===t&&!n)return void i(!0);if("team"===t&&!e.trim())return void alert("Please enter a team name!");ot(t),"sudden-death"===t&&(ht(!0),pt(1)),"team"===t&&lt(e.trim());const s=Cp.find(e=>"day-to-be-wrong"===e.id),a=Qf(s.questions);D(s),q(a),V(0),K(0),Q(0),X(0),Z(0),te([]),ve([]),Je(0),$e(null),et({isolationRooms:1,emergencyPasses:1,providerCalls:1}),nt(0),it([]),bt(!1),o("playing"),$t(),null!==(r=a[0])&&void 0!==r&&r.timeLimit?ue(a[0].timeLimit):ue(60),he(0)};return(0,Bf.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white flex items-center justify-center p-6",children:(0,Bf.jsxs)("div",{className:"max-w-4xl w-full",children:[(0,Bf.jsx)("button",{onClick:()=>{bt(!1),o("menu")},className:"mb-6 text-slate-400 hover:text-white transition flex items-center",children:"\u2190 Back to Menu"}),(0,Bf.jsxs)("div",{className:"text-center mb-12",children:[(0,Bf.jsx)("div",{className:"text-6xl mb-4",children:"\u2696\ufe0f"}),(0,Bf.jsx)("h1",{className:"text-4xl font-black mb-3",children:"A Day to be Wrong"}),(0,Bf.jsx)("p",{className:"text-lg text-slate-300",children:"Choose Your Challenge Mode"})]}),n&&(0,Bf.jsxs)("div",{className:"mb-8 p-6 bg-purple-900/30 border-2 border-purple-500 rounded-2xl",children:[(0,Bf.jsx)("h3",{className:"text-xl font-bold mb-4 text-purple-300",children:"\ud83d\udc65 Enter Team Name"}),(0,Bf.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"e.g., Night Shift Warriors, Code Blue Crew",className:"w-full px-4 py-3 bg-slate-800 border border-purple-500 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-purple-400 mb-4",maxLength:30,autoFocus:!0}),(0,Bf.jsxs)("div",{className:"flex gap-3",children:[(0,Bf.jsx)("button",{onClick:()=>{i(!1),t("")},className:"flex-1 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg font-bold transition",children:"Cancel"}),(0,Bf.jsx)("button",{onClick:()=>s("team"),className:"flex-1 py-2 bg-purple-500 hover:bg-purple-400 rounded-lg font-bold transition",children:"Start Battle \u2192"})]})]}),(0,Bf.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,Bf.jsxs)("button",{onClick:()=>s("solo"),className:"bg-slate-800 border-2 border-cyan-500 rounded-2xl p-8 hover:bg-slate-750 transition-all group",children:[(0,Bf.jsx)("div",{className:"text-5xl mb-4",children:"\ud83c\udfaf"}),(0,Bf.jsx)("h3",{className:"text-2xl font-bold mb-3",children:"Solo Mission"}),(0,Bf.jsx)("p",{className:"text-slate-400 text-sm mb-4",children:"Full escalation system. Every mistake triggers a crisis."}),(0,Bf.jsxs)("div",{className:"text-xs text-slate-500 space-y-1",children:[(0,Bf.jsx)("div",{children:"\u2022 5 base questions"}),(0,Bf.jsx)("div",{children:"\u2022 Up to 4 escalations"}),(0,Bf.jsx)("div",{children:"\u2022 3 limited resources"}),(0,Bf.jsx)("div",{children:"\u2022 Maximum 9 questions"})]}),(0,Bf.jsx)("div",{className:"mt-6 px-4 py-2 bg-cyan-500/20 text-cyan-300 rounded-lg text-sm font-bold",children:"Classic Mode"})]}),(0,Bf.jsxs)("button",{onClick:()=>s("team"),className:"bg-slate-800 border-2 border-purple-500 rounded-2xl p-8 hover:bg-slate-750 transition-all group relative overflow-hidden",children:[(0,Bf.jsx)("div",{className:"absolute top-2 right-2 bg-purple-500 text-white px-2 py-1 rounded-full text-xs font-bold",children:"COMPETITIVE"}),(0,Bf.jsx)("div",{className:"text-5xl mb-4",children:"\ud83d\udc65"}),(0,Bf.jsx)("h3",{className:"text-2xl font-bold mb-3",children:"Team Relay"}),(0,Bf.jsx)("p",{className:"text-slate-400 text-sm mb-4",children:"Pass questions between teammates. Collaborate strategically!"}),(0,Bf.jsxs)("div",{className:"text-xs text-slate-500 space-y-1",children:[(0,Bf.jsx)("div",{children:"\u2022 2-4 players take turns"}),(0,Bf.jsx)("div",{children:"\u2022 Can pass tough questions"}),(0,Bf.jsx)("div",{children:"\u2022 Shared resource pool"}),(0,Bf.jsx)("div",{children:"\u2022 Team completion time"})]}),(0,Bf.jsx)("div",{className:"mt-6 px-4 py-2 bg-purple-500/20 text-purple-300 rounded-lg text-sm font-bold",children:"Multiplayer"})]}),(0,Bf.jsxs)("button",{onClick:()=>s("sudden-death"),className:"bg-slate-800 border-2 border-red-500 rounded-2xl p-8 hover:bg-slate-750 transition-all group relative overflow-hidden",children:[(0,Bf.jsx)("div",{className:"absolute top-2 right-2 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold animate-pulse",children:"EXTREME"}),(0,Bf.jsx)("div",{className:"text-5xl mb-4",children:"\ud83d\udc80"}),(0,Bf.jsx)("h3",{className:"text-2xl font-bold mb-3",children:"Sudden Death"}),(0,Bf.jsx)("p",{className:"text-slate-400 text-sm mb-4",children:"One mistake and you're out. Ultimate high-stakes challenge."}),(0,Bf.jsxs)("div",{className:"text-xs text-slate-500 space-y-1",children:[(0,Bf.jsx)("div",{children:"\u2022 1 life only"}),(0,Bf.jsx)("div",{children:"\u2022 No escalations"}),(0,Bf.jsx)("div",{children:"\u2022 Instant elimination"}),(0,Bf.jsx)("div",{children:"\u2022 Hall of survivors"})]}),(0,Bf.jsx)("div",{className:"mt-6 px-4 py-2 bg-red-500/20 text-red-300 rounded-lg text-sm font-bold",children:"Expert Only"})]}),(0,Bf.jsxs)("button",{onClick:()=>{St(!0),bt(!1)},className:"bg-slate-800 border-2 border-yellow-500 rounded-2xl p-8 hover:bg-slate-750 transition-all group relative overflow-hidden",children:[(0,Bf.jsx)("div",{className:"absolute top-2 right-2 bg-yellow-500 text-slate-900 px-2 py-1 rounded-full text-xs font-bold",children:"CLASSROOM"}),(0,Bf.jsx)("div",{className:"text-5xl mb-4",children:"\u2694\ufe0f"}),(0,Bf.jsx)("h3",{className:"text-2xl font-bold mb-3",children:"Challenge Mode"}),(0,Bf.jsx)("p",{className:"text-slate-400 text-sm mb-4",children:"Team battle with trap challenges. Instructor judges disputes."}),(0,Bf.jsxs)("div",{className:"text-xs text-slate-500 space-y-1",children:[(0,Bf.jsx)("div",{children:"\u2022 2-4 teams compete"}),(0,Bf.jsx)("div",{children:"\u2022 Challenge wrong answers"}),(0,Bf.jsx)("div",{children:"\u2022 Explain the trap"}),(0,Bf.jsx)("div",{children:"\u2022 Instructor decides"})]}),(0,Bf.jsx)("div",{className:"mt-6 px-4 py-2 bg-yellow-500/20 text-yellow-300 rounded-lg text-sm font-bold",children:"Instructor-Led"})]})]}),(0,Bf.jsx)("div",{className:"mt-8 text-center text-sm text-slate-400",children:(0,Bf.jsx)("p",{children:"\ud83d\udca1 Tip: Start with Solo Mode to learn the mechanics before trying competitive modes"})})]})})},fn=()=>{const e=()=>{Tt.trim()?It.length>=4?alert("Maximum 4 teams allowed!"):(Et([...It,{id:"team-".concat(Date.now()),name:Tt.trim()}]),_t("")):alert("Please enter a team name!")};return(0,Bf.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-yellow-900 to-slate-900 text-white flex items-center justify-center p-6",children:(0,Bf.jsxs)("div",{className:"max-w-3xl w-full",children:[(0,Bf.jsx)("button",{onClick:()=>{St(!1),bt(!0)},className:"mb-6 text-slate-400 hover:text-white transition flex items-center",children:"\u2190 Back to Mode Select"}),(0,Bf.jsxs)("div",{className:"text-center mb-8",children:[(0,Bf.jsx)("div",{className:"text-6xl mb-4",children:"\u2694\ufe0f"}),(0,Bf.jsx)("h1",{className:"text-4xl font-black mb-3",children:"Challenge Mode Lobby"}),(0,Bf.jsx)("p",{className:"text-lg text-slate-300",children:"Set up teams for competitive battle"})]}),(0,Bf.jsxs)("div",{className:"mb-6 p-6 bg-yellow-900/30 border-2 border-yellow-500 rounded-2xl",children:[(0,Bf.jsx)("h3",{className:"text-xl font-bold mb-4 text-yellow-300",children:"\u2795 Add Team"}),(0,Bf.jsxs)("div",{className:"flex gap-3",children:[(0,Bf.jsx)("input",{type:"text",value:Tt,onChange:e=>_t(e.target.value),onKeyPress:t=>"Enter"===t.key&&e(),placeholder:"Team name (e.g., Code Blue Crew)",className:"flex-1 px-4 py-3 bg-slate-800 border border-yellow-500 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-yellow-400",maxLength:30}),(0,Bf.jsx)("button",{onClick:e,className:"px-6 py-3 bg-yellow-500 hover:bg-yellow-400 rounded-lg font-bold transition text-slate-900",children:"Add Team"})]})]}),(0,Bf.jsxs)("div",{className:"mb-6 p-6 bg-slate-800 rounded-2xl",children:[(0,Bf.jsxs)("h3",{className:"text-xl font-bold mb-4 flex items-center justify-between",children:[(0,Bf.jsxs)("span",{children:["\ud83d\udc65 Teams (",It.length,"/4)"]}),It.length>=2&&(0,Bf.jsx)("span",{className:"text-sm text-green-400",children:"\u2713 Ready to start"})]}),0===It.length?(0,Bf.jsx)("p",{className:"text-slate-400 text-center py-8",children:"No teams yet. Add at least 2 teams to begin."}):(0,Bf.jsx)("div",{className:"space-y-3",children:It.map((e,t)=>(0,Bf.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-700 rounded-lg",children:[(0,Bf.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Bf.jsx)("div",{className:"text-2xl",children:["\ud83d\udd34","\ud83d\udd35","\ud83d\udfe2","\ud83d\udfe1"][t]}),(0,Bf.jsx)("span",{className:"font-bold text-lg",children:e.name})]}),(0,Bf.jsx)("button",{onClick:()=>{return t=e.id,void Et(It.filter(e=>e.id!==t));var t},className:"px-3 py-1 text-sm bg-red-500/20 text-red-400 hover:bg-red-500/30 rounded transition",children:"Remove"})]},e.id))})]}),(0,Bf.jsx)("button",{onClick:()=>{if(It.length<2)return void alert("At least 2 teams required!");const e=function(){let{teams:e=[],scenarios:t=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Array.isArray(e)||e.length<2)throw new Error("Challenge mode needs at least 2 teams.");if(!Array.isArray(t)||0===t.length)throw new Error("No scenarios provided.");const n={phase:Ep.LOBBY,round:0,scenarioIndex:-1,teams:e.map(e=>({id:e.id,name:e.name,score:0})),currentScenario:null,submissions:{},challenges:[],judgeDecision:null};function r(e){const t=n.teams.find(t=>t.id===e);if(!t)throw new Error("Unknown teamId: ".concat(e));return t}function i(){var e,t;let{allowReveal:r=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=n.currentScenario,o=i?(0,s.A)({id:i.id,title:i.title?Np(i.title):"",prompt:i.prompt,stem:i.stem,choices:i.choices,difficulty:null!==(e=i.difficulty)&&void 0!==e?e:1,timerSeconds:null!==(t=i.timerSeconds)&&void 0!==t?t:60},r?{correctIndex:i.correctIndex,rationaleCorrect:Np(i.rationaleCorrect||""),rationaleWrong:Array.isArray(i.rationaleWrong)?i.rationaleWrong.map(Np):[],consequenceIfWrong:Np(i.consequenceIfWrong||"")}:{}):null;return{phase:n.phase,round:n.round,scenarioIndex:n.scenarioIndex,teams:n.teams.map(e=>(0,s.A)({},e)),currentScenario:o,submissions:(0,s.A)({},n.submissions),challenges:n.challenges.map(e=>(0,s.A)({},e)),judgeDecision:n.judgeDecision?(0,s.A)({},n.judgeDecision):null}}return{getState:()=>i({allowReveal:n.phase===Ep.REVEAL}),nextScenario:function(){n.round+=1,n.scenarioIndex=(n.scenarioIndex+1)%t.length;const e=t[n.scenarioIndex],r=(0,s.A)((0,s.A)({},e),{},{prompt:Np(e.prompt),stem:Np(e.stem),choices:(e.choices||[]).map(e=>Np(e))});return n.currentScenario=r,n.submissions={},n.challenges=[],n.judgeDecision=null,n.phase=Ep.QUESTION,i()},submitAnswer:function(e,t){if(![Ep.QUESTION,Ep.ANSWER_LOCKED].includes(n.phase))throw new Error("Cannot submit during phase ".concat(n.phase));const r=n.currentScenario;if(!r)throw new Error("No active scenario.");if("number"!==typeof t||t<0||t>=r.choices.length)throw new Error("Invalid choiceIndex.");if(n.submissions[e])throw new Error("This team already submitted.");return n.submissions[e]={choiceIndex:t,submittedAt:Date.now()},n.phase=Ep.ANSWER_LOCKED,i()},openChallengeWindow:function(){if(n.phase!==Ep.ANSWER_LOCKED)throw new Error("Challenge window can open only after at least one submission.");return n.phase=Ep.CHALLENGE,i()},challengeAnswer:function(e){let{challengerTeamId:t,targetTeamId:r,trapText:s,alternativeIndex:o}=e;if(n.phase!==Ep.CHALLENGE)throw new Error("Cannot challenge during phase ".concat(n.phase));if(t===r)throw new Error("Cannot challenge your own team.");if(!n.submissions[r])throw new Error("Target team has not submitted.");const a=n.currentScenario;if(!a)throw new Error("No active scenario.");const l=Np(s);if(!l||l.length<5)throw new Error("Trap explanation is too short.");if("number"!==typeof o||o<0||o>=a.choices.length)throw new Error("Invalid alternativeIndex.");if(n.challenges.find(e=>e.challengerTeamId===t&&e.targetTeamId===r))throw new Error("This challenge already exists.");return n.challenges.push({challengerTeamId:t,targetTeamId:r,trapText:l,alternativeIndex:o,createdAt:Date.now()}),i()},lockChallenges:function(){if(n.phase!==Ep.CHALLENGE)throw new Error("Not in challenge phase.");return n.phase=Ep.JUDGE,i()},judge:function(e){let{type:t,challengerTeamId:r,targetTeamId:s,note:o=""}=e;if(n.phase!==Ep.JUDGE)throw new Error("Cannot judge during phase ".concat(n.phase));return n.judgeDecision={type:t,challengerTeamId:r,targetTeamId:s,note:Np(o)},i()},revealAndScore:function(){if(![Ep.JUDGE,Ep.ANSWER_LOCKED].includes(n.phase))throw new Error("Reveal allowed after judge, or after answer lock if you skip challenges.");const e=n.currentScenario;if(!e)throw new Error("No active scenario.");const t=10,s=-10,o=8,a=-5,l=0,c=e.correctIndex,u=e=>{var t;return(null===(t=n.submissions[e])||void 0===t?void 0:t.choiceIndex)===c};for(const i of Object.keys(n.submissions))r(i).score+=u(i)?t:s;const d=n.judgeDecision;if("CHALLENGE_SUCCESS"===(null===d||void 0===d?void 0:d.type)&&d.challengerTeamId&&d.targetTeamId){r(d.challengerTeamId).score+=o;const e=r(d.targetTeamId);n.submissions[d.targetTeamId]&&u(d.targetTeamId)&&(e.score-=t,e.score+=l)}else"CHALLENGE_FAIL"===(null===d||void 0===d?void 0:d.type)&&d.challengerTeamId?r(d.challengerTeamId).score+=a:null===d||void 0===d||d.type;return n.phase=Ep.REVEAL,i({allowReveal:!0})}}}({teams:It,scenarios:Sp});console.log("\ud83c\udfae Challenge game created:",e),e.nextScenario(),console.log("\ud83c\udfae First scenario loaded, state:",e.getState()),wt(e),ot("challenge"),St(!1),o("playing"),console.log("\ud83c\udfae Challenge Mode started!")},disabled:It.length<2,className:"w-full py-4 rounded-xl font-black text-xl transition ".concat(It.length>=2?"bg-yellow-500 hover:bg-yellow-400 text-slate-900":"bg-slate-700 text-slate-500 cursor-not-allowed"),children:It.length<2?"Need at least 2 teams":"\u2694\ufe0f Start Challenge Battle"}),(0,Bf.jsxs)("div",{className:"mt-6 p-4 bg-slate-800/50 rounded-lg text-sm text-slate-400",children:[(0,Bf.jsx)("p",{className:"font-bold text-slate-300 mb-2",children:"How Challenge Mode Works:"}),(0,Bf.jsxs)("ul",{className:"space-y-1 list-disc list-inside",children:[(0,Bf.jsx)("li",{children:"Each round shows a clinical scenario with 4 answer choices"}),(0,Bf.jsx)("li",{children:"All teams submit their answers simultaneously (hidden from others)"}),(0,Bf.jsx)("li",{children:"Teams can challenge opponents' answers by explaining the trap"}),(0,Bf.jsx)("li",{children:"Instructor reviews challenges and makes final judgments"}),(0,Bf.jsx)("li",{children:"Points: +10 correct, -10 wrong, +8 challenge success, -5 challenge fail"})]})]})]})})};return Nt?(0,Bf.jsx)(fn,{}):vt?(0,Bf.jsx)(hn,{}):"menu"===i?(0,Bf.jsx)(ln,{}):"playing"===i?(0,Bf.jsx)(cn,{}):"summary"===i?(0,Bf.jsx)(un,{}):"leaderboard"===i?(0,Bf.jsx)(dn,{}):(0,Bf.jsx)(ln,{})}const Ap=(0,f.A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var Rp=n(837);const Pp=[{id:"ch18",title:"Ch 18: Immune Assessment",description:"Anatomy, function, and assessment.",iconName:"Shield"},{id:"ch19",title:"Ch 19: Immune Disorders",description:"Hypersensitivities & Autoimmunity.",iconName:"AlertCircle"},{id:"ch20",title:"Ch 20: Connective Tissue",description:"RA, Lupus, Gout, Scleroderma.",iconName:"Bone"},{id:"ch21",title:"Ch 21: MDROs",description:"Transmission & Infection Control.",iconName:"Bug"},{id:"ch22",title:"Ch 22: HIV/AIDS",description:"Etiology, Progression, Management.",iconName:"Activity"},{id:"quiz1",title:"Review for Quiz 1",description:"Mixed Review: Chapters 18-22.",iconName:"Brain"},{id:"day-to-be-wrong",title:"\u2696\ufe0f A Day to be Wrong",description:"\ud83d\udd25\ud83d\udd25\ud83d\udd25\ud83d\udd25\ud83d\udd25 Every answer is wrong - pick the least dangerous",iconName:"Scale"}];function Op(){if(console.log("chapterManager: getChapterMetadata called"),console.log("chapterManager: chaptersConfig type:",typeof Pp),console.log("chapterManager: chaptersConfig isArray:",Array.isArray(Pp)),console.log("chapterManager: chaptersConfig value:",Pp),!Pp||!Array.isArray(Pp))return console.warn("Chapters config not loaded"),[];const e=Pp.map(e=>(0,s.A)((0,s.A)({},e),{},{IconComponent:(0,Rp.sW)(e.iconName)}));return console.log("chapterManager: Returning chapters:",e),e}function Lp(e){let{onSelectGame:t,onSettings:i,userName:o}=e;const[a,l]=(0,r.useState)([]),[c,u]=(0,r.useState)([]),[d,h]=(0,r.useState)(0),[f,m]=(0,r.useState)(null),[g,y]=(0,r.useState)(!0),[v,b]=(0,r.useState)(null);(0,r.useEffect)(()=>{w()},[]);const w=async()=>{try{y(!0);const{getCategories:e,getAllGames:t,getGamesByCategory:r}=await Promise.resolve().then(n.bind(n,837)),i=(e()||[]).map(e=>(0,s.A)((0,s.A)({},e),{},{games:r(e.id)}));l(i);const o=t();u(o||[]);const a=Op();h((null===a||void 0===a?void 0:a.length)||0),y(!1)}catch(e){console.error("Error loading hub:",e),b(e.message),y(!1)}};f&&c.filter(e=>e.category===f);return g?(0,Bf.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 text-white flex items-center justify-center",children:(0,Bf.jsxs)("div",{className:"text-center",children:[(0,Bf.jsx)("div",{className:"inline-block animate-spin rounded-full h-16 w-16 border-4 border-white border-t-transparent mb-4"}),(0,Bf.jsx)("p",{className:"text-xl",children:"Loading Hub..."})]})}):v?(0,Bf.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-red-900 via-purple-900 to-pink-900 text-white flex items-center justify-center p-6",children:(0,Bf.jsxs)("div",{className:"max-w-2xl bg-red-800/50 backdrop-blur p-8 rounded-lg",children:[(0,Bf.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"\u26a0\ufe0f Error Loading Hub"}),(0,Bf.jsx)("p",{className:"mb-4 text-lg",children:v}),(0,Bf.jsx)("button",{onClick:w,className:"px-6 py-3 bg-white text-red-900 rounded-lg hover:bg-gray-100 font-semibold",children:"Try Again"})]})}):(0,Bf.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 text-white",children:[(0,Bf.jsx)("div",{className:"bg-black/30 backdrop-blur-sm border-b border-white/10",children:(0,Bf.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-4 flex items-center justify-between",children:[(0,Bf.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Bf.jsx)(p,{className:"w-8 h-8"}),(0,Bf.jsxs)("div",{children:[(0,Bf.jsx)("h1",{className:"text-2xl font-bold",children:"Nursing Education Hub"}),(0,Bf.jsx)("p",{className:"text-sm text-white/70",children:"Choose your learning path"})]})]}),(0,Bf.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Bf.jsxs)("div",{className:"text-right",children:[(0,Bf.jsx)("p",{className:"text-sm text-white/70",children:"Chapters Available"}),(0,Bf.jsx)("p",{className:"text-2xl font-bold",children:d})]}),o&&(0,Bf.jsxs)("div",{className:"flex items-center gap-2 bg-white/10 px-4 py-2 rounded-lg",children:[(0,Bf.jsx)(Ap,{className:"w-5 h-5"}),(0,Bf.jsx)("span",{children:o})]}),(0,Bf.jsx)("button",{onClick:i,className:"p-2 hover:bg-white/10 rounded-lg transition",children:(0,Bf.jsx)(x,{className:"w-6 h-6"})})]})]})}),(0,Bf.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-12",children:[(0,Bf.jsxs)("div",{className:"flex gap-3 mb-8 overflow-x-auto pb-2",children:[(0,Bf.jsx)("button",{onClick:()=>m(null),className:"px-6 py-2 rounded-full font-semibold whitespace-nowrap transition ".concat(null===f?"bg-white text-purple-900":"bg-white/10 hover:bg-white/20"),children:"All Games"}),a.map(e=>(0,Bf.jsxs)("button",{onClick:()=>m(e.id),className:"px-6 py-2 rounded-full font-semibold whitespace-nowrap transition flex items-center gap-2 ".concat(f===e.id?"bg-white text-purple-900":"bg-white/10 hover:bg-white/20"),children:[(0,Bf.jsx)(e.IconComponent,{className:"w-4 h-4"}),e.title]},e.id))]}),a.filter(e=>!f||e.id===f).map(e=>(0,Bf.jsxs)("div",{className:"mb-12",children:[(0,Bf.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,Bf.jsx)(e.IconComponent,{className:"w-8 h-8"}),(0,Bf.jsxs)("div",{children:[(0,Bf.jsx)("h2",{className:"text-3xl font-bold",children:e.title}),(0,Bf.jsx)("p",{className:"text-white/70",children:e.description})]})]}),(0,Bf.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.games.map(e=>(0,Bf.jsxs)("button",{onClick:()=>(e=>{t(e)})(e),className:"bg-gradient-to-br ".concat(e.color," p-6 rounded-2xl shadow-2xl hover:scale-105 transition-all duration-300 text-left relative overflow-hidden group"),children:[(0,Bf.jsx)("div",{className:"absolute inset-0 opacity-10",children:(0,Bf.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle, white 1px, transparent 1px)",backgroundSize:"20px 20px"}})}),(0,Bf.jsxs)("div",{className:"relative z-10",children:[(0,Bf.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,Bf.jsx)(e.IconComponent,{className:"w-12 h-12"}),e.specialMode&&(0,Bf.jsx)("span",{className:"px-2 py-1 bg-yellow-400 text-yellow-900 text-xs font-bold rounded",children:"SPECIAL"})]}),(0,Bf.jsx)("h3",{className:"text-2xl font-bold mb-2",children:e.title}),(0,Bf.jsx)("p",{className:"text-white/90 mb-4",children:e.description}),(0,Bf.jsx)("div",{className:"flex flex-wrap gap-2",children:e.modes.map(e=>(0,Bf.jsx)("span",{className:"px-3 py-1 bg-black/20 rounded-full text-sm font-semibold",children:e},e))}),e.supportsDynamicChapters&&(0,Bf.jsxs)("div",{className:"mt-4 text-sm text-white/80 flex items-center gap-2",children:[(0,Bf.jsx)("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),"Supports all ",d," chapters"]})]}),(0,Bf.jsx)("div",{className:"absolute inset-0 bg-white/0 group-hover:bg-white/10 transition-all duration-300"})]},e.id))})]},e.id)),0===a.length&&(0,Bf.jsx)("div",{className:"text-center py-20",children:(0,Bf.jsx)("p",{className:"text-2xl text-white/50",children:"Loading games..."})})]}),(0,Bf.jsx)("div",{className:"bg-black/30 backdrop-blur-sm border-t border-white/10 mt-20",children:(0,Bf.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-8 text-center text-white/50",children:[(0,Bf.jsx)("p",{children:"\ud83c\udf93 Nursing Education Platform"}),(0,Bf.jsx)("p",{className:"text-sm mt-2",children:"Add new games and chapters without coding - just edit JSON files!"})]})})]})}const Mp={Shield:"\ud83d\udee1\ufe0f",AlertCircle:"\u26a0\ufe0f",Bone:"\ud83e\uddb4",Bug:"\ud83e\udda0",Activity:"\ud83d\udcca",Brain:"\ud83e\udde0",Scale:"\u2696\ufe0f",Heart:"\u2764\ufe0f",Stethoscope:"\ud83e\ude7a"};function jp(e){let{onBackToHub:t}=e;const[n,i]=(0,r.useState)("chapter-select"),[s,o]=(0,r.useState)(null),[a,l]=(0,r.useState)([]),[c,u]=(0,r.useState)([]),[d,h]=(0,r.useState)(0),[f,p]=(0,r.useState)(!1),[m,g]=(0,r.useState)([]),[y,v]=(0,r.useState)([]),[b,x]=(0,r.useState)([]),[w,I]=(0,r.useState)(!1),[E,N]=(0,r.useState)(!0);(0,r.useEffect)(()=>{S()},[]);const S=async()=>{try{N(!0),console.log("FlashcardMode: Starting to load chapters..."),zf._initialized||(console.log("FlashcardMode: Initializing question loader..."),await zf.initialize()),console.log("FlashcardMode: Getting chapter metadata...");const e=Op();console.log("FlashcardMode: Loaded chapters:",e),console.log("FlashcardMode: Chapter count:",e.length),e&&0!==e.length||console.error("FlashcardMode: No chapters returned from getChapterMetadata()"),l(e),N(!1)}catch(e){console.error("FlashcardMode: Error loading chapters:",e),N(!1)}},T=e=>{const t=[...e];for(let n=t.length-1;n>0;n--){const e=Math.floor(Math.random()*(n+1));[t[n],t[e]]=[t[e],t[n]]}return t},_=()=>{p(!f)},C=()=>{const e=c[d];m.includes(e.id)||g([...m,e.id]),R()},k=()=>{const e=c[d];y.includes(e.id)||v([...y,e.id]),R()},A=()=>{const e=c[d];b.includes(e.id)||x([...b,e.id]),R()},R=()=>{p(!1),d<c.length-1?h(d+1):i("summary")},P=()=>{d>0&&(p(!1),h(d-1))},O=()=>{h(0),p(!1),g([]),v([]),x([]),i("flashcard-session")},L=()=>{const e=c.filter(e=>y.includes(e.id)||b.includes(e.id));u(w?T(e):e),h(0),p(!1),g([]),v([]),x([]),i("flashcard-session")};if("chapter-select"===n)return E?(0,Bf.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 text-white flex items-center justify-center",children:(0,Bf.jsxs)("div",{className:"text-center",children:[(0,Bf.jsx)("div",{className:"inline-block animate-spin rounded-full h-16 w-16 border-4 border-white border-t-transparent mb-4"}),(0,Bf.jsx)("p",{className:"text-xl",children:"Loading chapters..."})]})}):(0,Bf.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 text-white p-4",children:(0,Bf.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,Bf.jsx)("div",{className:"mb-4 bg-yellow-500/20 border border-yellow-500/50 rounded-xl p-4 text-center",children:(0,Bf.jsxs)("p",{className:"text-yellow-200 font-semibold",children:["\ud83c\udd95 New Flashcard Mode Available! Press ",(0,Bf.jsx)("kbd",{className:"px-2 py-1 bg-white/20 rounded",children:"Ctrl+Shift+R"})," (or ",(0,Bf.jsx)("kbd",{className:"px-2 py-1 bg-white/20 rounded",children:"Cmd+Shift+R"})," on Mac) to refresh and see all chapters"]})}),(0,Bf.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,Bf.jsx)("button",{onClick:t,className:"px-6 py-3 bg-white/10 hover:bg-white/20 rounded-xl font-semibold transition-all",children:"\u2190 Back to Hub"}),(0,Bf.jsx)("h1",{className:"text-4xl font-bold",children:"\ud83d\udcc7 Flashcard Study Mode"}),(0,Bf.jsx)("div",{className:"w-32"})]}),(0,Bf.jsx)("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-6 mb-6",children:(0,Bf.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,Bf.jsx)("input",{type:"checkbox",checked:w,onChange:e=>I(e.target.checked),className:"w-5 h-5 rounded"}),(0,Bf.jsx)("span",{className:"text-lg",children:"\ud83d\udd00 Shuffle cards"})]})}),(0,Bf.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-6",children:[(0,Bf.jsxs)("h3",{className:"text-2xl font-bold mb-6",children:["Select Chapter (",a.length," available)"]}),0===a.length?(0,Bf.jsxs)("div",{className:"text-center py-12 text-white/60",children:[(0,Bf.jsx)("p",{className:"text-xl mb-2",children:"No chapters found"}),(0,Bf.jsx)("p",{className:"text-sm",children:"Try refreshing the page or check console for errors"})]}):(0,Bf.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(e=>{const t=Mp[e.iconName]||"\ud83d\udcda";return(0,Bf.jsxs)("button",{onClick:()=>(async e=>{o(e);const t=zf.getQuestionsForChapter(e.id,!1).map((e,t)=>{var n,r;return{id:e.id||t,front:e.question,back:{answer:(null===(n=e.options)||void 0===n||null===(r=n.find(e=>e.correct))||void 0===r?void 0:r.text)||e.correctAnswer||"Answer not available",rationale:e.rationale||e.explanation||"No explanation available",skill:e.skill||[],concept:e.concept||""}}});u(w?T(t):t),h(0),p(!1),g([]),v([]),x([]),i("flashcard-session")})(e),className:"p-6 bg-white/5 hover:bg-white/10 border border-white/20 hover:border-white/40 rounded-xl transition-all text-left",children:[(0,Bf.jsx)("div",{className:"text-3xl mb-3",children:t}),(0,Bf.jsx)("div",{className:"font-bold text-lg mb-2",children:e.title}),(0,Bf.jsx)("div",{className:"text-sm text-white/70",children:e.description})]},e.id)})})]})]})});if("flashcard-session"===n){var M;const e=c[d],t=(d+1)/c.length*100;return(0,Bf.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 text-white p-4",children:(0,Bf.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,Bf.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Bf.jsx)("button",{onClick:()=>i("chapter-select"),className:"px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-all",children:"\u2190 Exit"}),(0,Bf.jsxs)("div",{className:"text-center",children:[(0,Bf.jsxs)("div",{className:"text-2xl font-bold",children:["Card ",d+1," of ",c.length]}),(0,Bf.jsx)("div",{className:"text-sm text-white/70",children:null===s||void 0===s?void 0:s.title})]}),(0,Bf.jsx)("div",{className:"w-20"})]}),(0,Bf.jsx)("div",{className:"mb-8",children:(0,Bf.jsx)("div",{className:"h-3 bg-white/20 rounded-full overflow-hidden",children:(0,Bf.jsx)("div",{className:"h-full bg-gradient-to-r from-green-400 to-blue-500 transition-all duration-300",style:{width:"".concat(t,"%")}})})}),(0,Bf.jsx)("div",{className:"relative h-96 mb-8 cursor-pointer",onClick:_,style:{perspective:"1000px"},children:(0,Bf.jsxs)("div",{className:"absolute w-full h-full transition-transform duration-500 preserve-3d ".concat(f?"rotate-y-180":""),style:{transformStyle:"preserve-3d"},children:[(0,Bf.jsxs)("div",{className:"absolute w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 rounded-3xl shadow-2xl p-8 flex flex-col items-center justify-center backface-hidden",style:{backfaceVisibility:"hidden"},children:[(0,Bf.jsx)("div",{className:"text-6xl mb-4",children:"\u2753"}),(0,Bf.jsx)("div",{className:"text-xl text-center leading-relaxed",children:null===e||void 0===e?void 0:e.front}),(0,Bf.jsx)("div",{className:"mt-6 text-sm text-white/70",children:"Click to reveal answer"})]}),(0,Bf.jsxs)("div",{className:"absolute w-full h-full bg-gradient-to-br from-green-500 to-teal-600 rounded-3xl shadow-2xl p-8 flex flex-col justify-center rotate-y-180 backface-hidden overflow-y-auto",style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:[(0,Bf.jsx)("div",{className:"text-4xl mb-4",children:"\u2705"}),(0,Bf.jsxs)("div",{className:"mb-4",children:[(0,Bf.jsx)("div",{className:"text-sm text-white/70 mb-2",children:"Correct Answer:"}),(0,Bf.jsx)("div",{className:"text-lg font-semibold",children:null===e||void 0===e?void 0:e.back.answer})]}),(0,Bf.jsxs)("div",{className:"mb-4",children:[(0,Bf.jsx)("div",{className:"text-sm text-white/70 mb-2",children:"Rationale:"}),(0,Bf.jsx)("div",{className:"text-base leading-relaxed",children:null===e||void 0===e?void 0:e.back.rationale})]}),(null===e||void 0===e||null===(M=e.back.skill)||void 0===M?void 0:M.length)>0&&(0,Bf.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:e.back.skill.map((e,t)=>(0,Bf.jsx)("span",{className:"px-3 py-1 bg-white/20 rounded-full text-xs",children:e},t))})]})]})}),(0,Bf.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,Bf.jsx)("button",{onClick:P,disabled:0===d,className:"px-6 py-3 bg-white/10 hover:bg-white/20 disabled:opacity-30 disabled:cursor-not-allowed rounded-xl font-semibold transition-all",children:"\u2190 Previous"}),(0,Bf.jsxs)("div",{className:"flex gap-3",children:[(0,Bf.jsx)("button",{onClick:A,className:"px-6 py-3 bg-red-500 hover:bg-red-600 rounded-xl font-semibold transition-all",disabled:!f,children:"\ud83d\udd34 Learning"}),(0,Bf.jsx)("button",{onClick:k,className:"px-6 py-3 bg-yellow-500 hover:bg-yellow-600 rounded-xl font-semibold transition-all",disabled:!f,children:"\ud83d\udfe1 Review"}),(0,Bf.jsx)("button",{onClick:C,className:"px-6 py-3 bg-green-500 hover:bg-green-600 rounded-xl font-semibold transition-all",disabled:!f,children:"\ud83d\udfe2 Know It"})]}),(0,Bf.jsx)("button",{onClick:R,disabled:d===c.length-1,className:"px-6 py-3 bg-white/10 hover:bg-white/20 disabled:opacity-30 disabled:cursor-not-allowed rounded-xl font-semibold transition-all",children:"Next \u2192"})]}),(0,Bf.jsxs)("div",{className:"mt-8 grid grid-cols-3 gap-4 text-center",children:[(0,Bf.jsxs)("div",{className:"bg-green-500/20 rounded-xl p-4",children:[(0,Bf.jsx)("div",{className:"text-3xl font-bold",children:m.length}),(0,Bf.jsx)("div",{className:"text-sm text-white/70",children:"Know It"})]}),(0,Bf.jsxs)("div",{className:"bg-yellow-500/20 rounded-xl p-4",children:[(0,Bf.jsx)("div",{className:"text-3xl font-bold",children:y.length}),(0,Bf.jsx)("div",{className:"text-sm text-white/70",children:"Review"})]}),(0,Bf.jsxs)("div",{className:"bg-red-500/20 rounded-xl p-4",children:[(0,Bf.jsx)("div",{className:"text-3xl font-bold",children:b.length}),(0,Bf.jsx)("div",{className:"text-sm text-white/70",children:"Learning"})]})]})]})})}if("summary"===n){const e=c.length,n=Math.round(m.length/e*100);return(0,Bf.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 text-white p-4",children:(0,Bf.jsx)("div",{className:"max-w-3xl mx-auto",children:(0,Bf.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-3xl p-8 text-center",children:[(0,Bf.jsx)("div",{className:"text-6xl mb-6",children:"\ud83c\udf89"}),(0,Bf.jsx)("h2",{className:"text-4xl font-bold mb-4",children:"Flashcard Session Complete!"}),(0,Bf.jsx)("p",{className:"text-xl text-white/80 mb-8",children:null===s||void 0===s?void 0:s.title}),(0,Bf.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-8",children:[(0,Bf.jsxs)("div",{className:"bg-green-500/20 rounded-xl p-6",children:[(0,Bf.jsx)("div",{className:"text-4xl font-bold",children:m.length}),(0,Bf.jsx)("div",{className:"text-sm text-white/70",children:"Know It"})]}),(0,Bf.jsxs)("div",{className:"bg-yellow-500/20 rounded-xl p-6",children:[(0,Bf.jsx)("div",{className:"text-4xl font-bold",children:y.length}),(0,Bf.jsx)("div",{className:"text-sm text-white/70",children:"Review"})]}),(0,Bf.jsxs)("div",{className:"bg-red-500/20 rounded-xl p-6",children:[(0,Bf.jsx)("div",{className:"text-4xl font-bold",children:b.length}),(0,Bf.jsx)("div",{className:"text-sm text-white/70",children:"Learning"})]})]}),(0,Bf.jsxs)("div",{className:"text-5xl font-bold mb-8",children:[n,"% Mastery"]}),(0,Bf.jsxs)("div",{className:"flex flex-col gap-4",children:[(y.length>0||b.length>0)&&(0,Bf.jsxs)("button",{onClick:L,className:"px-8 py-4 bg-yellow-500 hover:bg-yellow-600 rounded-xl font-bold text-lg transition-all",children:["\ud83d\udd04 Review Difficult Cards (",y.length+b.length,")"]}),(0,Bf.jsx)("button",{onClick:O,className:"px-8 py-4 bg-blue-500 hover:bg-blue-600 rounded-xl font-bold text-lg transition-all",children:"\ud83d\udd01 Start Over"}),(0,Bf.jsx)("button",{onClick:()=>i("chapter-select"),className:"px-8 py-4 bg-purple-500 hover:bg-purple-600 rounded-xl font-bold text-lg transition-all",children:"\ud83d\udcda Choose Different Chapter"}),(0,Bf.jsx)("button",{onClick:t,className:"px-8 py-4 bg-white/10 hover:bg-white/20 rounded-xl font-semibold transition-all",children:"\u2190 Back to Hub"})]})]})})})}return null}const Dp=function(){var e;const[t,n]=(0,r.useState)("hub"),[i,s]=(0,r.useState)(null),[o,a]=(0,r.useState)("Student"),[l,c]=(0,r.useState)(null),u=e=>{try{console.log("Selected game:",e),s(e),n("game")}catch(t){console.error("Error selecting game:",t),c(t.message)}},d=()=>{try{n("hub"),s(null)}catch(e){console.error("Error returning to hub:",e),c(e.message)}},h=()=>{alert("Settings coming soon!")};return l?(0,Bf.jsxs)("div",{style:{minHeight:"100vh",background:"#991b1b",color:"white",padding:"40px",textAlign:"center",fontFamily:"system-ui"},children:[(0,Bf.jsx)("h1",{style:{fontSize:"32px",marginBottom:"20px"},children:"\u26a0\ufe0f Error"}),(0,Bf.jsx)("p",{style:{marginBottom:"20px",fontSize:"18px"},children:l}),(0,Bf.jsx)("button",{onClick:()=>{c(null),n("hub")},style:{padding:"12px 24px",fontSize:"16px",background:"white",color:"#991b1b",border:"none",borderRadius:"8px",cursor:"pointer"},children:"Return to Hub"})]}):"hub"===t?(0,Bf.jsx)(Lp,{onSelectGame:u,onSettings:h,userName:o}):"flashcards"===(null===i||void 0===i?void 0:i.id)?(0,Bf.jsx)(jp,{onBackToHub:d}):(0,Bf.jsx)(kp,{onBackToHub:d,initialMode:(null===i||void 0===i||null===(e=i.modes)||void 0===e?void 0:e[0])||"study"})};i.createRoot(document.getElementById("root")).render((0,Bf.jsx)(r.StrictMode,{children:(0,Bf.jsx)(Dp,{})}))})();
//# sourceMappingURL=main.31a6af38.js.map