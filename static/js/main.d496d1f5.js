/*! For license information please see main.d496d1f5.js.LICENSE.txt */
(()=>{"use strict";var e={12(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("scale",[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]])},43(e,t,n){e.exports=n(202)},73(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},118(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},130(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]])},153(e,t,n){var r=n(43),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,s={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:s,_owner:o.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202(e,t){var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function v(){}function x(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var b=x.prototype=new v;b.constructor=x,m(b,y.prototype),b.isPureReactComponent=!0;var w=Array.isArray,I=Object.prototype.hasOwnProperty,N={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,r){var i,s={},a=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)I.call(t,i)&&!E.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:a,ref:o,props:s,_owner:N.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var _=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function k(e,t,i,s,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=e),e=""===s?"."+T(l,0):s,w(a)?(i="",null!=e&&(i=e.replace(_,"$&/")+"/"),k(a,t,i,"",function(e){return e})):null!=a&&(C(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(_,"$&/")+"/")+e)),t.push(a)),1;if(l=0,s=""===s?".":s+":",w(e))for(var c=0;c<e.length;c++){var u=s+T(o=e[c],c);l+=k(o,t,i,u,a)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=k(o=o.value,t,i,u=s+T(o,c++),a);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,n){if(null==e)return e;var r=[],i=0;return k(e,r,"","",function(e){return t.call(n,e,i++)}),r}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var j={current:null},P={transition:null},O={ReactCurrentDispatcher:j,ReactCurrentBatchConfig:P,ReactCurrentOwner:N};function M(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,n){A(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return A(e,function(){t++}),t},toArray:function(e){return A(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=a,t.PureComponent=x,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.act=M,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),s=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=N.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)I.call(t,c)&&!E.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:a,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=M,t.useCallback=function(e,t){return j.current.useCallback(e,t)},t.useContext=function(e){return j.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return j.current.useDeferredValue(e)},t.useEffect=function(e,t){return j.current.useEffect(e,t)},t.useId=function(){return j.current.useId()},t.useImperativeHandle=function(e,t,n){return j.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return j.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return j.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return j.current.useMemo(e,t)},t.useReducer=function(e,t,n){return j.current.useReducer(e,t,n)},t.useRef=function(e){return j.current.useRef(e)},t.useState=function(e){return j.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return j.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return j.current.useTransition()},t.version="18.3.1"},234(e,t){function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>s(l,n))c<i&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function w(e){if(g=!1,b(e),!m)if(null!==r(c))m=!0,P(I);else{var t=r(u);null!==t&&O(w,t.startTime-e)}}function I(e,n){m=!1,g&&(g=!1,v(C),C=-1),f=!0;var s=p;try{for(b(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!k());){var a=h.callback;if("function"===typeof a){h.callback=null,p=h.priorityLevel;var o=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(c)&&i(c),b(n)}else i(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&O(w,d.startTime-n),l=!1}return l}finally{h=null,p=s,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,E=!1,S=null,C=-1,_=5,T=-1;function k(){return!(t.unstable_now()-T<_)}function A(){if(null!==S){var e=t.unstable_now();T=e;var n=!0;try{n=S(!0,e)}finally{n?N():(E=!1,S=null)}}else E=!1}if("function"===typeof x)N=function(){x(A)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,j=R.port2;R.port1.onmessage=A,N=function(){j.postMessage(null)}}else N=function(){y(A,0)};function P(e){S=e,E||(E=!0,N())}function O(e,n){C=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,P(I))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,i,s){var a=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(g?(v(C),C=-1):g=!0,O(w,s-a))):(e.sortIndex=o,n(c,e),m||f||(m=!0,P(I))),e},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},382(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("brain",[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]])},391(e,t,n){var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},489(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},537(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},555(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function s(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}n.d(t,{A:()=>o})},574(e,t,n){n.d(t,{getAllGames:()=>R,getCategories:()=>A,getGamesByCategory:()=>k,sW:()=>_});var r=n(555),i=n(784);const s=(0,i.A)("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);var a=n(12),o=n(73),l=n(629);const c=(0,i.A)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);var u=n(382),d=n(130),h=n(118),p=n(489),f=n(819),m=n(537),g=n(800),y=n(942);const v=(0,i.A)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]),x=(0,i.A)("syringe",[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]]);var b=n(935);const w=(0,i.A)("hospital",[["path",{d:"M12 7v4",key:"xawao1"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M14 9h-4",key:"1w2s2s"}],["path",{d:"M18 11h2a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-9a2 2 0 0 1 2-2h2",key:"1tthqt"}],["path",{d:"M18 21V5a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16",key:"dw4p4i"}]]),I=(0,i.A)("pill",[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]]),N=(0,i.A)("calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]),E=(0,i.A)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),S={games:[{id:"rn-mastery",title:"RN Mastery Quiz",description:"Chapter-based review with adaptive learning",icon:"GraduationCap",category:"study",color:"from-blue-500 to-indigo-600",enabled:!0,modes:["study","ranked"],supportsDynamicChapters:!0},{id:"flashcards",title:"Flashcard Study",description:"Flip cards with spaced repetition - mark as Know It, Review, or Learning",icon:"CreditCard",category:"study",color:"from-indigo-500 to-purple-600",enabled:!0,modes:["flashcard"],supportsDynamicChapters:!0},{id:"clinical-rounds",title:"Clinical Rounds",description:"Manage patients through a nursing shift with EHR charts and SBAR handoffs",icon:"Stethoscope",category:"clinical-judgment",color:"from-cyan-500 to-blue-600",enabled:!0,modes:["simulation"],supportsDynamicChapters:!1},{id:"challenge-mode",title:"Challenge Scenarios",description:"Time-based resource management challenges",icon:"Zap",category:"challenge",color:"from-orange-500 to-red-600",enabled:!0,modes:["challenge"],supportsDynamicChapters:!1},{id:"instructor-mode",title:"Instructor Panel",description:"Live classroom management and judgment panel",icon:"Crown",category:"instructor",color:"from-yellow-500 to-amber-600",enabled:!0,modes:["instructor"],requiresAuth:!0}],categories:[{id:"study",title:"Study & Review",icon:"BookOpen",description:"Self-paced learning modules"},{id:"clinical-judgment",title:"Clinical Judgment",icon:"Brain",description:"Decision-making scenarios"},{id:"challenge",title:"Challenges",icon:"Trophy",description:"Timed competitive modes"},{id:"instructor",title:"Instructor Tools",icon:"Users",description:"Classroom management"}]},C={GraduationCap:s,Scale:a.A,Zap:o.A,Crown:l.A,BookOpen:c,Brain:u.A,Trophy:d.A,Users:h.A,Shield:p.A,AlertCircle:f.A,Activity:m.A,Bug:g.A,Bone:y.A,Heart:v,Syringe:x,Stethoscope:b.A,Hospital:w,Pill:I,Calculator:N,CreditCard:E};function _(e){return C[e]||u.A}function T(){return S&&S.games?S.games.filter(e=>e.enabled).map(e=>(0,r.A)((0,r.A)({},e),{},{IconComponent:_(e.icon)})):(console.warn("Games config not loaded"),[])}function k(e){return T().filter(t=>t.category===e)}function A(){return S&&S.categories?S.categories.map(e=>(0,r.A)((0,r.A)({},e),{},{IconComponent:_(e.icon),games:k(e.id)})):(console.warn("Categories config not loaded"),[])}function R(){return S.games.map(e=>(0,r.A)((0,r.A)({},e),{},{IconComponent:_(e.icon)}))}},579(e,t,n){e.exports=n(153)},629(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]])},730(e,t,n){var r=n(43),i=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,r,i,s,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function x(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),I=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),_=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),j=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var L,D=Object.assign;function F(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var q=!1;function U(e,t){if(!e||q)return"";q=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),s=r.stack.split("\n"),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(1!==a||1!==o)do{if(a--,0>--o||i[a]!==s[o]){var l="\n"+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{q=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function V(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case I:return"Portal";case S:return"Profiler";case E:return"StrictMode";case k:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case _:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case R:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case j:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function z(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(Jt){return e.body}}function Q(e,t){var n=t.checked;return D({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&x(e,"checked",t,!1)}function $(e,t){X(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Y(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return D({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function se(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(pe).forEach(function(e){fe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var ye=D({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function xe(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ie=null,Ne=null,Ee=null;function Se(e){if(e=bi(e)){if("function"!==typeof Ie)throw Error(s(280));var t=e.stateNode;t&&(t=Ii(t),Ie(e.stateNode,e.type,t))}}function Ce(e){Ne?Ee?Ee.push(e):Ee=[e]:Ne=e}function _e(){if(Ne){var e=Ne,t=Ee;if(Ee=Ne=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Te(e,t){return e(t)}function ke(){}var Ae=!1;function Re(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Te(e,t,n)}finally{Ae=!1,(null!==Ne||null!==Ee)&&(ke(),_e())}}function je(e,t){var n=e.stateNode;if(null===n)return null;var r=Ii(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Pe=!1;if(u)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ue){Pe=!1}function Me(e,t,n,r,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Le=!1,De=null,Fe=!1,qe=null,Ue={onError:function(e){Le=!0,De=e}};function Ve(e,t,n,r,i,s,a,o,l){Le=!1,De=null,Me.apply(Ue,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function ze(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Be(e)!==e)throw Error(s(188))}function Ge(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return He(i),e;if(a===r)return He(i),t;a=a.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e),null!==e?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var Ke=i.unstable_scheduleCallback,Ye=i.unstable_cancelCallback,Qe=i.unstable_shouldYield,Je=i.unstable_requestPaint,Xe=i.unstable_now,$e=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,a=268435455&n;if(0!==a){var o=a&~i;0!==o?r=dt(o):0!==(s&=a)&&(r=dt(s))}else 0!==(a=n&~i)?r=dt(a):0!==s&&(r=dt(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-at(t)),r|=e[n],t&=~i;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var xt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,It,Nt,Et,St,Ct=!1,_t=[],Tt=null,kt=null,At=null,Rt=new Map,jt=new Map,Pt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":kt=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Rt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":jt.delete(t.pointerId)}}function Lt(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&It(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Dt(e){var t=xi(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=ze(n)))return e.blockedOn=t,void St(e.priority,function(){Nt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&It(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function qt(e,t,n){Ft(e)&&n.delete(t)}function Ut(){Ct=!1,null!==Tt&&Ft(Tt)&&(Tt=null),null!==kt&&Ft(kt)&&(kt=null),null!==At&&Ft(At)&&(At=null),Rt.forEach(qt),jt.forEach(qt)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ut)))}function Bt(e){function t(t){return Vt(t,e)}if(0<_t.length){Vt(_t[0],e);for(var n=1;n<_t.length;n++){var r=_t[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Tt&&Vt(Tt,e),null!==kt&&Vt(kt,e),null!==At&&Vt(At,e),Rt.forEach(t),jt.forEach(t),n=0;n<Pt.length;n++)(r=Pt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Pt.length&&null===(n=Pt[0]).blockedOn;)Dt(n),null===n.blockedOn&&Pt.shift()}var zt=b.ReactCurrentBatchConfig,Ht=!0;function Gt(e,t,n,r){var i=xt,s=zt.transition;zt.transition=null;try{xt=1,Kt(e,t,n,r)}finally{xt=i,zt.transition=s}}function Wt(e,t,n,r){var i=xt,s=zt.transition;zt.transition=null;try{xt=4,Kt(e,t,n,r)}finally{xt=i,zt.transition=s}}function Kt(e,t,n,r){if(Ht){var i=Qt(e,t,n,r);if(null===i)Gr(e,t,r,Yt,n),Mt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Tt=Lt(Tt,e,t,n,r,i),!0;case"dragenter":return kt=Lt(kt,e,t,n,r,i),!0;case"mouseover":return At=Lt(At,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Rt.set(s,Lt(Rt.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,jt.set(s,Lt(jt.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==i;){var s=bi(i);if(null!==s&&wt(s),null===(s=Qt(e,t,n,r))&&Gr(e,t,r,Yt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else Gr(e,t,r,null,n)}}var Yt=null;function Qt(e,t,n,r){if(Yt=null,null!==(e=xi(e=we(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=ze(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var $t=null,Zt=null,en=null;function tn(){if(en)return en;var e,t,n=Zt,r=n.length,i="value"in $t?$t.value:$t.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[s-t];t++);return en=i.slice(e,1<t?1-t:void 0)}function nn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rn(){return!0}function sn(){return!1}function an(e){function t(t,n,r,i,s){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?rn:sn,this.isPropagationStopped=sn,this}return D(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rn)},persist:function(){},isPersistent:rn}),t}var on,ln,cn,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=an(un),hn=D({},un,{view:0,detail:0}),pn=an(hn),fn=D({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cn&&(cn&&"mousemove"===e.type?(on=e.screenX-cn.screenX,ln=e.screenY-cn.screenY):ln=on=0,cn=e),on)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),mn=an(fn),gn=an(D({},fn,{dataTransfer:0})),yn=an(D({},hn,{relatedTarget:0})),vn=an(D({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),xn=D({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(xn),wn=an(D({},un,{data:0})),In={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},En={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=En[e])&&!!t[e]}function Cn(){return Sn}var _n=D({},hn,{key:function(e){if(e.key){var t=In[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=nn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Nn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?nn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?nn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tn=an(_n),kn=an(D({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=an(D({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),Rn=an(D({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),jn=D({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=an(jn),On=[9,13,27,32],Mn=u&&"CompositionEvent"in window,Ln=null;u&&"documentMode"in document&&(Ln=document.documentMode);var Dn=u&&"TextEvent"in window&&!Ln,Fn=u&&(!Mn||Ln&&8<Ln&&11>=Ln),qn=String.fromCharCode(32),Un=!1;function Vn(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var zn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function Wn(e,t,n,r){Ce(r),0<(t=Kr(t,"onChange")).length&&(n=new dn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Kn=null,Yn=null;function Qn(e){qr(e,0)}function Jn(e){if(K(wi(e)))return e}function Xn(e,t){if("change"===e)return t}var $n=!1;if(u){var Zn;if(u){var er="oninput"in document;if(!er){var tr=document.createElement("div");tr.setAttribute("oninput","return;"),er="function"===typeof tr.oninput}Zn=er}else Zn=!1;$n=Zn&&(!document.documentMode||9<document.documentMode)}function nr(){Kn&&(Kn.detachEvent("onpropertychange",rr),Yn=Kn=null)}function rr(e){if("value"===e.propertyName&&Jn(Yn)){var t=[];Wn(t,Yn,e,we(e)),Re(Qn,t)}}function ir(e,t,n){"focusin"===e?(nr(),Yn=n,(Kn=t).attachEvent("onpropertychange",rr)):"focusout"===e&&nr()}function sr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(Yn)}function ar(e,t){if("click"===e)return Jn(t)}function or(e,t){if("input"===e||"change"===e)return Jn(t)}var lr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cr(e,t){if(lr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!lr(e[i],t[i]))return!1}return!0}function ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=ur(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ur(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pr(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Y((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mr(e){var t=pr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=dr(n,s);var a=dr(n,r);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gr=u&&"documentMode"in document&&11>=document.documentMode,yr=null,vr=null,xr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==yr||yr!==Y(r)||("selectionStart"in(r=yr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},xr&&cr(xr,r)||(xr=r,0<(r=Kr(vr,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=yr)))}function Ir(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Nr={animationend:Ir("Animation","AnimationEnd"),animationiteration:Ir("Animation","AnimationIteration"),animationstart:Ir("Animation","AnimationStart"),transitionend:Ir("Transition","TransitionEnd")},Er={},Sr={};function Cr(e){if(Er[e])return Er[e];if(!Nr[e])return e;var t,n=Nr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return Er[e]=n[t];return e}u&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete Nr.animationend.animation,delete Nr.animationiteration.animation,delete Nr.animationstart.animation),"TransitionEvent"in window||delete Nr.transitionend.transition);var _r=Cr("animationend"),Tr=Cr("animationiteration"),kr=Cr("animationstart"),Ar=Cr("transitionend"),Rr=new Map,jr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(e,t){Rr.set(e,t),l(t,[e])}for(var Or=0;Or<jr.length;Or++){var Mr=jr[Or];Pr(Mr.toLowerCase(),"on"+(Mr[0].toUpperCase()+Mr.slice(1)))}Pr(_r,"onAnimationEnd"),Pr(Tr,"onAnimationIteration"),Pr(kr,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(Ar,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,o,l,c){if(Ve.apply(this,arguments),Le){if(!Le)throw Error(s(198));var u=De;Le=!1,De=null,Fe||(Fe=!0,qe=u)}}(r,t,void 0,e),e.currentTarget=null}function qr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Fr(i,o,c),s=l}else for(a=0;a<r.length;a++){if(l=(o=r[a]).instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Fr(i,o,c),s=l}}}if(Fe)throw e=qe,Fe=!1,qe=null,e}function Ur(e,t){var n=t[gi];void 0===n&&(n=t[gi]=new Set);var r=e+"__bubble";n.has(r)||(Hr(t,e,2,!1),n.add(r))}function Vr(e,t,n){var r=0;t&&(r|=4),Hr(n,e,r,t)}var Br="_reactListening"+Math.random().toString(36).slice(2);function zr(e){if(!e[Br]){e[Br]=!0,a.forEach(function(t){"selectionchange"!==t&&(Dr.has(t)||Vr(t,!1,e),Vr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Br]||(t[Br]=!0,Vr("selectionchange",!1,t))}}function Hr(e,t,n,r){switch(Xt(t)){case 1:var i=Gt;break;case 4:i=Wt;break;default:i=Kt}n=i.bind(null,t,n,e),i=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Gr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var o=r.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==o;){if(null===(a=xi(o)))return;if(5===(l=a.tag)||6===l){r=s=a;continue e}o=o.parentNode}}r=r.return}Re(function(){var r=s,i=we(n),a=[];e:{var o=Rr.get(e);if(void 0!==o){var l=dn,c=e;switch(e){case"keypress":if(0===nn(n))break e;case"keydown":case"keyup":l=Tn;break;case"focusin":c="focus",l=yn;break;case"focusout":c="blur",l=yn;break;case"beforeblur":case"afterblur":l=yn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=An;break;case _r:case Tr:case kr:l=vn;break;case Ar:l=Rn;break;case"scroll":l=pn;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=kn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==o?o+"Capture":null:o;u=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=je(f,h))&&u.push(Wr(f,m,p)))),d)break;f=f.return}0<u.length&&(o=new l(o,c,null,n,i),a.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!xi(c)&&!c[mi])&&(l||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?xi(c):null)&&(c!==(d=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=mn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=kn,m="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==l?o:wi(l),p=null==c?o:wi(c),(o=new u(m,f+"leave",l,n,i)).target=d,o.relatedTarget=p,m=null,xi(i)===r&&((u=new u(h,f+"enter",c,n,i)).target=p,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,f=0,p=u=l;p;p=Yr(p))f++;for(p=0,m=h;m;m=Yr(m))p++;for(;0<f-p;)u=Yr(u),f--;for(;0<p-f;)h=Yr(h),p--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=Yr(u),h=Yr(h)}u=null}else u=null;null!==l&&Qr(a,o,l,u,!1),null!==c&&null!==d&&Qr(a,d,c,u,!0)}if("select"===(l=(o=r?wi(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Xn;else if(Gn(o))if($n)g=or;else{g=sr;var y=ir}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=ar);switch(g&&(g=g(e,r))?Wn(a,g,n,i):(y&&y(e,o,r),"focusout"===e&&(y=o._wrapperState)&&y.controlled&&"number"===o.type&&ee(o,"number",o.value)),y=r?wi(r):window,e){case"focusin":(Gn(y)||"true"===y.contentEditable)&&(yr=y,vr=r,xr=null);break;case"focusout":xr=vr=yr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(a,n,i);break;case"selectionchange":if(gr)break;case"keydown":case"keyup":wr(a,n,i)}var v;if(Mn)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else zn?Vn(e,n)&&(x="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(x="onCompositionStart");x&&(Fn&&"ko"!==n.locale&&(zn||"onCompositionStart"!==x?"onCompositionEnd"===x&&zn&&(v=tn()):(Zt="value"in($t=i)?$t.value:$t.textContent,zn=!0)),0<(y=Kr(r,x)).length&&(x=new wn(x,e,null,n,i),a.push({event:x,listeners:y}),v?x.data=v:null!==(v=Bn(n))&&(x.data=v))),(v=Dn?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(Un=!0,qn);case"textInput":return(e=t.data)===qn&&Un?null:e;default:return null}}(e,n):function(e,t){if(zn)return"compositionend"===e||!Mn&&Vn(e,t)?(e=tn(),en=Zt=$t=null,zn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Kr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=v))}qr(a,t)})}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Kr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=je(e,n))&&r.unshift(Wr(e,s,i)),null!=(s=je(e,t))&&r.push(Wr(e,s,i))),e=e.return}return r}function Yr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,i){for(var s=t._reactName,a=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,i?null!=(l=je(n,s))&&a.unshift(Wr(n,l,o)):i||null!=(l=je(n,s))&&a.push(Wr(n,l,o))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Jr=/\r\n?/g,Xr=/\u0000|\uFFFD/g;function $r(e){return("string"===typeof e?e:""+e).replace(Jr,"\n").replace(Xr,"")}function Zr(e,t,n){if(t=$r(t),$r(e)!==t&&n)throw Error(s(425))}function ei(){}var ti=null,ni=null;function ri(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ii="function"===typeof setTimeout?setTimeout:void 0,si="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(e){return ai.resolve(null).then(e).catch(li)}:ii;function li(e){setTimeout(function(){throw e})}function ci(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Bt(t)}function ui(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function di(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),pi="__reactFiber$"+hi,fi="__reactProps$"+hi,mi="__reactContainer$"+hi,gi="__reactEvents$"+hi,yi="__reactListeners$"+hi,vi="__reactHandles$"+hi;function xi(e){var t=e[pi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[mi]||n[pi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=di(e);null!==e;){if(n=e[pi])return n;e=di(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[pi]||e[mi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function Ii(e){return e[fi]||null}var Ni=[],Ei=-1;function Si(e){return{current:e}}function Ci(e){0>Ei||(e.current=Ni[Ei],Ni[Ei]=null,Ei--)}function _i(e,t){Ei++,Ni[Ei]=e.current,e.current=t}var Ti={},ki=Si(Ti),Ai=Si(!1),Ri=Ti;function ji(e,t){var n=e.type.contextTypes;if(!n)return Ti;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Pi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Oi(){Ci(Ai),Ci(ki)}function Mi(e,t,n){if(ki.current!==Ti)throw Error(s(168));_i(ki,t),_i(Ai,n)}function Li(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,z(e)||"Unknown",i));return D({},n,r)}function Di(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ti,Ri=ki.current,_i(ki,e),_i(Ai,Ai.current),!0}function Fi(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Li(e,t,Ri),r.__reactInternalMemoizedMergedChildContext=e,Ci(Ai),Ci(ki),_i(ki,e)):Ci(Ai),_i(Ai,n)}var qi=null,Ui=!1,Vi=!1;function Bi(e){null===qi?qi=[e]:qi.push(e)}function zi(){if(!Vi&&null!==qi){Vi=!0;var e=0,t=xt;try{var n=qi;for(xt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}qi=null,Ui=!1}catch(i){throw null!==qi&&(qi=qi.slice(e+1)),Ke(Ze,zi),i}finally{xt=t,Vi=!1}}return null}var Hi=[],Gi=0,Wi=null,Ki=0,Yi=[],Qi=0,Ji=null,Xi=1,$i="";function Zi(e,t){Hi[Gi++]=Ki,Hi[Gi++]=Wi,Wi=e,Ki=t}function es(e,t,n){Yi[Qi++]=Xi,Yi[Qi++]=$i,Yi[Qi++]=Ji,Ji=e;var r=Xi;e=$i;var i=32-at(r)-1;r&=~(1<<i),n+=1;var s=32-at(t)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Xi=1<<32-at(t)+i|n<<i|r,$i=s+e}else Xi=1<<s|n<<i|r,$i=e}function ts(e){null!==e.return&&(Zi(e,1),es(e,1,0))}function ns(e){for(;e===Wi;)Wi=Hi[--Gi],Hi[Gi]=null,Ki=Hi[--Gi],Hi[Gi]=null;for(;e===Ji;)Ji=Yi[--Qi],Yi[Qi]=null,$i=Yi[--Qi],Yi[Qi]=null,Xi=Yi[--Qi],Yi[Qi]=null}var rs=null,is=null,ss=!1,as=null;function os(e,t){var n=Rc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ls(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,rs=e,is=ui(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,rs=e,is=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ji?{id:Xi,overflow:$i}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Rc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,rs=e,is=null,!0);default:return!1}}function cs(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function us(e){if(ss){var t=is;if(t){var n=t;if(!ls(e,t)){if(cs(e))throw Error(s(418));t=ui(n.nextSibling);var r=rs;t&&ls(e,t)?os(r,n):(e.flags=-4097&e.flags|2,ss=!1,rs=e)}}else{if(cs(e))throw Error(s(418));e.flags=-4097&e.flags|2,ss=!1,rs=e}}}function ds(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;rs=e}function hs(e){if(e!==rs)return!1;if(!ss)return ds(e),ss=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ri(e.type,e.memoizedProps)),t&&(t=is)){if(cs(e))throw ps(),Error(s(418));for(;t;)os(e,t),t=ui(t.nextSibling)}if(ds(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){is=ui(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}is=null}}else is=rs?ui(e.stateNode.nextSibling):null;return!0}function ps(){for(var e=is;e;)e=ui(e.nextSibling)}function fs(){is=rs=null,ss=!1}function ms(e){null===as?as=[e]:as.push(e)}var gs=b.ReactCurrentBatchConfig;function ys(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function vs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function xs(e){return(0,e._init)(e._payload)}function bs(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Dc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===N?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===j&&xs(s)===t.type)?((r=i(t,n.props)).ref=ys(e,t,n),r.return=e,r):((r=Oc(n.type,n.key,n.props,null,e.mode,r)).ref=ys(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,s){return null===t||7!==t.tag?((t=Mc(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Dc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=ys(e,null,t),n.return=e,n;case I:return(t=Fc(t,e.mode,n)).return=e,t;case j:return h(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=Mc(t,e.mode,n,null)).return=e,t;vs(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?c(e,t,n,r):null;case I:return n.key===i?u(e,t,n,r):null;case j:return p(e,t,(i=n._init)(n._payload),r)}if(te(n)||M(n))return null!==i?null:d(e,t,n,r,null);vs(e,n)}return null}function f(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case I:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case j:return f(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||M(r))return d(t,e=e.get(n)||null,r,i,null);vs(t,r)}return null}function m(i,s,o,l){for(var c=null,u=null,d=s,m=s=0,g=null;null!==d&&m<o.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var y=p(i,d,o[m],l);if(null===y){null===d&&(d=g);break}e&&d&&null===y.alternate&&t(i,d),s=a(y,s,m),null===u?c=y:u.sibling=y,u=y,d=g}if(m===o.length)return n(i,d),ss&&Zi(i,m),c;if(null===d){for(;m<o.length;m++)null!==(d=h(i,o[m],l))&&(s=a(d,s,m),null===u?c=d:u.sibling=d,u=d);return ss&&Zi(i,m),c}for(d=r(i,d);m<o.length;m++)null!==(g=f(d,i,m,o[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),s=a(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(i,e)}),ss&&Zi(i,m),c}function g(i,o,l,c){var u=M(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var d=u=null,m=o,g=o=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var x=p(i,m,v.value,c);if(null===x){null===m&&(m=y);break}e&&m&&null===x.alternate&&t(i,m),o=a(x,o,g),null===d?u=x:d.sibling=x,d=x,m=y}if(v.done)return n(i,m),ss&&Zi(i,g),u;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=h(i,v.value,c))&&(o=a(v,o,g),null===d?u=v:d.sibling=v,d=v);return ss&&Zi(i,g),u}for(m=r(i,m);!v.done;g++,v=l.next())null!==(v=f(m,i,g,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),o=a(v,o,g),null===d?u=v:d.sibling=v,d=v);return e&&m.forEach(function(e){return t(i,e)}),ss&&Zi(i,g),u}return function e(r,s,a,l){if("object"===typeof a&&null!==a&&a.type===N&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var c=a.key,u=s;null!==u;){if(u.key===c){if((c=a.type)===N){if(7===u.tag){n(r,u.sibling),(s=i(u,a.props.children)).return=r,r=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===j&&xs(c)===u.type){n(r,u.sibling),(s=i(u,a.props)).ref=ys(r,u,a),s.return=r,r=s;break e}n(r,u);break}t(r,u),u=u.sibling}a.type===N?((s=Mc(a.props.children,r.mode,l,a.key)).return=r,r=s):((l=Oc(a.type,a.key,a.props,null,r.mode,l)).ref=ys(r,s,a),l.return=r,r=l)}return o(r);case I:e:{for(u=a.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){n(r,s.sibling),(s=i(s,a.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Fc(a,r.mode,l)).return=r,r=s}return o(r);case j:return e(r,s,(u=a._init)(a._payload),l)}if(te(a))return m(r,s,a,l);if(M(a))return g(r,s,a,l);vs(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,a)).return=r,r=s):(n(r,s),(s=Dc(a,r.mode,l)).return=r,r=s),o(r)):n(r,s)}}var ws=bs(!0),Is=bs(!1),Ns=Si(null),Es=null,Ss=null,Cs=null;function _s(){Cs=Ss=Es=null}function Ts(e){var t=Ns.current;Ci(Ns),e._currentValue=t}function ks(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function As(e,t){Es=e,Cs=Ss=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bo=!0),e.firstContext=null)}function Rs(e){var t=e._currentValue;if(Cs!==e)if(e={context:e,memoizedValue:t,next:null},null===Ss){if(null===Es)throw Error(s(308));Ss=e,Es.dependencies={lanes:0,firstContext:e}}else Ss=Ss.next=e;return t}var js=null;function Ps(e){null===js?js=[e]:js.push(e)}function Os(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Ps(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ms(e,r)}function Ms(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ls=!1;function Ds(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Us(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Tl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ms(e,n)}return null===(i=r.interleaved)?(t.next=t,Ps(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ms(e,n)}function Vs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Bs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=a:s=s.next=a,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function zs(e,t,n,r){var i=e.updateQueue;Ls=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?s=c:a.next=c,a=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=i.baseState;for(a=0,u=c=l=null,o=s;;){var h=o.lane,p=o.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,d,h):f)||void 0===h)break e;d=D({},d,h);break e;case 2:Ls=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,a|=h;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(h=o).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);Ll|=a,e.lanes=a,e.memoizedState=d}}function Hs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var Gs={},Ws=Si(Gs),Ks=Si(Gs),Ys=Si(Gs);function Qs(e){if(e===Gs)throw Error(s(174));return e}function Js(e,t){switch(_i(Ys,t),_i(Ks,e),_i(Ws,Gs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ci(Ws),_i(Ws,t)}function Xs(){Ci(Ws),Ci(Ks),Ci(Ys)}function $s(e){Qs(Ys.current);var t=Qs(Ws.current),n=le(t,e.type);t!==n&&(_i(Ks,e),_i(Ws,n))}function Zs(e){Ks.current===e&&(Ci(Ws),Ci(Ks))}var ea=Si(0);function ta(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var na=[];function ra(){for(var e=0;e<na.length;e++)na[e]._workInProgressVersionPrimary=null;na.length=0}var ia=b.ReactCurrentDispatcher,sa=b.ReactCurrentBatchConfig,aa=0,oa=null,la=null,ca=null,ua=!1,da=!1,ha=0,pa=0;function fa(){throw Error(s(321))}function ma(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!lr(e[n],t[n]))return!1;return!0}function ga(e,t,n,r,i,a){if(aa=a,oa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ia.current=null===e||null===e.memoizedState?Za:eo,e=n(r,i),da){a=0;do{if(da=!1,ha=0,25<=a)throw Error(s(301));a+=1,ca=la=null,t.updateQueue=null,ia.current=to,e=n(r,i)}while(da)}if(ia.current=$a,t=null!==la&&null!==la.next,aa=0,ca=la=oa=null,ua=!1,t)throw Error(s(300));return e}function ya(){var e=0!==ha;return ha=0,e}function va(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ca?oa.memoizedState=ca=e:ca=ca.next=e,ca}function xa(){if(null===la){var e=oa.alternate;e=null!==e?e.memoizedState:null}else e=la.next;var t=null===ca?oa.memoizedState:ca.next;if(null!==t)ca=t,la=e;else{if(null===e)throw Error(s(310));e={memoizedState:(la=e).memoizedState,baseState:la.baseState,baseQueue:la.baseQueue,queue:la.queue,next:null},null===ca?oa.memoizedState=ca=e:ca=ca.next=e}return ca}function ba(e,t){return"function"===typeof t?t(e):t}function wa(e){var t=xa(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=la,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(null!==i){a=i.next,r=r.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((aa&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,o=r):c=c.next=h,oa.lanes|=d,Ll|=d}u=u.next}while(null!==u&&u!==a);null===c?o=r:c.next=l,lr(r,t.memoizedState)||(bo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{a=i.lane,oa.lanes|=a,Ll|=a,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ia(e){var t=xa(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{a=e(a,o.action),o=o.next}while(o!==i);lr(a,t.memoizedState)||(bo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Na(){}function Ea(e,t){var n=oa,r=xa(),i=t(),a=!lr(r.memoizedState,i);if(a&&(r.memoizedState=i,bo=!0),r=r.queue,La(_a.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==ca&&1&ca.memoizedState.tag){if(n.flags|=2048,Ra(9,Ca.bind(null,n,r,i,t),void 0,null),null===kl)throw Error(s(349));0!==(30&aa)||Sa(n,t,i)}return i}function Sa(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oa.updateQueue)?(t={lastEffect:null,stores:null},oa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ca(e,t,n,r){t.value=n,t.getSnapshot=r,Ta(t)&&ka(e)}function _a(e,t,n){return n(function(){Ta(t)&&ka(e)})}function Ta(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!lr(e,n)}catch(r){return!0}}function ka(e){var t=Ms(e,1);null!==t&&nc(t,e,1,-1)}function Aa(e){var t=va();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:e},t.queue=e,e=e.dispatch=Ya.bind(null,oa,e),[t.memoizedState,e]}function Ra(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=oa.updateQueue)?(t={lastEffect:null,stores:null},oa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function ja(){return xa().memoizedState}function Pa(e,t,n,r){var i=va();oa.flags|=e,i.memoizedState=Ra(1|t,n,void 0,void 0===r?null:r)}function Oa(e,t,n,r){var i=xa();r=void 0===r?null:r;var s=void 0;if(null!==la){var a=la.memoizedState;if(s=a.destroy,null!==r&&ma(r,a.deps))return void(i.memoizedState=Ra(t,n,s,r))}oa.flags|=e,i.memoizedState=Ra(1|t,n,s,r)}function Ma(e,t){return Pa(8390656,8,e,t)}function La(e,t){return Oa(2048,8,e,t)}function Da(e,t){return Oa(4,2,e,t)}function Fa(e,t){return Oa(4,4,e,t)}function qa(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ua(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oa(4,4,qa.bind(null,t,e),n)}function Va(){}function Ba(e,t){var n=xa();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function za(e,t){var n=xa();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ha(e,t,n){return 0===(21&aa)?(e.baseState&&(e.baseState=!1,bo=!0),e.memoizedState=n):(lr(n,t)||(n=mt(),oa.lanes|=n,Ll|=n,e.baseState=!0),t)}function Ga(e,t){var n=xt;xt=0!==n&&4>n?n:4,e(!0);var r=sa.transition;sa.transition={};try{e(!1),t()}finally{xt=n,sa.transition=r}}function Wa(){return xa().memoizedState}function Ka(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qa(e))Ja(t,n);else if(null!==(n=Os(e,t,n,r))){nc(n,e,r,ec()),Xa(n,t,r)}}function Ya(e,t,n){var r=tc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qa(e))Ja(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=s(a,n);if(i.hasEagerState=!0,i.eagerState=o,lr(o,a)){var l=t.interleaved;return null===l?(i.next=i,Ps(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Os(e,t,i,r))&&(nc(n,e,r,i=ec()),Xa(n,t,r))}}function Qa(e){var t=e.alternate;return e===oa||null!==t&&t===oa}function Ja(e,t){da=ua=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Xa(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var $a={readContext:Rs,useCallback:fa,useContext:fa,useEffect:fa,useImperativeHandle:fa,useInsertionEffect:fa,useLayoutEffect:fa,useMemo:fa,useReducer:fa,useRef:fa,useState:fa,useDebugValue:fa,useDeferredValue:fa,useTransition:fa,useMutableSource:fa,useSyncExternalStore:fa,useId:fa,unstable_isNewReconciler:!1},Za={readContext:Rs,useCallback:function(e,t){return va().memoizedState=[e,void 0===t?null:t],e},useContext:Rs,useEffect:Ma,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Pa(4194308,4,qa.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Pa(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pa(4,2,e,t)},useMemo:function(e,t){var n=va();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=va();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ka.bind(null,oa,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},va().memoizedState=e},useState:Aa,useDebugValue:Va,useDeferredValue:function(e){return va().memoizedState=e},useTransition:function(){var e=Aa(!1),t=e[0];return e=Ga.bind(null,e[1]),va().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=oa,i=va();if(ss){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===kl)throw Error(s(349));0!==(30&aa)||Sa(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Ma(_a.bind(null,r,a,e),[e]),r.flags|=2048,Ra(9,Ca.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=va(),t=kl.identifierPrefix;if(ss){var n=$i;t=":"+t+"R"+(n=(Xi&~(1<<32-at(Xi)-1)).toString(32)+n),0<(n=ha++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=pa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},eo={readContext:Rs,useCallback:Ba,useContext:Rs,useEffect:La,useImperativeHandle:Ua,useInsertionEffect:Da,useLayoutEffect:Fa,useMemo:za,useReducer:wa,useRef:ja,useState:function(){return wa(ba)},useDebugValue:Va,useDeferredValue:function(e){return Ha(xa(),la.memoizedState,e)},useTransition:function(){return[wa(ba)[0],xa().memoizedState]},useMutableSource:Na,useSyncExternalStore:Ea,useId:Wa,unstable_isNewReconciler:!1},to={readContext:Rs,useCallback:Ba,useContext:Rs,useEffect:La,useImperativeHandle:Ua,useInsertionEffect:Da,useLayoutEffect:Fa,useMemo:za,useReducer:Ia,useRef:ja,useState:function(){return Ia(ba)},useDebugValue:Va,useDeferredValue:function(e){var t=xa();return null===la?t.memoizedState=e:Ha(t,la.memoizedState,e)},useTransition:function(){return[Ia(ba)[0],xa().memoizedState]},useMutableSource:Na,useSyncExternalStore:Ea,useId:Wa,unstable_isNewReconciler:!1};function no(e,t){if(e&&e.defaultProps){for(var n in t=D({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ro(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:D({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var io={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),s=qs(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,i))&&(nc(t,e,i,r),Vs(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),s=qs(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,i))&&(nc(t,e,i,r),Vs(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),i=qs(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Us(e,i,r))&&(nc(t,e,r,n),Vs(t,e,r))}};function so(e,t,n,r,i,s,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,a):!t.prototype||!t.prototype.isPureReactComponent||(!cr(n,r)||!cr(i,s))}function ao(e,t,n){var r=!1,i=Ti,s=t.contextType;return"object"===typeof s&&null!==s?s=Rs(s):(i=Pi(t)?Ri:ki.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?ji(e,i):Ti),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=io,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function oo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&io.enqueueReplaceState(t,t.state,null)}function lo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Ds(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=Rs(s):(s=Pi(t)?Ri:ki.current,i.context=ji(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ro(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&io.enqueueReplaceState(i,i.state,null),zs(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function co(e,t){try{var n="",r=t;do{n+=V(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function uo(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ho(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var po="function"===typeof WeakMap?WeakMap:Map;function fo(e,t,n){(n=qs(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hl||(Hl=!0,Gl=r),ho(0,t)},n}function mo(e,t,n){(n=qs(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ho(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){ho(0,t),"function"!==typeof r&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function go(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new po;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Sc.bind(null,e,t,n),t.then(e,e))}function yo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vo(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=qs(-1,1)).tag=2,Us(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var xo=b.ReactCurrentOwner,bo=!1;function wo(e,t,n,r){t.child=null===e?Is(t,null,n,r):ws(t,e.child,n,r)}function Io(e,t,n,r,i){n=n.render;var s=t.ref;return As(t,i),r=ga(e,t,n,r,s,i),n=ya(),null===e||bo?(ss&&n&&ts(t),t.flags|=1,wo(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ho(e,t,i))}function No(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||jc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Eo(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var a=s.memoizedProps;if((n=null!==(n=n.compare)?n:cr)(a,r)&&e.ref===t.ref)return Ho(e,t,i)}return t.flags|=1,(e=Pc(s,r)).ref=t.ref,e.return=t,t.child=e}function Eo(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(cr(s,r)&&e.ref===t.ref){if(bo=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,Ho(e,t,i);0!==(131072&e.flags)&&(bo=!0)}}return _o(e,t,n,r,i)}function So(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},_i(Pl,jl),jl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,_i(Pl,jl),jl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,_i(Pl,jl),jl|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,_i(Pl,jl),jl|=r;return wo(e,t,i,n),t.child}function Co(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function _o(e,t,n,r,i){var s=Pi(n)?Ri:ki.current;return s=ji(t,s),As(t,i),n=ga(e,t,n,r,s,i),r=ya(),null===e||bo?(ss&&r&&ts(t),t.flags|=1,wo(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ho(e,t,i))}function To(e,t,n,r,i){if(Pi(n)){var s=!0;Di(t)}else s=!1;if(As(t,i),null===t.stateNode)zo(e,t),ao(t,n,r),lo(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=Rs(c):c=ji(t,c=Pi(n)?Ri:ki.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==r||l!==c)&&oo(t,a,r,c),Ls=!1;var h=t.memoizedState;a.state=h,zs(t,r,a,i),l=t.memoizedState,o!==r||h!==l||Ai.current||Ls?("function"===typeof u&&(ro(t,n,u,r),l=t.memoizedState),(o=Ls||so(t,n,o,r,h,l,c))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=c,r=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Fs(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:no(t.type,o),a.props=c,d=t.pendingProps,h=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=Rs(l):l=ji(t,l=Pi(n)?Ri:ki.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==d||h!==l)&&oo(t,a,r,l),Ls=!1,h=t.memoizedState,a.state=h,zs(t,r,a,i);var f=t.memoizedState;o!==d||h!==f||Ai.current||Ls?("function"===typeof p&&(ro(t,n,p,r),f=t.memoizedState),(c=Ls||so(t,n,c,r,h,f,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),a.props=r,a.state=f,a.context=l,r=c):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return ko(e,t,n,r,s,i)}function ko(e,t,n,r,i,s){Co(e,t);var a=0!==(128&t.flags);if(!r&&!a)return i&&Fi(t,n,!1),Ho(e,t,s);r=t.stateNode,xo.current=t;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=ws(t,e.child,null,s),t.child=ws(t,null,o,s)):wo(e,t,o,s),t.memoizedState=r.state,i&&Fi(t,n,!0),t.child}function Ao(e){var t=e.stateNode;t.pendingContext?Mi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Mi(0,t.context,!1),Js(e,t.containerInfo)}function Ro(e,t,n,r,i){return fs(),ms(i),t.flags|=256,wo(e,t,n,r),t.child}var jo,Po,Oo,Mo={dehydrated:null,treeContext:null,retryLane:0};function Lo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Do(e,t,n){var r,i=t.pendingProps,a=ea.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),_i(ea,1&a),null===e)return us(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,o?(i=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Lc(l,i,0,null),e=Mc(e,i,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Lo(n),t.memoizedState=Mo,e):Fo(t,l));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,i,a,o){if(n)return 256&t.flags?(t.flags&=-257,qo(e,t,o,r=uo(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Lc({mode:"visible",children:r.children},i,0,null),(a=Mc(a,i,o,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&ws(t,e.child,null,o),t.child.memoizedState=Lo(o),t.memoizedState=Mo,a);if(0===(1&t.mode))return qo(e,t,o,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,qo(e,t,o,r=uo(a=Error(s(419)),r,void 0))}if(l=0!==(o&e.childLanes),bo||l){if(null!==(r=kl)){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|o))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Ms(e,i),nc(r,e,i,-1))}return mc(),qo(e,t,o,r=uo(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=_c.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,is=ui(i.nextSibling),rs=t,ss=!0,as=null,null!==e&&(Yi[Qi++]=Xi,Yi[Qi++]=$i,Yi[Qi++]=Ji,Xi=e.id,$i=e.overflow,Ji=t),t=Fo(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,a,n);if(o){o=i.fallback,l=t.mode,r=(a=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==a?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Pc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==r?o=Pc(r,o):(o=Mc(o,l,n,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,l=null===(l=e.child.memoizedState)?Lo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Mo,i}return e=(o=e.child).sibling,i=Pc(o,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Fo(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function qo(e,t,n,r){return null!==r&&ms(r),ws(t,e.child,null,n),(e=Fo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Uo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ks(e.return,t,n)}function Vo(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Bo(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(wo(e,t,r.children,n),0!==(2&(r=ea.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Uo(e,n,t);else if(19===e.tag)Uo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(_i(ea,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ta(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Vo(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ta(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Vo(t,!0,n,null,s);break;case"together":Vo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function zo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ho(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ll|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Go(e,t){if(!ss)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Wo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ko(e,t,n){var r=t.pendingProps;switch(ns(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wo(t),null;case 1:case 17:return Pi(t.type)&&Oi(),Wo(t),null;case 3:return r=t.stateNode,Xs(),Ci(Ai),Ci(ki),ra(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==as&&(ac(as),as=null))),Wo(t),null;case 5:Zs(t);var i=Qs(Ys.current);if(n=t.type,null!==e&&null!=t.stateNode)Po(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Wo(t),null}if(e=Qs(Ws.current),hs(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[pi]=t,r[fi]=a,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(i=0;i<Lr.length;i++)Ur(Lr[i],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":J(r,a),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Ur("invalid",r);break;case"textarea":ie(r,a),Ur("invalid",r)}for(var l in ve(n,a),i=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==a.suppressHydrationWarning&&Zr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Zr(r.textContent,c,e),i=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ur("scroll",r)}switch(n){case"input":W(r),Z(r,a,!0);break;case"textarea":W(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=ei)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[pi]=t,e[fi]=r,jo(e,t),t.stateNode=e;e:{switch(l=xe(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),i=r;break;case"iframe":case"object":case"embed":Ur("load",e),i=r;break;case"video":case"audio":for(i=0;i<Lr.length;i++)Ur(Lr[i],e);i=r;break;case"source":Ur("error",e),i=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),i=r;break;case"details":Ur("toggle",e),i=r;break;case"input":J(e,r),i=Q(e,r),Ur("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=D({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Ur("invalid",e)}for(a in ve(n,i),c=i)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?ge(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===a?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Ur("scroll",e):null!=u&&x(e,a,u,l))}switch(n){case"input":W(e),Z(e,r,!1);break;case"textarea":W(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=ei)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Wo(t),null;case 6:if(e&&null!=t.stateNode)Oo(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Qs(Ys.current),Qs(Ws.current),hs(t)){if(r=t.stateNode,n=t.memoizedProps,r[pi]=t,(a=r.nodeValue!==n)&&null!==(e=rs))switch(e.tag){case 3:Zr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zr(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[pi]=t,t.stateNode=r}return Wo(t),null;case 13:if(Ci(ea),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ss&&null!==is&&0!==(1&t.mode)&&0===(128&t.flags))ps(),fs(),t.flags|=98560,a=!1;else if(a=hs(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(s(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(s(317));a[pi]=t}else fs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Wo(t),a=!1}else null!==as&&(ac(as),as=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ea.current)?0===Ol&&(Ol=3):mc())),null!==t.updateQueue&&(t.flags|=4),Wo(t),null);case 4:return Xs(),null===e&&zr(t.stateNode.containerInfo),Wo(t),null;case 10:return Ts(t.type._context),Wo(t),null;case 19:if(Ci(ea),null===(a=t.memoizedState))return Wo(t),null;if(r=0!==(128&t.flags),null===(l=a.rendering))if(r)Go(a,!1);else{if(0!==Ol||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ta(e))){for(t.flags|=128,Go(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return _i(ea,1&ea.current|2),t.child}e=e.sibling}null!==a.tail&&Xe()>Bl&&(t.flags|=128,r=!0,Go(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ta(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Go(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!ss)return Wo(t),null}else 2*Xe()-a.renderingStartTime>Bl&&1073741824!==n&&(t.flags|=128,r=!0,Go(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Xe(),t.sibling=null,n=ea.current,_i(ea,r?1&n|2:1&n),t):(Wo(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&jl)&&(Wo(t),6&t.subtreeFlags&&(t.flags|=8192)):Wo(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Yo(e,t){switch(ns(t),t.tag){case 1:return Pi(t.type)&&Oi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xs(),Ci(Ai),Ci(ki),ra(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zs(t),null;case 13:if(Ci(ea),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ci(ea),null;case 4:return Xs(),null;case 10:return Ts(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}jo=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Po=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Qs(Ws.current);var s,a=null;switch(n){case"input":i=Q(e,i),r=Q(e,r),a=[];break;case"select":i=D({},i,{value:void 0}),r=D({},r,{value:void 0}),a=[];break;case"textarea":i=re(e,i),r=re(e,r),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=ei)}for(u in ve(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ur("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Oo=function(e,t,n,r){n!==r&&(t.flags|=4)};var Qo=!1,Jo=!1,Xo="function"===typeof WeakSet?WeakSet:Set,$o=null;function Zo(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Ec(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Ec(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&el(t,n,s)}i=i.next}while(i!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[pi],delete t[fi],delete t[gi],delete t[yi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=ei));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(o){}switch(n.tag){case 5:Jo||Zo(n,t);case 6:var r=ul,i=dl;ul=null,hl(e,t,n),dl=i,null!==(ul=r)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?ci(e.parentNode,n):1===e.nodeType&&ci(e,n),Bt(e)):ci(ul,n.stateNode));break;case 4:r=ul,i=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=r,dl=i;break;case 0:case 11:case 14:case 15:if(!Jo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,void 0!==a&&(0!==(2&s)||0!==(4&s))&&el(n,t,a),i=i.next}while(i!==r)}hl(e,t,n);break;case 1:if(!Jo&&(Zo(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Ec(n,t,o)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Jo=(r=Jo)||null!==n.memoizedState,hl(e,t,n),Jo=r):hl(e,t,n);break;default:hl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xo),t.forEach(function(t){var r=Tc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(s(160));pl(a,o,i),ul=null,dl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){Ec(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){Ec(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Ec(e,e.return,g)}}break;case 1:ml(t,e),yl(e),512&r&&null!==n&&Zo(n,n.return);break;case 5:if(ml(t,e),yl(e),512&r&&null!==n&&Zo(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(g){Ec(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var a=e.memoizedProps,o=null!==n?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&X(i,a),xe(l,o);var u=xe(l,a);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];"style"===d?ge(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):x(i,d,h,u)}switch(l){case"input":$(i,a);break;case"textarea":se(i,a);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var f=a.value;null!=f?ne(i,!!a.multiple,f,!1):p!==!!a.multiple&&(null!=a.defaultValue?ne(i,!!a.multiple,a.defaultValue,!0):ne(i,!!a.multiple,a.multiple?[]:"",!1))}i[fi]=a}catch(g){Ec(e,e.return,g)}}break;case 6:if(ml(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){Ec(e,e.return,g)}}break;case 3:if(ml(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(g){Ec(e,e.return,g)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(Vl=Xe())),4&r&&fl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Jo=(u=Jo)||d,ml(t,e),Jo=u):ml(t,e),yl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for($o=e,d=e.child;null!==d;){for(h=$o=d;null!==$o;){switch(f=(p=$o).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:Zo(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Ec(r,n,g)}}break;case 5:Zo(p,p.return);break;case 22:if(null!==p.memoizedState){wl(h);continue}}null!==f?(f.return=p,$o=f):wl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,u?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",o))}catch(g){Ec(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Ec(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),yl(e),4&r&&fl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),cl(e,ol(e),i);break;case 3:case 4:var a=r.stateNode.containerInfo;ll(e,ol(e),a);break;default:throw Error(s(161))}}catch(o){Ec(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){$o=e,xl(e,t,n)}function xl(e,t,n){for(var r=0!==(1&e.mode);null!==$o;){var i=$o,s=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||Qo;if(!a){var o=i.alternate,l=null!==o&&null!==o.memoizedState||Jo;o=Qo;var c=Jo;if(Qo=a,(Jo=l)&&!c)for($o=i;null!==$o;)l=(a=$o).child,22===a.tag&&null!==a.memoizedState?Il(i):null!==l?(l.return=a,$o=l):Il(i);for(;null!==s;)$o=s,xl(s,t,n),s=s.sibling;$o=i,Qo=o,Jo=c}bl(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,$o=s):bl(e)}}function bl(e){for(;null!==$o;){var t=$o;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Jo||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Jo)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:no(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Hs(t,a,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Hs(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Bt(h)}}}break;default:throw Error(s(163))}Jo||512&t.flags&&il(t)}catch(p){Ec(t,t.return,p)}}if(t===e){$o=null;break}if(null!==(n=t.sibling)){n.return=t.return,$o=n;break}$o=t.return}}function wl(e){for(;null!==$o;){var t=$o;if(t===e){$o=null;break}var n=t.sibling;if(null!==n){n.return=t.return,$o=n;break}$o=t.return}}function Il(e){for(;null!==$o;){var t=$o;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Ec(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Ec(t,i,l)}}var s=t.return;try{il(t)}catch(l){Ec(t,s,l)}break;case 5:var a=t.return;try{il(t)}catch(l){Ec(t,a,l)}}}catch(l){Ec(t,t.return,l)}if(t===e){$o=null;break}var o=t.sibling;if(null!==o){o.return=t.return,$o=o;break}$o=t.return}}var Nl,El=Math.ceil,Sl=b.ReactCurrentDispatcher,Cl=b.ReactCurrentOwner,_l=b.ReactCurrentBatchConfig,Tl=0,kl=null,Al=null,Rl=0,jl=0,Pl=Si(0),Ol=0,Ml=null,Ll=0,Dl=0,Fl=0,ql=null,Ul=null,Vl=0,Bl=1/0,zl=null,Hl=!1,Gl=null,Wl=null,Kl=!1,Yl=null,Ql=0,Jl=0,Xl=null,$l=-1,Zl=0;function ec(){return 0!==(6&Tl)?Xe():-1!==$l?$l:$l=Xe()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Tl)&&0!==Rl?Rl&-Rl:null!==gs.transition?(0===Zl&&(Zl=mt()),Zl):0!==(e=xt)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function nc(e,t,n,r){if(50<Jl)throw Jl=0,Xl=null,Error(s(185));yt(e,n,r),0!==(2&Tl)&&e===kl||(e===kl&&(0===(2&Tl)&&(Dl|=n),4===Ol&&oc(e,Rl)),rc(e,r),1===n&&0===Tl&&0===(1&t.mode)&&(Bl=Xe()+500,Ui&&zi()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-at(s),o=1<<a,l=i[a];-1===l?0!==(o&n)&&0===(o&r)||(i[a]=pt(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var r=ht(e,e===kl?Rl:0);if(0===r)null!==n&&Ye(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ye(n),1===t)0===e.tag?function(e){Ui=!0,Bi(e)}(lc.bind(null,e)):Bi(lc.bind(null,e)),oi(function(){0===(6&Tl)&&zi()}),n=null;else{switch(bt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=kc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if($l=-1,Zl=0,0!==(6&Tl))throw Error(s(327));var n=e.callbackNode;if(Ic()&&e.callbackNode!==n)return null;var r=ht(e,e===kl?Rl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var i=Tl;Tl|=2;var a=fc();for(kl===e&&Rl===t||(zl=null,Bl=Xe()+500,hc(e,t));;)try{vc();break}catch(l){pc(e,l)}_s(),Sl.current=a,Tl=i,null!==Al?t=0:(kl=null,Rl=0,t=Ol)}if(0!==t){if(2===t&&(0!==(i=ft(e))&&(r=i,t=sc(e,i))),1===t)throw n=Ml,hc(e,0),oc(e,r),rc(e,Xe()),n;if(6===t)oc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!lr(s(),i))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=gc(e,r))&&(0!==(a=ft(e))&&(r=a,t=sc(e,a))),1===t))throw n=Ml,hc(e,0),oc(e,r),rc(e,Xe()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:wc(e,Ul,zl);break;case 3:if(oc(e,r),(130023424&r)===r&&10<(t=Vl+500-Xe())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ii(wc.bind(null,e,Ul,zl),t);break}wc(e,Ul,zl);break;case 4:if(oc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-at(r);a=1<<o,(o=t[o])>i&&(i=o),r&=~a}if(r=i,10<(r=(120>(r=Xe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*El(r/1960))-r)){e.timeoutHandle=ii(wc.bind(null,e,Ul,zl),r);break}wc(e,Ul,zl);break;default:throw Error(s(329))}}}return rc(e,Xe()),e.callbackNode===n?ic.bind(null,e):null}function sc(e,t){var n=ql;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Ul,Ul=n,null!==t&&ac(t)),e}function ac(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function oc(e,t){for(t&=~Fl,t&=~Dl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&Tl))throw Error(s(327));Ic();var t=ht(e,0);if(0===(1&t))return rc(e,Xe()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=sc(e,r))}if(1===n)throw n=Ml,hc(e,0),oc(e,t),rc(e,Xe()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Ul,zl),rc(e,Xe()),null}function cc(e,t){var n=Tl;Tl|=1;try{return e(t)}finally{0===(Tl=n)&&(Bl=Xe()+500,Ui&&zi())}}function uc(e){null!==Yl&&0===Yl.tag&&0===(6&Tl)&&Ic();var t=Tl;Tl|=1;var n=_l.transition,r=xt;try{if(_l.transition=null,xt=1,e)return e()}finally{xt=r,_l.transition=n,0===(6&(Tl=t))&&zi()}}function dc(){jl=Pl.current,Ci(Pl)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,si(n)),null!==Al)for(n=Al.return;null!==n;){var r=n;switch(ns(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Oi();break;case 3:Xs(),Ci(Ai),Ci(ki),ra();break;case 5:Zs(r);break;case 4:Xs();break;case 13:case 19:Ci(ea);break;case 10:Ts(r.type._context);break;case 22:case 23:dc()}n=n.return}if(kl=e,Al=e=Pc(e.current,null),Rl=jl=t,Ol=0,Ml=null,Fl=Dl=Ll=0,Ul=ql=null,null!==js){for(t=0;t<js.length;t++)if(null!==(r=(n=js[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var a=s.next;s.next=i,r.next=a}n.pending=r}js=null}return e}function pc(e,t){for(;;){var n=Al;try{if(_s(),ia.current=$a,ua){for(var r=oa.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ua=!1}if(aa=0,ca=la=oa=null,da=!1,ha=0,Cl.current=null,null===n||null===n.return){Ol=1,Ml=t,Al=null;break}e:{var a=e,o=n.return,l=n,c=t;if(t=Rl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=yo(o);if(null!==f){f.flags&=-257,vo(f,o,l,0,t),1&f.mode&&go(a,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){go(a,u,t),mc();break e}c=Error(s(426))}else if(ss&&1&l.mode){var y=yo(o);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),vo(y,o,l,0,t),ms(co(c,l));break e}}a=c=co(c,l),4!==Ol&&(Ol=2),null===ql?ql=[a]:ql.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Bs(a,fo(0,c,t));break e;case 1:l=c;var v=a.type,x=a.stateNode;if(0===(128&a.flags)&&("function"===typeof v.getDerivedStateFromError||null!==x&&"function"===typeof x.componentDidCatch&&(null===Wl||!Wl.has(x)))){a.flags|=65536,t&=-t,a.lanes|=t,Bs(a,mo(a,l,t));break e}}a=a.return}while(null!==a)}bc(n)}catch(b){t=b,Al===n&&null!==n&&(Al=n=n.return);continue}break}}function fc(){var e=Sl.current;return Sl.current=$a,null===e?$a:e}function mc(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===kl||0===(268435455&Ll)&&0===(268435455&Dl)||oc(kl,Rl)}function gc(e,t){var n=Tl;Tl|=2;var r=fc();for(kl===e&&Rl===t||(zl=null,hc(e,t));;)try{yc();break}catch(i){pc(e,i)}if(_s(),Tl=n,Sl.current=r,null!==Al)throw Error(s(261));return kl=null,Rl=0,Ol}function yc(){for(;null!==Al;)xc(Al)}function vc(){for(;null!==Al&&!Qe();)xc(Al)}function xc(e){var t=Nl(e.alternate,e,jl);e.memoizedProps=e.pendingProps,null===t?bc(e):Al=t,Cl.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ko(n,t,jl)))return void(Al=n)}else{if(null!==(n=Yo(n,t)))return n.flags&=32767,void(Al=n);if(null===e)return Ol=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Ol&&(Ol=5)}function wc(e,t,n){var r=xt,i=_l.transition;try{_l.transition=null,xt=1,function(e,t,n,r){do{Ic()}while(null!==Yl);if(0!==(6&Tl))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-at(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,a),e===kl&&(Al=kl=null,Rl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,kc(tt,function(){return Ic(),null})),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=_l.transition,_l.transition=null;var o=xt;xt=1;var l=Tl;Tl|=4,Cl.current=null,function(e,t){if(ti=Ht,fr(e=pr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(w){n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==i&&3!==h.nodeType||(l=o+i),h!==a||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===i&&(l=o),p===a&&++d===r&&(c=o),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ni={focusedElem:e,selectionRange:n},Ht=!1,$o=t;null!==$o;)if(e=(t=$o).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,$o=e;else for(;null!==$o;){t=$o;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,x=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:no(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(s(163))}}catch(w){Ec(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,$o=e;break}$o=t.return}m=tl,tl=!1}(e,n),gl(n,e),mr(ni),Ht=!!ti,ni=ti=null,e.current=n,vl(n,e,i),Je(),Tl=l,xt=o,_l.transition=a}else e.current=n;if(Kl&&(Kl=!1,Yl=e,Ql=i),a=e.pendingLanes,0===a&&(Wl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Xe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Hl)throw Hl=!1,e=Gl,Gl=null,e;0!==(1&Ql)&&0!==e.tag&&Ic(),a=e.pendingLanes,0!==(1&a)?e===Xl?Jl++:(Jl=0,Xl=e):Jl=0,zi()}(e,t,n,r)}finally{_l.transition=i,xt=r}return null}function Ic(){if(null!==Yl){var e=bt(Ql),t=_l.transition,n=xt;try{if(_l.transition=null,xt=16>e?16:e,null===Yl)var r=!1;else{if(e=Yl,Yl=null,Ql=0,0!==(6&Tl))throw Error(s(331));var i=Tl;for(Tl|=4,$o=e.current;null!==$o;){var a=$o,o=a.child;if(0!==(16&$o.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for($o=u;null!==$o;){var d=$o;switch(d.tag){case 0:case 11:case 15:nl(8,d,a)}var h=d.child;if(null!==h)h.return=d,$o=h;else for(;null!==$o;){var p=(d=$o).sibling,f=d.return;if(sl(d),d===u){$o=null;break}if(null!==p){p.return=f,$o=p;break}$o=f}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}$o=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,$o=o;else e:for(;null!==$o;){if(0!==(2048&(a=$o).flags))switch(a.tag){case 0:case 11:case 15:nl(9,a,a.return)}var v=a.sibling;if(null!==v){v.return=a.return,$o=v;break e}$o=a.return}}var x=e.current;for($o=x;null!==$o;){var b=(o=$o).child;if(0!==(2064&o.subtreeFlags)&&null!==b)b.return=o,$o=b;else e:for(o=x;null!==$o;){if(0!==(2048&(l=$o).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(I){Ec(l,l.return,I)}if(l===o){$o=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,$o=w;break e}$o=l.return}}if(Tl=i,zi(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(I){}r=!0}return r}finally{xt=n,_l.transition=t}}return!1}function Nc(e,t,n){e=Us(e,t=fo(0,t=co(n,t),1),1),t=ec(),null!==e&&(yt(e,1,t),rc(e,t))}function Ec(e,t,n){if(3===e.tag)Nc(e,e,n);else for(;null!==t;){if(3===t.tag){Nc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Wl||!Wl.has(r))){t=Us(t,e=mo(t,e=co(n,e),1),1),e=ec(),null!==t&&(yt(t,1,e),rc(t,e));break}}t=t.return}}function Sc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,kl===e&&(Rl&n)===n&&(4===Ol||3===Ol&&(130023424&Rl)===Rl&&500>Xe()-Vl?hc(e,0):Fl|=n),rc(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Ms(e,t))&&(yt(e,t,n),rc(e,n))}function _c(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cc(e,n)}function Tc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Cc(e,n)}function kc(e,t){return Ke(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(e,t,n,r){return new Ac(e,t,n,r)}function jc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=Rc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,r,i,a){var o=2;if(r=e,"function"===typeof e)jc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case N:return Mc(n.children,i,a,t);case E:o=8,i|=8;break;case S:return(e=Rc(12,n,t,2|i)).elementType=S,e.lanes=a,e;case k:return(e=Rc(13,n,t,i)).elementType=k,e.lanes=a,e;case A:return(e=Rc(19,n,t,i)).elementType=A,e.lanes=a,e;case P:return Lc(n,i,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:o=10;break e;case _:o=9;break e;case T:o=11;break e;case R:o=14;break e;case j:o=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Rc(o,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Mc(e,t,n,r){return(e=Rc(7,e,r,t)).lanes=n,e}function Lc(e,t,n,r){return(e=Rc(22,e,r,t)).elementType=P,e.lanes=n,e.stateNode={isHidden:!1},e}function Dc(e,t,n){return(e=Rc(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Rc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Uc(e,t,n,r,i,s,a,o,l){return e=new qc(e,t,n,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Rc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ds(s),e}function Vc(e){if(!e)return Ti;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Pi(n))return Li(e,n,t)}return t}function Bc(e,t,n,r,i,s,a,o,l){return(e=Uc(n,r,!0,e,0,s,0,o,l)).context=Vc(null),n=e.current,(s=qs(r=ec(),i=tc(n))).callback=void 0!==t&&null!==t?t:null,Us(n,s,i),e.current.lanes=i,yt(e,i,r),rc(e,r),e}function zc(e,t,n,r){var i=t.current,s=ec(),a=tc(i);return n=Vc(n),null===t.context?t.context=n:t.pendingContext=n,(t=qs(s,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Us(i,t,a))&&(nc(e,i,a,s),Vs(e,i,a)),a}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Wc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}Nl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ai.current)bo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bo=!1,function(e,t,n){switch(t.tag){case 3:Ao(t),fs();break;case 5:$s(t);break;case 1:Pi(t.type)&&Di(t);break;case 4:Js(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;_i(Ns,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(_i(ea,1&ea.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Do(e,t,n):(_i(ea,1&ea.current),null!==(e=Ho(e,t,n))?e.sibling:null);_i(ea,1&ea.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Bo(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),_i(ea,ea.current),r)break;return null;case 22:case 23:return t.lanes=0,So(e,t,n)}return Ho(e,t,n)}(e,t,n);bo=0!==(131072&e.flags)}else bo=!1,ss&&0!==(1048576&t.flags)&&es(t,Ki,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;zo(e,t),e=t.pendingProps;var i=ji(t,ki.current);As(t,n),i=ga(null,t,r,e,i,n);var a=ya();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pi(r)?(a=!0,Di(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ds(t),i.updater=io,t.stateNode=i,i._reactInternals=t,lo(t,r,e,n),t=ko(null,t,r,!0,a,n)):(t.tag=0,ss&&a&&ts(t),wo(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(zo(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return jc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===R)return 14}return 2}(r),e=no(r,e),i){case 0:t=_o(null,t,r,e,n);break e;case 1:t=To(null,t,r,e,n);break e;case 11:t=Io(null,t,r,e,n);break e;case 14:t=No(null,t,r,no(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,_o(e,t,r,i=t.elementType===r?i:no(r,i),n);case 1:return r=t.type,i=t.pendingProps,To(e,t,r,i=t.elementType===r?i:no(r,i),n);case 3:e:{if(Ao(t),null===e)throw Error(s(387));r=t.pendingProps,i=(a=t.memoizedState).element,Fs(e,t),zs(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Ro(e,t,r,n,i=co(Error(s(423)),t));break e}if(r!==i){t=Ro(e,t,r,n,i=co(Error(s(424)),t));break e}for(is=ui(t.stateNode.containerInfo.firstChild),rs=t,ss=!0,as=null,n=Is(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),r===i){t=Ho(e,t,n);break e}wo(e,t,r,n)}t=t.child}return t;case 5:return $s(t),null===e&&us(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,o=i.children,ri(r,i)?o=null:null!==a&&ri(r,a)&&(t.flags|=32),Co(e,t),wo(e,t,o,n),t.child;case 6:return null===e&&us(t),null;case 13:return Do(e,t,n);case 4:return Js(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ws(t,null,r,n):wo(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Io(e,t,r,i=t.elementType===r?i:no(r,i),n);case 7:return wo(e,t,t.pendingProps,n),t.child;case 8:case 12:return wo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,_i(Ns,r._currentValue),r._currentValue=o,null!==a)if(lr(a.value,o)){if(a.children===i.children&&!Ai.current){t=Ho(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===a.tag){(c=qs(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),ks(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(s(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),ks(o,n,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}wo(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,As(t,n),r=r(i=Rs(i)),t.flags|=1,wo(e,t,r,n),t.child;case 14:return i=no(r=t.type,t.pendingProps),No(e,t,r,i=no(r.type,i),n);case 15:return Eo(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:no(r,i),zo(e,t),t.tag=1,Pi(r)?(e=!0,Di(t)):e=!1,As(t,n),ao(t,r,i),lo(t,r,i,n),ko(null,t,r,!0,e,n);case 19:return Bo(e,t,n);case 22:return So(e,t,n)}throw Error(s(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Qc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $c(){}function Zc(e,t,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if("function"===typeof i){var o=i;i=function(){var e=Hc(a);o.call(e)}}zc(t,a,e,i)}else a=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=Hc(a);s.call(e)}}var a=Bc(t,r,e,0,null,!1,0,"",$c);return e._reactRootContainer=a,e[mi]=a.current,zr(8===e.nodeType?e.parentNode:e),uc(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var o=r;r=function(){var e=Hc(l);o.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",$c);return e._reactRootContainer=l,e[mi]=l.current,zr(8===e.nodeType?e.parentNode:e),uc(function(){zc(t,l,n,r)}),l}(n,t,e,i,r);return Hc(a)}Qc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));zc(e,t,null,null)},Qc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){zc(null,e,null,null)}),t[mi]=null}},Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pt.length&&0!==t&&t<Pt[n].priority;n++);Pt.splice(n,0,e),0===n&&Dt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),rc(t,Xe()),0===(6&Tl)&&(Bl=Xe()+500,zi()))}break;case 13:uc(function(){var t=Ms(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),Wc(e,1)}},It=function(e){if(13===e.tag){var t=Ms(e,134217728);if(null!==t)nc(t,e,134217728,ec());Wc(e,134217728)}},Nt=function(e){if(13===e.tag){var t=tc(e),n=Ms(e,t);if(null!==n)nc(n,e,t,ec());Wc(e,t)}},Et=function(){return xt},St=function(e,t){var n=xt;try{return xt=e,t()}finally{xt=n}},Ie=function(e,t,n){switch(t){case"input":if($(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Ii(r);if(!i)throw Error(s(90));K(r),$(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Te=cc,ke=uc;var eu={usingClientEntryPoint:!1,Events:[bi,wi,Ii,Ce,_e,cc]},tu={findFiberByHostInstance:xi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{it=ru.inject(nu),st=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:I,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jc(e))throw Error(s(299));var n=!1,r="",i=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Uc(e,1,!1,null,0,n,0,r,i),e[mi]=t.current,zr(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Xc(t))throw Error(s(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jc(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,a="",o=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Bc(t,null,e,1,null!=n?n:null,i,0,a,o),e[mi]=t.current,zr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Qc(t)},t.render=function(e,t,n){if(!Xc(t))throw Error(s(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(s(40));return!!e._reactRootContainer&&(uc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[mi]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},784(e,t,n){n.d(t,{A:()=>h});var r=n(555),i=n(986),s=n(43);const a=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const c=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],u=(0,s.forwardRef)((e,t)=>{let{color:n="currentColor",size:a=24,strokeWidth:u=2,absoluteStrokeWidth:d,className:h="",children:p,iconNode:f}=e,m=(0,i.A)(e,c);return(0,s.createElement)("svg",(0,r.A)((0,r.A)((0,r.A)({ref:t},l),{},{width:a,height:a,stroke:n,strokeWidth:d?24*Number(u)/Number(a):u,className:o("lucide",h)},!p&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"}),m),[...f.map(e=>{let[t,n]=e;return(0,s.createElement)(t,n)}),...Array.isArray(p)?p:[p]])}),d=["className"],h=(e,t)=>{const n=(0,s.forwardRef)((n,l)=>{let{className:c}=n,h=(0,i.A)(n,d);return(0,s.createElement)(u,(0,r.A)({ref:l,iconNode:t,className:o("lucide-".concat((p=a(e),p.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(e),c)},h));var p});return n.displayName=a(e),n}},800(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("bug",[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]])},819(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},853(e,t,n){e.exports=n(234)},935(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("stethoscope",[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]])},942(e,t,n){n.d(t,{A:()=>r});const r=(0,n(784).A)("bone",[["path",{d:"M17 10c.7-.7 1.69 0 2.5 0a2.5 2.5 0 1 0 0-5 .5.5 0 0 1-.5-.5 2.5 2.5 0 1 0-5 0c0 .81.7 1.8 0 2.5l-7 7c-.7.7-1.69 0-2.5 0a2.5 2.5 0 0 0 0 5c.28 0 .5.22.5.5a2.5 2.5 0 1 0 5 0c0-.81-.7-1.8 0-2.5Z",key:"w610uw"}]])},950(e,t,n){!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},986(e,t,n){function r(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}n.d(t,{A:()=>r})}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r=n(43),i=n(391),s=n(555),a=n(489),o=n(819),l=n(942),c=n(800),u=n(537),d=n(382),h=n(784);const p=(0,h.A)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]);var f=n(130);const m=(0,h.A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),g=(0,h.A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var y=n(629);const v=(0,h.A)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),x=(0,h.A)("flame",[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]]),b=(0,h.A)("split",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]]),w=(0,h.A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),I=(0,h.A)("timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);var N=n(12),E=n(73);const S=(0,h.A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),C=(0,h.A)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),_=(0,h.A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),T=(0,h.A)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),k=(0,h.A)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),A=(0,h.A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),R=(0,h.A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var j={};!function e(t,n,r,i){var s=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),a="function"===typeof Path2D&&"function"===typeof DOMMatrix;function o(){}function l(e){var r=n.exports.Promise,i=void 0!==r?r:t.Promise;return"function"===typeof i?new i(e):(e(o,o),null)}var c,u=function(e,t){return{transform:function(n){if(e)return n;if(t.has(n))return t.get(n);var r=new OffscreenCanvas(n.width,n.height);return r.getContext("2d").drawImage(n,0,0),t.set(n,r),r},clear:function(){t.clear()}}}(function(){if(!t.OffscreenCanvas)return!1;try{var e=new OffscreenCanvas(1,1),n=e.getContext("2d");n.fillRect(0,0,1,1);var r=e.transferToImageBitmap();n.createPattern(r,"no-repeat")}catch(i){return!1}return!0}(),new Map),d=function(){var e,t,n=Math.floor(1e3/60),r={},i=0;return"function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?(e=function(e){var t=Math.random();return r[t]=requestAnimationFrame(function s(a){i===a||i+n-1<a?(i=a,delete r[t],e()):r[t]=requestAnimationFrame(s)}),t},t=function(e){r[e]&&cancelAnimationFrame(r[e])}):(e=function(e){return setTimeout(e,n)},t=function(e){return clearTimeout(e)}),{frame:e,cancel:t}}(),h=function(){var t,n,i={};return function(){if(t)return t;if(!r&&s){var a=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join("\n");try{t=new Worker(URL.createObjectURL(new Blob([a])))}catch(o){return"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn("\ud83c\udf8a Could not load worker",o),null}!function(e){function t(t,n){e.postMessage({options:t||{},callback:n})}e.init=function(t){var n=t.transferControlToOffscreen();e.postMessage({canvas:n},[n])},e.fire=function(r,s,a){if(n)return t(r,null),n;var o=Math.random().toString(36).slice(2);return n=l(function(s){function l(t){t.data.callback===o&&(delete i[o],e.removeEventListener("message",l),n=null,u.clear(),a(),s())}e.addEventListener("message",l),t(r,o),i[o]=l.bind(null,{data:{callback:o}})})},e.reset=function(){for(var t in e.postMessage({reset:!0}),i)i[t](),delete i[t]}}(t)}return t}}(),p={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function f(e,t,n){return function(e,t){return t?t(e):e}(e&&(null!==(r=e[t])&&void 0!==r)?e[t]:p[t],n);var r}function m(e){return e<0?0:Math.floor(e)}function g(e,t){return Math.floor(Math.random()*(t-e))+e}function y(e){return parseInt(e,16)}function v(e){return e.map(x)}function x(e){var t=String(e).replace(/[^0-9a-f]/gi,"");return t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),{r:y(t.substring(0,2)),g:y(t.substring(2,4)),b:y(t.substring(4,6))}}function b(e){e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight}function w(e){var t=e.getBoundingClientRect();e.width=t.width,e.height=t.height}function I(e){var t=e.angle*(Math.PI/180),n=e.spread*(Math.PI/180);return{x:e.x,y:e.y,wobble:10*Math.random(),wobbleSpeed:Math.min(.11,.1*Math.random()+.05),velocity:.5*e.startVelocity+Math.random()*e.startVelocity,angle2D:-t+(.5*n-Math.random()*n),tiltAngle:(.5*Math.random()+.25)*Math.PI,color:e.color,shape:e.shape,tick:0,totalTicks:e.ticks,decay:e.decay,drift:e.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*e.gravity,ovalScalar:.6,scalar:e.scalar,flat:e.flat}}function N(e,t){t.x+=Math.cos(t.angle2D)*t.velocity+t.drift,t.y+=Math.sin(t.angle2D)*t.velocity+t.gravity,t.velocity*=t.decay,t.flat?(t.wobble=0,t.wobbleX=t.x+10*t.scalar,t.wobbleY=t.y+10*t.scalar,t.tiltSin=0,t.tiltCos=0,t.random=1):(t.wobble+=t.wobbleSpeed,t.wobbleX=t.x+10*t.scalar*Math.cos(t.wobble),t.wobbleY=t.y+10*t.scalar*Math.sin(t.wobble),t.tiltAngle+=.1,t.tiltSin=Math.sin(t.tiltAngle),t.tiltCos=Math.cos(t.tiltAngle),t.random=Math.random()+2);var n=t.tick++/t.totalTicks,r=t.x+t.random*t.tiltCos,i=t.y+t.random*t.tiltSin,s=t.wobbleX+t.random*t.tiltCos,o=t.wobbleY+t.random*t.tiltSin;if(e.fillStyle="rgba("+t.color.r+", "+t.color.g+", "+t.color.b+", "+(1-n)+")",e.beginPath(),a&&"path"===t.shape.type&&"string"===typeof t.shape.path&&Array.isArray(t.shape.matrix))e.fill(function(e,t,n,r,i,s,a){var o=new Path2D(e),l=new Path2D;l.addPath(o,new DOMMatrix(t));var c=new Path2D;return c.addPath(l,new DOMMatrix([Math.cos(a)*i,Math.sin(a)*i,-Math.sin(a)*s,Math.cos(a)*s,n,r])),c}(t.shape.path,t.shape.matrix,t.x,t.y,.1*Math.abs(s-r),.1*Math.abs(o-i),Math.PI/10*t.wobble));else if("bitmap"===t.shape.type){var l=Math.PI/10*t.wobble,c=.1*Math.abs(s-r),d=.1*Math.abs(o-i),h=t.shape.bitmap.width*t.scalar,p=t.shape.bitmap.height*t.scalar,f=new DOMMatrix([Math.cos(l)*c,Math.sin(l)*c,-Math.sin(l)*d,Math.cos(l)*d,t.x,t.y]);f.multiplySelf(new DOMMatrix(t.shape.matrix));var m=e.createPattern(u.transform(t.shape.bitmap),"no-repeat");m.setTransform(f),e.globalAlpha=1-n,e.fillStyle=m,e.fillRect(t.x-h/2,t.y-p/2,h,p),e.globalAlpha=1}else if("circle"===t.shape)e.ellipse?e.ellipse(t.x,t.y,Math.abs(s-r)*t.ovalScalar,Math.abs(o-i)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI):function(e,t,n,r,i,s,a,o,l){e.save(),e.translate(t,n),e.rotate(s),e.scale(r,i),e.arc(0,0,1,a,o,l),e.restore()}(e,t.x,t.y,Math.abs(s-r)*t.ovalScalar,Math.abs(o-i)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI);else if("star"===t.shape)for(var g=Math.PI/2*3,y=4*t.scalar,v=8*t.scalar,x=t.x,b=t.y,w=5,I=Math.PI/w;w--;)x=t.x+Math.cos(g)*v,b=t.y+Math.sin(g)*v,e.lineTo(x,b),g+=I,x=t.x+Math.cos(g)*y,b=t.y+Math.sin(g)*y,e.lineTo(x,b),g+=I;else e.moveTo(Math.floor(t.x),Math.floor(t.y)),e.lineTo(Math.floor(t.wobbleX),Math.floor(i)),e.lineTo(Math.floor(s),Math.floor(o)),e.lineTo(Math.floor(r),Math.floor(t.wobbleY));return e.closePath(),e.fill(),t.tick<t.totalTicks}function E(e,n){var a,o=!e,c=!!f(n||{},"resize"),p=!1,y=f(n,"disableForReducedMotion",Boolean),x=s&&!!f(n||{},"useWorker")?h():null,E=o?b:w,S=!(!e||!x)&&!!e.__confetti_initialized,C="function"===typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function _(t,n,s){for(var o=f(t,"particleCount",m),c=f(t,"angle",Number),h=f(t,"spread",Number),p=f(t,"startVelocity",Number),y=f(t,"decay",Number),x=f(t,"gravity",Number),b=f(t,"drift",Number),w=f(t,"colors",v),S=f(t,"ticks",Number),C=f(t,"shapes"),_=f(t,"scalar"),T=!!f(t,"flat"),k=function(e){var t=f(e,"origin",Object);return t.x=f(t,"x",Number),t.y=f(t,"y",Number),t}(t),A=o,R=[],j=e.width*k.x,P=e.height*k.y;A--;)R.push(I({x:j,y:P,angle:c,spread:h,startVelocity:p,color:w[A%w.length],shape:C[g(0,C.length)],ticks:S,decay:y,gravity:x,drift:b,scalar:_,flat:T}));return a?a.addFettis(R):(a=function(e,t,n,s,a){var o,c,h=t.slice(),p=e.getContext("2d"),f=l(function(t){function l(){o=c=null,p.clearRect(0,0,s.width,s.height),u.clear(),a(),t()}o=d.frame(function t(){!r||s.width===i.width&&s.height===i.height||(s.width=e.width=i.width,s.height=e.height=i.height),s.width||s.height||(n(e),s.width=e.width,s.height=e.height),p.clearRect(0,0,s.width,s.height),(h=h.filter(function(e){return N(p,e)})).length?o=d.frame(t):l()}),c=l});return{addFettis:function(e){return h=h.concat(e),f},canvas:e,promise:f,reset:function(){o&&d.cancel(o),c&&c()}}}(e,R,E,n,s),a.promise)}function T(n){var r=y||f(n,"disableForReducedMotion",Boolean),i=f(n,"zIndex",Number);if(r&&C)return l(function(e){e()});o&&a?e=a.canvas:o&&!e&&(e=function(e){var t=document.createElement("canvas");return t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=e,t}(i),document.body.appendChild(e)),c&&!S&&E(e);var s={width:e.width,height:e.height};function u(){if(x){var t={getBoundingClientRect:function(){if(!o)return e.getBoundingClientRect()}};return E(t),void x.postMessage({resize:{width:t.width,height:t.height}})}s.width=s.height=null}function d(){a=null,c&&(p=!1,t.removeEventListener("resize",u)),o&&e&&(document.body.contains(e)&&document.body.removeChild(e),e=null,S=!1)}return x&&!S&&x.init(e),S=!0,x&&(e.__confetti_initialized=!0),c&&!p&&(p=!0,t.addEventListener("resize",u,!1)),x?x.fire(n,s,d):_(n,s,d)}return T.reset=function(){x&&x.reset(),a&&a.reset()},T}function S(){return c||(c=E(null,{useWorker:!0,resize:!0})),c}n.exports=function(){return S().apply(this,arguments)},n.exports.reset=function(){S().reset()},n.exports.create=E,n.exports.shapeFromPath=function(e){if(!a)throw new Error("path confetti are not supported in this browser");var t,n;"string"===typeof e?t=e:(t=e.path,n=e.matrix);var r=new Path2D(t),i=document.createElement("canvas").getContext("2d");if(!n){for(var s,o,l=1e3,c=l,u=l,d=0,h=0,p=0;p<l;p+=2)for(var f=0;f<l;f+=2)i.isPointInPath(r,p,f,"nonzero")&&(c=Math.min(c,p),u=Math.min(u,f),d=Math.max(d,p),h=Math.max(h,f));s=d-c,o=h-u;var m=Math.min(10/s,10/o);n=[m,0,0,m,-Math.round(s/2+c)*m,-Math.round(o/2+u)*m]}return{type:"path",path:t,matrix:n}},n.exports.shapeFromText=function(e){var t,n=1,r="#000000",i='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';"string"===typeof e?t=e:(t=e.text,n="scalar"in e?e.scalar:n,i="fontFamily"in e?e.fontFamily:i,r="color"in e?e.color:r);var s=10*n,a=s+"px "+i,o=new OffscreenCanvas(s,s),l=o.getContext("2d");l.font=a;var c=l.measureText(t),u=Math.ceil(c.actualBoundingBoxRight+c.actualBoundingBoxLeft),d=Math.ceil(c.actualBoundingBoxAscent+c.actualBoundingBoxDescent),h=c.actualBoundingBoxLeft+2,p=c.actualBoundingBoxAscent+2;u+=4,d+=4,(l=(o=new OffscreenCanvas(u,d)).getContext("2d")).font=a,l.fillStyle=r,l.fillText(t,h,p);var f=1/n;return{type:"bitmap",bitmap:o.transferToImageBitmap(),matrix:[f,0,0,f,-u*f/2,-d*f/2]}}}(function(){return"undefined"!==typeof window?window:"undefined"!==typeof self?self:this||{}}(),j,!1);const P=j.exports;j.exports.create;const O=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},M={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,a=s?e[i+1]:0,o=i+2<e.length,l=o?e[i+2]:0,c=t>>2,u=(3&t)<<4|a>>4;let d=(15&a)<<2|l>>6,h=63&l;o||(h=64,s||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(O(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const a=i<e.length?n[e.charAt(i)]:64;++i;const o=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==a||null==o)throw new L;const l=t<<2|s>>4;if(r.push(l),64!==a){const e=s<<4&240|a>>2;if(r.push(e),64!==o){const e=a<<6&192|o;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class L extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const D=function(e){return function(e){const t=O(e);return M.encodeByteArray(t,!0)}(e).replace(/\./g,"")},F=function(e){try{return M.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};const q=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,U=()=>{try{return q()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/Term-3-Gaming",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&F(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},V=e=>{var t,n;return null===(n=null===(t=U())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},B=()=>{var e;return null===(e=U())||void 0===e?void 0:e.config},z=e=>{var t;return null===(t=U())||void 0===t?void 0:t["_".concat(e)]};class H{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function G(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function W(){return!function(){var e;const t=null===(e=U())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function K(){try{return"object"===typeof indexedDB}catch(e){return!1}}class Y extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Y.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Q.prototype.create)}}class Q{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(J,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",s="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new Y(n,s,t)}}const J=/\{\$([^}]+)}/g;function X(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if($(n)&&$(s)){if(!X(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function $(e){return null!==e&&"object"===typeof e}function Z(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function ee(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function te(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class ne{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=re),void 0===r.error&&(r.error=re),void 0===r.complete&&(r.complete=re);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function re(){}function ie(e){return e&&e._delegate?e._delegate:e}class se{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ae="[DEFAULT]";class oe{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new H;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:ae})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===ae?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(s){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae;return this.component?this.component.multipleInstances?e:ae:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class le{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new oe(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const ce=[];var ue;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(ue||(ue={}));const de={debug:ue.DEBUG,verbose:ue.VERBOSE,info:ue.INFO,warn:ue.WARN,error:ue.ERROR,silent:ue.SILENT},he=ue.INFO,pe={[ue.DEBUG]:"log",[ue.VERBOSE]:"log",[ue.INFO]:"info",[ue.WARN]:"warn",[ue.ERROR]:"error"},fe=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=pe[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,s=new Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];console[r]("[".concat(n,"]  ").concat(e.name,":"),...s)};class me{constructor(e){this.name=e,this._logLevel=he,this._logHandler=fe,this._userLogHandler=null,ce.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ue))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?de[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ue.DEBUG,...t),this._logHandler(this,ue.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ue.VERBOSE,...t),this._logHandler(this,ue.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ue.INFO,...t),this._logHandler(this,ue.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ue.WARN,...t),this._logHandler(this,ue.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ue.ERROR,...t),this._logHandler(this,ue.ERROR,...t)}}let ge,ye;const ve=new WeakMap,xe=new WeakMap,be=new WeakMap,we=new WeakMap,Ie=new WeakMap;let Ne={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return xe.get(e);if("objectStoreNames"===t)return e.objectStoreNames||be.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ce(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Ee(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(ye||(ye=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(_e(this),n),Ce(ve.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ce(e.apply(_e(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(_e(this),t,...r);return be.set(s,t.sort?t.sort():[t]),Ce(s)}}function Se(e){return"function"===typeof e?Ee(e):(e instanceof IDBTransaction&&function(e){if(xe.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});xe.set(e,t)}(e),t=e,(ge||(ge=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,Ne):e);var t}function Ce(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(Ce(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&ve.set(t,e)}).catch(()=>{}),Ie.set(t,e),t}(e);if(we.has(e))return we.get(e);const t=Se(e);return t!==e&&(we.set(e,t),Ie.set(t,e)),t}const _e=e=>Ie.get(e);const Te=["get","getKey","getAll","getAllKeys","count"],ke=["put","add","delete","clear"],Ae=new Map;function Re(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(Ae.get(t))return Ae.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=ke.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Te.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var a=arguments.length,o=new Array(a>1?a-1:0),l=1;l<a;l++)o[l-1]=arguments[l];return r&&(s=s.index(o.shift())),(await Promise.all([s[n](...o),i&&t.done]))[0]};return Ae.set(t,s),s}Ne=(e=>(0,s.A)((0,s.A)({},e),{},{get:(t,n,r)=>Re(t,n)||e.get(t,n,r),has:(t,n)=>!!Re(t,n)||e.has(t,n)}))(Ne);class je{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const Pe="@firebase/app",Oe="0.10.13",Me=new me("@firebase/app"),Le="@firebase/app-compat",De="@firebase/analytics-compat",Fe="@firebase/analytics",qe="@firebase/app-check-compat",Ue="@firebase/app-check",Ve="@firebase/auth",Be="@firebase/auth-compat",ze="@firebase/database",He="@firebase/data-connect",Ge="@firebase/database-compat",We="@firebase/functions",Ke="@firebase/functions-compat",Ye="@firebase/installations",Qe="@firebase/installations-compat",Je="@firebase/messaging",Xe="@firebase/messaging-compat",$e="@firebase/performance",Ze="@firebase/performance-compat",et="@firebase/remote-config",tt="@firebase/remote-config-compat",nt="@firebase/storage",rt="@firebase/storage-compat",it="@firebase/firestore",st="@firebase/vertexai-preview",at="@firebase/firestore-compat",ot="firebase",lt="[DEFAULT]",ct={[Pe]:"fire-core",[Le]:"fire-core-compat",[Fe]:"fire-analytics",[De]:"fire-analytics-compat",[Ue]:"fire-app-check",[qe]:"fire-app-check-compat",[Ve]:"fire-auth",[Be]:"fire-auth-compat",[ze]:"fire-rtdb",[He]:"fire-data-connect",[Ge]:"fire-rtdb-compat",[We]:"fire-fn",[Ke]:"fire-fn-compat",[Ye]:"fire-iid",[Qe]:"fire-iid-compat",[Je]:"fire-fcm",[Xe]:"fire-fcm-compat",[$e]:"fire-perf",[Ze]:"fire-perf-compat",[et]:"fire-rc",[tt]:"fire-rc-compat",[nt]:"fire-gcs",[rt]:"fire-gcs-compat",[it]:"fire-fst",[at]:"fire-fst-compat",[st]:"fire-vertex","fire-js":"fire-js",[ot]:"fire-js-all"},ut=new Map,dt=new Map,ht=new Map;function pt(e,t){try{e.container.addComponent(t)}catch(n){Me.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function ft(e){const t=e.name;if(ht.has(t))return Me.debug("There were multiple attempts to register component ".concat(t,".")),!1;ht.set(t,e);for(const n of ut.values())pt(n,e);for(const n of dt.values())pt(n,e);return!0}function mt(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function gt(e){return void 0!==e.settings}const yt=new Q("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class vt{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new se("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw yt.create("app-deleted",{appName:this._name})}}const xt="10.14.1";function bt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:lt,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw yt.create("bad-app-name",{appName:String(i)});if(n||(n=B()),!n)throw yt.create("no-options");const s=ut.get(i);if(s){if(X(n,s.options)&&X(r,s.config))return s;throw yt.create("duplicate-app",{appName:i})}const a=new le(i);for(const l of ht.values())a.addComponent(l);const o=new vt(n,r,a);return ut.set(i,o),o}function wt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt;const t=ut.get(e);if(!t&&e===lt&&B())return bt();if(!t)throw yt.create("no-app",{appName:e});return t}function It(e,t,n){var r;let i=null!==(r=ct[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));const s=i.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const e=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return s&&e.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),s&&a&&e.push("and"),a&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void Me.warn(e.join(" "))}ft(new se("".concat(i,"-version"),()=>({library:i,version:t}),"VERSION"))}const Nt="firebase-heartbeat-store";let Et=null;function St(){return Et||(Et=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=indexedDB.open(e,t),o=Ce(a);return r&&a.addEventListener("upgradeneeded",e=>{r(Ce(a.result),e.oldVersion,e.newVersion,Ce(a.transaction),e)}),n&&a.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Nt)}catch(n){console.warn(n)}}}).catch(e=>{throw yt.create("idb-open",{originalErrorMessage:e.message})})),Et}async function Ct(e,t){try{const n=(await St()).transaction(Nt,"readwrite"),r=n.objectStore(Nt);await r.put(t,_t(e)),await n.done}catch(n){if(n instanceof Y)Me.warn(n.message);else{const e=yt.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});Me.warn(e.message)}}}function _t(e){return"".concat(e.name,"!").concat(e.options.appId)}class Tt{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new At(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=kt();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache)}catch(n){Me.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=kt(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),Rt(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Rt(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=D(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Me.warn(t),""}}}function kt(){return(new Date).toISOString().substring(0,10)}class At{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!K()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await St()).transaction(Nt),n=await t.objectStore(Nt).get(_t(e));return await t.done,n}catch(t){if(t instanceof Y)Me.warn(t.message);else{const e=yt.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});Me.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ct(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ct(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Rt(e){return D(JSON.stringify({version:2,heartbeats:e})).length}var jt;jt="",ft(new se("platform-logger",e=>new je(e),"PRIVATE")),ft(new se("heartbeat",e=>new Tt(e),"PRIVATE")),It(Pe,Oe,jt),It(Pe,Oe,"esm2017"),It("fire-js","");var Pt,Ot,Mt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Lt={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],a=t+(s^n&(i^s))+r[0]+3614090360&4294967295;a=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(a<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((s=(t=n+((a=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((i=s+((a=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,s=this.h,a=0;a<t;){if(0==s)for(;a<=r;)n(this,e,a),a+=this.blockSize;if("string"===typeof e){for(;a<t;)if(i[s++]=e.charCodeAt(a++),s==this.blockSize){n(this,i),s=0;break}}else for(;a<t;)if(i[s++]=e[a++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var i={};function s(e){return-128<=e&&128>e?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],0>e?-1:0)}):new r([0|e],0>e?-1:0)}function a(e){if(isNaN(e)||!isFinite(e))return o;if(0>e)return h(a(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=4294967296;return new r(t,0)}var o=s(0),l=s(1),c=s(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function d(e){return-1==e.h}function h(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new r(n,~e.h).add(l)}function p(e,t){return e.add(h(t))}function f(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(o,o);if(d(e))return t=g(h(e),t),new m(h(t.g),h(t.h));if(d(t))return t=g(e,h(t)),new m(h(t.g),t.h);if(30<e.g.length){if(d(e)||d(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=y(n),r=y(r);var i=v(n,1),s=v(r,1);for(r=v(r,2),n=v(n,2);!u(r);){var c=s.add(r);0>=c.l(e)&&(i=i.add(n),s=c),r=v(r,1),n=v(n,1)}return t=p(e,i.j(t)),new m(i,t)}for(i=o;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),c=(s=a(n)).j(t);d(c)||0<c.l(e);)c=(s=a(n-=r)).j(t);u(s)&&(s=l),i=i.add(s),e=p(e,c)}return new m(i,e)}function y(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.i(i)<<1|e.i(i-1)>>>31;return new r(n,e.h)}function v(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,s=[],a=0;a<i;a++)s[a]=0<t?e.i(a+n)>>>t|e.i(a+n+1)<<32-t:e.i(a+n);return new r(s,e.h)}(e=r.prototype).m=function(){if(d(this))return-h(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(d(this))return"-"+h(this).toString(e);for(var t=a(Math.pow(e,6)),n=this,r="";;){var i=g(n,t).g,s=((0<(n=p(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return d(e=p(this,e))?-1:u(e)?0:1},e.abs=function(){return d(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,s=0;s<=t;s++){var a=i+(65535&this.i(s))+(65535&e.i(s)),o=(a>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);i=o>>>16,a&=65535,o&=65535,n[s]=o<<16|a}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return o;if(d(this))return d(e)?h(this).j(h(e)):h(h(this).j(e));if(d(e))return h(this.j(h(e)));if(0>this.l(c)&&0>e.l(c))return a(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var s=0;s<e.g.length;s++){var l=this.i(i)>>>16,p=65535&this.i(i),m=e.i(s)>>>16,g=65535&e.i(s);n[2*i+2*s]+=p*g,f(n,2*i+2*s),n[2*i+2*s+1]+=l*g,f(n,2*i+2*s+1),n[2*i+2*s+1]+=p*m,f(n,2*i+2*s+1),n[2*i+2*s+2]+=l*m,f(n,2*i+2*s+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new r(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)&e.i(i);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)|e.i(i);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)^e.i(i);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,Ot=Lt.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=a,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=a(Math.pow(n,8)),i=o,s=0;s<t.length;s+=8){var l=Math.min(8,t.length-s),c=parseInt(t.substring(s,s+l),n);8>l?(l=a(Math.pow(n,l)),i=i.j(l).add(a(c))):i=(i=i.j(r)).add(a(c))}return i},Pt=Lt.Integer=r}).apply("undefined"!==typeof Mt?Mt:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var Dt,Ft,qt,Ut,Vt,Bt,zt,Ht,Gt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Wt={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Gt&&Gt];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var a=e[s];if(!(a in i))break e;i=i[a]}(r=r(s=i[e=e[e.length-1]]))!=s&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,function(e,t){return t})}});var r=r||{},i=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function a(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function h(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function p(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(s(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function f(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var y=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function v(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function x(e){const t={};for(const n in e)t[n]=e[n];return t}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<b.length;t++)n=b[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function I(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function N(e){i.setTimeout(()=>{throw e},0)}function E(){var e=k;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var S=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new C,e=>e.reset());class C{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let _,T=!1,k=new class{constructor(){this.h=this.g=null}add(e,t){const n=S.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},A=()=>{const e=i.Promise.resolve(void 0);_=()=>{e.then(R)}};var R=()=>{for(var e;e=E();){try{e.h.call(e.g)}catch(n){N(n)}var t=S;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}T=!1};function j(){this.s=this.s,this.C=this.C}function P(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}j.prototype.s=!1,j.prototype.ma=function(){this.s||(this.s=!0,this.N())},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},P.prototype.h=function(){this.defaultPrevented=!0};var O=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(n){}return e}();function M(e,t){if(P.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(y){e:{try{g(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:L[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&M.aa.h.call(this)}}d(M,P);var L={2:"touch",3:"pen",4:"mouse"};M.prototype.h=function(){M.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var D="closure_listenable_"+(1e6*Math.random()|0),F=0;function q(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++F,this.da=this.fa=!1}function U(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function V(e){this.src=e,this.g={},this.h=0}function B(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(U(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function z(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}V.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var a=z(e,t,r,i);return-1<a?(t=e[a],n||(t.fa=!1)):((t=new q(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var H="closure_lm_"+(1e6*Math.random()|0),G={};function W(e,t,n,r,i){if(r&&r.once)return Y(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)W(e,t[s],n,r,i);return null}return n=te(n),e&&e[D]?e.K(t,n,a(r)?!!r.capture:!!r,i):K(e,t,n,!1,r,i)}function K(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=a(i)?!!i.capture:!!i,l=Z(e);if(l||(e[H]=l=new V(e)),(n=l.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=$;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)O||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(X(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function Y(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)Y(e,t[s],n,r,i);return null}return n=te(n),e&&e[D]?e.L(t,n,a(r)?!!r.capture:!!r,i):K(e,t,n,!0,r,i)}function Q(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)Q(e,t[s],n,r,i);else r=a(r)?!!r.capture:!!r,n=te(n),e&&e[D]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=z(s=e.g[t],n,r,i))&&(U(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=z(t,n,r,i)),(n=-1<e?t[e]:null)&&J(n))}function J(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[D])B(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(X(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?(B(n,e),0==n.h&&(n.src=null,t[H]=null)):U(e)}}}function X(e){return e in G?G[e]:G[e]="on"+e}function $(e,t){if(e.da)e=!0;else{t=new M(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&J(e),e=n.call(r,t)}return e}function Z(e){return(e=e[H])instanceof V?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){j.call(this),this.i=new V(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new P(t,e);else if(t instanceof P)t.target=t.target||e;else{var i=t;w(t=new P(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var a=t.g=n[s];i=ie(a,r,!0,t)&&i}if(i=ie(a=t.g=e,r,!0,t)&&i,i=ie(a,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=ie(a=t.g=n[s],r,!1,t)&&i}function ie(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var a=t[s];if(a&&!a.da&&a.capture==n){var o=a.listener,l=a.ha||a.src;a.fa&&B(e.i,a),i=!1!==o.call(l,r)&&i}}return i&&!r.defaultPrevented}function se(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function ae(e){e.g=se(()=>{e.g=null,e.i&&(e.i=!1,ae(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}d(ne,j),ne.prototype[D]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Q(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)U(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class oe extends j{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ae(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){j.call(this),this.h=e,this.g={}}d(le,j);var ce=[];function ue(e){v(e.g,function(e,t){this.g.hasOwnProperty(t)&&J(e)},e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var de=i.JSON.stringify,he=i.JSON.parse,pe=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function fe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}fe.prototype.h=null;var ye={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ve(){P.call(this,"d")}function xe(){P.call(this,"c")}d(ve,P),d(xe,P);var be={},we=null;function Ie(){return we=we||new ne}function Ne(e){P.call(this,be.La,e)}function Ee(e){const t=Ie();re(t,new Ne(t))}function Se(e,t){P.call(this,be.STAT_EVENT,e),this.stat=t}function Ce(e){const t=Ie();re(t,new Se(t,e))}function _e(e,t){P.call(this,be.Ma,e),this.size=t}function Te(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout(function(){e()},t)}function ke(){this.g=!0}function Ae(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var a=1;a<i.length;a++)i[a]=""}}}return de(n)}catch(o){return t}}(e,n)+(r?" "+r:"")})}be.La="serverreachability",d(Ne,P),be.STAT_EVENT="statevent",d(Se,P),be.Ma="timingevent",d(_e,P),ke.prototype.xa=function(){this.g=!1},ke.prototype.info=function(){};var Re,je={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Pe={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Oe(){}function Me(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Le}function Le(){this.i=null,this.g="",this.h=!1}d(Oe,fe),Oe.prototype.g=function(){return new XMLHttpRequest},Oe.prototype.i=function(){return{}},Re=new Oe;var De={},Fe={};function qe(e,t,n){e.L=1,e.v=dt(at(t)),e.m=n,e.P=!0,Ue(e,null)}function Ue(e,t){e.F=Date.now(),ze(e),e.A=at(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),St(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Le,e.g=Sn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new oe(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(ce[0]=i.toString()),i=ce);for(var s=0;s<i.length;s++){var a=W(n,i[s],r||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}t=e.H?x(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ee(),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s)for(var a="",o=s.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");a=2<=d.length&&"type"==d[1]?a+(u+"=")+c+"&":a+(u+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+a})}(e.i,e.u,e.A,e.l,e.R,e.m)}function Ve(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Be(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Fe:(n=Number(t.substring(n,r)),isNaN(n)?De:(r+=1)+n>t.length?Fe:(t=t.slice(r,r+n),e.C=r+n,t))}function ze(e){e.S=Date.now()+e.I,He(e,e.I)}function He(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Te(c(e.ba,e),t)}function Ge(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function We(e){0==e.j.G||e.J||bn(e.j,e)}function Ke(e){Ge(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ye(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;xn(n),cn(n)}gn(n),Ce(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=Te(c(n.Za,n),6e3));if(1>=$e(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else In(n,11)}else if((e.K||n.g==e)&&xn(n),!f(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=c[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(et(s,s.h),s.h=null))}if(r.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,ut(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var a=e;if((r=n).qa=En(r,r.J?r.ia:null,r.W),a.K){tt(r.h,a);var o=a,l=r.L;l&&(o.I=l),o.B&&(Ge(o),ze(o)),r.g=a}else mn(r);0<n.i.length&&dn(n)}else"stop"!=c[0]&&"close"!=c[0]||In(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?In(n,7):ln(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Ee()}catch(u){}}Me.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==rn(e)?t.j():this.Y(e)},Me.prototype.Y=function(e){try{if(e==this.g)e:{const h=rn(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||sn(this.g)))){this.J||4!=h||7==t||Ee(),Ge(this);var n=this.g.Z();this.X=n;t:if(Ve(this)){var r=sn(this.g);e="";var s=r.length,a=4==rn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ke(this),We(this);var o="";break t}this.h.i=new i.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(a&&t==s-1)});r.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,s,a){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+a})}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!f(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Ce(12),Ke(this),We(this);break e}Ae(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ye(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=Be(this,o),e==Fe){4==h&&(this.s=4,Ce(14),n=!1),Ae(this.i,this.l,null,"[Incomplete Response]");break}if(e==De){this.s=4,Ce(15),Ae(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}Ae(this.i,this.l,e,null),Ye(this,e)}if(Ve(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=o.length||this.h.h||(this.s=1,Ce(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),yn(d),d.M=!0,Ce(11))}}else Ae(this.i,this.l,o,"[Invalid Chunked Response]"),Ke(this),We(this)}else Ae(this.i,this.l,o,null),Ye(this,o);4==h&&Ke(this),this.o&&!this.J&&(4==h?bn(this.j,this):(this.o=!1,ze(this)))}else(function(e){const t={};e=(e.g&&2<=rn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(f(e[r]))continue;var n=I(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Ce(12)):(this.s=0,Ce(13)),Ke(this),We(this)}}}catch(Kt){}},Me.prototype.cancel=function(){this.J=!0,Ke(this)},Me.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(Ee(),Ce(17)),Ke(this),this.s=2,We(this)):He(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Je(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Xe(e){return!!e.h||!!e.g&&e.g.size>=e.j}function $e(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return h(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}Je.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var it=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function st(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof st){this.h=e.h,ot(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new wt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(it))?(this.h=!1,ot(this,t[1]||"",!0),this.o=ht(t[2]||""),this.g=ht(t[3]||"",!0),lt(this,t[4]),this.l=ht(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=ht(t[7]||"")):(this.h=!1,this.i=new wt(null,this.h))}function at(e){return new st(e)}function ot(e,t,n){e.j=n?ht(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof wt?(e.i=t,function(e,t){t&&!e.j&&(It(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Nt(this,t),St(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=pt(t,xt)),e.i=new wt(t,e.h))}function ut(e,t,n){e.i.set(t,n)}function dt(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ht(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function pt(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,ft),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ft(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}st.prototype.toString=function(){var e=[],t=this.j;t&&e.push(pt(t,gt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(pt(t,gt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(pt(n,"/"==n.charAt(0)?vt:yt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",pt(n,bt)),e.join("")};var mt,gt=/[#\/\?@]/g,yt=/[#\?:]/g,vt=/[#\?]/g,xt=/[#\?@]/g,bt=/#/g;function wt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function It(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function Nt(e,t){It(e),t=Ct(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Et(e,t){return It(e),t=Ct(e,t),e.g.has(t)}function St(e,t,n){Nt(e,t),0<n.length&&(e.i=null,e.g.set(Ct(e,t),h(n)),e.h+=n.length)}function Ct(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function _t(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(s){}}function Tt(){this.g=new pe}function kt(e,t,n){const r=n||"";try{rt(e,function(e,n){let i=e;a(e)&&(i=de(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function At(e){this.l=e.Ub||null,this.j=e.eb||!1}function Rt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function jt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Pt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Ot(e)}function Ot(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Mt(e){let t="";return v(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Lt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Mt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ut(e,t,n))}function Yt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=wt.prototype).add=function(e,t){It(this),this.i=null,e=Ct(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){It(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.na=function(){It(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){It(this);let t=[];if("string"===typeof e)Et(this,e)&&(t=t.concat(this.g.get(Ct(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return It(this),this.i=null,Et(this,e=Ct(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),a=this.V(r);for(r=0;r<a.length;r++){var i=s;""!==a[r]&&(i+="="+encodeURIComponent(String(a[r]))),e.push(i)}}return this.i=e.join("&")},d(At,fe),At.prototype.g=function(){return new Rt(this.l,this.j)},At.prototype.i=(mt={},function(){return mt}),d(Rt,ne),(e=Rt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Ot(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Pt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ot(this)),this.g&&(this.readyState=3,Ot(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;jt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Pt(this):Ot(this),3==this.readyState&&jt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Pt(this))},e.Qa=function(e){this.g&&(this.response=e,Pt(this))},e.ga=function(){this.g&&Pt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Rt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),d(Yt,ne);var Qt=/^https?$/i,Xt=["POST","PUT"];function $t(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Zt(e),tn(e)}function Zt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function en(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=rn(e)||2!=e.Z()))if(e.u&&4==rn(e))se(e.Ea,0,e);else if(re(e,"readystatechange"),4==rn(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var s;if(s=0===r){var a=String(e.D).match(it)[1]||null;!a&&i.self&&i.self.location&&(a=i.self.location.protocol.slice(0,-1)),s=!Qt.test(a?a.toLowerCase():"")}n=s}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var o=2<rn(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",Zt(e)}}finally{tn(e)}}}function tn(e,t){if(e.g){nn(e);const r=e.g,i=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{r.onreadystatechange=i}catch(n){}}}function nn(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function rn(e){return e.g?e.g.readyState:0}function sn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(Jt){return null}}function an(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function on(e){this.Aa=0,this.i=[],this.j=new ke,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=an("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=an("baseRetryDelayMs",5e3,e),this.cb=an("retryDelaySeedMs",1e4,e),this.Wa=an("forwardChannelMaxRetries",2,e),this.wa=an("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Je(e&&e.concurrentRequestLimit),this.Da=new Tt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function ln(e){if(un(e),3==e.G){var t=e.U++,n=at(e.I);if(ut(n,"SID",e.K),ut(n,"RID",t),ut(n,"TYPE","terminate"),pn(e,n),(t=new Me(e,e.j,t)).L=2,t.v=dt(at(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&i.Image&&((new Image).src=t.v,n=!0),n||(t.g=Sn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),ze(t)}Nn(e)}function cn(e){e.g&&(yn(e),e.g.cancel(),e.g=null)}function un(e){cn(e),e.u&&(i.clearTimeout(e.u),e.u=null),xn(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function dn(e){if(!Xe(e.h)&&!e.s){e.s=!0;var t=e.Ga;_||A(),T||(_(),T=!0),k.add(t,e),e.B=0}}function hn(e,t){var n;n=t?t.l:e.U++;const r=at(e.I);ut(r,"SID",e.K),ut(r,"RID",n),ut(r,"AID",e.T),pn(e,r),e.m&&e.o&&Lt(r,e.m,e.o),n=new Me(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=fn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),qe(n,r,t)}function pn(e,t){e.H&&v(e.H,function(e,n){ut(t,n,e)}),e.l&&rt({},function(e,n){ut(t,n,e)})}function fn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let a=0;a<n;a++){let n=i[a].g;const o=i[a].map;if(n-=t,0>n)t=Math.max(0,i[a].g-100),s=!1;else try{kt(o,e,"req"+n+"_")}catch(Kt){r&&r(o)}}if(s){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function mn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;_||A(),T||(_(),T=!0),k.add(t,e),e.v=0}}function gn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Te(c(e.Fa,e),wn(e,e.v)),e.v++,!0)}function yn(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function vn(e){e.g=new Me(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=at(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),pn(e,t),e.m&&e.o&&Lt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=dt(at(t)),n.m=null,n.P=!0,Ue(n,e)}function xn(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function bn(e,t){var n=null;if(e.g==t){xn(e),yn(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;re(r=Ie(),new _e(r,n)),dn(e)}else mn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!($e(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Te(c(e.Ga,e,t),wn(e,e.B)),e.B++,!0))}(e,t)||2==r&&gn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:In(e,5);break;case 4:In(e,10);break;case 3:In(e,6);break;default:In(e,2)}}function wn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function In(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new st(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||ot(r,"https"),dt(r),t?function(e,t){const n=new ke;if(i.Image){const r=new Image;r.onload=u(_t,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(_t,n,"TestLoadImage: error",!1,t,r),r.onabort=u(_t,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(_t,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new ke;const n=new AbortController,r=setTimeout(()=>{n.abort(),_t(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?_t(0,0,!0,t):_t(0,0,!1,t)}).catch(()=>{clearTimeout(r),_t(0,0,!1,t)})}(r.toString(),n)}else Ce(2);e.G=0,e.l&&e.l.sa(t),Nn(e),un(e)}function Nn(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(p(e.ka,t),p(e.ka,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.ra()}}function En(e,t,n){var r=n instanceof st?at(n):new st(n);if(""!=r.g)t&&(r.g=t+"."+r.g),lt(r,r.s);else{var s=i.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var a=new st(null);r&&ot(a,r),t&&(a.g=t),s&&lt(a,s),n&&(a.l=n),r=a}return n=e.D,t=e.ya,n&&t&&ut(r,n,t),ut(r,"VER",e.la),pn(e,r),r}function Sn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Yt(new At({eb:n})):new Yt(e.pa)).Ha(e.J),t}function Cn(){}function _n(){}function Tn(e,t){ne.call(this),this.g=new on(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!f(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!f(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Rn(this)}function kn(e){ve.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function An(){xe.call(this),this.status=1}function Rn(e){this.g=e}(e=Yt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Re.g(),this.v=this.o?me(this.o):me(Re),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(a){return void $t(this,a)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),s=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Xt,t,void 0))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{nn(this),this.u=!0,this.g.send(e),this.u=!1}catch(a){$t(this,a)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),tn(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),tn(this,!0)),Yt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?en(this):this.bb())},e.bb=function(){en(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<rn(this)?this.g.status:-1}catch(mt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(mt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),he(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=on.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Ce(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=En(this,null,this.W),dn(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new Me(this,this.j,e);let s=this.o;if(this.S&&(s?(s=x(s),w(s,this.S)):s=this.S),null!==this.m||this.O||(i.H=s,s=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=fn(this,i,t),ut(n=at(this.I),"RID",e),ut(n,"CVER",22),this.D&&ut(n,"X-HTTP-Session-Id",this.D),pn(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Mt(s)))+"&"+t:this.m&&Lt(n,this.m,s)),et(this.h,i),this.Ua&&ut(n,"TYPE","init"),this.P?(ut(n,"$req",t),ut(n,"SID","null"),i.T=!0,qe(i,n,null)):qe(i,n,t),this.G=2}}else 3==this.G&&(e?hn(this,e):0==this.i.length||Xe(this.h)||hn(this))},e.Fa=function(){if(this.u=null,vn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Te(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ce(10),cn(this),vn(this))},e.Za=function(){null!=this.C&&(this.C=null,cn(this),gn(this),Ce(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Ce(2)):(this.j.info("Failed to ping google.com"),Ce(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=Cn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},_n.prototype.g=function(e,t){return new Tn(e,t)},d(Tn,ne),Tn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Tn.prototype.close=function(){ln(this.g)},Tn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=de(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&dn(t)},Tn.prototype.N=function(){this.g.l=null,delete this.j,ln(this.g),delete this.g,Tn.aa.N.call(this)},d(kn,ve),d(An,xe),d(Rn,Cn),Rn.prototype.ua=function(){re(this.g,"a")},Rn.prototype.ta=function(e){re(this.g,new kn(e))},Rn.prototype.sa=function(e){re(this.g,new An)},Rn.prototype.ra=function(){re(this.g,"b")},_n.prototype.createWebChannel=_n.prototype.g,Tn.prototype.send=Tn.prototype.o,Tn.prototype.open=Tn.prototype.m,Tn.prototype.close=Tn.prototype.close,Ht=Wt.createWebChannelTransport=function(){return new _n},zt=Wt.getStatEventTarget=function(){return Ie()},Bt=Wt.Event=be,Vt=Wt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},je.NO_ERROR=0,je.TIMEOUT=8,je.HTTP_ERROR=6,Ut=Wt.ErrorCode=je,Pe.COMPLETE="complete",qt=Wt.EventType=Pe,ge.EventType=ye,ye.OPEN="a",ye.CLOSE="b",ye.ERROR="c",ye.MESSAGE="d",ne.prototype.listen=ne.prototype.K,Ft=Wt.WebChannel=ge,Wt.FetchXmlHttpFactory=At,Yt.prototype.listenOnce=Yt.prototype.L,Yt.prototype.getLastError=Yt.prototype.Ka,Yt.prototype.getLastErrorCode=Yt.prototype.Ba,Yt.prototype.getStatus=Yt.prototype.Z,Yt.prototype.getResponseJson=Yt.prototype.Oa,Yt.prototype.getResponseText=Yt.prototype.oa,Yt.prototype.send=Yt.prototype.ea,Yt.prototype.setWithCredentials=Yt.prototype.Ha,Dt=Wt.XhrIo=Yt}).apply("undefined"!==typeof Gt?Gt:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const Kt="@firebase/firestore";class Yt{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Yt.UNAUTHENTICATED=new Yt(null),Yt.GOOGLE_CREDENTIALS=new Yt("google-credentials-uid"),Yt.FIRST_PARTY=new Yt("first-party-uid"),Yt.MOCK_USER=new Yt("mock-user");let Qt="10.14.0";const Jt=new me("@firebase/firestore");function Xt(){return Jt.logLevel}function $t(e){if(Jt.logLevel<=ue.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(tn);Jt.debug("Firestore (".concat(Qt,"): ").concat(e),...i)}}function Zt(e){if(Jt.logLevel<=ue.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(tn);Jt.error("Firestore (".concat(Qt,"): ").concat(e),...i)}}function en(e){if(Jt.logLevel<=ue.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(tn);Jt.warn("Firestore (".concat(Qt,"): ").concat(e),...i)}}function tn(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function nn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state";const t="FIRESTORE (".concat(Qt,") INTERNAL ASSERTION FAILED: ")+e;throw Zt(t),new Error(t)}function rn(e,t){e||nn()}function sn(e,t){return e}const an={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class on extends Y{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class ln{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class cn{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class un{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Yt.UNAUTHENTICATED))}shutdown(){}}class dn{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class hn{constructor(e){this.t=e,this.currentUser=Yt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){rn(void 0===this.o);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new ln;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ln,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},a=e=>{$t("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?a(e):($t("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ln)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?($t("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(rn("string"==typeof t.accessToken),new cn(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return rn(null===e||"string"==typeof e),new Yt(e)}}class pn{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Yt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class fn{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new pn(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Yt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class mn{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class gn{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){rn(void 0===this.o);const n=e=>{null!=e.error&&$t("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.R;return this.R=e.token,$t("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{$t("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):$t("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(rn("string"==typeof e.token),this.R=e.token,new mn(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function yn(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class vn{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=yn(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function xn(e,t){return e<t?-1:e>t?1:0}function bn(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}class wn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new on(an.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new on(an.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new on(an.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new on(an.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return wn.fromMillis(Date.now())}static fromDate(e){return wn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new wn(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?xn(this.nanoseconds,e.nanoseconds):xn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class In{constructor(e){this.timestamp=e}static fromTimestamp(e){return new In(e)}static min(){return new In(new wn(0,0))}static max(){return new In(new wn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Nn{constructor(e,t,n){void 0===t?t=0:t>e.length&&nn(),void 0===n?n=e.length-t:n>e.length-t&&nn(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Nn.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Nn?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class En extends Nn{construct(e,t,n){return new En(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new on(an.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));e.push(...i.split("/").filter(e=>e.length>0))}return new En(e)}static emptyPath(){return new En([])}}const Sn=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Cn extends Nn{construct(e,t,n){return new Cn(e,t,n)}static isValidIdentifier(e){return Sn.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Cn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Cn(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new on(an.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new on(an.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new on(an.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new on(an.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Cn(t)}static emptyPath(){return new Cn([])}}class _n{constructor(e){this.path=e}static fromPath(e){return new _n(En.fromString(e))}static fromName(e){return new _n(En.fromString(e).popFirst(5))}static empty(){return new _n(En.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===En.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return En.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new _n(new En(e.slice()))}}class Tn{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}Tn.UNKNOWN_ID=-1;function kn(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=In.fromTimestamp(1e9===r?new wn(n+1,0):new wn(n,r));return new Rn(i,_n.empty(),t)}function An(e){return new Rn(e.readTime,e.key,-1)}class Rn{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Rn(In.min(),_n.empty(),-1)}static max(){return new Rn(In.max(),_n.empty(),-1)}}function jn(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=_n.comparator(e.documentKey,t.documentKey),0!==n?n:xn(e.largestBatchId,t.largestBatchId))}const Pn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class On{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function Mn(e){if(e.code!==an.FAILED_PRECONDITION||e.message!==Pn)throw e;$t("LocalStore","Unexpectedly lost primary lease")}class Ln{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&nn(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ln((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Ln?t:Ln.resolve(t)}catch(e){return Ln.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Ln.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Ln.reject(t)}static resolve(e){return new Ln((t,n)=>{t(e)})}static reject(e){return new Ln((t,n)=>{n(e)})}static waitFor(e){return new Ln((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=Ln.resolve(!1);for(const n of e)t=t.next(e=>e?Ln.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new Ln((n,r)=>{const i=e.length,s=new Array(i);let a=0;for(let o=0;o<i;o++){const l=o;t(e[l]).next(e=>{s[l]=e,++a,a===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new Ln((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}function Dn(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Fn(e){return"IndexedDbTransactionError"===e.name}class qn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function Un(e){return null==e}function Vn(e){return 0===e&&1/e==-1/0}function Bn(e){return"number"==typeof e&&Number.isInteger(e)&&!Vn(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}qn.oe=-1;const zn=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Hn=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Gn=Hn,Wn=[...Gn,"indexConfiguration","indexState","indexEntries"];function Kn(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Yn(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Qn(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Jn{constructor(e,t){this.comparator=e,this.root=t||$n.EMPTY}insert(e,t){return new Jn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,$n.BLACK,null,null))}remove(e){return new Jn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$n.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Xn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Xn(this.root,e,this.comparator,!1)}getReverseIterator(){return new Xn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Xn(this.root,e,this.comparator,!0)}}class Xn{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class $n{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:$n.RED,this.left=null!=r?r:$n.EMPTY,this.right=null!=i?i:$n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new $n(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return $n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return $n.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,$n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,$n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw nn();if(this.right.isRed())throw nn();const e=this.left.check();if(e!==this.right.check())throw nn();return e+(this.isRed()?0:1)}}$n.EMPTY=null,$n.RED=!0,$n.BLACK=!1,$n.EMPTY=new class{constructor(){this.size=0}get key(){throw nn()}get value(){throw nn()}get color(){throw nn()}get left(){throw nn()}get right(){throw nn()}copy(e,t,n,r,i){return this}insert(e,t,n){return new $n(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Zn{constructor(e){this.comparator=e,this.data=new Jn(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new er(this.data.getIterator())}getIteratorFrom(e){return new er(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Zn))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Zn(this.comparator);return t.data=e,t}}class er{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class tr{constructor(e){this.fields=e,e.sort(Cn.comparator)}static empty(){return new tr([])}unionWith(e){let t=new Zn(Cn.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new tr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return bn(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class nr extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class rr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new nr("Invalid base64 string: "+e):e}}(e);return new rr(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new rr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}rr.EMPTY_BYTE_STRING=new rr("");const ir=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function sr(e){if(rn(!!e),"string"==typeof e){let t=0;const n=ir.exec(e);if(rn(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:ar(e.seconds),nanos:ar(e.nanos)}}function ar(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function or(e){return"string"==typeof e?rr.fromBase64String(e):rr.fromUint8Array(e)}function lr(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function cr(e){const t=e.mapValue.fields.__previous_value__;return lr(t)?cr(t):t}function ur(e){const t=sr(e.mapValue.fields.__local_write_time__.timestampValue);return new wn(t.seconds,t.nanos)}class dr{constructor(e,t,n,r,i,s,a,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l}}class hr{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new hr("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof hr&&e.projectId===this.projectId&&e.database===this.database}}const pr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function fr(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?lr(e)?4:Ar(e)?9007199254740991:Tr(e)?10:11:nn()}function mr(e,t){if(e===t)return!0;const n=fr(e);if(n!==fr(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return ur(e).isEqual(ur(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=sr(e.timestampValue),r=sr(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return or(e.bytesValue).isEqual(or(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return ar(e.geoPointValue.latitude)===ar(t.geoPointValue.latitude)&&ar(e.geoPointValue.longitude)===ar(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return ar(e.integerValue)===ar(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=ar(e.doubleValue),r=ar(t.doubleValue);return n===r?Vn(n)===Vn(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return bn(e.arrayValue.values||[],t.arrayValue.values||[],mr);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Kn(n)!==Kn(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!mr(n[i],r[i])))return!1;return!0}(e,t);default:return nn()}}function gr(e,t){return void 0!==(e.values||[]).find(e=>mr(e,t))}function yr(e,t){if(e===t)return 0;const n=fr(e),r=fr(t);if(n!==r)return xn(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return xn(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=ar(e.integerValue||e.doubleValue),r=ar(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return vr(e.timestampValue,t.timestampValue);case 4:return vr(ur(e),ur(t));case 5:return xn(e.stringValue,t.stringValue);case 6:return function(e,t){const n=or(e),r=or(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=xn(n[i],r[i]);if(0!==e)return e}return xn(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=xn(ar(e.latitude),ar(t.latitude));return 0!==n?n:xn(ar(e.longitude),ar(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return xr(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,s;const a=e.fields||{},o=t.fields||{},l=null===(n=a.value)||void 0===n?void 0:n.arrayValue,c=null===(r=o.value)||void 0===r?void 0:r.arrayValue,u=xn((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(s=null==c?void 0:c.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:xr(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===pr.mapValue&&t===pr.mapValue)return 0;if(e===pr.mapValue)return 1;if(t===pr.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let a=0;a<r.length&&a<s.length;++a){const e=xn(r[a],s[a]);if(0!==e)return e;const t=yr(n[r[a]],i[s[a]]);if(0!==t)return t}return xn(r.length,s.length)}(e.mapValue,t.mapValue);default:throw nn()}}function vr(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return xn(e,t);const n=sr(e),r=sr(t),i=xn(n.seconds,r.seconds);return 0!==i?i:xn(n.nanos,r.nanos)}function xr(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=yr(n[i],r[i]);if(e)return e}return xn(n.length,r.length)}function br(e){return wr(e)}function wr(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=sr(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return or(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return _n.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=wr(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+="".concat(i,":").concat(wr(e.fields[i]));return n+"}"}(e.mapValue):nn()}function Ir(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Nr(e){return!!e&&"integerValue"in e}function Er(e){return!!e&&"arrayValue"in e}function Sr(e){return!!e&&"nullValue"in e}function Cr(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function _r(e){return!!e&&"mapValue"in e}function Tr(e){var t,n;return"__vector__"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function kr(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Yn(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=kr(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=kr(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Ar(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class Rr{constructor(e){this.value=e}static empty(){return new Rr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!_r(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=kr(t)}setAll(e){let t=Cn.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=kr(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());_r(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return mr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];_r(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Yn(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new Rr(kr(this.value))}}function jr(e){const t=[];return Yn(e.fields,(e,n)=>{const r=new Cn([e]);if(_r(n)){const e=jr(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new tr(t)}class Pr{constructor(e,t,n,r,i,s,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=a}static newInvalidDocument(e){return new Pr(e,0,In.min(),In.min(),In.min(),Rr.empty(),0)}static newFoundDocument(e,t,n,r){return new Pr(e,1,t,In.min(),n,r,0)}static newNoDocument(e,t){return new Pr(e,2,t,In.min(),In.min(),Rr.empty(),0)}static newUnknownDocument(e,t){return new Pr(e,3,t,In.min(),In.min(),Rr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(In.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Rr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Rr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=In.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Pr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Pr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class Or{constructor(e,t){this.position=e,this.inclusive=t}}function Mr(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],a=e.position[i];if(r=s.field.isKeyField()?_n.comparator(_n.fromName(a.referenceValue),n.key):yr(a,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Lr(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!mr(e.position[n],t.position[n]))return!1;return!0}class Dr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function Fr(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class qr{}class Ur extends qr{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Yr(e,t,n):"array-contains"===t?new $r(e,n):"in"===t?new Zr(e,n):"not-in"===t?new ei(e,n):"array-contains-any"===t?new ti(e,n):new Ur(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Qr(e,n):new Jr(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(yr(t,this.value)):null!==t&&fr(this.value)===fr(t)&&this.matchesComparison(yr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return nn()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Vr extends qr{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Vr(e,t)}matches(e){return Br(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Br(e){return"and"===e.op}function zr(e){return Hr(e)&&Br(e)}function Hr(e){for(const t of e.filters)if(t instanceof Vr)return!1;return!0}function Gr(e){if(e instanceof Ur)return e.field.canonicalString()+e.op.toString()+br(e.value);if(zr(e))return e.filters.map(e=>Gr(e)).join(",");{const t=e.filters.map(e=>Gr(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function Wr(e,t){return e instanceof Ur?function(e,t){return t instanceof Ur&&e.op===t.op&&e.field.isEqual(t.field)&&mr(e.value,t.value)}(e,t):e instanceof Vr?function(e,t){return t instanceof Vr&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&Wr(n,t.filters[r]),!0)}(e,t):void nn()}function Kr(e){return e instanceof Ur?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(br(e.value))}(e):e instanceof Vr?function(e){return e.op.toString()+" {"+e.getFilters().map(Kr).join(" ,")+"}"}(e):"Filter"}class Yr extends Ur{constructor(e,t,n){super(e,t,n),this.key=_n.fromName(n.referenceValue)}matches(e){const t=_n.comparator(e.key,this.key);return this.matchesComparison(t)}}class Qr extends Ur{constructor(e,t){super(e,"in",t),this.keys=Xr("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Jr extends Ur{constructor(e,t){super(e,"not-in",t),this.keys=Xr("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Xr(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>_n.fromName(e.referenceValue))}class $r extends Ur{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Er(t)&&gr(t.arrayValue,this.value)}}class Zr extends Ur{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&gr(this.value.arrayValue,t)}}class ei extends Ur{constructor(e,t){super(e,"not-in",t)}matches(e){if(gr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!gr(this.value.arrayValue,t)}}class ti extends Ur{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Er(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>gr(this.value.arrayValue,e))}}class ni{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=a,this.ue=null}}function ri(e){return new ni(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function ii(e){const t=sn(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Gr(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Un(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>br(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>br(e)).join(",")),t.ue=e}return t.ue}function si(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Fr(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Wr(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Lr(e.startAt,t.startAt)&&Lr(e.endAt,t.endAt)}function ai(e){return _n.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class oi{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=a,this.endAt=o,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function li(e,t,n,r,i,s,a,o){return new oi(e,t,n,r,i,s,a,o)}function ci(e){return new oi(e)}function ui(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function di(e){return null!==e.collectionGroup}function hi(e){const t=sn(e);if(null===t.ce){t.ce=[];const e=new Set;for(const i of t.explicitOrderBy)t.ce.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Zn(Cn.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.ce.push(new Dr(r,n))}),e.has(Cn.keyField().canonicalString())||t.ce.push(new Dr(Cn.keyField(),n))}return t.ce}function pi(e){const t=sn(e);return t.le||(t.le=fi(t,hi(e))),t.le}function fi(e,t){if("F"===e.limitType)return ri(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new Dr(e.field,t)});const n=e.endAt?new Or(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Or(e.startAt.position,e.startAt.inclusive):null;return ri(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function mi(e,t){const n=e.filters.concat([t]);return new oi(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function gi(e,t,n){return new oi(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function yi(e,t){return si(pi(e),pi(t))&&e.limitType===t.limitType}function vi(e){return"".concat(ii(pi(e)),"|lt:").concat(e.limitType)}function xi(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>Kr(e)).join(", "),"]")),Un(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>br(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>br(e)).join(",")),"Target(".concat(t,")")}(pi(e)),"; limitType=").concat(e.limitType,")")}function bi(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):_n.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of hi(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Mr(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,hi(e),t))&&!(e.endAt&&!function(e,t,n){const r=Mr(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,hi(e),t))}(e,t)}function wi(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Ii(e){return(t,n)=>{let r=!1;for(const i of hi(e)){const e=Ni(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Ni(e,t,n){const r=e.field.isKeyField()?_n.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?yr(r,i):nn()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return nn()}}class Ei{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Yn(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return Qn(this.inner)}size(){return this.innerSize}}const Si=new Jn(_n.comparator);function Ci(){return Si}const _i=new Jn(_n.comparator);function Ti(){let e=_i;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function ki(e){let t=_i;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Ai(){return ji()}function Ri(){return ji()}function ji(){return new Ei(e=>e.toString(),(e,t)=>e.isEqual(t))}const Pi=new Jn(_n.comparator),Oi=new Zn(_n.comparator);function Mi(){let e=Oi;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const Li=new Zn(xn);function Di(){return Li}function Fi(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vn(t)?"-0":t}}function qi(e){return{integerValue:""+e}}function Ui(e,t){return Bn(t)?qi(t):Fi(e,t)}class Vi{constructor(){this._=void 0}}function Bi(e,t,n){return e instanceof Gi?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&lr(t)&&(t=cr(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Wi?Ki(e,t):e instanceof Yi?Qi(e,t):function(e,t){const n=Hi(e,t),r=Xi(n)+Xi(e.Pe);return Nr(n)&&Nr(e.Pe)?qi(r):Fi(e.serializer,r)}(e,t)}function zi(e,t,n){return e instanceof Wi?Ki(e,t):e instanceof Yi?Qi(e,t):n}function Hi(e,t){return e instanceof Ji?function(e){return Nr(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Gi extends Vi{}class Wi extends Vi{constructor(e){super(),this.elements=e}}function Ki(e,t){const n=$i(t);for(const r of e.elements)n.some(e=>mr(e,r))||n.push(r);return{arrayValue:{values:n}}}class Yi extends Vi{constructor(e){super(),this.elements=e}}function Qi(e,t){let n=$i(t);for(const r of e.elements)n=n.filter(e=>!mr(e,r));return{arrayValue:{values:n}}}class Ji extends Vi{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Xi(e){return ar(e.integerValue||e.doubleValue)}function $i(e){return Er(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Zi{constructor(e,t){this.field=e,this.transform=t}}class es{constructor(e,t){this.version=e,this.transformResults=t}}class ts{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ts}static exists(e){return new ts(void 0,e)}static updateTime(e){return new ts(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ns(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class rs{}function is(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new fs(e.key,ts.none()):new cs(e.key,e.data,ts.none());{const n=e.data,r=Rr.empty();let i=new Zn(Cn.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new us(e.key,r,new tr(i.toArray()),ts.none())}}function ss(e,t,n){e instanceof cs?function(e,t,n){const r=e.value.clone(),i=hs(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof us?function(e,t,n){if(!ns(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=hs(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(ds(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function as(e,t,n,r){return e instanceof cs?function(e,t,n,r){if(!ns(e.precondition,t))return n;const i=e.value.clone(),s=ps(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof us?function(e,t,n,r){if(!ns(e.precondition,t))return n;const i=ps(e.fieldTransforms,r,t),s=t.data;return s.setAll(ds(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return ns(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function os(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Hi(r.transform,e||null);null!=i&&(null===n&&(n=Rr.empty()),n.set(r.field,i))}return n||null}function ls(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&bn(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Wi&&t instanceof Wi||e instanceof Yi&&t instanceof Yi?bn(e.elements,t.elements,mr):e instanceof Ji&&t instanceof Ji?mr(e.Pe,t.Pe):e instanceof Gi&&t instanceof Gi}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class cs extends rs{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class us extends rs{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function ds(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function hs(e,t,n){const r=new Map;rn(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],a=s.transform,o=t.data.field(s.field);r.set(s.field,zi(a,o,n[i]))}return r}function ps(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,Bi(e,s,t))}return r}class fs extends rs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ms extends rs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class gs{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&ss(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=as(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=as(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Ri();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let a=this.applyToLocalView(s,i.mutatedFields);a=t.has(r.key)?null:a;const o=is(s,a);null!==o&&n.set(r.key,o),s.isValidDocument()||s.convertToNoDocument(In.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Mi())}isEqual(e){return this.batchId===e.batchId&&bn(this.mutations,e.mutations,(e,t)=>ls(e,t))&&bn(this.baseMutations,e.baseMutations,(e,t)=>ls(e,t))}}class ys{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){rn(e.mutations.length===n.length);let r=Pi;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new ys(e,t,n,r)}}class vs{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class xs{constructor(e,t){this.count=e,this.unchangedNames=t}}var bs,ws;function Is(e){switch(e){default:return nn();case an.CANCELLED:case an.UNKNOWN:case an.DEADLINE_EXCEEDED:case an.RESOURCE_EXHAUSTED:case an.INTERNAL:case an.UNAVAILABLE:case an.UNAUTHENTICATED:return!1;case an.INVALID_ARGUMENT:case an.NOT_FOUND:case an.ALREADY_EXISTS:case an.PERMISSION_DENIED:case an.FAILED_PRECONDITION:case an.ABORTED:case an.OUT_OF_RANGE:case an.UNIMPLEMENTED:case an.DATA_LOSS:return!0}}function Ns(e){if(void 0===e)return Zt("GRPC error has no .code"),an.UNKNOWN;switch(e){case bs.OK:return an.OK;case bs.CANCELLED:return an.CANCELLED;case bs.UNKNOWN:return an.UNKNOWN;case bs.DEADLINE_EXCEEDED:return an.DEADLINE_EXCEEDED;case bs.RESOURCE_EXHAUSTED:return an.RESOURCE_EXHAUSTED;case bs.INTERNAL:return an.INTERNAL;case bs.UNAVAILABLE:return an.UNAVAILABLE;case bs.UNAUTHENTICATED:return an.UNAUTHENTICATED;case bs.INVALID_ARGUMENT:return an.INVALID_ARGUMENT;case bs.NOT_FOUND:return an.NOT_FOUND;case bs.ALREADY_EXISTS:return an.ALREADY_EXISTS;case bs.PERMISSION_DENIED:return an.PERMISSION_DENIED;case bs.FAILED_PRECONDITION:return an.FAILED_PRECONDITION;case bs.ABORTED:return an.ABORTED;case bs.OUT_OF_RANGE:return an.OUT_OF_RANGE;case bs.UNIMPLEMENTED:return an.UNIMPLEMENTED;case bs.DATA_LOSS:return an.DATA_LOSS;default:return nn()}}(ws=bs||(bs={}))[ws.OK=0]="OK",ws[ws.CANCELLED=1]="CANCELLED",ws[ws.UNKNOWN=2]="UNKNOWN",ws[ws.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ws[ws.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ws[ws.NOT_FOUND=5]="NOT_FOUND",ws[ws.ALREADY_EXISTS=6]="ALREADY_EXISTS",ws[ws.PERMISSION_DENIED=7]="PERMISSION_DENIED",ws[ws.UNAUTHENTICATED=16]="UNAUTHENTICATED",ws[ws.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ws[ws.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ws[ws.ABORTED=10]="ABORTED",ws[ws.OUT_OF_RANGE=11]="OUT_OF_RANGE",ws[ws.UNIMPLEMENTED=12]="UNIMPLEMENTED",ws[ws.INTERNAL=13]="INTERNAL",ws[ws.UNAVAILABLE=14]="UNAVAILABLE",ws[ws.DATA_LOSS=15]="DATA_LOSS";let Es=null;function Ss(){return new TextEncoder}const Cs=new Pt([4294967295,4294967295],0);function _s(e){const t=Ss().encode(e),n=new Ot;return n.update(t),new Uint8Array(n.digest())}function Ts(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Pt([n,r],0),new Pt([i,s],0)]}class ks{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new As("Invalid padding: ".concat(t));if(n<0)throw new As("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new As("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new As("Invalid padding when bitmap length is 0: ".concat(t));this.Ie=8*e.length-t,this.Te=Pt.fromNumber(this.Ie)}Ee(e,t,n){let r=e.add(t.multiply(Pt.fromNumber(n)));return 1===r.compare(Cs)&&(r=new Pt([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=_s(e),[n,r]=Ts(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);if(!this.de(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new ks(i,r,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.Ie)return;const t=_s(e),[n,r]=Ts(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class As extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Rs{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,js.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Rs(In.min(),r,new Jn(xn),Ci(),Mi())}}class js{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new js(n,t,Mi(),Mi(),Mi())}}class Ps{constructor(e,t,n,r){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=r}}class Os{constructor(e,t){this.targetId=e,this.me=t}}class Ms{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rr.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Ls{constructor(){this.fe=0,this.ge=qs(),this.pe=rr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Mi(),t=Mi(),n=Mi();return this.ge.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:nn()}}),new js(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=qs()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,rn(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Ds{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ci(),this.qe=Fs(),this.Qe=new Jn(xn)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:nn()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((e,n)=>{this.ze(n)&&t(n)})}He(e){const t=e.targetId,n=e.me.count,r=this.Je(t);if(r){const i=r.target;if(ai(i))if(0===n){const e=new _n(i.path);this.Ue(t,e,Pr.newNoDocument(e,In.min()))}else rn(1===n);else{const r=this.Ye(t);if(r!==n){const n=this.Ze(e),i=n?this.Xe(n,e,r):1;if(0!==i){this.je(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==Es||Es.et(function(e,t,n,r,i){var s,a,o,l,c,u;const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===i,hashCount:null!==(s=null==h?void 0:h.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(l=null===(o=null===(a=null==h?void 0:h.bits)||void 0===a?void 0:a.bitmap)||void 0===o?void 0:o.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),d}(r,e.me,this.Le.tt(),n,i))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,a;try{s=or(n).toUint8Array()}catch(e){if(e instanceof nr)return en("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{a=new ks(s,r,i)}catch(e){return en(e instanceof As?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===a.Ie?null:a}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const i=this.Le.tt(),s="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(n.path.canonicalString());e.mightContain(s)||(this.Ue(t,n,null),r++)}),r}rt(e){const t=new Map;this.Be.forEach((n,r)=>{const i=this.Je(r);if(i){if(n.current&&ai(i.target)){const t=new _n(i.target.path);null!==this.ke.get(t)||this.it(r,t)||this.Ue(r,t,Pr.newNoDocument(t,e))}n.be&&(t.set(r,n.ve()),n.Ce())}});let n=Mi();this.qe.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.ke.forEach((t,n)=>n.setReadTime(e));const r=new Rs(e,t,this.Qe,this.ke,n);return this.ke=Ci(),this.qe=Fs(),this.Qe=new Jn(xn),r}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Ls,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Zn(xn),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||$t("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ls),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Fs(){return new Jn(_n.comparator)}function qs(){return new Jn(_n.comparator)}const Us={asc:"ASCENDING",desc:"DESCENDING"},Vs={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Bs={and:"AND",or:"OR"};class zs{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Hs(e,t){return e.useProto3Json||Un(t)?t:{value:t}}function Gs(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Ws(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Ks(e,t){return Gs(e,t.toTimestamp())}function Ys(e){return rn(!!e),In.fromTimestamp(function(e){const t=sr(e);return new wn(t.seconds,t.nanos)}(e))}function Qs(e,t){return Js(e,t).canonicalString()}function Js(e,t){const n=function(e){return new En(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Xs(e){const t=En.fromString(e);return rn(ya(t)),t}function $s(e,t){return Qs(e.databaseId,t.path)}function Zs(e,t){const n=Xs(t);if(n.get(1)!==e.databaseId.projectId)throw new on(an.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new on(an.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new _n(ra(n))}function ea(e,t){return Qs(e.databaseId,t)}function ta(e){const t=Xs(e);return 4===t.length?En.emptyPath():ra(t)}function na(e){return new En(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function ra(e){return rn(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function ia(e,t,n){return{name:$s(e,t),fields:n.value.mapValue.fields}}function sa(e,t){let n;if(t instanceof cs)n={update:ia(e,t.key,t.value)};else if(t instanceof fs)n={delete:$s(e,t.key)};else if(t instanceof us)n={update:ia(e,t.key,t.data),updateMask:ga(t.fieldMask)};else{if(!(t instanceof ms))return nn();n={verify:$s(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof Gi)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Wi)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Yi)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ji)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw nn()}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Ks(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:nn()}(e,t.precondition)),n}function aa(e,t){return{documents:[ea(e,t.path)]}}function oa(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=ea(e,i);const s=function(e){if(0!==e.length)return ma(Vr.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const a=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:pa(e.field),direction:ua(e.dir)}}(e))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);const o=Hs(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:i}}function la(e){let t=ta(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){rn(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=ca(e);return t instanceof Vr&&zr(t)?t.getFilters():[t]}(n.where));let a=[];n.orderBy&&(a=function(e){return e.map(e=>function(e){return new Dr(fa(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,Un(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Or(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Or(n,t)}(n.endAt)),li(t,i,a,s,o,"F",l,c)}function ca(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=fa(e.unaryFilter.field);return Ur.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=fa(e.unaryFilter.field);return Ur.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=fa(e.unaryFilter.field);return Ur.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=fa(e.unaryFilter.field);return Ur.create(i,"!=",{nullValue:"NULL_VALUE"});default:return nn()}}(e):void 0!==e.fieldFilter?function(e){return Ur.create(fa(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return nn()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Vr.create(e.compositeFilter.filters.map(e=>ca(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return nn()}}(e.compositeFilter.op))}(e):nn()}function ua(e){return Us[e]}function da(e){return Vs[e]}function ha(e){return Bs[e]}function pa(e){return{fieldPath:e.canonicalString()}}function fa(e){return Cn.fromServerFormat(e.fieldPath)}function ma(e){return e instanceof Ur?function(e){if("=="===e.op){if(Cr(e.value))return{unaryFilter:{field:pa(e.field),op:"IS_NAN"}};if(Sr(e.value))return{unaryFilter:{field:pa(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Cr(e.value))return{unaryFilter:{field:pa(e.field),op:"IS_NOT_NAN"}};if(Sr(e.value))return{unaryFilter:{field:pa(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:pa(e.field),op:da(e.op),value:e.value}}}(e):e instanceof Vr?function(e){const t=e.getFilters().map(e=>ma(e));return 1===t.length?t[0]:{compositeFilter:{op:ha(e.op),filters:t}}}(e):nn()}function ga(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function ya(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class va{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:In.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:In.min(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:rr.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new va(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new va(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new va(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new va(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class xa{constructor(e){this.ct=e}}function ba(e){const t=la({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?gi(t,t.limit,"L"):t}class wa{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(ar(e.integerValue));else if("doubleValue"in e){const n=ar(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),Vn(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),"string"==typeof n&&(n=sr(n)),t.Rt("".concat(n.seconds||"")),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(or(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?Ar(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Tr(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):nn()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const r of Object.keys(n))this.Vt(r,t),this.Tt(n[r],t)}wt(e,t){var n,r;const i=e.fields||{};this.dt(t,53);const s="value",a=(null===(r=null===(n=i[s].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.dt(t,15),t.At(ar(a)),this.Vt(s,t),this.Tt(i[s],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const r of n)this.Tt(r,t)}yt(e,t){this.dt(t,37),_n.fromName(e).path.forEach(e=>{this.dt(t,60),this.Dt(e,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}wa.vt=new wa;class Ia{constructor(){this.un=new Na}addToCollectionParentIndex(e,t){return this.un.add(t),Ln.resolve()}getCollectionParents(e,t){return Ln.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return Ln.resolve()}deleteFieldIndex(e,t){return Ln.resolve()}deleteAllFieldIndexes(e){return Ln.resolve()}createTargetIndexes(e,t){return Ln.resolve()}getDocumentsMatchingTarget(e,t){return Ln.resolve(null)}getIndexType(e,t){return Ln.resolve(0)}getFieldIndexes(e,t){return Ln.resolve([])}getNextCollectionGroupToUpdate(e){return Ln.resolve(null)}getMinOffset(e,t){return Ln.resolve(Rn.min())}getMinOffsetFromCollectionGroup(e,t){return Ln.resolve(Rn.min())}updateCollectionGroup(e,t,n){return Ln.resolve()}updateIndexEntries(e,t){return Ln.resolve()}}class Na{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Zn(En.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Zn(En.comparator)).toArray()}}new Uint8Array(0);class Ea{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Ea(e,Ea.DEFAULT_COLLECTION_PERCENTILE,Ea.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Ea.DEFAULT_COLLECTION_PERCENTILE=10,Ea.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ea.DEFAULT=new Ea(41943040,Ea.DEFAULT_COLLECTION_PERCENTILE,Ea.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ea.DISABLED=new Ea(-1,0,0);class Sa{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Sa(0)}static kn(){return new Sa(-1)}}class Ca{constructor(){this.changes=new Ei(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Pr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Ln.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class _a{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Ta{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&as(n.mutation,e,tr.empty(),wn.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Mi()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Mi();const r=Ai();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=Ti();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Ai();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Mi()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=Ci();const s=ji(),a=ji();return t.forEach((e,t)=>{const a=n.get(t.key);r.has(t.key)&&(void 0===a||a.mutation instanceof us)?i=i.insert(t.key,t):void 0!==a?(s.set(t.key,a.mutation.getFieldMask()),as(a.mutation,t,a.mutation.getFieldMask(),wn.now())):s.set(t.key,tr.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return a.set(e,new _a(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),a))}recalculateAndSaveOverlays(e,t){const n=ji();let r=new Jn((e,t)=>e-t),i=Mi();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let a=n.get(e)||tr.empty();a=i.applyToLocalView(s,a),n.set(e,a);const o=(r.get(i.batchId)||Mi()).add(e);r=r.insert(i.batchId,o)})}).next(()=>{const s=[],a=r.getReverseIterator();for(;a.hasNext();){const r=a.getNext(),o=r.key,l=r.value,c=Ri();l.forEach(e=>{if(!i.has(e)){const r=is(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,c))}return Ln.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return _n.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):di(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Ln.resolve(Ai());let a=-1,o=i;return s.next(t=>Ln.forEach(t,(t,n)=>(a<n.largestBatchId&&(a=n.largestBatchId),i.get(t)?Ln.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,o,t,Mi())).next(e=>({batchId:a,changes:ki(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new _n(t)).next(e=>{let t=Ti();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=Ti();return this.indexManager.getCollectionParents(e,i).next(a=>Ln.forEach(a,a=>{const o=function(e,t){return new oi(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Pr.newInvalidDocument(r)))});let n=Ti();return e.forEach((e,r)=>{const s=i.get(e);void 0!==s&&as(s.mutation,r,tr.empty(),wn.now()),bi(t,r)&&(n=n.insert(e,r))}),n})}}class ka{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return Ln.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Ys(e.createTime)}}(t)),Ln.resolve()}getNamedQuery(e,t){return Ln.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(e){return{name:e.name,query:ba(e.bundledQuery),readTime:Ys(e.readTime)}}(t)),Ln.resolve()}}class Aa{constructor(){this.overlays=new Jn(_n.comparator),this.Ir=new Map}getOverlay(e,t){return Ln.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Ai();return Ln.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.ht(e,t,r)}),Ln.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Ir.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.Ir.delete(n)),Ln.resolve()}getOverlaysForCollection(e,t,n){const r=Ai(),i=t.length+1,s=new _n(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const e=a.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Ln.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Jn((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Ai(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const a=Ai(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=r)););return Ln.resolve(a)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Ir.get(r.largestBatchId).delete(n.key);this.Ir.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new vs(t,n));let i=this.Ir.get(t);void 0===i&&(i=Mi(),this.Ir.set(t,i)),this.Ir.set(t,i.add(n.key))}}class Ra{constructor(){this.sessionToken=rr.EMPTY_BYTE_STRING}getSessionToken(e){return Ln.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ln.resolve()}}class ja{constructor(){this.Tr=new Zn(Pa.Er),this.dr=new Zn(Pa.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new Pa(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Vr(new Pa(e,t))}mr(e,t){e.forEach(e=>this.removeReference(e,t))}gr(e){const t=new _n(new En([])),n=new Pa(t,e),r=new Pa(t,e+1),i=[];return this.dr.forEachInRange([n,r],e=>{this.Vr(e),i.push(e.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new _n(new En([])),n=new Pa(t,e),r=new Pa(t,e+1);let i=Mi();return this.dr.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new Pa(e,0),n=this.Tr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Pa{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return _n.comparator(e.key,t.key)||xn(e.wr,t.wr)}static Ar(e,t){return xn(e.wr,t.wr)||_n.comparator(e.key,t.key)}}class Oa{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Zn(Pa.Er)}checkEmpty(e){return Ln.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new gs(i,t,n,r);this.mutationQueue.push(s);for(const a of r)this.br=this.br.add(new Pa(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Ln.resolve(s)}lookupMutationBatch(e,t){return Ln.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.vr(n),i=r<0?0:r;return Ln.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Ln.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return Ln.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Pa(t,0),r=new Pa(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,r],e=>{const t=this.Dr(e.wr);i.push(t)}),Ln.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Zn(xn);return t.forEach(e=>{const t=new Pa(e,0),r=new Pa(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,r],e=>{n=n.add(e.wr)})}),Ln.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;_n.isDocumentKey(i)||(i=i.child(""));const s=new Pa(new _n(i),0);let a=new Zn(xn);return this.br.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.wr)),!0)},s),Ln.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(e=>{const n=this.Dr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){rn(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.br;return Ln.forEach(t.mutations,r=>{const i=new Pa(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,t){const n=new Pa(t,0),r=this.br.firstAfterOrEqual(n);return Ln.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ln.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Ma{constructor(e){this.Mr=e,this.docs=new Jn(_n.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Ln.resolve(n?n.document.mutableCopy():Pr.newInvalidDocument(t))}getEntries(e,t){let n=Ci();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Pr.newInvalidDocument(e))}),Ln.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Ci();const s=t.path,a=new _n(s.child("")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){const{key:e,value:{document:a}}=o.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||jn(An(a),n)<=0||(r.has(a.key)||bi(t,a))&&(i=i.insert(a.key,a.mutableCopy()))}return Ln.resolve(i)}getAllFromCollectionGroup(e,t,n,r){nn()}Or(e,t){return Ln.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new La(this)}getSize(e){return Ln.resolve(this.size)}}class La extends Ca{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(n)}),Ln.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class Da{constructor(e){this.persistence=e,this.Nr=new Ei(e=>ii(e),si),this.lastRemoteSnapshotVersion=In.min(),this.highestTargetId=0,this.Lr=0,this.Br=new ja,this.targetCount=0,this.kr=Sa.Bn()}forEachTarget(e,t){return this.Nr.forEach((e,n)=>t(n)),Ln.resolve()}getLastRemoteSnapshotVersion(e){return Ln.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ln.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Ln.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),Ln.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Sa(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,Ln.resolve()}updateTargetData(e,t){return this.Kn(t),Ln.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,Ln.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Nr.forEach((s,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.Nr.delete(s),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),Ln.waitFor(i).next(()=>r)}getTargetCount(e){return Ln.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return Ln.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),Ln.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),Ln.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),Ln.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return Ln.resolve(n)}containsKey(e,t){return Ln.resolve(this.Br.containsKey(t))}}class Fa{constructor(e,t){this.qr={},this.overlays={},this.Qr=new qn(0),this.Kr=!1,this.Kr=!0,this.$r=new Ra,this.referenceDelegate=e(this),this.Ur=new Da(this),this.indexManager=new Ia,this.remoteDocumentCache=function(e){return new Ma(e)}(e=>this.referenceDelegate.Wr(e)),this.serializer=new xa(t),this.Gr=new ka(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Aa,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new Oa(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){$t("MemoryPersistence","Starting transaction:",e);const r=new qa(this.Qr.next());return this.referenceDelegate.zr(),n(r).next(e=>this.referenceDelegate.jr(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Hr(e,t){return Ln.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,t)))}}class qa extends On{constructor(e){super(),this.currentSequenceNumber=e}}class Ua{constructor(e){this.persistence=e,this.Jr=new ja,this.Yr=null}static Zr(e){return new Ua(e)}get Xr(){if(this.Yr)return this.Yr;throw nn()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),Ln.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),Ln.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),Ln.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(e=>this.Xr.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.Xr.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ln.forEach(this.Xr,n=>{const r=_n.fromPath(n);return this.ei(e,r).next(e=>{e||t.removeEntry(r,In.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return Ln.or([()=>Ln.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class Va{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=r}static Wi(e,t){let n=Mi(),r=Mi();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Va(e,t.fromCache,n,r)}}class Ba{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class za{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=W()?8:Dn(G())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.Yi(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.Zi(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;const n=new Ba;return this.Xi(e,t,n).next(r=>{if(i.result=r,this.zi)return this.es(e,t,n,r.size)})}).next(()=>i.result)}es(e,t,n,r){return n.documentReadCount<this.ji?(Xt()<=ue.DEBUG&&$t("QueryEngine","SDK will not create cache indexes for query:",xi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Ln.resolve()):(Xt()<=ue.DEBUG&&$t("QueryEngine","Query:",xi(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Hi*r?(Xt()<=ue.DEBUG&&$t("QueryEngine","The SDK decides to create cache indexes for query:",xi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pi(t))):Ln.resolve())}Yi(e,t){if(ui(t))return Ln.resolve(null);let n=pi(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=gi(t,null,"F"),n=pi(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=Mi(...r);return this.Ji.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.ts(t,r);return this.ns(t,s,i,n.readTime)?this.Yi(e,gi(t,null,"F")):this.rs(e,s,t,n)}))})))}Zi(e,t,n,r){return ui(t)||r.isEqual(In.min())?Ln.resolve(null):this.Ji.getDocuments(e,n).next(i=>{const s=this.ts(t,i);return this.ns(t,s,n,r)?Ln.resolve(null):(Xt()<=ue.DEBUG&&$t("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),xi(t)),this.rs(e,s,t,kn(r,-1)).next(e=>e))})}ts(e,t){let n=new Zn(Ii(e));return t.forEach((t,r)=>{bi(e,r)&&(n=n.add(r))}),n}ns(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Xi(e,t,n){return Xt()<=ue.DEBUG&&$t("QueryEngine","Using full collection scan to execute query:",xi(t)),this.Ji.getDocumentsMatchingQuery(e,t,Rn.min(),n)}rs(e,t,n,r){return this.Ji.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}class Ha{constructor(e,t,n,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new Jn(xn),this._s=new Ei(e=>ii(e),si),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ta(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function Ga(e,t,n,r){return new Ha(e,t,n,r)}async function Wa(e,t){const n=sn(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.ls(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let a=Mi();for(const e of r){i.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}return n.localDocuments.getDocuments(e,a).next(e=>({hs:e,removedBatchIds:i,addedBatchIds:s}))})})}function Ka(e){const t=sn(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Ur.getLastRemoteSnapshotVersion(e))}function Ya(e,t,n){let r=Mi(),i=Mi();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=Ci();return n.forEach((n,s)=>{const a=e.get(n);s.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(In.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):$t("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)}),{Ps:r,Is:i}})}function Qa(e,t){const n=sn(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function Ja(e,t){const n=sn(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Ur.getTargetData(e,t).next(i=>i?(r=i,Ln.resolve(r)):n.Ur.allocateTargetId(e).next(i=>(r=new va(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Ur.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.os.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.os=n.os.insert(e.targetId,e),n._s.set(t,e.targetId)),e})}async function Xa(e,t,n){const r=sn(e),i=r.os.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!Fn(e))throw e;$t("LocalStore","Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.os=r.os.remove(t),r._s.delete(i.target)}function $a(e,t,n){const r=sn(e);let i=In.min(),s=Mi();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=sn(e),i=r._s.get(n);return void 0!==i?Ln.resolve(r.os.get(i)):r.Ur.getTargetData(t,n)}(r,e,pi(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.ss.getDocumentsMatchingQuery(e,t,n?i:In.min(),n?s:Mi())).next(e=>(Za(r,wi(t),e),{documents:e,Ts:s})))}function Za(e,t,n){let r=e.us.get(t)||In.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.us.set(t,r)}class eo{constructor(){this.activeTargetIds=Di()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class to{constructor(){this.so=new eo,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new eo,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class no{_o(e){}shutdown(){}}class ro{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){$t("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){$t("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let io=null;function so(){return null===io?io=268435456+Math.round(2147483648*Math.random()):io++,"0x"+io.toString(16)}const ao={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class oo{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const lo="WebChannelConnection";class co extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo="projects/".concat(n,"/databases/").concat(r),this.Co="(default)"===this.databaseId.database?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}get Fo(){return!1}Mo(e,t,n,r,i){const s=so(),a=this.xo(e,t.toUriEncodedString());$t("RestConnection","Sending RPC '".concat(e,"' ").concat(s,":"),a,n);const o={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(o,r,i),this.No(e,a,o,n).then(t=>($t("RestConnection","Received RPC '".concat(e,"' ").concat(s,": "),t),t),t=>{throw en("RestConnection","RPC '".concat(e,"' ").concat(s," failed with error: "),t,"url: ",a,"request:",n),t})}Lo(e,t,n,r,i,s){return this.Mo(e,t,n,r,i)}Oo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Qt,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}xo(e,t){const n=ao[e];return"".concat(this.Do,"/v1/").concat(t,":").concat(n)}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,r){const i=so();return new Promise((s,a)=>{const o=new Dt;o.setWithCredentials(!0),o.listenOnce(qt.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case Ut.NO_ERROR:const t=o.getResponseJson();$t(lo,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(t)),s(t);break;case Ut.TIMEOUT:$t(lo,"RPC '".concat(e,"' ").concat(i," timed out")),a(new on(an.DEADLINE_EXCEEDED,"Request time out"));break;case Ut.HTTP_ERROR:const n=o.getStatus();if($t(lo,"RPC '".concat(e,"' ").concat(i," failed with status:"),n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(an).indexOf(t)>=0?t:an.UNKNOWN}(t.status);a(new on(e,t.message))}else a(new on(an.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new on(an.UNAVAILABLE,"Connection failed."));break;default:nn()}}finally{$t(lo,"RPC '".concat(e,"' ").concat(i," completed."))}});const l=JSON.stringify(r);$t(lo,"RPC '".concat(e,"' ").concat(i," sending request:"),r),o.send(t,"POST",l,n,15)})}Bo(e,t,n){const r=so(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Ht(),a=zt(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Oo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=i.join("");$t(lo,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),o);const u=s.createWebChannel(c,o);let d=!1,h=!1;const p=new oo({Io:t=>{h?$t(lo,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(d||($t(lo,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),d=!0),$t(lo,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},To:()=>u.close()}),f=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return f(u,Ft.EventType.OPEN,()=>{h||($t(lo,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),p.yo())}),f(u,Ft.EventType.CLOSE,()=>{h||(h=!0,$t(lo,"RPC '".concat(e,"' stream ").concat(r," transport closed")),p.So())}),f(u,Ft.EventType.ERROR,t=>{h||(h=!0,en(lo,"RPC '".concat(e,"' stream ").concat(r," transport errored:"),t),p.So(new on(an.UNAVAILABLE,"The operation could not be completed")))}),f(u,Ft.EventType.MESSAGE,t=>{var n;if(!h){const i=t.data[0];rn(!!i);const s=i,a=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(a){$t(lo,"RPC '".concat(e,"' stream ").concat(r," received error:"),a);const t=a.status;let n=function(e){const t=bs[e];if(void 0!==t)return Ns(t)}(t),i=a.message;void 0===n&&(n=an.INTERNAL,i="Unknown error status: "+t+" with message "+a.message),h=!0,p.So(new on(n,i)),u.close()}else $t(lo,"RPC '".concat(e,"' stream ").concat(r," received:"),i),p.bo(i)}}),f(a,Bt.STAT_EVENT,t=>{t.stat===Vt.PROXY?$t(lo,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===Vt.NOPROXY&&$t(lo,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(()=>{p.wo()},0),p}}function uo(){return"undefined"!=typeof document?document:null}function ho(e){return new zs(e,!0)}class po{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ui=e,this.timerId=t,this.ko=n,this.qo=r,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-n);r>0&&$t("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.Ko," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class fo{constructor(e,t,n,r,i,s,a,o){this.ui=e,this.Ho=n,this.Jo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new po(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===an.RESOURCE_EXHAUSTED?(Zt(t.toString()),Zt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===an.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.Yo===t&&this.P_(n,r)},t=>{e(()=>{const e=new on(an.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)})})}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(e=>{n(()=>this.I_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.e_?this.E_(e):this.onNext(e))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return $t("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():($t("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class mo extends fo{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:nn()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(rn(void 0===t||"string"==typeof t),rr.fromBase64String(t||"")):(rn(void 0===t||t instanceof Buffer||t instanceof Uint8Array),rr.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,o=a&&function(e){const t=void 0===e.code?an.UNKNOWN:Ns(e.code);return new on(t,e.message||"")}(a);n=new Ms(r,i,s,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Zs(e,r.document.name),s=Ys(r.document.updateTime),a=r.document.createTime?Ys(r.document.createTime):In.min(),o=new Rr({mapValue:{fields:r.document.fields}}),l=Pr.newFoundDocument(i,s,a,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Ps(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Zs(e,r.document),s=r.readTime?Ys(r.readTime):In.min(),a=Pr.newNoDocument(i,s),o=r.removedTargetIds||[];n=new Ps([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Zs(e,r.document),s=r.removedTargetIds||[];n=new Ps([],s,i,null)}else{if(!("filter"in t))return nn();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new xs(r,i),a=e.targetId;n=new Os(a,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return In.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?In.min():t.readTime?Ys(t.readTime):In.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=na(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=ai(r)?{documents:aa(e,r)}:{query:oa(e,r)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Ws(e,t.resumeToken);const r=Hs(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(In.min())>0){n.readTime=Gs(e,t.snapshotVersion.toTimestamp());const r=Hs(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return nn()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=na(this.serializer),t.removeTarget=e,this.a_(t)}}class go extends fo{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return rn(!!e.streamToken),this.lastStreamToken=e.streamToken,rn(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){rn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(rn(void 0!==t),e.map(e=>function(e,t){let n=e.updateTime?Ys(e.updateTime):Ys(t);return n.isEqual(In.min())&&(n=Ys(t)),new es(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Ys(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=na(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>sa(this.serializer,e))};this.a_(t)}}class yo extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new on(an.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[s,a]=i;return this.connection.Mo(e,Js(t,n),r,s,a)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===an.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new on(an.UNKNOWN,e.toString())})}Lo(e,t,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[a,o]=s;return this.connection.Lo(e,Js(t,n),r,a,o,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===an.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new on(an.UNKNOWN,e.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class vo{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.D_?(Zt(t),this.D_=!1):$t("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}class xo{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(e=>{n.enqueueAndForget(async()=>{To(this)&&($t("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=sn(e);t.L_.add(4),await wo(t),t.q_.set("Unknown"),t.L_.delete(4),await bo(t)}(this))})}),this.q_=new vo(n,r)}}async function bo(e){if(To(e))for(const t of e.B_)await t(!0)}async function wo(e){for(const t of e.B_)await t(!1)}function Io(e,t){const n=sn(e);n.N_.has(t.targetId)||(n.N_.set(t.targetId,t),_o(n)?Co(n):Ko(n).r_()&&Eo(n,t))}function No(e,t){const n=sn(e),r=Ko(n);n.N_.delete(t),r.r_()&&So(n,t),0===n.N_.size&&(r.r_()?r.o_():To(n)&&n.q_.set("Unknown"))}function Eo(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(In.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Ko(e).A_(t)}function So(e,t){e.Q_.xe(t),Ko(e).R_(t)}function Co(e){e.Q_=new Ds({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),Ko(e).start(),e.q_.v_()}function _o(e){return To(e)&&!Ko(e).n_()&&e.N_.size>0}function To(e){return 0===sn(e).L_.size}function ko(e){e.Q_=void 0}async function Ao(e){e.q_.set("Online")}async function Ro(e){e.N_.forEach((t,n)=>{Eo(e,t)})}async function jo(e,t){ko(e),_o(e)?(e.q_.M_(t),Co(e)):e.q_.set("Unknown")}async function Po(e,t,n){if(e.q_.set("Online"),t instanceof Ms&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.N_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.N_.delete(r),e.Q_.removeTarget(r))}(e,t)}catch(n){$t("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Oo(e,n)}else if(t instanceof Ps?e.Q_.Ke(t):t instanceof Os?e.Q_.He(t):e.Q_.We(t),!n.isEqual(In.min()))try{const t=await Ka(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Q_.rt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.N_.get(r);i&&e.N_.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.N_.get(t);if(!r)return;e.N_.set(t,r.withResumeToken(rr.EMPTY_BYTE_STRING,r.snapshotVersion)),So(e,t);const i=new va(r.target,t,n,r.sequenceNumber);Eo(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){$t("RemoteStore","Failed to raise snapshot:",t),await Oo(e,t)}}async function Oo(e,t,n){if(!Fn(t))throw t;e.L_.add(1),await wo(e),e.q_.set("Offline"),n||(n=()=>Ka(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{$t("RemoteStore","Retrying IndexedDB access"),await n(),e.L_.delete(1),await bo(e)})}function Mo(e,t){return t().catch(n=>Oo(e,n,t))}async function Lo(e){const t=sn(e),n=Yo(t);let r=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;Do(t);)try{const e=await Qa(t.localStore,r);if(null===e){0===t.O_.length&&n.o_();break}r=e.batchId,Fo(t,e)}catch(e){await Oo(t,e)}qo(t)&&Uo(t)}function Do(e){return To(e)&&e.O_.length<10}function Fo(e,t){e.O_.push(t);const n=Yo(e);n.r_()&&n.V_&&n.m_(t.mutations)}function qo(e){return To(e)&&!Yo(e).n_()&&e.O_.length>0}function Uo(e){Yo(e).start()}async function Vo(e){Yo(e).p_()}async function Bo(e){const t=Yo(e);for(const n of e.O_)t.m_(n.mutations)}async function zo(e,t,n){const r=e.O_.shift(),i=ys.from(r,t,n);await Mo(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await Lo(e)}async function Ho(e,t){t&&Yo(e).V_&&await async function(e,t){if(function(e){return Is(e)&&e!==an.ABORTED}(t.code)){const n=e.O_.shift();Yo(e).s_(),await Mo(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Lo(e)}}(e,t),qo(e)&&Uo(e)}async function Go(e,t){const n=sn(e);n.asyncQueue.verifyOperationInProgress(),$t("RemoteStore","RemoteStore received new credentials");const r=To(n);n.L_.add(3),await wo(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.L_.delete(3),await bo(n)}async function Wo(e,t){const n=sn(e);t?(n.L_.delete(2),await bo(n)):t||(n.L_.add(2),await wo(n),n.q_.set("Unknown"))}function Ko(e){return e.K_||(e.K_=function(e,t,n){const r=sn(e);return r.w_(),new mo(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:Ao.bind(null,e),Ro:Ro.bind(null,e),mo:jo.bind(null,e),d_:Po.bind(null,e)}),e.B_.push(async t=>{t?(e.K_.s_(),_o(e)?Co(e):e.q_.set("Unknown")):(await e.K_.stop(),ko(e))})),e.K_}function Yo(e){return e.U_||(e.U_=function(e,t,n){const r=sn(e);return r.w_(),new go(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Vo.bind(null,e),mo:Ho.bind(null,e),f_:Bo.bind(null,e),g_:zo.bind(null,e)}),e.B_.push(async t=>{t?(e.U_.s_(),await Lo(e)):(await e.U_.stop(),e.O_.length>0&&($t("RemoteStore","Stopping write stream with ".concat(e.O_.length," pending writes")),e.O_=[]))})),e.U_}class Qo{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new ln,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,a=new Qo(e,t,s,r,i);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new on(an.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Jo(e,t){if(Zt("AsyncQueue","".concat(t,": ").concat(e)),Fn(e))return new on(an.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class Xo{constructor(e){this.comparator=e?(t,n)=>e(t,n)||_n.comparator(t.key,n.key):(e,t)=>_n.comparator(e.key,t.key),this.keyedMap=Ti(),this.sortedSet=new Jn(this.comparator)}static emptySet(e){return new Xo(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Xo))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Xo;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class $o{constructor(){this.W_=new Jn(_n.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?0!==e.type&&3===n.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==n.type?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.W_=this.W_.remove(t):1===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):nn():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,n)=>{e.push(n)}),e}}class Zo{constructor(e,t,n,r,i,s,a,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new Zo(e,t,Xo.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yi(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class el{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class tl{constructor(){this.queries=nl(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const n=sn(e),r=n.queries;n.queries=nl(),r.forEach((e,n)=>{for(const r of n.j_)r.onError(t)})}(this,new on(an.ABORTED,"Firestore shutting down"))}}function nl(){return new Ei(e=>vi(e),yi)}async function rl(e,t){const n=sn(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.H_()&&t.J_()&&(r=2):(s=new el,r=t.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=Jo(e,"Initialization of query '".concat(xi(t.query),"' failed"));return void t.onError(n)}n.queries.set(i,s),s.j_.push(t),t.Z_(n.onlineState),s.z_&&t.X_(s.z_)&&ol(n)}async function il(e,t){const n=sn(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.j_.indexOf(t);e>=0&&(s.j_.splice(e,1),0===s.j_.length?i=t.J_()?0:1:!s.H_()&&t.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function sl(e,t){const n=sn(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.j_)e.X_(i)&&(r=!0);t.z_=i}}r&&ol(n)}function al(e,t,n){const r=sn(e),i=r.queries.get(t);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(t)}function ol(e){e.Y_.forEach(e=>{e.next()})}var ll,cl;(cl=ll||(ll={})).ea="default",cl.Cache="cache";class ul{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Zo(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache)return!0;if(!this.J_())return!0;const n="Offline"!==t;return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}oa(e){e=Zo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ll.Cache}}class dl{constructor(e){this.key=e}}class hl{constructor(e){this.key=e}}class pl{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Mi(),this.mutatedKeys=Mi(),this.Aa=Ii(e),this.Ra=new Xo(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new $o,r=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,a=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=bi(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let p=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),p=!0):this.ga(c,u)||(n.track({type:2,doc:u}),p=!0,(o&&this.Aa(u,o)>0||l&&this.Aa(u,l)<0)&&(a=!0)):!c&&u?(n.track({type:0,doc:u}),p=!0):c&&!u&&(n.track({type:1,doc:c}),p=!0,(o||l)&&(a=!0)),p&&(u?(s=s.add(u),i=h?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Ra:s,fa:n,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const s=e.fa.G_();s.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return nn()}};return n(e)-n(t)}(e.type,t.type)||this.Aa(e.doc,t.doc)),this.pa(n),r=null!=r&&r;const a=t&&!r?this.ya():[],o=0===this.da.size&&this.current&&!r?1:0,l=o!==this.Ea;return this.Ea=o,0!==s.length||l?{snapshot:new Zo(this.query,e.Ra,i,s,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new $o,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(e=>this.Ta=this.Ta.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ta=this.Ta.delete(e)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Mi(),this.Ra.forEach(e=>{this.Sa(e.key)&&(this.da=this.da.add(e.key))});const t=[];return e.forEach(e=>{this.da.has(e)||t.push(new hl(e))}),this.da.forEach(n=>{e.has(n)||t.push(new dl(n))}),t}ba(e){this.Ta=e.Ts,this.da=Mi();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Zo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class fl{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class ml{constructor(e){this.key=e,this.va=!1}}class gl{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new Ei(e=>vi(e),yi),this.Ma=new Map,this.xa=new Set,this.Oa=new Jn(_n.comparator),this.Na=new Map,this.La=new ja,this.Ba={},this.ka=new Map,this.qa=Sa.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}async function yl(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Fl(e);let i;const s=r.Fa.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await xl(r,t,n,!0),i}async function vl(e,t){const n=Fl(e);await xl(n,t,!0,!1)}async function xl(e,t,n,r){const i=await Ja(e.localStore,pi(t)),s=i.targetId,a=e.sharedClientState.addLocalQueryTarget(s,n);let o;return r&&(o=await bl(e,t,s,"current"===a,i.resumeToken)),e.isPrimaryClient&&n&&Io(e.remoteStore,i),o}async function bl(e,t,n,r,i){e.Ka=(t,n,r)=>async function(e,t,n,r){let i=t.view.ma(n);i.ns&&(i=await $a(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ma(n,i)}));const s=r&&r.targetChanges.get(t.targetId),a=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s,a);return jl(e,t.targetId,o.wa),o.snapshot}(e,t,n,r);const s=await $a(e.localStore,t,!0),a=new pl(t,s.Ts),o=a.ma(s.documents),l=js.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=a.applyChanges(o,e.isPrimaryClient,l);jl(e,n,c.wa);const u=new fl(t,n,a);return e.Fa.set(t,u),e.Ma.has(n)?e.Ma.get(n).push(t):e.Ma.set(n,[t]),c.snapshot}async function wl(e,t,n){const r=sn(e),i=r.Fa.get(t),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(e=>!yi(e,t))),void r.Fa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Xa(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&No(r.remoteStore,i.targetId),Al(r,i.targetId)}).catch(Mn)):(Al(r,i.targetId),await Xa(r.localStore,i.targetId,!0))}async function Il(e,t){const n=sn(e),r=n.Fa.get(t),i=n.Ma.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),No(n.remoteStore,r.targetId))}async function Nl(e,t){const n=sn(e);try{const e=await function(e,t){const n=sn(e),r=t.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const a=[];t.targetChanges.forEach((s,o)=>{const l=i.get(o);if(!l)return;a.push(n.Ur.removeMatchingKeys(e,s.removedDocuments,o).next(()=>n.Ur.addMatchingKeys(e,s.addedDocuments,o)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(rr.EMPTY_BYTE_STRING,In.min()).withLastLimboFreeSnapshotVersion(In.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,s)&&a.push(n.Ur.updateTargetData(e,c))});let o=Ci(),l=Mi();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),a.push(Ya(e,s,t.documentUpdates).next(e=>{o=e.Ps,l=e.Is})),!r.isEqual(In.min())){const t=n.Ur.getLastRemoteSnapshotVersion(e).next(t=>n.Ur.setTargetsMetadata(e,e.currentSequenceNumber,r));a.push(t)}return Ln.waitFor(a).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(n.os=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Na.get(t);r&&(rn(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.va=!0:e.modifiedDocuments.size>0?rn(r.va):e.removedDocuments.size>0&&(rn(r.va),r.va=!1))}),await Ml(n,e,t)}catch(e){await Mn(e)}}function El(e,t,n){const r=sn(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Fa.forEach((n,r)=>{const i=r.view.Z_(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=sn(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.j_)i.Z_(t)&&(r=!0)}),r&&ol(n)}(r.eventManager,t),e.length&&r.Ca.d_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Sl(e,t,n){const r=sn(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Na.get(t),s=i&&i.key;if(s){let e=new Jn(_n.comparator);e=e.insert(s,Pr.newNoDocument(s,In.min()));const n=Mi().add(s),i=new Rs(In.min(),new Map,new Jn(xn),e,n);await Nl(r,i),r.Oa=r.Oa.remove(s),r.Na.delete(t),Ol(r)}else await Xa(r.localStore,t,!1).then(()=>Al(r,t,n)).catch(Mn)}async function Cl(e,t){const n=sn(e),r=t.batch.batchId;try{const e=await function(e,t){const n=sn(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let a=Ln.resolve();return s.forEach(e=>{a=a.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);rn(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),a.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Mi();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);kl(n,r,null),Tl(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ml(n,e)}catch(e){await Mn(e)}}async function _l(e,t,n){const r=sn(e);try{const e=await function(e,t){const n=sn(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(rn(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);kl(r,t,n),Tl(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Ml(r,e)}catch(n){await Mn(n)}}function Tl(e,t){(e.ka.get(t)||[]).forEach(e=>{e.resolve()}),e.ka.delete(t)}function kl(e,t,n){const r=sn(e);let i=r.Ba[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Ba[r.currentUser.toKey()]=i}}function Al(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Ma.get(t))e.Fa.delete(r),n&&e.Ca.$a(r,n);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach(t=>{e.La.containsKey(t)||Rl(e,t)})}function Rl(e,t){e.xa.delete(t.path.canonicalString());const n=e.Oa.get(t);null!==n&&(No(e.remoteStore,n),e.Oa=e.Oa.remove(t),e.Na.delete(n),Ol(e))}function jl(e,t,n){for(const r of n)r instanceof dl?(e.La.addReference(r.key,t),Pl(e,r)):r instanceof hl?($t("SyncEngine","Document no longer in limbo: "+r.key),e.La.removeReference(r.key,t),e.La.containsKey(r.key)||Rl(e,r.key)):nn()}function Pl(e,t){const n=t.key,r=n.path.canonicalString();e.Oa.get(n)||e.xa.has(r)||($t("SyncEngine","New document in limbo: "+n),e.xa.add(r),Ol(e))}function Ol(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const n=new _n(En.fromString(t)),r=e.qa.next();e.Na.set(r,new ml(n)),e.Oa=e.Oa.insert(n,r),Io(e.remoteStore,new va(pi(ci(n.path)),r,"TargetPurposeLimboResolution",qn.oe))}}async function Ml(e,t,n){const r=sn(e),i=[],s=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((e,o)=>{a.push(r.Ka(o,t,n).then(e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,i?"current":"not-current")}if(e){i.push(e);const t=Va.Wi(o.targetId,e);s.push(t)}}))}),await Promise.all(a),r.Ca.d_(i),await async function(e,t){const n=sn(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Ln.forEach(t,t=>Ln.forEach(t.$i,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>Ln.forEach(t.Ui,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!Fn(e))throw e;$t("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.os.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.os=n.os.insert(e,i)}}}(r.localStore,s))}async function Ll(e,t){const n=sn(e);if(!n.currentUser.isEqual(t)){$t("SyncEngine","User change. New user:",t.toKey());const e=await Wa(n.localStore,t);n.currentUser=t,function(e,t){e.ka.forEach(e=>{e.forEach(e=>{e.reject(new on(an.CANCELLED,t))})}),e.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Ml(n,e.hs)}}function Dl(e,t){const n=sn(e),r=n.Na.get(t);if(r&&r.va)return Mi().add(r.key);{let e=Mi();const r=n.Ma.get(t);if(!r)return e;for(const t of r){const r=n.Fa.get(t);e=e.unionWith(r.view.Va)}return e}}function Fl(e){const t=sn(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Nl.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Dl.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Sl.bind(null,t),t.Ca.d_=sl.bind(null,t.eventManager),t.Ca.$a=al.bind(null,t.eventManager),t}function ql(e){const t=sn(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Cl.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=_l.bind(null,t),t}class Ul{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ho(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return Ga(this.persistence,new za,e.initialUser,this.serializer)}Ga(e){return new Fa(Ua.Zr,this.serializer)}Wa(e){return new to}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ul.provider={build:()=>new Ul};class Vl{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>El(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Ll.bind(null,this.syncEngine),await Wo(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new tl}createDatastore(e){const t=ho(e.databaseInfo.databaseId),n=function(e){return new co(e)}(e.databaseInfo);return function(e,t,n,r){return new yo(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new xo(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,e=>El(this.syncEngine,e,0),ro.D()?new ro:new no)}createSyncEngine(e,t){return function(e,t,n,r,i,s,a){const o=new gl(e,t,n,r,i,s);return a&&(o.Qa=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=sn(e);$t("RemoteStore","RemoteStore shutting down."),t.L_.add(5),await wo(t),t.k_.shutdown(),t.q_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}Vl.provider={build:()=>new Vl};class Bl{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Zt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class zl{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Yt.UNAUTHENTICATED,this.clientId=vn.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{$t("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>($t("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ln;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Jo(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Hl(e,t){e.asyncQueue.verifyOperationInProgress(),$t("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Wa(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Gl(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Wl(e);$t("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>Go(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>Go(t.remoteStore,n)),e._onlineComponents=t}async function Wl(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){$t("FirestoreClient","Using user provided OfflineComponentProvider");try{await Hl(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===an.FAILED_PRECONDITION||e.code===an.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;en("Error using user provided cache. Falling back to memory cache: "+n),await Hl(e,new Ul)}}else $t("FirestoreClient","Using default OfflineComponentProvider"),await Hl(e,new Ul);return e._offlineComponents}async function Kl(e){return e._onlineComponents||(e._uninitializedComponentsProvider?($t("FirestoreClient","Using user provided OnlineComponentProvider"),await Gl(e,e._uninitializedComponentsProvider._online)):($t("FirestoreClient","Using default OnlineComponentProvider"),await Gl(e,new Vl))),e._onlineComponents}function Yl(e){return Kl(e).then(e=>e.syncEngine)}async function Ql(e){const t=await Kl(e),n=t.eventManager;return n.onListen=yl.bind(null,t.syncEngine),n.onUnlisten=wl.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=vl.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Il.bind(null,t.syncEngine),n}function Jl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new ln;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new Bl({next:n=>{s.Za(),t.enqueueAndForget(()=>il(e,a)),n.fromCache&&"server"===r.source?i.reject(new on(an.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),a=new ul(n,s,{includeMetadataChanges:!0,_a:!0});return rl(e,a)}(await Ql(e),e.asyncQueue,t,n,r)),r.promise}function Xl(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const $l=new Map;function Zl(e,t,n){if(!n)throw new on(an.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function ec(e){if(!_n.isDocumentKey(e))throw new on(an.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function tc(e){if(_n.isDocumentKey(e))throw new on(an.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function nc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":nn()}function rc(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new on(an.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=nc(e);throw new on(an.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function ic(e,t){if(t<=0)throw new on(an.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}class sc{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new on(an.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new on(an.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new on(an.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Xl(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new on(an.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new on(an.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new on(an.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ac{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sc({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new on(an.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new on(an.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sc(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new un;switch(e.type){case"firstParty":return new fn(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new on(an.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=$l.get(e);t&&($t("ComponentProvider","Removing Datastore"),$l.delete(e),t.terminate())}(this),Promise.resolve()}}function oc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const s=(e=rc(e,ac))._getSettings(),a="".concat(t,":").concat(n);if("firestore.googleapis.com"!==s.host&&s.host!==a&&en("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Yt.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[D(JSON.stringify({alg:"none",type:"JWT"})),D(JSON.stringify(s)),""].join(".")}(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new on(an.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Yt(s)}e._authCredentials=new dn(new cn(t,n))}}class lc{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new lc(this.firestore,e,this._query)}}class cc{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new uc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new cc(this.firestore,e,this._key)}}class uc extends lc{constructor(e,t,n){super(e,t,ci(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new cc(this.firestore,null,new _n(e))}withConverter(e){return new uc(this.firestore,e,this._path)}}function dc(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=ie(e),Zl("collection","path",t),e instanceof ac){const n=En.fromString(t,...r);return tc(n),new uc(e,null,n)}{if(!(e instanceof cc||e instanceof uc))throw new on(an.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(En.fromString(t,...r));return tc(n),new uc(e.firestore,null,n)}}function hc(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=ie(e),1===arguments.length&&(t=vn.newId()),Zl("doc","path",t),e instanceof ac){const n=En.fromString(t,...r);return ec(n),new cc(e,null,new _n(n))}{if(!(e instanceof cc||e instanceof uc))throw new on(an.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(En.fromString(t,...r));return ec(n),new cc(e.firestore,e instanceof uc?e.converter:null,new _n(n))}}class pc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new po(this,"async_queue_retry"),this.Vu=()=>{const e=uo();e&&$t("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=uo();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=uo();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new ln;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(0!==this.Pu.length){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Fn(e))throw e;$t("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(e=>{this.Eu=e,this.du=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Zt("INTERNAL UNHANDLED ERROR: ",t),e}).then(e=>(this.du=!1,e))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const r=Qo.createAndSchedule(this,e,t,n,e=>this.yu(e));return this.Tu.push(r),r}fu(){this.Eu&&nn()}verifyOperationInProgress(){}async wu(){let e;do{e=this.mu,await e}while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function fc(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class mc extends ac{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new pc,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new pc(e),this._firestoreClient=void 0,await e}}}function gc(e){if(e._terminated)throw new on(an.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||yc(e),e._firestoreClient}function yc(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new dr(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Xl(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new zl(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class vc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new vc(rr.fromBase64String(e))}catch(e){throw new on(an.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new vc(rr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class xc{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new on(an.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Cn(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class bc{constructor(e){this._methodName=e}}class wc{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new on(an.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new on(an.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return xn(this._lat,e._lat)||xn(this._long,e._long)}}class Ic{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const Nc=/^__.*__$/;class Ec{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new us(e,this.data,this.fieldMask,t,this.fieldTransforms):new cs(e,this.data,t,this.fieldTransforms)}}class Sc{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new us(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Cc(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw nn()}}class _c{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new _c(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.Ou(e),r}Nu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return zc(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(Cc(this.Cu)&&Nc.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Tc{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||ho(e)}Qu(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new _c({Cu:e,methodName:t,qu:n,path:Cn.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function kc(e){const t=e._freezeSettings(),n=ho(e._databaseId);return new Tc(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Ac(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=e.Qu(s.merge||s.mergeFields?2:0,t,n,i);qc("Data must be an object, but it was:",a,r);const o=Dc(r,a);let l,c;if(s.merge)l=new tr(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=Uc(t,r,n);if(!a.contains(i))throw new on(an.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));Hc(e,i)||e.push(i)}l=new tr(e),c=a.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=a.fieldTransforms;return new Ec(new Rr(o),l,c)}class Rc extends bc{_toFieldTransform(e){if(2!==e.Cu)throw 1===e.Cu?e.Bu("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Bu("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Rc}}class jc extends bc{_toFieldTransform(e){return new Zi(e.path,new Gi)}isEqual(e){return e instanceof jc}}function Pc(e,t,n,r){const i=e.Qu(1,t,n);qc("Data must be an object, but it was:",i,r);const s=[],a=Rr.empty();Yn(r,(e,r)=>{const o=Bc(t,e,n);r=ie(r);const l=i.Nu(o);if(r instanceof Rc)s.push(o);else{const e=Lc(r,l);null!=e&&(s.push(o),a.set(o,e))}});const o=new tr(s);return new Sc(a,o,i.fieldTransforms)}function Oc(e,t,n,r,i,s){const a=e.Qu(1,t,n),o=[Uc(t,r,n)],l=[i];if(s.length%2!=0)throw new on(an.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let h=0;h<s.length;h+=2)o.push(Uc(t,s[h])),l.push(s[h+1]);const c=[],u=Rr.empty();for(let h=o.length-1;h>=0;--h)if(!Hc(c,o[h])){const e=o[h];let t=l[h];t=ie(t);const n=a.Nu(e);if(t instanceof Rc)c.push(e);else{const r=Lc(t,n);null!=r&&(c.push(e),u.set(e,r))}}const d=new tr(c);return new Sc(u,d,a.fieldTransforms)}function Mc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Lc(n,e.Qu(r?4:3,t))}function Lc(e,t){if(Fc(e=ie(e)))return qc("Unsupported field value:",t,e),Dc(e,t);if(e instanceof bc)return function(e,t){if(!Cc(t.Cu))throw t.Bu("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Bu("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=Lc(i,t.Lu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=ie(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Ui(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=wn.fromDate(e);return{timestampValue:Gs(t.serializer,n)}}if(e instanceof wn){const n=new wn(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Gs(t.serializer,n)}}if(e instanceof wc)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof vc)return{bytesValue:Ws(t.serializer,e._byteString)};if(e instanceof cc){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Bu("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:Qs(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Ic)return function(e,t){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Bu("VectorValues must only contain numeric values.");return Fi(t.serializer,e)})}}}}}}(e,t);throw t.Bu("Unsupported field value: ".concat(nc(e)))}(e,t)}function Dc(e,t){const n={};return Qn(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Yn(e,(e,r)=>{const i=Lc(r,t.Mu(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function Fc(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof wn||e instanceof wc||e instanceof vc||e instanceof cc||e instanceof bc||e instanceof Ic)}function qc(e,t,n){if(!Fc(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=nc(n);throw"an object"===r?t.Bu(e+" a custom object"):t.Bu(e+" "+r)}}function Uc(e,t,n){if((t=ie(t))instanceof xc)return t._internalPath;if("string"==typeof t)return Bc(e,t);throw zc("Field path arguments must be of type string or ",e,!1,void 0,n)}const Vc=new RegExp("[~\\*/\\[\\]]");function Bc(e,t,n){if(t.search(Vc)>=0)throw zc("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new xc(...t.split("."))._internalPath}catch(r){throw zc("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function zc(e,t,n,r,i){const s=r&&!r.isEmpty(),a=void 0!==i;let o="Function ".concat(t,"() called with invalid data");n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=" in field ".concat(r)),a&&(l+=" in document ".concat(i)),l+=")"),new on(an.INVALID_ARGUMENT,o+e+l)}function Hc(e,t){return e.some(e=>e.isEqual(t))}class Gc{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new cc(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Wc(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Kc("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Wc extends Gc{data(){return super.data()}}function Kc(e,t){return"string"==typeof t?Bc(e,t):t instanceof xc?t._internalPath:t._delegate._internalPath}function Yc(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new on(an.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Qc{}class Jc extends Qc{}function Xc(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof Qc&&n.push(t),n=n.concat(i),function(e){const t=e.filter(e=>e instanceof Zc).length,n=e.filter(e=>e instanceof $c).length;if(t>1||t>0&&n>0)throw new on(an.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)e=a._apply(e);return e}class $c extends Jc{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new $c(e,t,n)}_apply(e){const t=this._parse(e);return su(e._query,t),new lc(e.firestore,e.converter,mi(e._query,t))}_parse(e){const t=kc(e.firestore),n=function(e,t,n,r,i,s,a){let o;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new on(an.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){iu(a,s);const t=[];for(const n of a)t.push(ru(r,e,n));o={arrayValue:{values:t}}}else o=ru(r,e,a)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||iu(a,s),o=Mc(n,t,a,"in"===s||"not-in"===s);return Ur.create(i,s,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class Zc extends Qc{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Zc(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:Vr.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)su(n,i),n=mi(n,i)}(e._query,t),new lc(e.firestore,e.converter,mi(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class eu extends Jc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new eu(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new on(an.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new on(an.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Dr(t,n)}(e._query,this._field,this._direction);return new lc(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new oi(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function tu(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=Kc("orderBy",e);return eu._create(n,t)}class nu extends Jc{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new nu(e,t,n)}_apply(e){return new lc(e.firestore,e.converter,gi(e._query,this._limit,this._limitType))}}function ru(e,t,n){if("string"==typeof(n=ie(n))){if(""===n)throw new on(an.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!di(t)&&-1!==n.indexOf("/"))throw new on(an.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(En.fromString(n));if(!_n.isDocumentKey(r))throw new on(an.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Ir(e,new _n(r))}if(n instanceof cc)return Ir(e,n._key);throw new on(an.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(nc(n),"."))}function iu(e,t){if(!Array.isArray(e)||0===e.length)throw new on(an.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function su(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new on(an.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new on(an.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class au{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(fr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ar(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(or(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw nn()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return Yn(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map(e=>ar(e.doubleValue));return new Ic(i)}convertGeoPoint(e){return new wc(ar(e.latitude),ar(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=cr(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(ur(e));default:return null}}convertTimestamp(e){const t=sr(e);return new wn(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=En.fromString(e);rn(ya(n));const r=new hr(n.get(1),n.get(3)),i=new _n(n.popFirst(5));return r.isEqual(t)||Zt("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}function ou(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class lu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class cu extends Gc{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new uu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Kc("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class uu extends cu{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class du{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new lu(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new uu(this._firestore,this._userDataWriter,n.key,n,new lu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new on(an.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new uu(e._firestore,e._userDataWriter,n.doc.key,n.doc,new lu(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new uu(e._firestore,e._userDataWriter,t.doc.key,t.doc,new lu(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:hu(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function hu(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return nn()}}class pu extends au{constructor(e){super(),this.firestore=e}convertBytes(e){return new vc(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new cc(this.firestore,null,t)}}function fu(e){e=rc(e,lc);const t=rc(e.firestore,mc),n=gc(t),r=new pu(t);return Yc(e._query),Jl(n,e._query).then(n=>new du(t,r,e,n))}function mu(e,t){const n=rc(e.firestore,mc),r=hc(e),i=ou(e.converter,t);return gu(n,[Ac(kc(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,ts.exists(!1))]).then(()=>r)}function gu(e,t){return function(e,t){const n=new ln;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=ql(e);try{const e=await function(e,t){const n=sn(e),r=wn.now(),i=t.reduce((e,t)=>e.add(t.key),Mi());let s,a;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=Ci(),l=Mi();return n.cs.getEntries(e,i).next(e=>{o=e,o.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,o)).next(i=>{s=i;const a=[];for(const e of t){const t=os(e,s.get(e.key).overlayedDocument);null!=t&&a.push(new us(e.key,t,jr(t.value.mapValue),ts.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,a,t)}).next(t=>{a=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:a.batchId,changes:ki(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ba[e.currentUser.toKey()];r||(r=new Jn(xn)),r=r.insert(t,n),e.Ba[e.currentUser.toKey()]=r}(r,e.batchId,n),await Ml(r,e.changes),await Lo(r.remoteStore)}catch(e){const t=Jo(e,"Failed to persist write");n.reject(t)}}(await Yl(e),t,n)),n.promise}(gc(e),t)}function yu(e,t,n){const r=n.docs.get(t._key),i=new pu(e);return new cu(e,i,t._key,r,new lu(n.hasPendingWrites,n.fromCache),t.converter)}function vu(){return new jc("serverTimestamp")}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Qt=e}(xt),ft(new se("firestore",(e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),a=new mc(new hn(e.getProvider("auth-internal")),new gn(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new on(an.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hr(e.options.projectId,t)}(s,r),s);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),It(Kt,"4.7.3",e),It(Kt,"4.7.3","esm2017")}();function xu(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function bu(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const wu=bu,Iu=new Q("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Nu=new me("@firebase/auth");function Eu(e){if(Nu.logLevel<=ue.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Nu.error("Auth (".concat(xt,"): ").concat(e),...n)}}function Su(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw ku(e,...n)}function Cu(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return ku(e,...n)}function _u(e,t,n){const r=Object.assign(Object.assign({},wu()),{[t]:n});return new Q("auth","Firebase",r).create(t,{appName:e.name})}function Tu(e){return _u(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ku(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return Iu.create(e,...n)}function Au(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw ku(t,...r)}}function Ru(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Eu(t),new Error(t)}function ju(e,t){e||Ru(t)}function Pu(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Ou(){return"http:"===Mu()||"https:"===Mu()}function Mu(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function Lu(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Ou()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class Du{constructor(e,t){this.shortDelay=e,this.longDelay=t,ju(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(G())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return Lu()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Fu(e,t){ju(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class qu{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void Ru("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void Ru("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void Ru("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Uu={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Vu=new Du(3e4,6e4);function Bu(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function zu(e,t,n,r){return Hu(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const a=Z(Object.assign({key:e.config.apiKey},s)).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:o},i);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),qu.fetch()(Wu(e,e.config.apiHost,n,a),l)})}async function Hu(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Uu),t);try{const t=new Yu(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw Qu(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,a]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Qu(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Qu(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw Qu(e,"user-disabled",s);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(a)throw _u(e,o,a);Su(e,o)}}catch(i){if(i instanceof Y)throw i;Su(e,"network-request-failed",{message:String(i)})}}async function Gu(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await zu(e,t,n,r,i);return"mfaPendingCredential"in s&&Su(e,"multi-factor-auth-required",{_serverResponse:s}),s}function Wu(e,t,n,r){const i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?Fu(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}function Ku(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Yu{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(Cu(this.auth,"network-request-failed")),Vu.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Qu(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Cu(e,t,r);return i.customData._tokenResponse=n,i}function Ju(e){return void 0!==e&&void 0!==e.enterprise}class Xu{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Ku(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function $u(e,t){return zu(e,"GET","/v2/recaptchaConfig",Bu(e,t))}async function Zu(e,t){return zu(e,"POST","/v1/accounts:lookup",t)}function ed(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function td(e){return 1e3*Number(e)}function nd(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Eu("JWT malformed, contained fewer than 3 sections"),null;try{const e=F(n);return e?JSON.parse(e):(Eu("Failed to decode base64 JWT payload"),null)}catch(i){return Eu("Caught error parsing JWT payload as JSON",null===i||void 0===i?void 0:i.toString()),null}}function rd(e){const t=nd(e);return Au(t,"internal-error"),Au("undefined"!==typeof t.exp,"internal-error"),Au("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function id(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof Y&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class sd{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void((null===e||void 0===e?void 0:e.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class ad{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ed(this.lastLoginAt),this.creationTime=ed(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function od(e){var t;const n=e.auth,r=await e.getIdToken(),i=await id(e,Zu(n,{idToken:r}));Au(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const a=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?ld(s.providerUserInfo):[],o=(l=e.providerData,c=a,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const u=e.isAnonymous,d=!(e.email&&s.passwordHash)&&!(null===o||void 0===o?void 0:o.length),h=!!u&&d,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new ad(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(e,p)}function ld(e){return e.map(e=>{var{providerId:t}=e,n=xu(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class cd{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Au(e.idToken,"internal-error"),Au("undefined"!==typeof e.idToken,"internal-error"),Au("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):rd(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Au(0!==e.length,"internal-error");const t=rd(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(Au(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await Hu(e,{},async()=>{const n=Z({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=Wu(e,r,"/v1/token","key=".concat(i)),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",qu.fetch()(s,{method:"POST",headers:a,body:n})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new cd;return n&&(Au("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(Au("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(Au("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new cd,this.toJSON())}_performRefresh(){return Ru("not implemented")}}function ud(e,t){Au("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class dd{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=xu(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new sd(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new ad(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await id(this,this.stsTokenManager.getToken(this.auth,e));return Au(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=ie(e),r=await n.getIdToken(t),i=nd(r);Au(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"===typeof i.firebase?i.firebase:void 0,a=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:ed(td(i.auth_time)),issuedAtTime:ed(td(i.iat)),expirationTime:ed(td(i.exp)),signInProvider:a||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=ie(e);await od(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Au(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new dd(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Au(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await od(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(gt(this.auth.app))return Promise.reject(Tu(this.auth));const e=await this.getIdToken();return await id(this,async function(e,t){return zu(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,a,o,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,p=null!==(s=t.photoURL)&&void 0!==s?s:void 0,f=null!==(a=t.tenantId)&&void 0!==a?a:void 0,m=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,y=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:x,isAnonymous:b,providerData:w,stsTokenManager:I}=t;Au(v&&I,e,"internal-error");const N=cd.fromJSON(this.name,I);Au("string"===typeof v,e,"internal-error"),ud(u,e.name),ud(d,e.name),Au("boolean"===typeof x,e,"internal-error"),Au("boolean"===typeof b,e,"internal-error"),ud(h,e.name),ud(p,e.name),ud(f,e.name),ud(m,e.name),ud(g,e.name),ud(y,e.name);const E=new dd({uid:v,auth:e,email:d,emailVerified:x,displayName:u,isAnonymous:b,photoURL:p,phoneNumber:h,tenantId:f,stsTokenManager:N,createdAt:g,lastLoginAt:y});return w&&Array.isArray(w)&&(E.providerData=w.map(e=>Object.assign({},e))),m&&(E._redirectEventId=m),E}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new cd;r.updateFromServerResponse(t);const i=new dd({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await od(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Au(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?ld(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length),a=new cd;a.updateFromIdToken(n);const o=new dd({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:s}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new ad(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length)};return Object.assign(o,l),o}}const hd=new Map;function pd(e){ju(e instanceof Function,"Expected a class definition");let t=hd.get(e);return t?(ju(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,hd.set(e,t),t)}class fd{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}fd.type="NONE";const md=fd;function gd(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class yd{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=gd(this.userKey,r.apiKey,i),this.fullPersistenceKey=gd("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?dd._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new yd(pd(md),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=r[0]||pd(md);const s=gd(n,e.config.apiKey,e.name);let a=null;for(const c of t)try{const t=await c._get(s);if(t){const n=dd._fromJSON(e,t);c!==i&&(a=n),i=c;break}}catch(l){}const o=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&o.length?(i=o[0],a&&await i._set(s,a.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch(l){}})),new yd(i,e,n)):new yd(i,e,n)}}function vd(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Id(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(xd(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Ed(t))return"Blackberry";if(Sd(t))return"Webos";if(bd(t))return"Safari";if((t.includes("chrome/")||wd(t))&&!t.includes("edge/"))return"Chrome";if(Nd(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function xd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G();return/firefox\//i.test(e)}function bd(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:G()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function wd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G();return/crios\//i.test(e)}function Id(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G();return/iemobile/i.test(e)}function Nd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G();return/android/i.test(e)}function Ed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G();return/blackberry/i.test(e)}function Sd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G();return/webos/i.test(e)}function Cd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function _d(){return function(){const e=G();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Td(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G();return Cd(e)||Nd(e)||Sd(e)||Ed(e)||/windows phone/i.test(e)||Id(e)}function kd(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=vd(G());break;case"Worker":t="".concat(vd(G()),"-").concat(e);break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(xt,"/").concat(r)}class Ad{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(i){r(i)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class Rd{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,a;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(r=o.containsLowercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(i=o.containsUppercaseLetter)||void 0===i||i),o.isValid&&(o.isValid=null===(s=o.containsNumericCharacter)||void 0===s||s),o.isValid&&(o.isValid=null===(a=o.containsNonAlphanumericCharacter)||void 0===a||a),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class jd{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Od(this),this.idTokenSubscription=new Od(this),this.beforeStateQueue=new Ad(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Iu,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=pd(t)),this._initializationPromise=this.queue(async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await yd.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(i){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Zu(this,{idToken:e}),n=await dd._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(gt(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null===r||void 0===r?void 0:r._redirectEventId,a=await this.tryRedirectSignIn(e);n&&n!==s||!(null===a||void 0===a?void 0:a.user)||(r=a.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Au(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await od(e)}catch(t){if((null===t||void 0===t?void 0:t.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(gt(this.app))return Promise.reject(Tu(this));const t=e?ie(e):null;return t&&Au(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Au(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return gt(this.app)?Promise.reject(Tu(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return gt(this.app)?Promise.reject(Tu(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(pd(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return zu(e,"GET","/v2/passwordPolicy",Bu(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Rd(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Q("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return zu(e,"POST","/v2/accounts:revokeToken",Bu(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&pd(e)||this._popupRedirectResolver;Au(t,this,"argument-error"),this.redirectPersistenceManager=await yd.create(this,[pd(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let s=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Au(a,this,"internal-error"),a.then(()=>{s||i(this.currentUser)}),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Au(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=kd(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(Nu.logLevel<=ue.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Nu.warn("Auth (".concat(xt,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function Pd(e){return ie(e)}class Od{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new ne(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return Au(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Md={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ld(e){return Md.loadJS(e)}function Dd(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class Fd{constructor(e){this.type="recaptcha-enterprise",this.auth=Pd(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;Ju(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n("NO_RECAPTCHA")})}):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{$u(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new Xu(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(i=>{if(!t&&Ju(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Md.recaptchaEnterpriseScript;0!==t.length&&(t+=i),Ld(t).then(()=>{n(i,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function qd(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new Fd(e);let s;try{s=await i.verify(n)}catch(o){s=await i.verify(n,!0)}const a=Object.assign({},t);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Ud(e,t,n,r){var i;if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await qd(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch(async i=>{if(i.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const i=await qd(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)})}function Vd(e,t,n){const r=Pd(e);Au(r._canInitEmulator,r,"emulator-config-failed"),Au(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),s=Bd(t),{host:a,port:o}=function(e){const t=Bd(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:zd(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:zd(t)}}}(t),l=null===o?"":":".concat(o);r.config.emulator={url:"".concat(s,"//").concat(a).concat(l,"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Bd(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function zd(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Hd{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ru("not implemented")}_getIdTokenResponse(e){return Ru("not implemented")}_linkToIdToken(e,t){return Ru("not implemented")}_getReauthenticationResolver(e){return Ru("not implemented")}}async function Gd(e,t){return zu(e,"POST","/v1/accounts:signUp",t)}async function Wd(e,t){return Gu(e,"POST","/v1/accounts:signInWithPassword",Bu(e,t))}class Kd extends Hd{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Kd(e,t,"password")}static _fromEmailAndCode(e,t){return new Kd(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Ud(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Wd);case"emailLink":return async function(e,t){return Gu(e,"POST","/v1/accounts:signInWithEmailLink",Bu(e,t))}(e,{email:this._email,oobCode:this._password});default:Su(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Ud(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Gd);case"emailLink":return async function(e,t){return Gu(e,"POST","/v1/accounts:signInWithEmailLink",Bu(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Su(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Yd(e,t){return Gu(e,"POST","/v1/accounts:signInWithIdp",Bu(e,t))}class Qd extends Hd{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Qd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Su("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=xu(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new Qd(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Yd(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Yd(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Yd(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Z(t)}return e}}const Jd={USER_NOT_FOUND:"user-not-found"};class Xd extends Hd{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Xd({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Xd({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Gu(e,"POST","/v1/accounts:signInWithPhoneNumber",Bu(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Gu(e,"POST","/v1/accounts:signInWithPhoneNumber",Bu(e,t));if(n.temporaryProof)throw Qu(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Gu(e,"POST","/v1/accounts:signInWithPhoneNumber",Bu(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Jd)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Xd({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class $d{constructor(e){var t,n,r,i,s,a;const o=ee(te(e)),l=null!==(t=o.apiKey)&&void 0!==t?t:null,c=null!==(n=o.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=o.mode)&&void 0!==r?r:null);Au(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(i=o.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=o.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(a=o.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function(e){const t=ee(te(e)).link,n=t?ee(te(t)).deep_link_id:null,r=ee(te(e)).deep_link_id;return(r?ee(te(r)).link:null)||r||n||t||e}(e);try{return new $d(t)}catch(n){return null}}}class Zd{constructor(){this.providerId=Zd.PROVIDER_ID}static credential(e,t){return Kd._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=$d.parseLink(t);return Au(n,"argument-error"),Kd._fromEmailAndCode(e,n.code,n.tenantId)}}Zd.PROVIDER_ID="password",Zd.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Zd.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class eh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class th extends eh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class nh extends th{constructor(){super("facebook.com")}static credential(e){return Qd._fromParams({providerId:nh.PROVIDER_ID,signInMethod:nh.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return nh.credentialFromTaggedObject(e)}static credentialFromError(e){return nh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return nh.credential(t.oauthAccessToken)}catch(n){return null}}}nh.FACEBOOK_SIGN_IN_METHOD="facebook.com",nh.PROVIDER_ID="facebook.com";class rh extends th{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Qd._fromParams({providerId:rh.PROVIDER_ID,signInMethod:rh.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return rh.credentialFromTaggedObject(e)}static credentialFromError(e){return rh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return rh.credential(n,r)}catch(i){return null}}}rh.GOOGLE_SIGN_IN_METHOD="google.com",rh.PROVIDER_ID="google.com";class ih extends th{constructor(){super("github.com")}static credential(e){return Qd._fromParams({providerId:ih.PROVIDER_ID,signInMethod:ih.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ih.credentialFromTaggedObject(e)}static credentialFromError(e){return ih.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return ih.credential(t.oauthAccessToken)}catch(n){return null}}}ih.GITHUB_SIGN_IN_METHOD="github.com",ih.PROVIDER_ID="github.com";class sh extends th{constructor(){super("twitter.com")}static credential(e,t){return Qd._fromParams({providerId:sh.PROVIDER_ID,signInMethod:sh.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return sh.credentialFromTaggedObject(e)}static credentialFromError(e){return sh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return sh.credential(n,r)}catch(i){return null}}}async function ah(e,t){return Gu(e,"POST","/v1/accounts:signUp",Bu(e,t))}sh.TWITTER_SIGN_IN_METHOD="twitter.com",sh.PROVIDER_ID="twitter.com";class oh{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await dd._fromIdTokenResponse(e,n,r),s=lh(n);return new oh({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=lh(n);return new oh({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function lh(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class ch extends Y{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,ch.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new ch(e,t,n,r)}}function uh(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw ch._fromErrorAndOperation(e,n,t,r);throw n})}async function dh(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await id(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return oh._forOperation(e,"link",r)}async function hh(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(gt(r.app))return Promise.reject(Tu(r));const i="reauthenticate";try{const s=await id(e,uh(r,i,t,e),n);Au(s.idToken,r,"internal-error");const a=nd(s.idToken);Au(a,r,"internal-error");const{sub:o}=a;return Au(e.uid===o,r,"user-mismatch"),oh._forOperation(e,i,s)}catch(s){throw(null===s||void 0===s?void 0:s.code)==="auth/".concat("user-not-found")&&Su(r,"user-mismatch"),s}}async function ph(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(gt(e.app))return Promise.reject(Tu(e));const r="signIn",i=await uh(e,r,t),s=await oh._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function fh(e,t){if(gt(e.app))return Promise.reject(Tu(e));const n=Pd(e),r=await async function(e,t){return Gu(e,"POST","/v1/accounts:signInWithCustomToken",Bu(e,t))}(n,{token:t,returnSecureToken:!0}),i=await oh._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}new WeakMap;const mh="__sak";class gh{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(mh,"1"),this.storage.removeItem(mh),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class yh extends gh{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Td(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);_d()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}yh.type="LOCAL";const vh=yh;class xh extends gh{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}xh.type="SESSION";const bh=xh;class wh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new wh(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const a=Array.from(s).map(async e=>e(t.origin,i)),o=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(a);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Ih(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}wh.receivers=[];class Nh{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise((a,o)=>{const l=Ih("",20);r.port1.start();const c=setTimeout(()=>{o(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout(()=>{o(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(t.data.response);break;default:clearTimeout(c),clearTimeout(i),o(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Eh(){return window}function Sh(){return"undefined"!==typeof Eh().WorkerGlobalScope&&"function"===typeof Eh().importScripts}const Ch="firebaseLocalStorageDb",_h="firebaseLocalStorage",Th="fbase_key";class kh{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Ah(e,t){return e.transaction([_h],t?"readwrite":"readonly").objectStore(_h)}function Rh(){const e=indexedDB.open(Ch,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(_h,{keyPath:Th})}catch(r){n(r)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(_h)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Ch);return new kh(e).toPromise()}(),t(await Rh()))})})}async function jh(e,t,n){const r=Ah(e,!0).put({[Th]:t,value:n});return new kh(r).toPromise()}function Ph(e,t){const n=Ah(e,!0).delete(t);return new kh(n).toPromise()}class Oh{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Rh()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Sh()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=wh._getInstance(Sh()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Nh(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Rh();return await jh(e,mh,"1"),await Ph(e,mh),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>jh(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Ah(e,!1).get(t),r=await new kh(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Ph(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Ah(e,!1).getAll();return new kh(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Oh.type="LOCAL";const Mh=Oh;Dd("rcb"),new Du(3e4,6e4);const Lh="recaptcha";async function Dh(e,t,n){var r;const i=await n.verify();try{let s;if(Au("string"===typeof i,e,"argument-error"),Au(n.type===Lh,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){Au("enroll"===t.type,e,"internal-error");const n=await function(e,t){return zu(e,"POST","/v2/accounts/mfaEnrollment:start",Bu(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{Au("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;Au(n,e,"missing-multi-factor-info");const a=await function(e,t){return zu(e,"POST","/v2/accounts/mfaSignIn:start",Bu(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return a.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return zu(e,"POST","/v1/accounts:sendVerificationCode",Bu(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class Fh{constructor(e){this.providerId=Fh.PROVIDER_ID,this.auth=Pd(e)}verifyPhoneNumber(e,t){return Dh(this.auth,e,ie(t))}static credential(e,t){return Xd._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Fh.credentialFromTaggedObject(t)}static credentialFromError(e){return Fh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Xd._fromTokenResponse(n,r):null}}function qh(e,t){return t?pd(t):(Au(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Fh.PROVIDER_ID="phone",Fh.PHONE_SIGN_IN_METHOD="phone";class Uh extends Hd{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Yd(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Yd(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Yd(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Vh(e){return ph(e.auth,new Uh(e),e.bypassAuthState)}function Bh(e){const{auth:t,user:n}=e;return Au(n,t,"internal-error"),hh(n,new Uh(e),e.bypassAuthState)}async function zh(e){const{auth:t,user:n}=e;return Au(n,t,"internal-error"),dh(n,new Uh(e),e.bypassAuthState)}class Hh{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:a}=e;if(s)return void this.reject(s);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Vh;case"linkViaPopup":case"linkViaRedirect":return zh;case"reauthViaPopup":case"reauthViaRedirect":return Bh;default:Su(this.auth,"internal-error")}}resolve(e){ju(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ju(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Gh=new Du(2e3,1e4);class Wh extends Hh{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Wh.currentPopupAction&&Wh.currentPopupAction.cancel(),Wh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Au(e,this.auth,"internal-error"),e}async onExecution(){ju(1===this.filter.length,"Popup operations only handle one event");const e=Ih();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Cu(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Cu(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Wh.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Cu(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Gh.get())};e()}}Wh.currentPopupAction=null;const Kh=new Map;class Yh extends Hh{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Kh.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Xh(t),r=Jh(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Kh.set(this.auth._key(),e)}return this.bypassAuthState||Kh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Qh(e,t){Kh.set(e._key(),t)}function Jh(e){return pd(e._redirectPersistence)}function Xh(e){return gd("pendingRedirect",e.config.apiKey,e.name)}async function $h(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(gt(e.app))return Promise.reject(Tu(e));const r=Pd(e),i=qh(r,t),s=new Yh(r,i,n),a=await s.execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,t)),a}class Zh{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return tp(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!tp(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Cu(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(ep(e))}saveEventToCache(e){this.cachedEventUids.add(ep(e)),this.lastProcessedEventTime=Date.now()}}function ep(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function tp(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const np=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rp=/^https?/;async function ip(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return zu(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(sp(r))return}catch(n){}Su(e,"unauthorized-domain")}function sp(e){const t=Pu(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!rp.test(n))return!1;if(np.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const ap=new Du(3e4,6e4);function op(){const e=Eh().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function lp(e){return new Promise((t,n)=>{var r,i,s;function a(){op(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{op(),n(Cu(e,"network-request-failed"))},timeout:ap.get()})}if(null===(i=null===(r=Eh().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Eh().gapi)||void 0===s?void 0:s.load)){const t=Dd("iframefcb");return Eh()[t]=()=>{gapi.load?a():n(Cu(e,"network-request-failed"))},Ld("".concat(Md.gapiScript,"?onload=").concat(t)).catch(e=>n(e))}a()}}).catch(e=>{throw cp=null,e})}let cp=null;const up=new Du(5e3,15e3),dp={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},hp=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function pp(e){const t=e.config;Au(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Fu(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:xt},i=hp.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),"".concat(n,"?").concat(Z(r).slice(1))}async function fp(e){const t=await function(e){return cp=cp||lp(e),cp}(e),n=Eh().gapi;return Au(n,e,"internal-error"),t.open({where:document.body,url:pp(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:dp,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=Cu(e,"network-request-failed"),s=Eh().setTimeout(()=>{r(i)},up.get());function a(){Eh().clearTimeout(s),n(t)}t.ping(a).then(a,()=>{r(i)})}))}const mp={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class gp{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function yp(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l=Object.assign(Object.assign({},mp),{width:r.toString(),height:i.toString(),top:s,left:a}),c=G().toLowerCase();n&&(o=wd(c)?"_blank":n),xd(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")},"");if(function(){var e;return Cd(arguments.length>0&&void 0!==arguments[0]?arguments[0]:G())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",o),new gp(null);const d=window.open(t||"",o,u);Au(d,e,"popup-blocked");try{d.focus()}catch(h){}return new gp(d)}const vp="__/auth/handler",xp="emulator/auth/handler",bp=encodeURIComponent("fac");async function wp(e,t,n,r,i,s){Au(e.config.authDomain,e,"auth-domain-config-required"),Au(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:xt,eventId:i};if(t instanceof eh){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))a[e]=t}if(t instanceof th){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(a.scopes=e.join(","))}e.tenantId&&(a.tid=e.tenantId);const o=a;for(const u of Object.keys(o))void 0===o[u]&&delete o[u];const l=await e._getAppCheckToken(),c=l?"#".concat(bp,"=").concat(encodeURIComponent(l)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(vp);return Fu(t,xp)}(e),"?").concat(Z(o).slice(1)).concat(c)}const Ip="webStorageSupport";const Np=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=bh,this._completeRedirectFn=$h,this._overrideRedirectResult=Qh}async _openPopup(e,t,n,r){var i;ju(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return yp(e,await wp(e,t,n,Pu(),r),Ih())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Eh().location.href=e}(await wp(e,t,n,Pu(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(ju(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await fp(e),n=new Zh(e);return t.register("authEvent",t=>{Au(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ip,{type:Ip},n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[Ip];void 0!==i&&t(!!i),Su(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ip(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Td()||bd()||Cd()}};var Ep="@firebase/auth",Sp="1.7.9";class Cp{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Au(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const _p=z("authIdTokenMaxAge")||300;let Tp=null;var kp;Md={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=Cu("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},kp="Browser",ft(new se("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;Au(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:kp,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:kd(kp)},c=new jd(r,i,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(pd);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),ft(new se("auth-internal",e=>(e=>new Cp(e))(Pd(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),It(Ep,Sp,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(kp)),It(Ep,Sp,"esm2017");It("firebase","10.14.1","app");let Ap={apiKey:"AIzaSyCUDuHefWAoVrG6Gf4mDVaxnKuZzkdtBAw",authDomain:"term3-rn.firebaseapp.com",projectId:"term3-rn",storageBucket:"term3-rn.firebasestorage.app",messagingSenderId:"494666669692",appId:"1:494666669692:web:67b5a9b3ad9dd65b7a33f9",measurementId:"G-B13V3P1WEH"};if("undefined"!==typeof window&&window.__firebase_config)try{Ap=JSON.parse(window.__firebase_config),console.log("Using injected Firebase config")}catch(rm){console.warn("Failed to parse window.__firebase_config, using default")}const Rp=bt(Ap),jp=function(e,t){const n="string"==typeof e?e:t||"(default)",r=mt("object"==typeof e?e:wt(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=(e=>{const t=V(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&oc(r,...e)}return r}(Rp),Pp=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt();const t=mt(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=mt(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(X(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;Su(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Np,persistence:[Mh,vh,bh]}),r=z("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>_p)return;const r=null===t||void 0===t?void 0:t.token;Tp!==r&&(Tp=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:"Bearer ".concat(r)}:{}}))});!function(e,t,n){ie(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){ie(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}var i;const s=V("auth");return s&&Vd(n,"http://".concat(s)),n}(Rp),Op={id:"string",text:"string",options:"array",correctIndex:"number",rationale:"string"},Mp={id:"string",title:"string",prompt:"string",stem:"string",choices:"array",correctIndex:"number|array",rationaleCorrect:"string",rationaleWrong:"array",difficulty:"number",timerSeconds:"number"},Lp={id:"string",text:"string",scenario:"string",options:"array",correctIndex:"number|array",timeLimit:"number",rationale:"string",skill:"array",bloom:"string",difficulty:"number"};function Dp(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"standard";switch(n.toLowerCase()){case"challenge":t=Mp;break;case"clinical":case"clinical-judgment":t=Lp;break;default:t=Op}const r={totalQuestions:e.length,valid:0,invalid:0,questionResults:[]};return e.forEach((e,n)=>{const i=function(e,t){const n=[],r=[];for(const[s,a]of Object.entries(t)){if(!(s in e)){n.push("Missing required field: ".concat(s));continue}const t=e[s],r=a.split("|");let i=!1;for(const e of r){if("array"===e&&Array.isArray(t)){i=!0;break}if("number"===e&&"number"===typeof t){i=!0;break}if("string"===e&&"string"===typeof t){i=!0;break}}i||n.push("Field ".concat(s," has wrong type. Expected: ").concat(a,", got: ").concat(typeof t))}const i=e.options||e.choices;if(i&&Array.isArray(i)&&(i.length<2&&n.push("Must have at least 2 answer choices"),i.some(e=>!e||"string"===typeof e&&""===e.trim())&&n.push("All answer choices must have content")),"correctIndex"in e){const t=e.correctIndex,r=i?i.length:0;Array.isArray(t)?(0===t.length&&n.push("SATA question must have at least one correct answer"),t.forEach(e=>{(e<0||e>=r)&&n.push("correctIndex ".concat(e," out of range (0-").concat(r-1,")"))})):"number"===typeof t&&(t<0||t>=r)&&n.push("correctIndex ".concat(t," out of range (0-").concat(r-1,")"))}return e.rationale||e.rationaleCorrect||r.push("No rationale provided - students won't learn from mistakes"),{valid:0===n.length,errors:n,warnings:r}}(e,t);i.valid?r.valid++:r.invalid++,r.questionResults.push((0,s.A)({questionId:e.id||"Question ".concat(n+1),index:n},i))}),r}function Fp(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log("\ud83d\udccb QUESTION VALIDATION RESULTS"),console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550"),console.log("Total Questions: ".concat(e.totalQuestions)),console.log("\u2705 Valid: ".concat(e.valid)),console.log("\u274c Invalid: ".concat(e.invalid)),console.log("\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n"),(e.invalid>0||t)&&e.questionResults.forEach(e=>{e.valid&&!t||(console.log("\n\ud83d\udd0d ".concat(e.questionId," (Index: ").concat(e.index,")")),e.errors.length>0&&(console.log("  \u274c Errors:"),e.errors.forEach(e=>console.log("     - ".concat(e)))),e.warnings.length>0&&(console.log("  \u26a0\ufe0f  Warnings:"),e.warnings.forEach(e=>console.log("     - ".concat(e)))))}),0===e.invalid&&console.log("\u2728 All questions passed validation!\n")}const qp=new class{constructor(){this._chapters=null,this._questionCache=new Map,this._initialized=!1}async initialize(){if(this._initialized)console.warn("QuestionLoader already initialized");else try{const e="/Term-3-Gaming",t=await fetch("".concat(e,"/data/chapters.json"));if(!t.ok)throw new Error("Failed to load chapters: ".concat(t.statusText));this._chapters=await t.json(),console.log("\ud83d\udcda Loaded ".concat(this._chapters.length," chapters")),await this._loadAllQuestions(),this._initialized=!0,console.log("\u2705 QuestionLoader initialized successfully")}catch(e){throw console.error("\u274c Failed to initialize QuestionLoader:",e),e}}async _loadAllQuestions(){const e="/Term-3-Gaming",t={ch18:"".concat(e,"/data/ch18-questions.json"),ch19:"".concat(e,"/data/ch19-questions.json"),ch20:"".concat(e,"/data/ch20-questions.json"),ch21:"".concat(e,"/data/ch21-questions.json"),ch22:"".concat(e,"/data/ch22-questions.json"),quiz1:"".concat(e,"/data/quiz1-questions.json"),challenge:"".concat(e,"/data/challenge-scenarios.json"),"clinical-judgment":"".concat(e,"/data/clinical-judgment-scenarios.json"),"day-to-be-wrong":"".concat(e,"/data/clinical-judgment-scenarios.json")};for(const[r,i]of Object.entries(t))try{const e=await fetch(i);if(!e.ok){console.warn("\u26a0\ufe0f  Could not load ".concat(i,": ").concat(e.statusText));continue}const t=await e.json(),n=Dp(t,r);n.invalid>0?(console.warn("\u26a0\ufe0f  ".concat(i," has ").concat(n.invalid," invalid questions")),Fp(n)):console.log("\u2705 ".concat(i,": ").concat(n.valid," valid questions")),this._questionCache.set(r,Object.freeze(t))}catch(n){console.error("\u274c Error loading ".concat(i,":"),n)}}getChapters(){return this._ensureInitialized(),JSON.parse(JSON.stringify(this._chapters))}getChapter(e){this._ensureInitialized();const t=this._chapters.find(t=>t.id===e);return t?JSON.parse(JSON.stringify(t)):null}getRawQuestions(e){this._ensureInitialized();const t=this._getCacheKey(e),n=this._questionCache.get(t);return n||(console.warn("No questions found for chapter: ".concat(e)),[])}getQuestionsForChapter(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._ensureInitialized();const n=this.getRawQuestions(e),r=JSON.parse(JSON.stringify(n));return t&&this._shuffleArray(r),r}getRandomQuestions(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this.getQuestionsForChapter(e,n);return r.slice(0,Math.min(t,r.length))}getQuestionCount(e){return this.getRawQuestions(e).length}validateAllQuestions(){this._ensureInitialized();const e={total:0,valid:0,invalid:0,byChapter:{}};for(const[t,n]of this._questionCache.entries()){const r=Dp(n,t);e.total+=r.totalQuestions,e.valid+=r.valid,e.invalid+=r.invalid,e.byChapter[t]=r,r.invalid>0&&(console.log("\n\ud83d\udce6 Validation for: ".concat(t)),Fp(r))}return e}_getCacheKey(e){return"day-to-be-wrong"===e?"clinical-judgment":e.startsWith("challenge")?"challenge":e}_shuffleArray(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}_ensureInitialized(){if(!this._initialized)throw new Error("QuestionLoader not initialized. Call initialize() first.")}getStats(){this._ensureInitialized();const e={chapters:this._chapters.length,questionBanks:this._questionCache.size,totalQuestions:0,questionsByBank:{}};for(const[t,n]of this._questionCache.entries()){const r=n.length;e.totalQuestions+=r,e.questionsByBank[t]=r}return e}},Up=qp;var Vp=n(579);const Bp={Shield:a.A,AlertCircle:o.A,Activity:u.A,Bug:c.A,Brain:d.A,Scale:N.A,Bone:u.A};function zp(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{return"challenge-mode"===e?Up.getQuestionsForChapter("challenge",t):"day-to-be-wrong"===e?Up.getQuestionsForChapter("clinical-judgment",t):Up.getQuestionsForChapter(e,t)}catch(n){return console.error("Error loading questions for ".concat(e,":"),n),[]}}function Hp(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(){try{return Up.getChapters().map(e=>({id:e.id,title:e.title,icon:Gp(e.iconName),description:e.description,questions:[]}))}catch(e){return console.error("Error loading chapters:",e),[]}}().map(t=>{const n=zp(t.id,e);return(0,s.A)((0,s.A)({},t),{},{questions:n})})}function Gp(e){const t=Bp[e]||d.A;return(0,Vp.jsx)(t,{className:"w-6 h-6"})}(async()=>{await async function(){try{await Up.initialize(),console.log("\u2705 Question system initialized"),console.log("\ud83d\udcca Stats:",Up.getStats());const e=Up.validateAllQuestions();return e.invalid>0&&console.warn("\u26a0\ufe0f  ".concat(e.invalid," invalid questions found")),!0}catch(e){return console.error("\u274c Failed to initialize questions:",e),!1}}(),Hp()})();const Wp=(0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)({},{ch18_q01:{concept:"FIRST_LINE_DEFENSE",skill:["DIFFERENTIATION","TEACHING_ERROR"],bloom:"APPLICATION"},ch18_q02:{concept:"IMMUNE_ORGANS",skill:["RECALL"],bloom:"KNOWLEDGE"},ch18_q03:{concept:"LEUKOCYTES",skill:["DIFFERENTIATION","RECALL"],bloom:"KNOWLEDGE"},ch18_q04:{concept:"LEUKOCYTOSIS",skill:["PRIORITY","CLINICAL_REASONING"],bloom:"APPLICATION"},ch18_q05:{concept:"IMMUNITY_TYPES",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch18_q06:{concept:"AGING_IMMUNE_SYSTEM",skill:["CLINICAL_REASONING"],bloom:"COMPREHENSION"},ch18_q07:{concept:"DIAGNOSTIC_TESTS",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch18_q08:{concept:"IMMUNE_ASSESSMENT",skill:["PRIORITY","CLINICAL_REASONING"],bloom:"APPLICATION"},ch18_q09:{concept:"IMMUNE_ORGANS",skill:["RECALL"],bloom:"KNOWLEDGE"},ch18_q10:{concept:"IMMUNOGLOBULINS",skill:["RECALL"],bloom:"KNOWLEDGE"},ch18_q11:{concept:"IMMUNE_ASSESSMENT",skill:["CLINICAL_REASONING","DIFFERENTIATION"],bloom:"APPLICATION"},ch18_q12:{concept:"DIAGNOSTIC_TESTS",skill:["LAB_INTERPRETATION","DIFFERENTIATION"],bloom:"COMPREHENSION"},ch18_q13:{concept:"IMMUNE_FUNCTION",skill:["RECALL","TEACHING"],bloom:"COMPREHENSION"},ch18_q14:{concept:"LEUKOCYTES",skill:["RECALL"],bloom:"KNOWLEDGE"},ch18_q15:{concept:"INFLAMMATION",skill:["RECALL"],bloom:"KNOWLEDGE"},ch18_q16:{concept:"IMMUNITY_TYPES",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch18_q17:{concept:"LEUKOCYTES",skill:["PRIORITY","RECALL"],bloom:"COMPREHENSION"},ch18_q18:{concept:"IMMUNE_FUNCTION",skill:["RECALL"],bloom:"KNOWLEDGE"},ch18_q19:{concept:"IMMUNITY_TYPES",skill:["RECALL"],bloom:"COMPREHENSION"},ch18_q20:{concept:"IMMUNE_ASSESSMENT",skill:["CLINICAL_REASONING","PRIORITY"],bloom:"APPLICATION"},ch18_q21:{concept:"DIAGNOSTIC_TESTS",skill:["LAB_INTERPRETATION","PRIORITY"],bloom:"APPLICATION"},ch18_q22:{concept:"LEUKOCYTES",skill:["RECALL"],bloom:"KNOWLEDGE"},ch18_q23:{concept:"DIAGNOSTIC_TESTS",skill:["LAB_INTERPRETATION","DIFFERENTIATION"],bloom:"COMPREHENSION"},ch18_q24:{concept:"IMMUNE_FUNCTION",skill:["RECALL","DIFFERENTIATION"],bloom:"KNOWLEDGE"},ch18_q25:{concept:"LEUKOCYTES",skill:["RECALL"],bloom:"KNOWLEDGE"}}),{ch19_q01:{concept:"HYPERSENSITIVITY",skill:["RECALL"],bloom:"KNOWLEDGE"},ch19_q02:{concept:"LATEX_ALLERGY",skill:["TEACHING","MED_SAFETY"],bloom:"COMPREHENSION"},ch19_q03:{concept:"ANAPHYLAXIS",skill:["PRIORITY","CLINICAL_REASONING"],bloom:"APPLICATION"},ch19_q04:{concept:"TYPE_II",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch19_q05:{concept:"TYPE_III",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch19_q06:{concept:"ANAPHYLAXIS",skill:["PRIORITY","MED_SAFETY"],bloom:"APPLICATION"},ch19_q07:{concept:"TYPE_IV",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch19_q08:{concept:"ANAPHYLAXIS",skill:["PRIORITY","MED_SAFETY"],bloom:"APPLICATION"},ch19_q09:{concept:"AUTOIMMUNITY",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch19_q10:{concept:"IMMUNODEFICIENCY",skill:["MED_SAFETY","TEACHING_ERROR"],bloom:"APPLICATION"},ch19_q11:{concept:"TYPE_III",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch19_q12:{concept:"HYPERSENSITIVITY",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch19_q13:{concept:"HYPERSENSITIVITY",skill:["TEACHING","MED_SAFETY"],bloom:"APPLICATION"},ch19_q14:{concept:"TRANSPLANT",skill:["RECALL"],bloom:"KNOWLEDGE"},ch19_q15:{concept:"TYPE_IV",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch19_q16:{concept:"HYPERSENSITIVITY",skill:["MED_SAFETY"],bloom:"COMPREHENSION"},ch19_q17:{concept:"TYPE_II",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch19_q18:{concept:"TYPE_IV",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch19_q19:{concept:"AUTOIMMUNITY",skill:["CLINICAL_REASONING"],bloom:"COMPREHENSION"},ch19_q20:{concept:"ANAPHYLAXIS",skill:["PRIORITY","MED_SAFETY"],bloom:"APPLICATION"},ch19_q21:{concept:"IMMUNOSUPPRESSION",skill:["MED_SAFETY","TEACHING"],bloom:"APPLICATION"},ch19_q22:{concept:"AUTOIMMUNITY",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch19_q23:{concept:"TRANSPLANT",skill:["RECALL"],bloom:"KNOWLEDGE"},ch19_q24:{concept:"HYPERSENSITIVITY",skill:["RECALL"],bloom:"KNOWLEDGE"},ch19_q25:{concept:"LATEX_ALLERGY",skill:["TEACHING","MED_SAFETY"],bloom:"APPLICATION"}}),{ch20_q01:{concept:"OSTEOARTHRITIS",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch20_q02:{concept:"LUPUS",skill:["TEACHING","MED_SAFETY"],bloom:"APPLICATION"},ch20_q03:{concept:"RHEUMATOID_ARTHRITIS",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch20_q04:{concept:"GOUT",skill:["MED_SAFETY","DIFFERENTIATION"],bloom:"APPLICATION"},ch20_q05:{concept:"SCLERODERMA",skill:["RECALL"],bloom:"KNOWLEDGE"},ch20_q06:{concept:"GOUT",skill:["TEACHING"],bloom:"APPLICATION"},ch20_q07:{concept:"ARTHRITIS_MANAGEMENT",skill:["MED_SAFETY"],bloom:"APPLICATION"},ch20_q08:{concept:"OSTEOARTHRITIS",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch20_q09:{concept:"FIBROMYALGIA",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch20_q10:{concept:"SJOGREN",skill:["RECALL"],bloom:"KNOWLEDGE"},ch20_q11:{concept:"LUPUS",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch20_q12:{concept:"SCLERODERMA",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch20_q13:{concept:"OSTEOARTHRITIS",skill:["TEACHING"],bloom:"APPLICATION"},ch20_q14:{concept:"RAYNAUDS",skill:["TEACHING","MED_SAFETY"],bloom:"APPLICATION"},ch20_q15:{concept:"ARTHRITIS_MANAGEMENT",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch20_q16:{concept:"RHEUMATOID_ARTHRITIS",skill:["MED_SAFETY"],bloom:"APPLICATION"},ch20_q17:{concept:"RHEUMATOID_ARTHRITIS",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch20_q18:{concept:"ARTHRITIS_MANAGEMENT",skill:["TEACHING","MED_SAFETY"],bloom:"APPLICATION"},ch20_q19:{concept:"GOUT",skill:["RECALL"],bloom:"KNOWLEDGE"},ch20_q20:{concept:"OSTEOARTHRITIS",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch20_q21:{concept:"GOUT",skill:["MED_SAFETY","TEACHING_ERROR"],bloom:"APPLICATION"},ch20_q22:{concept:"GOUT",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch20_q23:{concept:"OSTEOARTHRITIS",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch20_q24:{concept:"LUPUS",skill:["TEACHING","PRIORITY"],bloom:"APPLICATION"},ch20_q25:{concept:"RHEUMATOID_ARTHRITIS",skill:["MED_SAFETY"],bloom:"APPLICATION"}}),{ch21_q01:{concept:"TRANSMISSION",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch21_q02:{concept:"TRANSMISSION",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch21_q03:{concept:"TRANSMISSION",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch21_q04:{concept:"MRSA",skill:["INFECTION_CONTROL","RECALL"],bloom:"COMPREHENSION"},ch21_q05:{concept:"C_DIFF",skill:["PRIORITY","INFECTION_CONTROL"],bloom:"APPLICATION"},ch21_q06:{concept:"VRE",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch21_q07:{concept:"MDRO_RISK",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch21_q08:{concept:"ACINETOBACTER",skill:["RECALL"],bloom:"KNOWLEDGE"},ch21_q09:{concept:"ANTIBIOTIC_STEWARDSHIP",skill:["RECALL"],bloom:"COMPREHENSION"},ch21_q10:{concept:"PPE",skill:["SEQUENCING"],bloom:"APPLICATION"},ch21_q11:{concept:"PPE",skill:["SEQUENCING","INFECTION_CONTROL"],bloom:"APPLICATION"},ch21_q12:{concept:"CRE",skill:["RECALL","MED_SAFETY"],bloom:"COMPREHENSION"},ch21_q13:{concept:"ISOLATION",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch21_q14:{concept:"HAND_HYGIENE",skill:["PRIORITY"],bloom:"APPLICATION"},ch21_q15:{concept:"STANDARD_PRECAUTIONS",skill:["RECALL"],bloom:"COMPREHENSION"},ch21_q16:{concept:"TB",skill:["DIFFERENTIATION","INFECTION_CONTROL"],bloom:"APPLICATION"},ch21_q17:{concept:"PPE",skill:["SEQUENCING"],bloom:"APPLICATION"},ch21_q18:{concept:"DROPLET_PRECAUTIONS",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch21_q19:{concept:"ESBL",skill:["RECALL","MED_SAFETY"],bloom:"COMPREHENSION"},ch21_q20:{concept:"CONTACT_PRECAUTIONS",skill:["INFECTION_CONTROL"],bloom:"COMPREHENSION"},ch21_q21:{concept:"CRE",skill:["RECALL"],bloom:"KNOWLEDGE"},ch21_q22:{concept:"TB",skill:["INFECTION_CONTROL"],bloom:"APPLICATION"},ch21_q23:{concept:"EXPOSURE_PROTOCOL",skill:["PRIORITY","MED_SAFETY"],bloom:"APPLICATION"},ch21_q24:{concept:"ANTIBIOTIC_RESISTANCE",skill:["RECALL"],bloom:"COMPREHENSION"},ch21_q25:{concept:"PROTECTIVE_ENVIRONMENT",skill:["DIFFERENTIATION","CLINICAL_REASONING"],bloom:"APPLICATION"}}),{ch22_q01:{concept:"HIV_PROGRESSION",skill:["SEQUENCING"],bloom:"COMPREHENSION"},ch22_q02:{concept:"HIV_PROGRESSION",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch22_q03:{concept:"PREP",skill:["DIFFERENTIATION","TEACHING"],bloom:"COMPREHENSION"},ch22_q04:{concept:"AIDS_DIAGNOSIS",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch22_q05:{concept:"OPPORTUNISTIC_INFECTIONS",skill:["RECALL"],bloom:"KNOWLEDGE"},ch22_q06:{concept:"ANTIRETROVIRAL_THERAPY",skill:["TEACHING"],bloom:"COMPREHENSION"},ch22_q07:{concept:"OPPORTUNISTIC_INFECTIONS",skill:["CLINICAL_REASONING"],bloom:"COMPREHENSION"},ch22_q08:{concept:"PEP",skill:["PRIORITY","MED_SAFETY"],bloom:"APPLICATION"},ch22_q09:{concept:"VIRAL_LOAD",skill:["TEACHING"],bloom:"COMPREHENSION"},ch22_q10:{concept:"OPPORTUNISTIC_INFECTIONS",skill:["CLINICAL_REASONING"],bloom:"COMPREHENSION"},ch22_q11:{concept:"HIV_TESTING",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch22_q12:{concept:"ANTIRETROVIRAL_THERAPY",skill:["MED_SAFETY"],bloom:"COMPREHENSION"},ch22_q13:{concept:"HIV_TRANSMISSION",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch22_q14:{concept:"ADHERENCE",skill:["TEACHING","MED_SAFETY"],bloom:"APPLICATION"},ch22_q15:{concept:"OPPORTUNISTIC_INFECTIONS",skill:["PRIORITY","CLINICAL_REASONING"],bloom:"APPLICATION"},ch22_q16:{concept:"HIV_TESTING",skill:["TEACHING"],bloom:"COMPREHENSION"},ch22_q17:{concept:"ANTIRETROVIRAL_THERAPY",skill:["MED_SAFETY"],bloom:"COMPREHENSION"},ch22_q18:{concept:"PREP",skill:["TEACHING","DIFFERENTIATION"],bloom:"COMPREHENSION"},ch22_q19:{concept:"CD4_COUNT",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},ch22_q20:{concept:"OPPORTUNISTIC_INFECTIONS",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch22_q21:{concept:"ADHERENCE",skill:["TEACHING","MED_SAFETY"],bloom:"APPLICATION"},ch22_q22:{concept:"HIV_PROGRESSION",skill:["CLINICAL_REASONING"],bloom:"APPLICATION"},ch22_q23:{concept:"ANTIRETROVIRAL_THERAPY",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},ch22_q24:{concept:"ADHERENCE",skill:["TEACHING","MED_SAFETY"],bloom:"APPLICATION"},ch22_q25:{concept:"HIV_DISCLOSURE",skill:["TEACHING","RECALL"],bloom:"COMPREHENSION"}}),{quiz1_q01:{concept:"IMMUNOGLOBULINS",skill:["RECALL"],bloom:"KNOWLEDGE"},quiz1_q02:{concept:"TYPE_IV",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},quiz1_q03:{concept:"OSTEOARTHRITIS",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},quiz1_q04:{concept:"C_DIFF",skill:["PRIORITY","INFECTION_CONTROL"],bloom:"APPLICATION"},quiz1_q05:{concept:"AIDS_DIAGNOSIS",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},quiz1_q06:{concept:"LEUKOCYTES",skill:["RECALL"],bloom:"KNOWLEDGE"},quiz1_q07:{concept:"LUPUS",skill:["CLINICAL_REASONING"],bloom:"COMPREHENSION"},quiz1_q08:{concept:"ANAPHYLAXIS",skill:["PRIORITY","MED_SAFETY"],bloom:"APPLICATION"},quiz1_q09:{concept:"MRSA",skill:["INFECTION_CONTROL"],bloom:"COMPREHENSION"},quiz1_q10:{concept:"ANTIRETROVIRAL_THERAPY",skill:["TEACHING"],bloom:"COMPREHENSION"},quiz1_q11:{concept:"INFLAMMATION",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},quiz1_q12:{concept:"TYPE_III",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},quiz1_q13:{concept:"GOUT",skill:["MED_SAFETY","DIFFERENTIATION"],bloom:"APPLICATION"},quiz1_q14:{concept:"HAND_HYGIENE",skill:["PRIORITY"],bloom:"APPLICATION"},quiz1_q15:{concept:"OPPORTUNISTIC_INFECTIONS",skill:["CLINICAL_REASONING"],bloom:"COMPREHENSION"},quiz1_q16:{concept:"IMMUNOGLOBULINS",skill:["RECALL"],bloom:"KNOWLEDGE"},quiz1_q17:{concept:"HYPERSENSITIVITY",skill:["RECALL"],bloom:"KNOWLEDGE"},quiz1_q18:{concept:"LUPUS",skill:["LAB_INTERPRETATION"],bloom:"COMPREHENSION"},quiz1_q19:{concept:"STANDARD_PRECAUTIONS",skill:["RECALL"],bloom:"COMPREHENSION"},quiz1_q20:{concept:"VIRAL_LOAD",skill:["TEACHING"],bloom:"COMPREHENSION"},quiz1_q21:{concept:"IMMUNITY_TYPES",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"},quiz1_q22:{concept:"RHEUMATOID_ARTHRITIS",skill:["MED_SAFETY"],bloom:"APPLICATION"},quiz1_q23:{concept:"PPE",skill:["SEQUENCING"],bloom:"APPLICATION"},quiz1_q24:{concept:"PEP",skill:["PRIORITY","MED_SAFETY"],bloom:"APPLICATION"},quiz1_q25:{concept:"LEUKOCYTES",skill:["DIFFERENTIATION"],bloom:"COMPREHENSION"}});function Kp(e){return e.map(e=>{var t;const n=Wp[e.id]||{},r=(null===(t=e.id)||void 0===t?void 0:t.split("_")[0])||"unknown";return(0,s.A)((0,s.A)({},e),{},{chapter:r,concept:n.concept||null,skill:n.skill||[],bloom:n.bloom||null})})}var Yp=n(986);const Qp=(0,h.A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Jp=(0,h.A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);var Xp=n(118);const $p=(0,h.A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Zp=(0,h.A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),ef=(0,h.A)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),tf=(0,h.A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),nf=(0,h.A)("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),rf=(0,h.A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),sf=(0,h.A)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]),af=(0,h.A)("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),of=(0,h.A)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),lf=(0,h.A)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),cf=["id"],uf="instructor_customChapters",df="instructor_chapterLocks",hf="instructor_studentScores",pf="instructor_analytics",ff="activeSessions",mf="instructor_messages",gf=e=>{let{unlockedChapters:t,onToggleLock:n,loading:r}=e;const i=[{id:"ch18",title:"Chapter 18: Immune Assessment",icon:"\ud83d\udee1\ufe0f"},{id:"ch19",title:"Chapter 19: Immune Disorders",icon:"\ud83e\udda0"},{id:"ch20",title:"Chapter 20: Connective Tissue",icon:"\ud83e\uddb4"},{id:"ch21",title:"Chapter 21: MDROs",icon:"\ud83d\udd2c"},{id:"ch22",title:"Chapter 22: HIV/AIDS",icon:"\ud83e\uddec"},{id:"quiz1",title:"Quiz 1 Review",icon:"\ud83d\udccb"}];return(0,Vp.jsxs)("div",{children:[(0,Vp.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Vp.jsx)("p",{className:"text-gray-600",children:"Control which chapters students can access. Locked chapters will show a \ud83d\udd12 badge and cannot be clicked."}),(0,Vp.jsx)("button",{onClick:()=>{t.length===i.length?i.forEach(e=>{t.includes(e.id)&&n(e.id)}):i.forEach(e=>{t.includes(e.id)||n(e.id)})},disabled:r,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:t.length===i.length?"Lock All":"Unlock All"})]}),(0,Vp.jsx)("div",{className:"grid gap-3",children:i.map(e=>{const i=t.includes(e.id);return(0,Vp.jsxs)("div",{className:"flex items-center justify-between p-4 border-2 rounded-lg hover:border-purple-300 transition-colors",children:[(0,Vp.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Vp.jsx)("span",{className:"text-3xl",children:e.icon}),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("h3",{className:"font-bold text-lg",children:e.title}),(0,Vp.jsxs)("p",{className:"text-sm text-gray-500",children:["ID: ",e.id]})]})]}),(0,Vp.jsx)("button",{onClick:()=>n(e.id),disabled:r,className:"flex items-center gap-2 px-6 py-3 rounded-lg font-semibold transition-all disabled:opacity-50 ".concat(i?"bg-green-500 text-white hover:bg-green-600":"bg-red-500 text-white hover:bg-red-600"),children:i?(0,Vp.jsxs)(Vp.Fragment,{children:[(0,Vp.jsx)(nf,{className:"w-5 h-5"}),"Unlocked"]}):(0,Vp.jsxs)(Vp.Fragment,{children:[(0,Vp.jsx)(g,{className:"w-5 h-5"}),"Locked"]})})]},e.id)})})]})},yf=e=>{let{chapter:t,onSave:n,onCancel:i,loading:a}=e;const[o,l]=(0,r.useState)({chapterId:t.chapterId||"",title:t.title||"",description:t.description||"",icon:t.icon||"\ud83d\udcda",questions:t.questions||[]}),[c,u]=(0,r.useState)({id:"",question:"",options:["","","",""],correct:0,rationale:""});return(0,Vp.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-4 overflow-y-auto",children:(0,Vp.jsxs)("div",{className:"max-w-4xl mx-auto bg-white rounded-xl shadow-2xl p-8",children:[(0,Vp.jsx)("h2",{className:"text-3xl font-bold mb-6",children:t.id?"Edit Chapter":"New Chapter"}),(0,Vp.jsxs)("form",{onSubmit:e=>{e.preventDefault(),o.chapterId&&o.title&&0!==o.questions.length?n((0,s.A)((0,s.A)({},t),o)):alert("Please fill in chapter ID, title, and add at least one question")},className:"space-y-6",children:[(0,Vp.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Chapter ID"}),(0,Vp.jsx)("input",{type:"text",value:o.chapterId,onChange:e=>l((0,s.A)((0,s.A)({},o),{},{chapterId:e.target.value})),className:"w-full px-4 py-2 border rounded-lg",placeholder:"ch23",required:!0})]}),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Icon"}),(0,Vp.jsx)("input",{type:"text",value:o.icon,onChange:e=>l((0,s.A)((0,s.A)({},o),{},{icon:e.target.value})),className:"w-full px-4 py-2 border rounded-lg",placeholder:"\ud83d\udcda"})]})]}),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Title"}),(0,Vp.jsx)("input",{type:"text",value:o.title,onChange:e=>l((0,s.A)((0,s.A)({},o),{},{title:e.target.value})),className:"w-full px-4 py-2 border rounded-lg",placeholder:"Chapter 23: Advanced Topics",required:!0})]}),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Description"}),(0,Vp.jsx)("textarea",{value:o.description,onChange:e=>l((0,s.A)((0,s.A)({},o),{},{description:e.target.value})),className:"w-full px-4 py-2 border rounded-lg",rows:"2",placeholder:"What this chapter covers..."})]}),(0,Vp.jsxs)("div",{className:"border-t pt-6",children:[(0,Vp.jsxs)("h3",{className:"text-xl font-bold mb-4",children:["Questions (",o.questions.length,")"]}),(0,Vp.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-4 space-y-4",children:[(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Question"}),(0,Vp.jsx)("textarea",{value:c.question,onChange:e=>u((0,s.A)((0,s.A)({},c),{},{question:e.target.value})),className:"w-full px-4 py-2 border rounded-lg",rows:"3",placeholder:"Enter question text..."})]}),c.options.map((e,t)=>(0,Vp.jsxs)("div",{children:[(0,Vp.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["Option ",t+1," ",t===c.correct&&"(Correct)"]}),(0,Vp.jsx)("input",{type:"text",value:e,onChange:e=>{const n=[...c.options];n[t]=e.target.value,u((0,s.A)((0,s.A)({},c),{},{options:n}))},className:"w-full px-4 py-2 border rounded-lg",placeholder:"Option ".concat(t+1)})]},t)),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Correct Answer"}),(0,Vp.jsxs)("select",{value:c.correct,onChange:e=>u((0,s.A)((0,s.A)({},c),{},{correct:parseInt(e.target.value)})),className:"w-full px-4 py-2 border rounded-lg",children:[(0,Vp.jsx)("option",{value:0,children:"Option 1"}),(0,Vp.jsx)("option",{value:1,children:"Option 2"}),(0,Vp.jsx)("option",{value:2,children:"Option 3"}),(0,Vp.jsx)("option",{value:3,children:"Option 4"})]})]}),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Rationale"}),(0,Vp.jsx)("textarea",{value:c.rationale,onChange:e=>u((0,s.A)((0,s.A)({},c),{},{rationale:e.target.value})),className:"w-full px-4 py-2 border rounded-lg",rows:"2",placeholder:"Explain why this is the correct answer..."})]}),(0,Vp.jsx)("button",{type:"button",onClick:()=>{if(!c.question||c.options.some(e=>!e))return void alert("Please fill in question and all options");const e=(0,s.A)((0,s.A)({},c),{},{id:c.id||"".concat(o.chapterId,"_q").concat(o.questions.length+1).padStart(2,"0")});l((0,s.A)((0,s.A)({},o),{},{questions:[...o.questions,e]})),u({id:"",question:"",options:["","","",""],correct:0,rationale:""})},className:"w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700",children:"Add Question"})]}),o.questions.length>0&&(0,Vp.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:o.questions.map((e,t)=>(0,Vp.jsxs)("div",{className:"border p-3 rounded-lg flex justify-between items-start",children:[(0,Vp.jsxs)("div",{className:"flex-1",children:[(0,Vp.jsxs)("p",{className:"font-medium",children:["Q",t+1,": ",e.question.substring(0,80),"..."]}),(0,Vp.jsxs)("p",{className:"text-sm text-green-600",children:["\u2713 ",e.options[e.correct]]})]}),(0,Vp.jsx)("button",{type:"button",onClick:()=>{return e=t,void l((0,s.A)((0,s.A)({},o),{},{questions:o.questions.filter((t,n)=>n!==e)}));var e},className:"text-red-600 hover:bg-red-50 p-2 rounded",children:(0,Vp.jsx)(tf,{className:"w-4 h-4"})})]},t))})]}),(0,Vp.jsxs)("div",{className:"flex gap-4 pt-6 border-t",children:[(0,Vp.jsxs)("button",{type:"submit",disabled:a,className:"flex-1 flex items-center justify-center gap-2 bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 disabled:opacity-50",children:[(0,Vp.jsx)(R,{className:"w-5 h-5"}),a?"Saving...":"Save Chapter"]}),(0,Vp.jsx)("button",{type:"button",onClick:i,disabled:a,className:"flex-1 border-2 border-gray-300 py-3 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Cancel"})]})]})]})})},vf=e=>{let{scores:t,loading:n,onRefresh:r,onSelectStudent:i}=e;const a={};t.forEach(e=>{a[e.playerName]||(a[e.playerName]={name:e.playerName,uid:e.uid,attempts:[],totalScore:0,chaptersCompleted:new Set}),a[e.playerName].attempts.push(e),a[e.playerName].totalScore+=e.score,a[e.playerName].chaptersCompleted.add(e.chapterTitle)});const o=Object.values(a).map(e=>(0,s.A)((0,s.A)({},e),{},{chaptersCompleted:e.chaptersCompleted.size,avgScore:Math.round(e.totalScore/e.attempts.length),totalAttempts:e.attempts.length})).sort((e,t)=>t.totalScore-e.totalScore);return(0,Vp.jsxs)("div",{children:[(0,Vp.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Vp.jsx)("div",{children:(0,Vp.jsxs)("p",{className:"text-gray-600",children:["Total Students: ",(0,Vp.jsx)("span",{className:"font-bold",children:o.length})," | Total Submissions: ",(0,Vp.jsx)("span",{className:"font-bold",children:t.length})]})}),(0,Vp.jsx)("button",{onClick:r,disabled:n,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:n?"Loading...":"Refresh"})]}),0===o.length?(0,Vp.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,Vp.jsx)(Xp.A,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),(0,Vp.jsx)("p",{className:"text-lg",children:"No student data yet."}),(0,Vp.jsx)("p",{className:"text-sm",children:"Scores will appear here once students submit ranked attempts."})]}):(0,Vp.jsx)("div",{className:"space-y-4",children:o.map((e,t)=>(0,Vp.jsxs)("div",{className:"border-2 border-gray-200 rounded-lg p-4 hover:border-purple-300 transition-colors cursor-pointer hover:shadow-md",onClick:()=>i&&i(e),children:[(0,Vp.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Vp.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Vp.jsxs)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center font-bold text-white ".concat(0===t?"bg-yellow-500":1===t?"bg-gray-400":2===t?"bg-orange-600":"bg-purple-600"),children:["#",t+1]}),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("h3",{className:"text-lg font-bold",children:e.name}),(0,Vp.jsxs)("p",{className:"text-xs text-gray-500",children:["UID: ",e.uid.substring(0,8),"..."]})]})]}),(0,Vp.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Vp.jsxs)("div",{className:"text-right",children:[(0,Vp.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:e.totalScore}),(0,Vp.jsx)("div",{className:"text-xs text-gray-500",children:"Total Points"})]}),(0,Vp.jsx)(rf,{className:"w-5 h-5 text-purple-600"})]})]}),(0,Vp.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,Vp.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3",children:[(0,Vp.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:e.chaptersCompleted}),(0,Vp.jsx)("div",{className:"text-xs text-gray-600",children:"Chapters"})]}),(0,Vp.jsxs)("div",{className:"bg-green-50 rounded-lg p-3",children:[(0,Vp.jsx)("div",{className:"text-2xl font-bold text-green-600",children:e.avgScore}),(0,Vp.jsx)("div",{className:"text-xs text-gray-600",children:"Avg Score"})]}),(0,Vp.jsxs)("div",{className:"bg-purple-50 rounded-lg p-3",children:[(0,Vp.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:e.totalAttempts}),(0,Vp.jsx)("div",{className:"text-xs text-gray-600",children:"Attempts"})]})]}),(0,Vp.jsxs)("details",{className:"mt-3",onClick:e=>e.stopPropagation(),children:[(0,Vp.jsxs)("summary",{className:"cursor-pointer text-sm text-gray-600 hover:text-gray-800 font-semibold",children:["View Attempts (",e.attempts.length,")"]}),(0,Vp.jsx)("div",{className:"mt-2 space-y-2",children:e.attempts.map((e,t)=>{var n;return(0,Vp.jsxs)("div",{className:"flex justify-between items-center text-sm bg-gray-50 p-2 rounded",children:[(0,Vp.jsx)("span",{className:"font-medium",children:e.chapterTitle}),(0,Vp.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Vp.jsxs)("span",{className:"text-purple-600 font-bold",children:[e.score," pts"]}),(0,Vp.jsx)("span",{className:"text-gray-500 text-xs",children:null!==(n=e.timestamp)&&void 0!==n&&n.toDate?e.timestamp.toDate().toLocaleString():"N/A"})]})]},t)})})]})]},e.uid))})]})},xf=e=>{let{analyticsData:t,loading:n,onRefresh:r}=e;const i={};t.forEach(e=>{const t=e.questionId;if(!t)return;i[t]||(i[t]={questionId:t,chapter:e.chapterTitle||"Unknown",totalAttempts:0,correctAttempts:0,incorrectAttempts:0,avgTimeSpent:0,timeData:[],rationaleCorrect:0,rationaleIncorrect:0,incorrectOptions:{}});const n=i[t];n.totalAttempts++,e.isCorrect?n.correctAttempts++:n.incorrectAttempts++,e.timeSpent&&n.timeData.push(e.timeSpent),"correct"===e.rationaleTier?n.rationaleCorrect++:"incorrect"!==e.rationaleTier&&"weak"!==e.rationaleTier||n.rationaleIncorrect++}),Object.values(i).forEach(e=>{e.percentCorrect=Math.round(e.correctAttempts/e.totalAttempts*100),e.avgTimeSpent=e.timeData.length>0?Math.round(e.timeData.reduce((e,t)=>e+t,0)/e.timeData.length):0,e.percentCorrect>90?e.flag="Too Easy":e.percentCorrect<40?e.flag="Too Hard":e.flag="Good"});const s=Object.values(i).sort((e,t)=>e.percentCorrect-t.percentCorrect);return n?(0,Vp.jsx)("div",{className:"text-center py-12 text-gray-500",children:"Loading analytics..."}):0===t.length?(0,Vp.jsxs)("div",{className:"text-center py-12",children:[(0,Vp.jsx)("p",{className:"text-gray-600 mb-4",children:"No question analytics available yet."}),(0,Vp.jsx)("p",{className:"text-sm text-gray-500",children:"Analytics are collected when students answer questions in ranked mode."})]}):(0,Vp.jsxs)("div",{children:[(0,Vp.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("h3",{className:"text-xl font-bold",children:"Item Analysis Dashboard"}),(0,Vp.jsx)("p",{className:"text-sm text-gray-600",children:"Question performance metrics across all students"})]}),(0,Vp.jsx)("button",{onClick:r,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm",children:"Refresh Data"})]}),(0,Vp.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,Vp.jsxs)("div",{className:"bg-blue-50 rounded-xl p-4",children:[(0,Vp.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:s.length}),(0,Vp.jsx)("div",{className:"text-sm text-gray-600",children:"Questions Analyzed"})]}),(0,Vp.jsxs)("div",{className:"bg-green-50 rounded-xl p-4",children:[(0,Vp.jsx)("div",{className:"text-3xl font-bold text-green-600",children:s.filter(e=>"Good"===e.flag).length}),(0,Vp.jsx)("div",{className:"text-sm text-gray-600",children:"Good Difficulty"})]}),(0,Vp.jsxs)("div",{className:"bg-red-50 rounded-xl p-4",children:[(0,Vp.jsx)("div",{className:"text-3xl font-bold text-red-600",children:s.filter(e=>"Too Easy"===e.flag||"Too Hard"===e.flag).length}),(0,Vp.jsx)("div",{className:"text-sm text-gray-600",children:"Need Review"})]})]}),(0,Vp.jsx)("div",{className:"overflow-x-auto",children:(0,Vp.jsxs)("table",{className:"w-full border-collapse",children:[(0,Vp.jsx)("thead",{children:(0,Vp.jsxs)("tr",{className:"bg-gray-100",children:[(0,Vp.jsx)("th",{className:"p-3 text-left text-sm font-bold",children:"Question ID"}),(0,Vp.jsx)("th",{className:"p-3 text-left text-sm font-bold",children:"Chapter"}),(0,Vp.jsx)("th",{className:"p-3 text-center text-sm font-bold",children:"Attempts"}),(0,Vp.jsx)("th",{className:"p-3 text-center text-sm font-bold",children:"% Correct"}),(0,Vp.jsx)("th",{className:"p-3 text-center text-sm font-bold",children:"Avg Time"}),(0,Vp.jsx)("th",{className:"p-3 text-center text-sm font-bold",children:"Rationale Acc"}),(0,Vp.jsx)("th",{className:"p-3 text-center text-sm font-bold",children:"Flag"})]})}),(0,Vp.jsx)("tbody",{children:s.map(e=>{const t=e.rationaleCorrect+e.rationaleIncorrect>0?Math.round(e.rationaleCorrect/(e.rationaleCorrect+e.rationaleIncorrect)*100):null;return(0,Vp.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,Vp.jsx)("td",{className:"p-3 text-sm font-mono",children:e.questionId}),(0,Vp.jsx)("td",{className:"p-3 text-sm",children:e.chapter}),(0,Vp.jsx)("td",{className:"p-3 text-center text-sm",children:e.totalAttempts}),(0,Vp.jsx)("td",{className:"p-3 text-center",children:(0,Vp.jsxs)("span",{className:"px-2 py-1 rounded font-bold text-sm ".concat(e.percentCorrect>=70?"bg-green-100 text-green-700":e.percentCorrect>=50?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:[e.percentCorrect,"%"]})}),(0,Vp.jsxs)("td",{className:"p-3 text-center text-sm",children:[e.avgTimeSpent,"s"]}),(0,Vp.jsx)("td",{className:"p-3 text-center text-sm",children:null!==t?"".concat(t,"%"):"N/A"}),(0,Vp.jsx)("td",{className:"p-3 text-center",children:(0,Vp.jsx)("span",{className:"px-2 py-1 rounded text-xs font-bold ".concat("Good"===e.flag?"bg-blue-100 text-blue-700":"Too Easy"===e.flag?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:e.flag})})]},e.questionId)})})]})}),(0,Vp.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-xl",children:[(0,Vp.jsx)("h4",{className:"font-bold text-blue-900 mb-2",children:"Recommendations:"}),(0,Vp.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,Vp.jsxs)("li",{children:["\u2022 ",(0,Vp.jsxs)("strong",{children:["Too Easy (",">","90%):"]})," Consider adding distractors or increasing complexity"]}),(0,Vp.jsxs)("li",{children:["\u2022 ",(0,Vp.jsxs)("strong",{children:["Too Hard (","<","40%):"]})," Review question clarity and review concept with students"]}),(0,Vp.jsxs)("li",{children:["\u2022 ",(0,Vp.jsx)("strong",{children:"Good (40-90%):"})," These questions effectively assess understanding"]}),(0,Vp.jsxs)("li",{children:["\u2022 ",(0,Vp.jsx)("strong",{children:"Low Rationale Accuracy:"})," Question may have confusing reasoning options"]})]})]})]})},bf=e=>{let{activeSessions:t,onSendHint:n,onSendMessage:i,onRefresh:s}=e;const[a,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(""),[h,p]=(0,r.useState)(""),f=e=>e.struggling?"bg-red-100 border-red-300 text-red-700":e.onStreak?"bg-green-100 border-green-300 text-green-700":"bg-blue-100 border-blue-300 text-blue-700";return(0,Vp.jsxs)("div",{children:[(0,Vp.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("h3",{className:"text-xl font-bold",children:"Live Student Activity"}),(0,Vp.jsx)("p",{className:"text-sm text-gray-600",children:"Real-time monitoring of active play sessions"})]}),(0,Vp.jsxs)("button",{onClick:s,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm flex items-center gap-2",children:[(0,Vp.jsx)(u.A,{className:"w-4 h-4"}),"Refresh"]})]}),0===t.length?(0,Vp.jsxs)("div",{className:"text-center py-16",children:[(0,Vp.jsx)(u.A,{className:"w-20 h-20 mx-auto mb-4 text-gray-300"}),(0,Vp.jsx)("h3",{className:"text-xl font-bold text-gray-600 mb-2",children:"No Active Sessions"}),(0,Vp.jsx)("p",{className:"text-gray-500",children:"When students start playing, they'll appear here in real-time"}),(0,Vp.jsx)("p",{className:"text-sm text-gray-400 mt-4",children:"\ud83d\udca1 Try generating sample data to see this feature in action"})]}):(0,Vp.jsx)("div",{className:"grid gap-4",children:t.map(e=>(0,Vp.jsxs)("div",{className:"border-2 rounded-xl p-4 transition-all ".concat(f(e)),children:[(0,Vp.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,Vp.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Vp.jsx)("div",{className:"w-12 h-12 rounded-full bg-white flex items-center justify-center",children:(0,Vp.jsx)(Xp.A,{className:"w-6 h-6 text-purple-600"})}),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("h3",{className:"text-lg font-bold",children:e.playerName}),(0,Vp.jsxs)("p",{className:"text-xs opacity-75",children:["Session ID: ",e.uid.substring(0,8),"..."]})]})]}),(0,Vp.jsxs)("div",{className:"flex gap-2",children:[(0,Vp.jsxs)("button",{onClick:()=>l(e),className:"px-3 py-1.5 bg-white rounded-lg text-sm font-semibold hover:bg-opacity-90 transition-colors flex items-center gap-1",children:[(0,Vp.jsx)(sf,{className:"w-4 h-4"}),"Message"]}),(0,Vp.jsxs)("button",{onClick:()=>l(e),className:"px-3 py-1.5 bg-yellow-400 text-yellow-900 rounded-lg text-sm font-semibold hover:bg-yellow-500 transition-colors flex items-center gap-1",children:[(0,Vp.jsx)(E.A,{className:"w-4 h-4"}),"Hint"]})]})]}),(0,Vp.jsxs)("div",{className:"grid grid-cols-4 gap-3 bg-white bg-opacity-50 rounded-lg p-3",children:[(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("div",{className:"text-xs opacity-75",children:"Chapter"}),(0,Vp.jsx)("div",{className:"font-bold",children:e.chapter||"N/A"})]}),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("div",{className:"text-xs opacity-75",children:"Question"}),(0,Vp.jsxs)("div",{className:"font-bold",children:[e.currentQuestion||1,"/10"]})]}),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("div",{className:"text-xs opacity-75",children:"Time on Q"}),(0,Vp.jsxs)("div",{className:"font-bold flex items-center gap-1",children:[(0,Vp.jsx)(S,{className:"w-3 h-3"}),e.timeOnQuestion||0,"s"]})]}),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("div",{className:"text-xs opacity-75",children:"Score"}),(0,Vp.jsxs)("div",{className:"font-bold",children:[e.currentScore||0," pts"]})]})]}),e.struggling&&(0,Vp.jsxs)("div",{className:"mt-3 bg-red-50 border border-red-200 rounded-lg p-2 flex items-center gap-2",children:[(0,Vp.jsx)(o.A,{className:"w-4 h-4 text-red-600"}),(0,Vp.jsxs)("span",{className:"text-sm text-red-700 font-semibold",children:["Student may need help - ",e.wrongAnswers," incorrect attempts"]})]}),e.onStreak&&(0,Vp.jsxs)("div",{className:"mt-3 bg-green-50 border border-green-200 rounded-lg p-2 flex items-center gap-2",children:[(0,Vp.jsx)(af,{className:"w-4 h-4 text-green-600"}),(0,Vp.jsxs)("span",{className:"text-sm text-green-700 font-semibold",children:["On a streak! ",e.streak," correct in a row"]})]})]},e.uid))}),a&&(0,Vp.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Vp.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl p-6 max-w-md w-full",children:[(0,Vp.jsxs)("h3",{className:"text-xl font-bold mb-4",children:["Send to ",a.playerName]}),(0,Vp.jsxs)("div",{className:"space-y-4",children:[(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("label",{className:"block text-sm font-semibold mb-2",children:"\ud83d\udcac Custom Message"}),(0,Vp.jsx)("textarea",{value:c,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border rounded-lg resize-none",rows:"3",placeholder:"Type your message..."}),(0,Vp.jsxs)("button",{onClick:()=>{c.trim()&&a&&(i(a.uid,c),d(""),l(null))},disabled:!c.trim(),className:"mt-2 w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[(0,Vp.jsx)(of,{className:"w-4 h-4"}),"Send Message"]})]}),(0,Vp.jsxs)("div",{className:"border-t pt-4",children:[(0,Vp.jsx)("label",{className:"block text-sm font-semibold mb-2",children:"\ud83d\udca1 Send Hint"}),(0,Vp.jsx)("textarea",{value:h,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 border rounded-lg resize-none",rows:"3",placeholder:"Type a hint..."}),(0,Vp.jsxs)("button",{onClick:()=>{h.trim()&&a&&(n(a.uid,h),p(""),l(null))},disabled:!h.trim(),className:"mt-2 w-full px-4 py-2 bg-yellow-500 text-yellow-900 rounded-lg hover:bg-yellow-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[(0,Vp.jsx)(E.A,{className:"w-4 h-4"}),"Send Hint"]})]})]}),(0,Vp.jsx)("button",{onClick:()=>{l(null),d(""),p("")},className:"mt-4 w-full px-4 py-2 border-2 border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"})]})})]})},wf=e=>{let{student:t,scores:n,analytics:r,onBack:i}=e;const s=n.filter(e=>e.uid===t.uid),a=r.filter(e=>s.some(t=>t.chapterTitle===e.chapterTitle)),o={};a.forEach(e=>{const t=e.questionId;t&&(o[t]||(o[t]={questionId:t,attempts:0,correct:0,totalTime:0,avgTime:0}),o[t].attempts++,e.isCorrect&&o[t].correct++,e.timeSpent&&(o[t].totalTime+=e.timeSpent))}),Object.values(o).forEach(e=>{e.avgTime=e.attempts>0?Math.round(e.totalTime/e.attempts):0,e.accuracy=e.attempts>0?Math.round(e.correct/e.attempts*100):0});const l=Object.values(o).sort((e,t)=>t.attempts-e.attempts),c={};s.forEach(e=>{c[e.chapterTitle]||(c[e.chapterTitle]={chapter:e.chapterTitle,attempts:0,totalScore:0,highScore:0});const t=c[e.chapterTitle];t.attempts++,t.totalScore+=e.score,t.highScore=Math.max(t.highScore,e.score),t.avgScore=Math.round(t.totalScore/t.attempts)});const u=Object.values(c);return(0,Vp.jsxs)("div",{children:[(0,Vp.jsxs)("button",{onClick:i,className:"mb-6 flex items-center gap-2 px-4 py-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",children:[(0,Vp.jsx)(Qp,{className:"w-4 h-4"}),"Back to Student List"]}),(0,Vp.jsxs)("div",{className:"bg-gradient-to-r from-purple-500 to-blue-500 rounded-xl p-6 text-white mb-6",children:[(0,Vp.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,Vp.jsx)("div",{className:"w-20 h-20 rounded-full bg-white flex items-center justify-center",children:(0,Vp.jsx)(Xp.A,{className:"w-10 h-10 text-purple-600"})}),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("h2",{className:"text-3xl font-bold",children:t.name}),(0,Vp.jsxs)("p",{className:"text-purple-100",children:["UID: ",t.uid]})]})]}),(0,Vp.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,Vp.jsxs)("div",{className:"bg-white bg-opacity-20 rounded-lg p-3",children:[(0,Vp.jsx)("div",{className:"text-purple-100 text-sm",children:"Total Score"}),(0,Vp.jsx)("div",{className:"text-2xl font-bold",children:t.totalScore})]}),(0,Vp.jsxs)("div",{className:"bg-white bg-opacity-20 rounded-lg p-3",children:[(0,Vp.jsx)("div",{className:"text-purple-100 text-sm",children:"Chapters"}),(0,Vp.jsx)("div",{className:"text-2xl font-bold",children:t.chaptersCompleted})]}),(0,Vp.jsxs)("div",{className:"bg-white bg-opacity-20 rounded-lg p-3",children:[(0,Vp.jsx)("div",{className:"text-purple-100 text-sm",children:"Avg Score"}),(0,Vp.jsx)("div",{className:"text-2xl font-bold",children:t.avgScore})]}),(0,Vp.jsxs)("div",{className:"bg-white bg-opacity-20 rounded-lg p-3",children:[(0,Vp.jsx)("div",{className:"text-purple-100 text-sm",children:"Total Attempts"}),(0,Vp.jsx)("div",{className:"text-2xl font-bold",children:t.totalAttempts})]})]})]}),(0,Vp.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,Vp.jsxs)("div",{className:"bg-white border-2 border-gray-200 rounded-xl p-6",children:[(0,Vp.jsxs)("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[(0,Vp.jsx)(lf,{className:"w-5 h-5 text-purple-600"}),"Chapter Performance"]}),0===u.length?(0,Vp.jsx)("p",{className:"text-gray-500 text-center py-8",children:"No chapter data available"}):(0,Vp.jsx)("div",{className:"space-y-3",children:u.map(e=>(0,Vp.jsxs)("div",{className:"border rounded-lg p-3",children:[(0,Vp.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,Vp.jsx)("h4",{className:"font-semibold",children:e.chapter}),(0,Vp.jsxs)("span",{className:"text-sm text-gray-500",children:[e.attempts," attempts"]})]}),(0,Vp.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,Vp.jsxs)("div",{className:"bg-blue-50 rounded p-2",children:[(0,Vp.jsx)("div",{className:"text-xs text-gray-600",children:"Avg Score"}),(0,Vp.jsx)("div",{className:"text-lg font-bold text-blue-600",children:e.avgScore})]}),(0,Vp.jsxs)("div",{className:"bg-green-50 rounded p-2",children:[(0,Vp.jsx)("div",{className:"text-xs text-gray-600",children:"High Score"}),(0,Vp.jsx)("div",{className:"text-lg font-bold text-green-600",children:e.highScore})]})]})]},e.chapter))})]}),(0,Vp.jsxs)("div",{className:"bg-white border-2 border-gray-200 rounded-xl p-6",children:[(0,Vp.jsxs)("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[(0,Vp.jsx)(Jp,{className:"w-5 h-5 text-purple-600"}),"Question Analysis"]}),0===l.length?(0,Vp.jsx)("p",{className:"text-gray-500 text-center py-8",children:"No question-level data available"}):(0,Vp.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:l.slice(0,20).map(e=>(0,Vp.jsx)("div",{className:"border rounded p-2 text-sm",children:(0,Vp.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Vp.jsx)("span",{className:"font-mono text-xs text-gray-600",children:e.questionId}),(0,Vp.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Vp.jsxs)("span",{className:"px-2 py-0.5 rounded font-bold ".concat(e.accuracy>=70?"bg-green-100 text-green-700":e.accuracy>=50?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:[e.accuracy,"%"]}),(0,Vp.jsxs)("span",{className:"text-gray-500",children:[e.avgTime,"s"]})]})]})},e.questionId))})]})]}),(0,Vp.jsxs)("div",{className:"mt-6 bg-white border-2 border-gray-200 rounded-xl p-6",children:[(0,Vp.jsxs)("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[(0,Vp.jsx)(S,{className:"w-5 h-5 text-purple-600"}),"Recent Activity"]}),(0,Vp.jsx)("div",{className:"space-y-2",children:t.attempts.slice().reverse().slice(0,10).map((e,t)=>{var n;return(0,Vp.jsxs)("div",{className:"flex items-center justify-between border-b pb-2",children:[(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("span",{className:"font-semibold",children:e.chapterTitle}),(0,Vp.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:null!==(n=e.timestamp)&&void 0!==n&&n.toDate?e.timestamp.toDate().toLocaleString():"N/A"})]}),(0,Vp.jsxs)("div",{className:"text-purple-600 font-bold",children:[e.score," pts"]})]},t)})})]})]})},If=e=>{let{onExit:t}=e;const[n,i]=(0,r.useState)(!1),[a,o]=(0,r.useState)(""),[l,c]=(0,r.useState)([]),[d,h]=(0,r.useState)(null),[p,f]=(0,r.useState)(!1),[m,y]=(0,r.useState)("chapters"),[v,x]=(0,r.useState)([]),[b,w]=(0,r.useState)([]),[I,N]=(0,r.useState)([]),[E,S]=(0,r.useState)(!0),[C,_]=(0,r.useState)([]),[T,k]=(0,r.useState)(null),[R,j]=(0,r.useState)([]),[P,O]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(n){z(),B(),V(),U(),D(),F();const e=setInterval(()=>{"liveDashboard"===m&&D()},5e3);return O(e),()=>{e&&clearInterval(e)}}},[n,m]);const M=e=>{try{const t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(t){return console.error("Error reading from localStorage:",t),null}},L=(e,t)=>{try{localStorage.setItem(e,JSON.stringify(t))}catch(n){console.error("Error saving to localStorage:",n)}},D=()=>{const e=(M(ff)||[]).filter(e=>{const t=new Date(e.lastUpdate);return new Date-t<12e4});_(e)},F=()=>{const e=M(mf)||[];j(e)},q=(e,t)=>{const n={id:Date.now().toString(),to:e,from:"instructor",text:t,timestamp:(new Date).toISOString(),read:!1},r=[...M(mf)||[],n];L(mf,r),j(r),alert("Message sent to student!")},U=async()=>{try{if(E){const e=M(pf)||[];return void N(e)}if(!jp){S(!0);const e=M(pf)||[];return void N(e)}const e=Xc(dc(jp,"artifacts","rn-mastery-game","public","data","analytics"),tu("timestamp","desc")),t=await fu(e),n=[];t.forEach(e=>{n.push((0,s.A)({id:e.id},e.data()))}),N(n)}catch(e){console.error("Error loading analytics, using localStorage:",e),S(!0);const t=M(pf)||[];N(t)}},V=async()=>{try{if(E){const e=M(hf)||[];return void w(e)}if(!jp){S(!0);const e=M(hf)||[];return void w(e)}const e=Xc(dc(jp,"artifacts","rn-mastery-game","public","data","scores"),tu("timestamp","desc")),t=await fu(e),n=[];t.forEach(e=>{n.push((0,s.A)({id:e.id},e.data()))}),w(n)}catch(e){console.error("Error loading scores, using localStorage:",e),S(!0);const t=M(hf)||[];w(t)}},B=async()=>{try{if(E){const e=M(df)||[];return void x(e)}if(!jp){S(!0);const e=M(df)||[];return void x(e)}const e=(await fu(dc(jp,"settings"))).docs.find(e=>"chapterAccess"===e.id);e&&x(e.data().unlocked||[])}catch(e){console.error("Error loading locks, using localStorage:",e),S(!0);const t=M(df)||[];x(t)}},z=async()=>{try{if(f(!0),E){const e=M(uf)||[];return c(e),void f(!1)}if(!jp){S(!0);const e=M(uf)||[];return c(e),void f(!1)}const e=await fu(dc(jp,"customChapters")),t=[];e.forEach(e=>{t.push((0,s.A)({id:e.id},e.data()))}),c(t)}catch(e){console.error("Error loading chapters, using localStorage:",e),S(!0);const t=M(uf)||[];c(t)}finally{f(!1)}},H=e=>{e.preventDefault(),"nursing2024"===a?i(!0):alert("Incorrect password")},G=async e=>{try{if(f(!0),E){const t=M(uf)||[];let n;if(e.id)n=t.map(t=>t.id===e.id?e:t),alert("Chapter updated!");else{const r=(0,s.A)((0,s.A)({},e),{},{id:Date.now().toString()});n=[...t,r],alert("Chapter added!")}return L(uf,n),c(n),h(null),void f(!1)}if(e.id){const t=hc(jp,"customChapters",e.id);await function(e,t,n){e=rc(e,cc);const r=rc(e.firestore,mc),i=kc(r);let s;for(var a=arguments.length,o=new Array(a>3?a-3:0),l=3;l<a;l++)o[l-3]=arguments[l];return s="string"==typeof(t=ie(t))||t instanceof xc?Oc(i,"updateDoc",e._key,t,n,o):Pc(i,"updateDoc",e._key,t),gu(r,[s.toMutation(e._key,ts.exists(!0))])}(t,e),alert("Chapter updated!")}else await mu(dc(jp,"customChapters"),e),alert("Chapter added!");await z(),h(null)}catch(t){console.error("Error saving chapter:",t),alert("Error saving chapter: "+t.message)}finally{f(!1)}},W=async e=>{var t;if(window.confirm("Delete this chapter? This cannot be undone."))try{if(f(!0),E){const t=(M(uf)||[]).filter(t=>t.id!==e);return L(uf,t),c(t),alert("Chapter deleted!"),void f(!1)}await(t=hc(jp,"customChapters",e),gu(rc(t.firestore,mc),[new fs(t._key,ts.none())])),alert("Chapter deleted!"),await z()}catch(n){console.error("Error deleting chapter:",n),alert("Error deleting chapter: "+n.message)}finally{f(!1)}};return n?null!==d?(0,Vp.jsx)(yf,{chapter:d,onSave:G,onCancel:()=>h(null),loading:p}):(0,Vp.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-4",children:(0,Vp.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,Vp.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl p-8",children:[(0,Vp.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("h2",{className:"text-3xl font-bold",children:"Instructor Mode"}),(0,Vp.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Storage: ",E?"\ud83d\udcbe Local Storage (Browser)":"\u2601\ufe0f Firebase Cloud"]})]}),(0,Vp.jsxs)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2 border-2 border-gray-300 rounded-lg hover:bg-gray-50",children:[(0,Vp.jsx)(Qp,{className:"w-4 h-4"}),"Exit"]})]}),(0,Vp.jsxs)("div",{className:"flex gap-2 mb-6 border-b overflow-x-auto",children:[(0,Vp.jsxs)("button",{onClick:()=>y("liveDashboard"),className:"px-6 py-3 font-semibold transition-colors whitespace-nowrap ".concat("liveDashboard"===m?"text-purple-600 border-b-2 border-purple-600":"text-gray-500 hover:text-gray-700"),children:[(0,Vp.jsx)(u.A,{className:"w-4 h-4 inline mr-2"}),"Live Dashboard",C.length>0&&(0,Vp.jsx)("span",{className:"ml-2 bg-green-500 text-white text-xs px-2 py-0.5 rounded-full",children:C.length})]}),(0,Vp.jsx)("button",{onClick:()=>y("chapters"),className:"px-6 py-3 font-semibold transition-colors whitespace-nowrap ".concat("chapters"===m?"text-purple-600 border-b-2 border-purple-600":"text-gray-500 hover:text-gray-700"),children:"Chapter Management"}),(0,Vp.jsxs)("button",{onClick:()=>y("itemAnalysis"),className:"px-6 py-3 font-semibold transition-colors whitespace-nowrap ".concat("itemAnalysis"===m?"text-purple-600 border-b-2 border-purple-600":"text-gray-500 hover:text-gray-700"),children:[(0,Vp.jsx)(Jp,{className:"w-4 h-4 inline mr-2"}),"Item Analysis"]}),(0,Vp.jsxs)("button",{onClick:()=>y("locks"),className:"px-6 py-3 font-semibold transition-colors whitespace-nowrap ".concat("locks"===m?"text-purple-600 border-b-2 border-purple-600":"text-gray-500 hover:text-gray-700"),children:[(0,Vp.jsx)(g,{className:"w-4 h-4 inline mr-2"}),"Chapter Locks"]}),(0,Vp.jsxs)("button",{onClick:()=>y("analytics"),className:"px-6 py-3 font-semibold transition-colors whitespace-nowrap ".concat("analytics"===m?"text-purple-600 border-b-2 border-purple-600":"text-gray-500 hover:text-gray-700"),children:[(0,Vp.jsx)(Xp.A,{className:"w-4 h-4 inline mr-2"}),"Student Analytics"]})]}),"chapters"===m&&(0,Vp.jsxs)(Vp.Fragment,{children:[(0,Vp.jsxs)("div",{className:"flex gap-4 mb-6 flex-wrap",children:[(0,Vp.jsxs)("button",{onClick:()=>h({}),className:"flex items-center gap-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,Vp.jsx)($p,{className:"w-5 h-5"}),"Add New Chapter"]}),(0,Vp.jsxs)("button",{onClick:()=>{const e=JSON.stringify(l,null,2),t=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="chapters-backup-".concat(Date.now(),".json"),r.click()},className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,Vp.jsx)(A,{className:"w-5 h-5"}),"Export All"]}),(0,Vp.jsxs)("label",{className:"flex items-center gap-2 px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 cursor-pointer",children:[(0,Vp.jsx)(Zp,{className:"w-5 h-5"}),"Import",(0,Vp.jsx)("input",{type:"file",accept:".json",onChange:e=>{const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=async e=>{try{const t=JSON.parse(e.target.result);if(!Array.isArray(t))return void alert("Invalid format. Expected an array of chapters.");if(f(!0),E){const e=M(uf)||[],n=t.map(e=>(0,s.A)((0,s.A)({},e),{},{id:Date.now().toString()+Math.random()})),r=[...e,...n];return L(uf,r),c(r),alert("Imported ".concat(t.length," chapters!")),void f(!1)}for(const e of t){const{id:t}=e,n=(0,Yp.A)(e,cf);await mu(dc(jp,"customChapters"),n)}alert("Imported ".concat(t.length," chapters!")),await z()}catch(t){console.error("Error importing:",t),alert("Error importing chapters: "+t.message)}finally{f(!1)}},n.readAsText(t)},className:"hidden"})]}),E&&(0,Vp.jsxs)("button",{onClick:()=>{if(!window.confirm("Generate sample student data for testing analytics? This will add fake student scores and analytics."))return;const e=[{id:"ch18",title:"Chapter 18"},{id:"ch19",title:"Chapter 19"},{id:"ch20",title:"Chapter 20"},{id:"ch21",title:"Chapter 21"},{id:"ch22",title:"Chapter 22"}],t=[],n=[];[{name:"Alice Johnson",uid:"alice_001"},{name:"Bob Smith",uid:"bob_002"},{name:"Carol Davis",uid:"carol_003"},{name:"David Wilson",uid:"david_004"},{name:"Emma Brown",uid:"emma_005"}].forEach(r=>{e.forEach((e,i)=>{if(Math.random()>.3){const i=50+Math.floor(50*Math.random());t.push({id:"score_".concat(r.uid,"_").concat(e.id,"_").concat(Date.now()),playerName:r.name,uid:r.uid,chapterTitle:e.title,chapterId:e.id,score:i,timestamp:{toDate:()=>new Date(Date.now()-7*Math.random()*24*60*60*1e3)}});for(let t=1;t<=10;t++){const i="".concat(e.id,"_q").concat(String(t).padStart(2,"0")),s=Math.random()>.4;n.push({id:"analytics_".concat(r.uid,"_").concat(i,"_").concat(Date.now()),questionId:i,chapterTitle:e.title,isCorrect:s,timeSpent:15+Math.floor(45*Math.random()),rationaleTier:s?"correct":Math.random()>.5?"incorrect":"weak",timestamp:{toDate:()=>new Date(Date.now()-7*Math.random()*24*60*60*1e3)}})}}})}),L(hf,t),L(pf,n),w(t),N(n),alert("Sample data generated! Check Student Analytics and Item Analysis tabs.")},className:"flex items-center gap-2 px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:[(0,Vp.jsx)(Jp,{className:"w-5 h-5"}),"Generate Sample Data"]})]}),p&&(0,Vp.jsxs)("div",{className:"text-center py-8",children:[(0,Vp.jsx)("div",{className:"animate-spin w-12 h-12 border-4 border-purple-600 border-t-transparent rounded-full mx-auto"}),(0,Vp.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]}),!p&&0===l.length&&(0,Vp.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,Vp.jsx)("p",{className:"text-lg",children:"No custom chapters yet."}),(0,Vp.jsx)("p",{className:"text-sm",children:'Click "Add New Chapter" to get started.'})]}),!p&&l.length>0&&(0,Vp.jsx)("div",{className:"grid gap-4",children:l.map(e=>{var t;return(0,Vp.jsx)("div",{className:"border-2 border-gray-200 rounded-lg p-4 hover:border-purple-300 transition-colors",children:(0,Vp.jsxs)("div",{className:"flex items-start justify-between",children:[(0,Vp.jsxs)("div",{className:"flex-1",children:[(0,Vp.jsx)("h3",{className:"text-xl font-bold mb-2",children:e.title}),(0,Vp.jsx)("p",{className:"text-gray-600 mb-2",children:e.description}),(0,Vp.jsxs)("div",{className:"flex gap-4 text-sm text-gray-500",children:[(0,Vp.jsxs)("span",{children:["ID: ",e.chapterId]}),(0,Vp.jsxs)("span",{children:[(null===(t=e.questions)||void 0===t?void 0:t.length)||0," questions"]})]})]}),(0,Vp.jsxs)("div",{className:"flex gap-2",children:[(0,Vp.jsx)("button",{onClick:()=>h(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",children:(0,Vp.jsx)(ef,{className:"w-5 h-5"})}),(0,Vp.jsx)("button",{onClick:()=>W(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:(0,Vp.jsx)(tf,{className:"w-5 h-5"})})]})]})},e.id)})})]}),"locks"===m&&(0,Vp.jsx)(gf,{unlockedChapters:v,onToggleLock:async e=>{try{f(!0);const t=v.includes(e)?v.filter(t=>t!==e):[...v,e];if(E)return L(df,t),x(t),void f(!1);await function(e,t,n){e=rc(e,cc);const r=rc(e.firestore,mc),i=ou(e.converter,t,n);return gu(r,[Ac(kc(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,ts.none())])}(hc(jp,"settings","chapterAccess"),{unlocked:t}),x(t)}catch(t){console.error("Error toggling lock:",t),alert("Error updating chapter lock: "+t.message)}finally{f(!1)}},loading:p}),"itemAnalysis"===m&&(0,Vp.jsx)(xf,{analyticsData:I,loading:p,onRefresh:U}),"analytics"===m&&(0,Vp.jsx)(vf,{scores:b,loading:p,onRefresh:V,onSelectStudent:e=>{k(e),y("studentDetail")}}),"liveDashboard"===m&&(0,Vp.jsx)(bf,{activeSessions:C,onSendHint:(e,t)=>{q(e,"\ud83d\udca1 Hint: ".concat(t))},onSendMessage:q,onRefresh:D}),"studentDetail"===m&&T&&(0,Vp.jsx)(wf,{student:T,scores:b,analytics:I,onBack:()=>y("analytics")})]})})}):(0,Vp.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4",children:(0,Vp.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl p-8 w-full max-w-md",children:[(0,Vp.jsx)("div",{className:"flex items-center justify-center mb-6",children:(0,Vp.jsx)(g,{className:"w-12 h-12 text-purple-600"})}),(0,Vp.jsx)("h2",{className:"text-2xl font-bold text-center mb-6",children:"Instructor Mode"}),(0,Vp.jsxs)("form",{onSubmit:H,className:"space-y-4",children:[(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,Vp.jsx)("input",{type:"password",value:a,onChange:e=>o(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Enter instructor password"})]}),(0,Vp.jsx)("button",{type:"submit",className:"w-full bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 transition-colors font-semibold",children:"Login"}),(0,Vp.jsx)("button",{type:"button",onClick:t,className:"w-full border-2 border-gray-300 text-gray-700 py-3 rounded-lg hover:bg-gray-50 transition-colors font-semibold",children:"Back to Game"})]})]})})},Nf=(0,h.A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Ef=(0,h.A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);function Sf(e){var t;let{gameState:n,onJudge:i,onReveal:s}=e;const[o,l]=(0,r.useState)(null),[c,u]=(0,r.useState)("");if(!n)return null;const{phase:d,currentScenario:h,teams:p,submissions:f,challenges:g,judgeDecision:y}=n;if("JUDGE"!==d)return null;const v=function(e){i({type:e,challengerTeamId:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,targetTeamId:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,note:c}),u("")};return(0,Vp.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-6",children:(0,Vp.jsxs)("div",{className:"bg-slate-900 border-2 border-purple-500 rounded-2xl max-w-5xl w-full max-h-[90vh] overflow-y-auto",children:[(0,Vp.jsxs)("div",{className:"bg-purple-900/30 border-b border-purple-500 p-6",children:[(0,Vp.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,Vp.jsx)(a.A,{className:"w-8 h-8 text-purple-400"}),(0,Vp.jsx)("h2",{className:"text-3xl font-black text-white",children:"Judge Panel"})]}),(0,Vp.jsx)("p",{className:"text-slate-300",children:"Review submissions and challenges to make your judgment"})]}),(0,Vp.jsxs)("div",{className:"p-6 space-y-6",children:[(0,Vp.jsxs)("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:[(0,Vp.jsx)("h3",{className:"text-xl font-bold text-white mb-3",children:"Current Question"}),(0,Vp.jsx)("div",{className:"text-slate-300 mb-4",children:null===h||void 0===h?void 0:h.prompt}),(0,Vp.jsx)("div",{className:"grid gap-2",children:null===h||void 0===h||null===(t=h.choices)||void 0===t?void 0:t.map((e,t)=>(0,Vp.jsxs)("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-3 text-sm text-slate-200",children:[(0,Vp.jsxs)("span",{className:"font-bold text-cyan-400",children:["Option ",t+1,":"]})," ",e]},t))})]}),(0,Vp.jsxs)("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:[(0,Vp.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Team Submissions"}),(0,Vp.jsx)("div",{className:"grid md:grid-cols-2 gap-4",children:p.map(e=>{const t=f[e.id];return(0,Vp.jsxs)("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4",children:[(0,Vp.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Vp.jsx)("span",{className:"font-bold text-white",children:e.name}),(0,Vp.jsxs)("span",{className:"text-sm text-slate-400",children:["Score: ",e.score]})]}),t?(0,Vp.jsxs)("div",{className:"bg-cyan-500/20 border border-cyan-500 rounded-lg p-2 text-cyan-300 text-sm",children:["Submitted: Option ",t.choiceIndex+1]}):(0,Vp.jsx)("div",{className:"text-slate-500 text-sm italic",children:"No submission"})]},e.id)})})]}),g.length>0?(0,Vp.jsxs)("div",{className:"bg-slate-800 border border-red-500 rounded-xl p-6",children:[(0,Vp.jsxs)("h3",{className:"text-xl font-bold text-red-400 mb-4 flex items-center gap-2",children:[(0,Vp.jsx)(Nf,{className:"w-6 h-6"}),"Challenges Submitted (",g.length,")"]}),(0,Vp.jsx)("div",{className:"space-y-4",children:g.map((e,t)=>{const n=p.find(t=>t.id===e.challengerTeamId),r=p.find(t=>t.id===e.targetTeamId),i=o===t;return(0,Vp.jsxs)("div",{className:"border-2 rounded-xl p-4 cursor-pointer transition-all ".concat(i?"border-yellow-500 bg-yellow-500/10":"border-slate-600 bg-slate-700/50 hover:border-slate-500"),onClick:()=>l(i?null:t),children:[(0,Vp.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Vp.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Vp.jsx)("span",{className:"font-bold text-orange-400",children:null===n||void 0===n?void 0:n.name}),(0,Vp.jsx)("span",{className:"text-slate-400",children:"\u2192 challenges \u2192"}),(0,Vp.jsx)("span",{className:"font-bold text-purple-400",children:null===r||void 0===r?void 0:r.name})]}),i&&(0,Vp.jsx)(rf,{className:"w-5 h-5 text-yellow-400"})]}),(0,Vp.jsxs)("div",{className:"bg-slate-800 rounded-lg p-3 mb-2",children:[(0,Vp.jsx)("div",{className:"text-xs text-slate-400 mb-1",children:"Trap Explanation:"}),(0,Vp.jsx)("div",{className:"text-slate-200 text-sm",children:e.trapText})]}),(0,Vp.jsxs)("div",{className:"text-sm text-cyan-400",children:["Alternative Proposed: Option ",e.alternativeIndex+1]}),i&&(0,Vp.jsxs)("div",{className:"mt-4 pt-4 border-t border-slate-600 flex gap-3",children:[(0,Vp.jsxs)("button",{onClick:t=>{t.stopPropagation(),v("CHALLENGE_SUCCESS",e.challengerTeamId,e.targetTeamId)},className:"flex-1 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg font-bold transition flex items-center justify-center gap-2",children:[(0,Vp.jsx)(m,{className:"w-5 h-5"}),"Accept Challenge"]}),(0,Vp.jsxs)("button",{onClick:t=>{t.stopPropagation(),v("CHALLENGE_FAIL",e.challengerTeamId,e.targetTeamId)},className:"flex-1 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg font-bold transition flex items-center justify-center gap-2",children:[(0,Vp.jsx)(w,{className:"w-5 h-5"}),"Reject Challenge"]})]})]},t)})})]}):(0,Vp.jsx)("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6 text-center",children:(0,Vp.jsx)("p",{className:"text-slate-400",children:"No challenges submitted"})}),(0,Vp.jsxs)("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6",children:[(0,Vp.jsx)("h3",{className:"text-lg font-bold text-white mb-3",children:"Judge Notes (Optional)"}),(0,Vp.jsx)("textarea",{value:c,onChange:e=>u(e.target.value),placeholder:"Add notes about your decision...",className:"w-full h-24 px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-purple-500 resize-none"})]}),y&&(0,Vp.jsxs)("div",{className:"bg-green-900/30 border-2 border-green-500 rounded-xl p-6",children:[(0,Vp.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,Vp.jsx)(m,{className:"w-6 h-6 text-green-400"}),(0,Vp.jsx)("h3",{className:"text-xl font-bold text-green-400",children:"Judgment Recorded"})]}),(0,Vp.jsxs)("div",{className:"text-slate-200",children:[(0,Vp.jsxs)("div",{className:"mb-2",children:[(0,Vp.jsx)("span",{className:"font-bold",children:"Decision:"})," ",y.type.replace(/_/g," ")]}),y.note&&(0,Vp.jsxs)("div",{className:"bg-slate-800 rounded-lg p-3 mt-2",children:[(0,Vp.jsx)("div",{className:"text-xs text-slate-400 mb-1",children:"Notes:"}),(0,Vp.jsx)("div",{className:"text-sm",children:y.note})]})]})]}),(0,Vp.jsx)("div",{className:"flex gap-4",children:y?(0,Vp.jsxs)("button",{onClick:s,className:"flex-1 py-4 bg-purple-600 hover:bg-purple-500 text-white rounded-xl font-bold transition flex items-center justify-center gap-2 animate-pulse",children:[(0,Vp.jsx)(Ef,{className:"w-6 h-6"}),"Reveal Answer & Score Round"]}):(0,Vp.jsx)("button",{onClick:()=>v("NO_CHALLENGE"),className:"flex-1 py-4 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-bold transition",children:"No Valid Challenges - Proceed to Score"})})]})]})})}function Cf(e){const{text:t,options:n,correctIndex:r,rationale:i,concept:a,skill:o,bloom:l}=e,c=Math.random()<.2,u=c?function(e){const{concept:t,skill:n,correctIndex:r,options:i}=e;return["This addresses the most immediate physiological need based on nursing priorities (ABCs - Airway, Breathing, Circulation). While other options are appropriate, they can be delayed until the patient is stabilized.","This intervention is important for ongoing care, but does not address the most urgent need. Patient safety and physiological stability take precedence over this action.","While this is clinically appropriate and should be completed, it represents a secondary priority. The immediate threat to patient well-being must be addressed first.","This action is part of comprehensive nursing care but can be safely delayed. The highest priority intervention focuses on preventing immediate complications or harm."]}(e):function(e){const{concept:t,skill:n,bloom:r,correctIndex:i,options:s}=e;s[i];return[kf(e),Af(e),"This option addresses a different priority in ".concat(t||"care"),"While related to ".concat((null===n||void 0===n?void 0:n[0])||"the concept",", this doesn't address the immediate need")]}(e),d=c?function(e,t){const n=["A patient with ".concat(t||"this condition"," requires multiple interventions. Which action should the nurse complete first?"),"The nurse is caring for a patient with ".concat(t||"this condition",". All of the following are appropriate, but which is the highest priority?"),"When caring for a patient with ".concat(t||"this condition",", the nurse recognizes several needs. Which intervention is most important initially?"),"A patient presents with ".concat(t||"this condition",". The nurse plans care. Which action should take priority?")];return n[Math.floor(Math.random()*n.length)]}(0,a):function(e,t,n){if(e.includes("nurse")&&(e.includes("patient")||e.includes("client")))return _f(e);return function(e,t,n){if(null!==n&&void 0!==n&&n.includes("TEACHING_ERROR")||e.toLowerCase().includes("teaching")||e.toLowerCase().includes("indicates the need for further"))return function(e,t){const n=["A patient with ".concat(t||"this condition"," makes the following statement. Which indicates a misunderstanding that could lead to complications?"),"During discharge teaching for ".concat(t||"this condition",", which patient statement requires immediate intervention to prevent adverse outcomes?"),"The nurse is evaluating understanding of ".concat(t||"this condition",". Which statement suggests the patient is at risk for poor outcomes?")];return n[Math.floor(Math.random()*n.length)]}(0,t);if(e.toLowerCase().includes("correlates")||e.toLowerCase().includes("function of"))return function(e,t){const n=["A patient presents with abnormal ".concat(t||"findings",". The nurse anticipates which clinical manifestation will require priority intervention?"),"During assessment of ".concat(t||"this system",", which finding indicates the most urgent need for intervention?"),"The nurse notes changes in ".concat(t||"function",". Which assessment finding suggests immediate risk to the patient?")];return n[Math.floor(Math.random()*n.length)]}(0,t);if(e.toLowerCase().includes("which type")||e.toLowerCase().includes("which is"))return function(e,t){const n=["A patient shows signs consistent with ".concat(t||"this process",". Which assessment finding requires the nurse to act first?"),"In a patient experiencing ".concat(t||"this condition",", which finding indicates the highest priority for immediate intervention?"),"The nurse is caring for multiple patients. Which assessment finding related to ".concat(t||"this system"," requires immediate attention?")];return n[Math.floor(Math.random()*n.length)]}(0,t);if(null!==n&&void 0!==n&&n.includes("PRIORITY")||e.toLowerCase().includes("most appropriate"))return function(e,t){const n=["To prevent complications in a patient with ".concat(t||"this condition",", the nurse's priority action is:"),"A patient with ".concat(t||"this condition"," is at risk for deterioration. Which intervention should the nurse implement first?"),"The nurse identifies early signs of ".concat(t||"complications",". Which action will prevent further decline?")];return n[Math.floor(Math.random()*n.length)]}(0,t);if(null!==n&&void 0!==n&&n.includes("LAB_INTERPRETATION")||e.toLowerCase().includes("lab")||e.toLowerCase().includes("test"))return function(e,t){const n=["A patient's lab results show abnormalities related to ".concat(t||"this system",". Which finding requires immediate notification of the provider?"),"During review of diagnostic tests for ".concat(t||"this condition",", which result indicates the need for urgent intervention?"),"The nurse receives critical lab values related to ".concat(t||"function",". Which finding poses the greatest immediate threat?")];return n[Math.floor(Math.random()*n.length)]}(0,t);return _f("In caring for a patient with ".concat(t||"this condition",", ").concat(e.charAt(0).toLowerCase()).concat(e.slice(1)))}(e,t,n)}(t,a,o),h=c?function(e,t,n){return e.map((e,r)=>{if(r===t)return Tf(e,"immediate",n);return Tf(e,r%3===0?"urgent":r%3===1?"important":"routine",n)})}(n,r,a):function(e){const t=Math.floor(3*Math.random());if(0===t)return e.map(e=>function(e){if(e.length>60||e.includes("BP")||e.includes("within"))return e;const t=[" within the next 5 minutes"," immediately to prevent deterioration"," while monitoring vital signs"," before condition worsens"," as first priority"];if(Math.random()>.5)return e+t[Math.floor(Math.random()*t.length)];return e}(e));if(1===t)return e.map(e=>function(e){if(e.length>60)return e;const t=["considering patient history","noting recent lab changes","observing current symptoms","based on assessment findings"];if(Math.random()>.6){const n=t[Math.floor(Math.random()*t.length)];return"".concat(e," - ").concat(n)}return e}(e));return e.map(e=>function(e){if(e.length>60)return e;const t=["to prevent complications","to stabilize condition","to ensure safety","to reduce risk"];if(Math.random()>.7)return"".concat(e," ").concat(t[Math.floor(Math.random()*t.length)]);return e}(e))}(n),{newOptions:p,newCorrectIndex:f}=function(e,t){e[t];const n=e.map((e,t)=>t);for(let s=n.length-1;s>0;s--){const e=Math.floor(Math.random()*(s+1));[n[s],n[e]]=[n[e],n[s]]}const r=n.map(t=>e[t]),i=n.indexOf(t);return{newOptions:r,newCorrectIndex:i}}(h,r);return(0,s.A)((0,s.A)({},e),{},{originalText:t,text:d,options:p,correctIndex:f,rationaleOptions:u,requiresRationale:!0,correctRationaleIndex:0,timeLimit:30,isTransformed:!0,isPriorityQuestion:c})}function _f(e){const t=["PRIORITY: ","The nurse must first: ","The most important action is: ","To prevent complications, the nurse should: "];return t[Math.floor(Math.random()*t.length)]+e.charAt(0).toLowerCase()+e.slice(1)}function Tf(e,t,n){let r=e.replace(/\b(always|never|must|only|all)\b/gi,"").replace(/\s{2,}/g," ").trim();const i={immediate:[r,"".concat(r," to stabilize condition"),"".concat(r," as priority intervention")],urgent:["".concat(r," after initial assessment"),"".concat(r," following stabilization"),"".concat(r," once safety is ensured")],important:["".concat(r," when condition permits"),"".concat(r," during ongoing care"),"".concat(r," as part of comprehensive plan")],routine:["".concat(r," before discharge"),"".concat(r," during follow-up care"),"".concat(r," when time allows")]},s=i[t]||i.important;return s[Math.floor(Math.random()*s.length)]}function kf(e){const{concept:t,skill:n,bloom:r,rationale:i}=e;if(i&&i.trim()){const e=i.split(".").map(e=>e.trim()).filter(e=>e.length>0);if(e.length>0)return e[0]+"."}return null!==n&&void 0!==n&&n.includes("PRIORITY")?"This addresses the most critical need based on ".concat(t||"nursing priorities","."):"APPLICATION"===r||"CLINICAL_JUDGMENT"===r?"This option requires analyzing the situation and applying clinical judgment based on ".concat(t||"the scenario","."):t?"This is the correct action based on evidence-based practice for ".concat(t,"."):"This option demonstrates proper clinical judgment and evidence-based practice."}function Af(e){const{concept:t,skill:n,rationale:r}=e;if(r&&r.trim()){const e=r.split(".").map(e=>e.trim()).filter(e=>e.length>0);if(e.length>1)return e[1]+"."}const i=["This option is mentioned in the textbook about ".concat(t||"this topic","."),"This is commonly recommended for ".concat(t||"this condition","."),"This intervention is part of standard nursing care.","This action appears in the care guidelines."];return i[Math.floor(Math.random()*i.length)]}function Rf(e){if(e.length<5)return!1;if(e.every(t=>t===e[0]))return!0;let t=!0;for(let r=1;r<e.length;r++)if(e[r]===e[r-1]){t=!1;break}if(t)return!0;let n=!0;for(let r=1;r<e.length;r++)if((e[r]-e[r-1]+4)%4!==1){n=!1;break}return n}const jf={cdiff_outbreak:{id:"ld_escalation_cdiff",text:"\ud83d\udea8 ESCALATION: Two more patients now have diarrhea. Administration demands an action plan. What do you do FIRST?",scenario:"**New Development:**\n- Patients D & E: Acute watery diarrhea started 24h after ED visit\n- Both were in hallway beds near Patient A\n- Lab confirms: Patient A positive for C. diff\n- Infection control called emergency meeting",options:["Close the unit to new admissions","Use your EMERGENCY PASS","Send mass email to all staff","Call provider to order empiric vancomycin"],correctIndex:1,timeLimit:45,requiresResource:"emergencyPasses",consequences:{0:"\u274c **Unit closed!** Administration furious. -20 beds = patients diverted. Your manager is now being questioned.",1:"\u2705 **EMERGENCY PASS used wisely.** Rapid bleach cleaning prevents further spread. Outbreak contained at 3 cases.",2:"\u274c **Email ignored.** C. diff spores survive alcohol sanitizer. Six patients now infected.",3:"\u274c **Provider refuses.** 'I'm not treating email notifications.' Outbreak continues. Seven cases by week end."},rationale:"Emergency passes exist for outbreaks. Rapid environmental disinfection (bleach) is the priority for C. diff spores. Closing units is administrative last resort.",skill:["CLINICAL_JUDGMENT","INFECTION_CONTROL"],bloom:"EVALUATE"},hiv_crisis:{id:"ld_escalation_hiv_crisis",text:"\ud83d\udea8 ESCALATION: Patient with CD4 count 12 now has seizures. You delayed care. What NOW?",scenario:"**Crisis:**\n- Patient seizing in hallway\n- No bed available in ICU\n- You have ONE PROVIDER CALL available\n- Code team is at another emergency",options:["Use PROVIDER CALL","Start seizure precautions and wait","Transfer to ICU immediately","Give lorazepam"],correctIndex:0,timeLimit:30,requiresResource:"providerCalls",consequences:{0:"\u2705 **PROVIDER CALL justified.** MD orders STAT MRI and antifungals. Cryptococcal meningitis confirmed. Patient survives with deficits.",1:"\u274c **Patient falls during seizure.** Head injury. Now intubated. Family considering lawsuit.",2:"\u274c **No ICU bed available!** Transfer request denied. Patient continues seizing. Permanent brain damage.",3:"\u274c **Seizure stops... then recurs.** Lorazepam bought 20 minutes. Not enough. Patient codes."},rationale:"Provider calls are for emergencies. CD4 of 12 + seizures = life-threatening opportunistic infection needing immediate specialist intervention.",skill:["CLINICAL_JUDGMENT","NEURO_ASSESSMENT"],bloom:"EVALUATE"},priority_code:{id:"ld_escalation_priority_code",text:"\ud83d\udea8 ESCALATION: Patient B is coding from unrecognized meningitis. Code team needs direction. What's your call?",scenario:"**Code Blue:**\n- Patient B unresponsive, seizure \u2192 cardiac arrest\n- Code team running ACLS\n- You're charge nurse - they need post-ROSC plan\n- One ISOLATION ROOM available for post-code care",options:["ICU admission with isolation room","Post-code monitoring in ED","Transfer to outside hospital","Continue code"],correctIndex:0,timeLimit:30,requiresResource:"isolationRooms",consequences:{0:"\u2705 **ISOLATION ROOM used appropriately.** ROSC achieved. Amphotericin started. Critical but alive.",1:"\u274c **Staff exposure!** Cryptococcal meningitis now exposed entire ED. Three nurses out sick. Public health investigating.",2:"\u274c **Transfer denied.** 'Too unstable to move.' Patient dies during preparation. Medical examiner case.",3:"\u274c **Code called.** Family devastated. Your initial priority error led here. Preventable death."},rationale:"Post-ROSC care for infectious meningitis requires isolation. Staff safety + patient care. This is when resources get used.",skill:["CLINICAL_JUDGMENT","CODE_MANAGEMENT"],bloom:"EVALUATE"},needlestick_disaster:{id:"ld_escalation_needlestick",text:"\ud83d\udea8 ESCALATION: 4 hours post-exposure. PEP effectiveness dropping. Employee health closed. What now?",scenario:"**Critical Window:**\n- Now 4 hours since needle stick\n- Source patient: HIV+ (uncontrolled), HCV+, HBsAg unknown\n- Employee health closed until 8am (4 more hours)\n- You have one EMERGENCY PASS to override protocols",options:["Use EMERGENCY PASS","Wait for employee health in morning","Send RN to ED for PEP","Give leftover HIV meds from pharmacy"],correctIndex:0,timeLimit:30,requiresResource:"emergencyPasses",consequences:{0:"\u2705 **EMERGENCY PASS justified.** On-call MD orders PEP within 30 min. Optimal window maintained.",1:"\u274c **8 hours total delay.** PEP effectiveness significantly reduced. RN's anxiety through the roof. Risk counseling fails.",2:"\u274c **ED refuses.** 'This is occupational exposure, wrong department.' Now 6 hours delayed. Nurses' union filing grievance.",3:"\u274c **Medication error report filed.** Wrong PEP regimen given. Now need correct meds + report incident. Trust destroyed."},rationale:"PEP works best within 2 hours. Emergency passes exist for staff safety emergencies. This is textbook appropriate use.",skill:["CLINICAL_JUDGMENT","OCCUPATIONAL_SAFETY"],bloom:"EVALUATE"}};const Pf=Object.freeze({LOBBY:"LOBBY",QUESTION:"QUESTION",ANSWER_LOCKED:"ANSWER_LOCKED",CHALLENGE:"CHALLENGE",JUDGE:"JUDGE",REVEAL:"REVEAL"});function Of(e){if("string"!==typeof e)return"";let t=e.replace(/\*\*(.*?)\*\*/g,"$1");return t=t.replace(/\*\*/g,""),t.trim()}const Mf=[{id:"mdro_cd_01",title:"C. diff or just diarrhea?",prompt:"Pick the least dangerous FIRST action.",stem:"76-year-old from LTC. Loose stools x2 today. Completed clindamycin 9 days ago. Afebrile. Vitals stable.",choices:["Obtain stool sample","Start IV fluids","Initiate contact precautions + soap & water","Administer loperamide"],correctIndex:2,rationaleCorrect:"Suspected C. diff = isolate immediately + soap/water; do not wait for labs.",rationaleWrong:["Labs can come after containment; test punishes delay.","Fluids help the patient but do not protect the unit first.","Correct.","Antidiarrheals increase risk of toxic megacolon."],consequenceIfWrong:"Diarrhea worsens \u2192 hypotension develops; secondary exposure occurs.",difficulty:4,timerSeconds:60},{id:"hiv_cd4_02",title:"CD4 count interpretation",prompt:"Which CD4 level is MOST dangerous right now?",stem:"Four HIV patients in clinic today. All on ART. Which needs immediate intervention?",choices:["Patient A: CD4 = 12, viral load undetectable","Patient B: CD4 = 180, viral load 45,000","Patient C: CD4 = 520, viral load 180,000","Patient D: CD4 = 350, viral load undetectable"],correctIndex:1,rationaleCorrect:"CD4 180 + high viral load = active replication. Medication failure. Adjust regimen immediately.",rationaleWrong:["CD4 is critically low BUT viral suppression = treatment working. Monitor closely but not most urgent.","Correct.","CD4 is great; viral load spike may be temporary or medication adherence issue.","Both values stable and improving. Routine follow-up."],consequenceIfWrong:"Patient B develops PCP pneumonia within 2 weeks due to delayed intervention.",difficulty:5,timerSeconds:60},{id:"prep_risk_03",title:"PrEP candidacy assessment",prompt:"Select ALL who need PrEP discussion (SATA)",stem:"Which patients should be offered pre-exposure prophylaxis?",choices:["22-year-old MSM with 3+ partners in past year","35-year-old woman whose partner has HIV (undetectable)","28-year-old injection drug user sharing needles","41-year-old monogamous heterosexual couple (both negative)"],correctIndex:[0,2],rationaleCorrect:"MSM with multiple partners + IDU sharing needles = high-risk behaviors requiring PrEP.",rationaleWrong:["Correct - high-risk sexual behavior.","Partner with undetectable HIV has zero transmission risk (U=U). PrEP unnecessary if truly undetectable.","Correct - needle sharing is highest risk.","Monogamous couple both negative = no indication for PrEP."],consequenceIfWrong:"Patient D receives unnecessary PrEP prescription; patient B becomes infected due to partner's unreported viral blip.",difficulty:6,timerSeconds:90},{id:"priority_triage_04",title:"Four patients, one nurse",prompt:"Who do you assess FIRST?",stem:"You arrive on shift. Four patients need attention.",choices:["Patient on droplet precautions requesting lunch tray","New admission with suspected bacterial meningitis","Post-op patient complaining of 6/10 incision pain","Diabetic patient with blood sugar 250 mg/dL"],correctIndex:1,rationaleCorrect:"Bacterial meningitis = life-threatening. Immediate assessment and isolation before it spreads.",rationaleWrong:["Can delegate to unlicensed staff; not urgent.","Correct.","Pain is expected post-op; can wait 15-20 minutes.","Elevated but not critical; address after life-threatening situation."],consequenceIfWrong:"Meningitis patient seizes due to increased ICP; staff exposed before isolation.",difficulty:4,timerSeconds:45},{id:"needlestick_pep_05",title:"Needlestick aftermath",prompt:"What is the FIRST priority?",stem:"You sustain needlestick from HIV+ patient (detectable viral load). Blood exposure confirmed.",choices:["Wash site with soap & water","Report to employee health immediately","Draw baseline HIV test","Squeeze puncture site to express blood"],correctIndex:0,rationaleCorrect:"Wash immediately reduces viral load at site. Do this FIRST, then report within 2 hours for PEP.",rationaleWrong:["Correct.","Important but do AFTER washing site. PEP must start within 72 hours (ideally <2 hours).","Baseline testing comes after immediate decontamination.","NEVER squeeze; increases tissue damage and viral exposure."],consequenceIfWrong:"Delay in washing increases infection risk. Squeezing causes deeper tissue exposure.",difficulty:5,timerSeconds:30}];console.log("Firebase initialized:",{db:!!jp,auth:!!Pp});const Lf=async e=>{const t={NODE_ENV:"production",PUBLIC_URL:"/Term-3-Gaming",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_GEMINI_API_KEY||"AIzaSyAT-wsupPN4ROtkDzkYVJ9yRJiGa4LvvV8",n=[1e3,2e3,4e3,8e3,16e3];for(let c=0;c<=n.length;c++)try{var r,i,s,a,o;const n=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:e}]}]})});if(!n.ok)throw new Error("API Error: ".concat(n.status));return(null===(r=(await n.json()).candidates)||void 0===r||null===(i=r[0])||void 0===i||null===(s=i.content)||void 0===s||null===(a=s.parts)||void 0===a||null===(o=a[0])||void 0===o?void 0:o.text)||"Could not generate response."}catch(l){if(c===n.length)return"Sorry, the AI tutor is currently offline. Please try again later.";await new Promise(e=>setTimeout(e,n[c]))}};let Df="rn-mastery-game";"undefined"!==typeof window&&"undefined"!==typeof window.__app_id&&(Df=window.__app_id);const Ff=[{id:"ch18",title:"Ch 18: Immune Assessment",icon:(0,Vp.jsx)(a.A,{className:"w-6 h-6"}),description:"Anatomy, function, and assessment.",questions:[{id:"ch18_q01",text:"The nurse is teaching a group of patients about first-line defense against infection. Which patient statement indicates the need for further education?",options:["The skin is a first-line defense.","A sneeze is a mechanical defense.","My saliva is a biochemical defense.","A cut with pus is a mechanical first-line defense."],correctIndex:3,rationale:"A cut with pus indicates an inflammatory response (second-line defense), not a first-line defense."},{id:"ch18_q02",text:"The nurse correlates the function of the thymus gland to which outcome?",options:["WBC development","T-cell development","Cytokine production","B-cell production"],correctIndex:1,rationale:"The thymus gland is the primary site for the maturation and development of T-cells."},{id:"ch18_q03",text:"Which type of leukocyte releases heparin as part of the inflammatory response?",options:["Basophil","Eosinophil","Monocyte","Neutrophil"],correctIndex:0,rationale:"Basophils release histamine and heparin during the inflammatory response."},{id:"ch18_q04",text:"A nurse is caring for a patient who is experiencing leukocytosis. Which action is most appropriate?",options:["Assessing for source of infection","Assessing for bleeding","Reverse isolation","Electric razor use"],correctIndex:0,rationale:"Leukocytosis (elevated WBC) is a sign of infection. The priority is to find the cause."},{id:"ch18_q05",text:"Breastfeeding provides which type of immunity?",options:["Natural Active","Artificial Active","Natural Passive","Artificial Passive"],correctIndex:2,rationale:"Natural Passive Immunity occurs when antibodies are passed from mother to baby (placenta/breastmilk)."},{id:"ch18_q06",text:"Which age-related change increases an older adult's susceptibility to cancer?",options:["Thymus involution","Increased autoantibodies","Decreased Cytotoxic T-cell surveillance","Increased vaccine response"],correctIndex:2,rationale:"Decreased surveillance by Cytotoxic T-cells allows malignant cells to proliferate."},{id:"ch18_q07",text:"A 'Left Shift' in WBC differential indicates:",options:["Viral infection","Acute bacterial infection","Parasitic infection","Allergy"],correctIndex:1,rationale:"A 'Left Shift' means increased immature neutrophils (bands), a sign of acute bacterial infection."},{id:"ch18_q08",text:"Which finding suggests potential immune deficiency?",options:["BP 120/80","Frequent, recurrent infections","Seasonal allergies","Mild fatigue"],correctIndex:1,rationale:"Frequent, severe, or recurrent infections are the hallmark of immune deficiency."},{id:"ch18_q09",text:"Which organ filters old blood cells and foreign antigens from the blood?",options:["Thymus","Spleen","Tonsils","Bone Marrow"],correctIndex:1,rationale:"The spleen filters blood and mounts immune responses to blood-borne pathogens."},{id:"ch18_q10",text:"Which immunoglobulin crosses the placenta?",options:["IgM","IgA","IgG","IgE"],correctIndex:2,rationale:"IgG is the most abundant and the only Ig that crosses the placenta."},{id:"ch18_q11",text:"A hard, fixed, non-tender lymph node suggests:",options:["Infection","Malignancy","Aging","Inflammation"],correctIndex:1,rationale:"Malignant nodes are hard, fixed, and non-tender. Infected nodes are soft and tender."},{id:"ch18_q12",text:"Elevated Eosinophils indicate:",options:["Bacterial infection","Viral infection","Parasitic infection/Allergy","Autoimmune flare"],correctIndex:2,rationale:"Eosinophils rise during allergic reactions and parasitic infections."},{id:"ch18_q13",text:"Which nutrient is critical for antibody synthesis?",options:["Protein","Carbs","Fats","Fiber"],correctIndex:0,rationale:"Protein is essential for antibody production. Malnutrition compromises immunity."},{id:"ch18_q14",text:"Primary function of B-Lymphocytes?",options:["Cellular attack","Phagocytosis","Humoral immunity (Antibodies)","Histamine release"],correctIndex:2,rationale:"B-cells produce antibodies (Humoral Immunity)."},{id:"ch18_q15",text:"Inflammation causes which vascular change?",options:["Vasoconstriction","Vasodilation & permeability","Decreased flow","Decreased permeability"],correctIndex:1,rationale:"Vasodilation (heat/redness) and permeability (swelling) allow immune cells to reach the site."},{id:"ch18_q16",text:"Natural Killer (NK) cells are part of which immunity?",options:["Adaptive","Innate","Passive","Artificial"],correctIndex:1,rationale:"NK cells provide immediate, non-specific defense as part of innate immunity."},{id:"ch18_q17",text:"Which WBC is the 'first responder' to bacterial infection?",options:["Lymphocyte","Monocyte","Neutrophil","Basophil"],correctIndex:2,rationale:"Neutrophils are the most abundant and first to arrive at infection sites."},{id:"ch18_q18",text:"Complement system activation results in:",options:["Decreased inflammation","Pathogen lysis","Antibody suppression","WBC destruction"],correctIndex:1,rationale:"Complement creates membrane attack complexes that lyse pathogens."},{id:"ch18_q19",text:"Memory B-cells provide:",options:["Immediate response","Long-term immunity","Phagocytosis","Inflammation"],correctIndex:1,rationale:"Memory cells enable faster, stronger responses upon re-exposure."},{id:"ch18_q20",text:"Which finding suggests lymphoma?",options:["Painful, mobile nodes","Painless, fixed lymphadenopathy","Fever only","Normal CBC"],correctIndex:1,rationale:"Painless, fixed nodes that don't resolve are concerning for malignancy."},{id:"ch18_q21",text:"Neutropenia increases risk for:",options:["Bleeding","Infection","Allergy","Clotting"],correctIndex:1,rationale:"Low neutrophils (<1500) significantly increase infection risk."},{id:"ch18_q22",text:"Monocytes differentiate into:",options:["Neutrophils","Macrophages","T-cells","Platelets"],correctIndex:1,rationale:"Monocytes leave blood and become tissue macrophages."},{id:"ch18_q23",text:"IgM indicates:",options:["Past infection","Active/recent infection","Vaccine response","Allergy"],correctIndex:1,rationale:"IgM is the first antibody produced during acute infection."},{id:"ch18_q24",text:"Interferons are released in response to:",options:["Bacteria","Viruses","Parasites","Allergens"],correctIndex:1,rationale:"Interferons 'interfere' with viral replication."},{id:"ch18_q25",text:"CD4 cells are also called:",options:["Killer T-cells","Helper T-cells","B-cells","NK cells"],correctIndex:1,rationale:"CD4+ T-cells are helper cells that coordinate immune responses."}]},{id:"ch19",title:"Ch 19: Immune Disorders",icon:(0,Vp.jsx)(o.A,{className:"w-6 h-6"}),description:"Hypersensitivities & Autoimmunity.",questions:[{id:"ch19_q01",text:"Which Ig is a mediator in allergic responses?",options:["IgA","IgD","IgE","IgG"],correctIndex:2,rationale:"IgE binds to mast cells and triggers histamine release in allergies."},{id:"ch19_q02",text:"Latex sensitivity is cross-reactive with:",options:["Strawberries","Shellfish","Bananas/Avocados","Peanuts"],correctIndex:2,rationale:"Bananas, avocados, and kiwis share similar proteins with latex."},{id:"ch19_q03",text:"Signs of Anaphylaxis (Type I) include:",options:["Delayed rash","Jaundice","Stridor, wheezing, hypotension","Joint pain"],correctIndex:2,rationale:"Stridor and hypotension indicate life-threatening airway constriction and shock."},{id:"ch19_q04",text:"A hemolytic transfusion reaction is which type?",options:["Type I","Type II (Cytotoxic)","Type III","Type IV"],correctIndex:1,rationale:"Antibodies attacking donor RBCs is a Type II Cytotoxic reaction."},{id:"ch19_q05",text:"SLE (Lupus) is which type of hypersensitivity?",options:["Type I","Type II","Type III (Immune Complex)","Type IV"],correctIndex:2,rationale:"SLE involves immune complex deposition in tissues (Type III)."},{id:"ch19_q06",text:"Priority for a severe bee sting reaction?",options:["Oral antihistamine","Epinephrine IM","Ice","Drive to hospital"],correctIndex:1,rationale:"Epinephrine is the life-saving priority to reverse anaphylaxis."},{id:"ch19_q07",text:"The TB skin test (PPD) is which reaction type?",options:["Type I","Type II","Type III","Type IV (Delayed)"],correctIndex:3,rationale:"PPD is a T-cell mediated Delayed (Type IV) reaction."},{id:"ch19_q08",text:"First-line drug for angioedema of the lips/tongue?",options:["Fluids","Epinephrine","Steroids","Benadryl"],correctIndex:1,rationale:"Airway compromise requires Epinephrine immediately."},{id:"ch19_q09",text:"Goodpasture's syndrome (antibodies attack lung/kidney) is:",options:["Autoimmunity","Immunodeficiency","Gammopathy","Alloimmunity"],correctIndex:0,rationale:"Autoimmunity is the loss of self-tolerance attacking own tissues."},{id:"ch19_q10",text:"Crucial intervention for B-cell deficiency?",options:["Avoid live vaccines","Daily steroids","Plasmapheresis","High potassium"],correctIndex:0,rationale:"Without antibodies, live vaccines can cause the actual disease."},{id:"ch19_q11",text:"Serum Sickness is which type of reaction?",options:["Type I","Type II","Type III","Type IV"],correctIndex:2,rationale:"Serum sickness is a Type III immune complex reaction."},{id:"ch19_q12",text:"Sign of allergic reaction to antibiotics?",options:["HR 72","Diffuse pruritus/urticaria","Hunger","Low urine output"],correctIndex:1,rationale:"Itching and hives are classic signs of allergy."},{id:"ch19_q13",text:"Important instruction before allergy skin testing?",options:["Stop antihistamines 48-72h prior","Fast 12h","Apply lotion","Double allergy meds"],correctIndex:0,rationale:"Antihistamines suppress the skin response and cause false negatives."},{id:"ch19_q14",text:"Hyperacute transplant rejection occurs:",options:["Minutes to hours","6 months","Years","If meds stopped"],correctIndex:0,rationale:"Hyperacute rejection is immediate and antibody-mediated."},{id:"ch19_q15",text:"Cell type responsible for Type IV reactions?",options:["B-cells","Sensitized T-cells","Neutrophils","Mast cells"],correctIndex:1,rationale:"Type IV is cell-mediated by T-cells, not antibodies."},{id:"ch19_q16",text:"Which medication suppresses Type I allergic reactions?",options:["Antihistamines","NSAIDs","ACE inhibitors","Beta blockers"],correctIndex:0,rationale:"Antihistamines block histamine release from mast cells in Type I reactions."},{id:"ch19_q17",text:"Hemolytic transfusion reaction is which type?",options:["Type I","Type II","Type III","Type IV"],correctIndex:1,rationale:"Type II cytotoxic reaction occurs when antibodies attack transfused RBCs."},{id:"ch19_q18",text:"Contact dermatitis from poison ivy is which type?",options:["Type I","Type II","Type III","Type IV"],correctIndex:3,rationale:"Poison ivy causes a delayed Type IV cell-mediated hypersensitivity."},{id:"ch19_q19",text:"Classic sign of Systemic Lupus Erythematosus (SLE)?",options:["Butterfly rash","Spider veins","Clubbing","Pallor"],correctIndex:0,rationale:"Malar (butterfly) rash across cheeks and nose is characteristic of SLE."},{id:"ch19_q20",text:"Priority nursing action during anaphylaxis?",options:["Establish IV access","Administer epinephrine","Get vital signs","Call physician"],correctIndex:1,rationale:"Epinephrine is the first-line treatment to reverse bronchospasm and vasodilation."},{id:"ch19_q21",text:"Which immunosuppressant requires monitoring for nephrotoxicity?",options:["Azathioprine","Prednisone","Cyclosporine","Methotrexate"],correctIndex:2,rationale:"Cyclosporine can damage kidneys; monitor creatinine and BUN levels."},{id:"ch19_q22",text:"Positive ANA test suggests which condition?",options:["Diabetes","Hypertension","Autoimmune disorder","Bacterial infection"],correctIndex:2,rationale:"Antinuclear antibodies (ANA) indicate autoimmune conditions like SLE."},{id:"ch19_q23",text:"Chronic transplant rejection time frame?",options:["Minutes","Hours to days","Months to years","Never occurs"],correctIndex:2,rationale:"Chronic rejection is a slow progressive process occurring months to years post-transplant."},{id:"ch19_q24",text:"Food most commonly causing Type I allergies in children?",options:["Wheat","Peanuts","Corn","Rice"],correctIndex:1,rationale:"Peanuts cause severe IgE-mediated allergic reactions and anaphylaxis in children."},{id:"ch19_q25",text:"Teaching point for clients with latex allergy?",options:["Only avoid powdered gloves","Report to healthcare providers","Allergy decreases over time","Safe to use latex at home"],correctIndex:1,rationale:"Clients must inform all healthcare providers to ensure latex-free equipment and gloves."}]},{id:"ch20",title:"Ch 20: Connective Tissue",icon:(0,Vp.jsx)(l.A,{className:"w-6 h-6"}),description:"RA, Lupus, Gout, Scleroderma.",questions:[{id:"ch20_q01",text:"Highest risk for Osteoarthritis (OA)?",options:["40yo admin","45yo construction","55yo obese female machinist","60yo accountant"],correctIndex:2,rationale:"Risk factors: Age >55, Female, Obesity, Repetitive motion."},{id:"ch20_q02",text:"Non-pharm therapy for Lupus?",options:["Avoid sun/Use sunscreen","Increase sun","Limit fluids","High protein only"],correctIndex:0,rationale:"Sun exposure triggers SLE flares (photosensitivity)."},{id:"ch20_q03",text:"Finding associated with RA (not OA)?",options:["Asymmetrical pain","Heberden's nodes","Symmetrical pain/Morning stiffness >1hr","Crepitus"],correctIndex:2,rationale:"RA is systemic, symmetrical, and causes prolonged morning stiffness."},{id:"ch20_q04",text:"Medication for ACUTE Gout flare?",options:["Allopurinol","Colchicine","Febuxostat","Methotrexate"],correctIndex:1,rationale:"Colchicine treats acute inflammation. Allopurinol prevents future attacks."},{id:"ch20_q05",text:"In CREST syndrome, 'R' stands for:",options:["Rash","Raynaud's Phenomenon","Renal","Rigidity"],correctIndex:1,rationale:"Calcinosis, Raynaud's, Esophageal dysfunction, Sclerodactyly, Telangiectasia."},{id:"ch20_q06",text:"Dietary modification for Gout?",options:["High protein","Low purine (no organ meat/alcohol)","Gluten-free","Fluid restriction"],correctIndex:1,rationale:"Purines break down into uric acid, which causes Gout."},{id:"ch20_q07",text:"Adverse effect of Methotrexate?",options:["Weight gain","Bone marrow suppression","Insomnia","Hyperactivity"],correctIndex:1,rationale:"Methotrexate causes immunosuppression/bone marrow suppression."},{id:"ch20_q08",text:"Heberden's nodes are a sign of:",options:["RA","Osteoarthritis","Gout","Lupus"],correctIndex:1,rationale:"Bony overgrowths on distal joints (Heberden's) are classic OA."},{id:"ch20_q09",text:"Fibromyalgia involves:",options:["Inflammation","Autoimmunity","Central sensitization/Amplified pain","Uric acid"],correctIndex:2,rationale:"Fibromyalgia is a non-inflammatory chronic pain syndrome."},{id:"ch20_q10",text:"Hallmark of Sj\xf6gren's syndrome?",options:["Dry eyes/mouth","Weakness","Kidney stones","Tremors"],correctIndex:0,rationale:"Sj\xf6gren's attacks moisture glands (eyes/mouth)."},{id:"ch20_q11",text:"Specific lab for SLE (Lupus)?",options:["RF","Anti-dsDNA","Uric Acid","CRP"],correctIndex:1,rationale:"Anti-dsDNA and Anti-Smith are highly specific for Lupus."},{id:"ch20_q12",text:"Scleroderma patient with swallowing difficulty?",options:["Esophageal dysfunction","Infection","Anxiety","Side effect"],correctIndex:0,rationale:"Esophageal hardening causes dysphagia (CREST)."},{id:"ch20_q13",text:"Best exercise for knee OA?",options:["Jogging","Heavy weights","Swimming/Water aerobics","Bed rest"],correctIndex:2,rationale:"Low-impact water exercise reduces joint stress."},{id:"ch20_q14",text:"Raynaud's trigger to avoid?",options:["Warmth","Cold & Stress","Water","Elevation"],correctIndex:1,rationale:"Cold and stress trigger vasospasm in digits."},{id:"ch20_q15",text:"Indication for Arthroplasty (Joint Replacement)?",options:["Diagnosis","Uncontrolled pain/mobility loss","Age <40","Cream failure"],correctIndex:1,rationale:"Surgery is the last resort for severe pain/loss of function."},{id:"ch20_q16",text:"First-line DMARD for Rheumatoid Arthritis?",options:["Prednisone","Methotrexate","Ibuprofen","Acetaminophen"],correctIndex:1,rationale:"Methotrexate is the gold standard DMARD to slow RA progression."},{id:"ch20_q17",text:"Lab value elevated in Rheumatoid Arthritis?",options:["Glucose","Rheumatoid Factor (RF)","Hemoglobin","Sodium"],correctIndex:1,rationale:"Rheumatoid Factor is an autoantibody present in 70-80% of RA patients."},{id:"ch20_q18",text:"Teaching for patient on Methotrexate?",options:["Take with grapefruit juice","Avoid folic acid","Avoid alcohol","Double dose if missed"],correctIndex:2,rationale:"Alcohol increases hepatotoxicity risk with Methotrexate."},{id:"ch20_q19",text:"Joint most commonly affected by Gout?",options:["Hip","Shoulder","Great toe (MTP joint)","Elbow"],correctIndex:2,rationale:"Gout classically presents in the first metatarsophalangeal joint (big toe)."},{id:"ch20_q20",text:"Complication of untreated Osteoarthritis?",options:["Increased flexibility","Joint deformity & disability","Hyperglycemia","Anemia"],correctIndex:1,rationale:"Progressive cartilage loss leads to deformity and loss of function."},{id:"ch20_q21",text:"Medication that can trigger Gout attack?",options:["Thiazide diuretics","Beta blockers","Calcium channel blockers","ACE inhibitors"],correctIndex:0,rationale:"Diuretics increase uric acid levels by reducing renal excretion."},{id:"ch20_q22",text:"Lab test to confirm diagnosis of Gout?",options:["CBC","Synovial fluid analysis for urate crystals","Chest X-ray","EKG"],correctIndex:1,rationale:"Needle-shaped urate crystals in joint fluid confirm Gout."},{id:"ch20_q23",text:"Expected X-ray finding in Osteoarthritis?",options:["Joint space widening","Joint space narrowing & bone spurs","Fractures","Soft tissue swelling only"],correctIndex:1,rationale:"OA shows decreased joint space and osteophytes (bone spurs)."},{id:"ch20_q24",text:"Priority teaching for Lupus patient about pregnancy?",options:["Safe to get pregnant anytime","High-risk; requires specialist care","Stop all medications","Avoid prenatal vitamins"],correctIndex:1,rationale:"SLE pregnancies are high-risk due to flares and complications; need MFM specialist."},{id:"ch20_q25",text:"Biologic therapy for severe Rheumatoid Arthritis?",options:["Aspirin","TNF inhibitors (Etanercept)","Tylenol","Vitamin D"],correctIndex:1,rationale:"TNF-alpha inhibitors target specific immune pathways in RA."}]},{id:"ch21",title:"Ch 21: MDROs",icon:(0,Vp.jsx)(c.A,{className:"w-6 h-6"}),description:"Transmission & Infection Control.",questions:[{id:"ch21_q01",text:"Contact Transmission involves:",options:["Insect bite","Direct/Indirect contact","Airborne particles","Ingestion"],correctIndex:1,rationale:"Direct contact or contact with contaminated surfaces."},{id:"ch21_q02",text:"Vector-Borne Transmission involves:",options:["Insects (ticks/mosquitoes)","Direct contact","Breathing","Food"],correctIndex:0,rationale:"Vectors are living organisms (insects) that transmit disease."},{id:"ch21_q03",text:"Airborne Transmission involves:",options:["Doorknobs","Breathing small suspended particles","Food","Droplets >5 microns"],correctIndex:1,rationale:"Airborne pathogens remain suspended in air for long periods."},{id:"ch21_q04",text:"Common MDRO requiring Contact Precautions?",options:["Strep","MRSA","Flu","Shingles"],correctIndex:1,rationale:"MRSA is a resistant organism spread by contact."},{id:"ch21_q05",text:"Priority for C. diff?",options:["Mask","Soap & Water hand wash","Negative pressure","Open door"],correctIndex:1,rationale:"Alcohol does not kill C. diff spores; mechanical washing is required."},{id:"ch21_q06",text:"VRE is spread via:",options:["Contact","Airborne","Water","Mosquitoes"],correctIndex:0,rationale:"VRE survives on surfaces/hands; spread by contact."},{id:"ch21_q07",text:"Highest risk for MDRO?",options:["Broken arm","ICU with central line/antibiotics","Cold","Outpatient"],correctIndex:1,rationale:"Invasive devices and antibiotic use increase MDRO risk."},{id:"ch21_q08",text:"Acinetobacter baumannii is associated with:",options:["Food","VAP/Wound infections in ICU","Sore throat","Ticks"],correctIndex:1,rationale:"Opportunistic pathogen common in ICUs/ventilators."},{id:"ch21_q09",text:"Antibiotic Stewardship means:",options:["Antibiotics for all","Right drug/dose/duration","Creating drugs","No antibiotics"],correctIndex:1,rationale:"Optimizing use to prevent resistance."},{id:"ch21_q10",text:"Donning PPE order?",options:["Gloves first","Gown -> Gloves","Mask -> Gloves","Gloves -> Mask"],correctIndex:1,rationale:"Gown first, then gloves over cuffs."},{id:"ch21_q11",text:"Most contaminated PPE item (remove first)?",options:["Mask","Gown","Gloves","Goggles"],correctIndex:2,rationale:"Gloves are most contaminated."},{id:"ch21_q12",text:"CRE are dangerous because:",options:["Viral","Resistant to carbapenems","Affect kids","Waterborne"],correctIndex:1,rationale:"Resistant to last-resort antibiotics."},{id:"ch21_q13",text:"Cohort isolation involves:",options:["Same organism roommates","Any roommate","Home","Negative pressure"],correctIndex:0,rationale:"Patients with the SAME active infection can share a room."},{id:"ch21_q14",text:"Best way to break transmission?",options:["Diagnosis","Hand Hygiene","Nutrition","Vaccines"],correctIndex:1,rationale:"Hand hygiene is #1 for preventing spread."},{id:"ch21_q15",text:"Standard Precautions apply to:",options:["Infected only","HIV only","All patients","Surgical only"],correctIndex:2,rationale:"Universal standard for all patients."},{id:"ch21_q16",text:"Transmission-based precaution for active TB?",options:["Contact","Droplet","Airborne","Standard only"],correctIndex:2,rationale:"TB requires airborne precautions with N95 respirator."},{id:"ch21_q17",text:"PPE removal (doffing) order?",options:["Mask first","Gloves -> Gown -> Mask -> Goggles","Gown first","Goggles first"],correctIndex:1,rationale:"Remove most contaminated items first (gloves) before touching face."},{id:"ch21_q18",text:"Type of precaution for Influenza?",options:["Contact","Airborne","Droplet","Protective environment"],correctIndex:2,rationale:"Influenza spreads via large droplets; requires surgical mask."},{id:"ch21_q19",text:"ESBL organisms are resistant to:",options:["All antibiotics","Beta-lactam antibiotics","Antifungals","Antivirals"],correctIndex:1,rationale:"Extended-spectrum beta-lactamase breaks down penicillins and cephalosporins."},{id:"ch21_q20",text:"Contact precautions require:",options:["N95 mask","Gown and gloves","Negative pressure room","PAPR"],correctIndex:1,rationale:"Gown and gloves prevent transmission via direct contact."},{id:"ch21_q21",text:"CRE stands for:",options:["Carbapenem-Resistant Enterobacteriaceae","Common Respiratory Enterococcus","Chronic Renal Encephalopathy","Continuous Renal Excretion"],correctIndex:0,rationale:"CRE are 'superbugs' resistant to carbapenem antibiotics."},{id:"ch21_q22",text:"Negative pressure room is required for:",options:["MRSA","C. diff","Tuberculosis","VRE"],correctIndex:2,rationale:"Negative pressure prevents airborne particles from escaping the room."},{id:"ch21_q23",text:"Priority action if exposed to blood/bodily fluids?",options:["Document later","Wash area immediately & report","Continue working","Wait until end of shift"],correctIndex:1,rationale:"Immediate washing and reporting enables timely post-exposure prophylaxis."},{id:"ch21_q24",text:"MDROs develop resistance primarily due to:",options:["Proper antibiotic use","Overuse and misuse of antibiotics","Handwashing","Vaccination"],correctIndex:1,rationale:"Inappropriate antibiotic use drives selection of resistant strains."},{id:"ch21_q25",text:"Which patient requires protective environment (reverse isolation)?",options:["MRSA infection","Neutropenic cancer patient","Diabetic","Post-op day 1"],correctIndex:1,rationale:"Immunocompromised patients need protection from environmental pathogens."}]},{id:"ch22",title:"Ch 22: HIV/AIDS",icon:(0,Vp.jsx)(u.A,{className:"w-6 h-6"}),description:"Etiology, Progression, Management.",questions:[{id:"ch22_q01",text:"Correct HIV progression?",options:["Acute->AIDS","Viral transmission -> Seroconversion -> Acute -> Chronic -> AIDS","AIDS first","Transmission->AIDS"],correctIndex:1,rationale:"Transmission > Antibodies > Acute Sx > Latency > AIDS."},{id:"ch22_q02",text:"Sign of deterioration in HIV?",options:["Undetectable load","Weight loss >10%","Night sweats","CD4 600"],correctIndex:1,rationale:"Wasting syndrome (>10% loss) indicates progression."},{id:"ch22_q03",text:"PrEP is:",options:["Vaccine","Daily med to prevent HIV","After sex","Cure"],correctIndex:1,rationale:"Pre-Exposure Prophylaxis prevents acquisition."},{id:"ch22_q04",text:"CD4 count of 180 indicates:",options:["Acute HIV","AIDS","Adherence","Normal"],correctIndex:1,rationale:"AIDS < 200 CD4 cells."},{id:"ch22_q05",text:"Opportunistic Infection (OI) in AIDS?",options:["Strep","PCP Pneumonia","Flu","Eczema"],correctIndex:1,rationale:"PCP is a classic OI."},{id:"ch22_q06",text:"Goal of ART?",options:["Cure","Undetectable viral load","Increase virus","Decrease CD4"],correctIndex:1,rationale:"Suppress virus to undetectable levels."},{id:"ch22_q07",text:"Kaposi's Sarcoma presents as:",options:["Purple/red skin lesions","White patches","Diarrhea","Blindness"],correctIndex:0,rationale:"Cancer of blood vessels causing purple lesions."},{id:"ch22_q08",text:"Needle stick priority?",options:["Wait","PEP within 72h","Antibiotics","Retire"],correctIndex:1,rationale:"Post-Exposure Prophylaxis ASAP (max 72h)."},{id:"ch22_q09",text:"Undetectable viral load means:",options:["Cured","Gone","Untransmittable (U=U)","Stop meds"],correctIndex:2,rationale:"Cannot transmit sexually, but must keep taking meds."},{id:"ch22_q10",text:"Oral Thrush presents as:",options:["Blisters","Creamy white patches","Bleeding","Taste loss"],correctIndex:1,rationale:"Fungal infection, white patches."},{id:"ch22_q11",text:"HIV Screening/Confirmation test?",options:["CBC","CXR","4th Gen Antigen/Antibody","UA"],correctIndex:2,rationale:"Detects p24 antigen and antibodies early."},{id:"ch22_q12",text:"IRIS is:",options:["Collapse","Immune recovery causing inflammation","Stop meds","Mutation"],correctIndex:1,rationale:"Recovering immune system attacks old infections."},{id:"ch22_q13",text:"Vertical Transmission:",options:["Sex","Needles","Mother-to-child","Blood"],correctIndex:2,rationale:"Perinatal transmission."},{id:"ch22_q14",text:"ART Adherence requirement:",options:["When sick","95%+","Double dose","Stop if side effects"],correctIndex:1,rationale:"Strict adherence prevents resistance."},{id:"ch22_q15",text:"TB in HIV:",options:["Rare","Leading cause of death","Untreatable","No isolation"],correctIndex:1,rationale:"Major coinfection and killer."},{id:"ch22_q16",text:"Window period for HIV testing refers to:",options:["Treatment duration","Time between infection and detectable antibodies","CD4 recovery time","Viral load doubling time"],correctIndex:1,rationale:"It takes 2-12 weeks for antibodies to develop; tests may be negative during this time."},{id:"ch22_q17",text:"Common side effect of Efavirenz (NNRTI)?",options:["Weight gain","Vivid dreams/CNS effects","Hair loss","Diarrhea"],correctIndex:1,rationale:"Efavirenz commonly causes neuropsychiatric side effects including vivid dreams."},{id:"ch22_q18",text:"PrEP (Pre-Exposure Prophylaxis) is for:",options:["Treating HIV infection","Preventing HIV in high-risk individuals","Curing AIDS","Treating opportunistic infections"],correctIndex:1,rationale:"PrEP (Truvada/Descovy) reduces HIV acquisition risk by >90% when taken consistently."},{id:"ch22_q19",text:"CD4 count indicating severe immunosuppression/AIDS?",options:[">500","350-500","200-350","<200"],correctIndex:3,rationale:"CD4 <200 defines AIDS and dramatically increases opportunistic infection risk."},{id:"ch22_q20",text:"Cryptococcal meningitis in AIDS patients presents with:",options:["Rash","Severe headache & altered mental status","Cough","Diarrhea"],correctIndex:1,rationale:"Fungal meningitis causes headache, fever, and neurological changes."},{id:"ch22_q21",text:"Adherence requirement for ART effectiveness?",options:["50%","75%",">95%","Take when sick"],correctIndex:2,rationale:"Strict adherence >95% prevents resistance and maintains viral suppression."},{id:"ch22_q22",text:"Wasting syndrome (HIV-associated) is defined as:",options:["Weight gain",">10% unintentional weight loss","Increased muscle mass","Fluid retention"],correctIndex:1,rationale:"AIDS wasting involves severe involuntary weight loss with muscle depletion."},{id:"ch22_q23",text:"Integrase inhibitor example?",options:["Raltegravir","Efavirenz","Lamivudine","Ritonavir"],correctIndex:0,rationale:"Raltegravir (Isentress) blocks HIV integration into host DNA."},{id:"ch22_q24",text:"Patient education about ART resistance?",options:["Missing doses has no effect","Resistance develops with inconsistent use","Double dose if missed","Stop meds if feeling better"],correctIndex:1,rationale:"Inconsistent dosing allows viral replication and mutation to resistant strains."},{id:"ch22_q25",text:"Legal requirement for HIV status disclosure?",options:["Must tell everyone","Varies by state; often required to inform sexual partners","Never required","Only employers need to know"],correctIndex:1,rationale:"Laws vary; many states criminalize non-disclosure to sexual partners."}]},{id:"quiz1",title:"Review for Quiz 1",icon:(0,Vp.jsx)(d.A,{className:"w-6 h-6"}),description:"Mixed Review: Chapters 18-22.",questions:[{id:"quiz1_q01",text:"Which antibody provides passive immunity in breast milk?",options:["IgG","IgM","IgA","IgE"],correctIndex:2,rationale:"IgA is secreted in mucous membranes and breast milk."},{id:"quiz1_q02",text:"Contact dermatitis is which hypersensitivity type?",options:["Type I","Type II","Type III","Type IV"],correctIndex:3,rationale:"Type IV delayed cell-mediated reaction (e.g., poison ivy)."},{id:"quiz1_q03",text:"Heberden's nodes are found in:",options:["Rheumatoid Arthritis","Osteoarthritis","Gout","Lupus"],correctIndex:1,rationale:"Bony enlargements at DIP joints characteristic of OA."},{id:"quiz1_q04",text:"Why is soap and water required for C. diff?",options:["Smells better","Alcohol doesn't kill spores","Faster","Required by law"],correctIndex:1,rationale:"Mechanical action of soap and water removes C. diff spores; alcohol doesn't."},{id:"quiz1_q05",text:"CD4 count at AIDS diagnosis?",options:[">500","350-500","200-350","<200"],correctIndex:3,rationale:"AIDS is defined by CD4 <200 or opportunistic infections."},{id:"quiz1_q06",text:"Which cell type produces antibodies?",options:["T-cells","Plasma cells (B-cells)","Neutrophils","Basophils"],correctIndex:1,rationale:"B-cells differentiate into plasma cells that secrete antibodies."},{id:"quiz1_q07",text:"Butterfly rash is associated with:",options:["RA","OA","SLE (Lupus)","Gout"],correctIndex:2,rationale:"Malar rash across cheeks/nose is classic for Systemic Lupus Erythematosus."},{id:"quiz1_q08",text:"Priority action during anaphylaxis?",options:["Call physician","Administer epinephrine","Start IV","Take vital signs"],correctIndex:1,rationale:"Epinephrine IM is the first-line life-saving treatment."},{id:"quiz1_q09",text:"MRSA requires which precautions?",options:["Standard only","Contact","Airborne","Droplet"],correctIndex:1,rationale:"MRSA spreads via direct contact; gown and gloves required."},{id:"quiz1_q10",text:"Goal of antiretroviral therapy (ART)?",options:["Cure HIV","Increase CD4","Undetectable viral load","Kill all T-cells"],correctIndex:2,rationale:"ART suppresses HIV replication to undetectable levels."},{id:"quiz1_q11",text:"Inflammation is part of which immunity?",options:["Adaptive","Innate","Passive","Artificial"],correctIndex:1,rationale:"Inflammation is a non-specific innate immune response."},{id:"quiz1_q12",text:"Serum sickness is which type of reaction?",options:["Type I","Type II","Type III","Type IV"],correctIndex:2,rationale:"Type III immune complex-mediated hypersensitivity."},{id:"quiz1_q13",text:"Which medication prevents Gout attacks long-term?",options:["Colchicine","Allopurinol","Prednisone","NSAIDs"],correctIndex:1,rationale:"Allopurinol reduces uric acid production to prevent future flares."},{id:"quiz1_q14",text:"Hand hygiene is most effective at preventing:",options:["Aging","MDRO transmission","Genetic diseases","Cancer"],correctIndex:1,rationale:"Proper handwashing is the #1 method to break infection chain."},{id:"quiz1_q15",text:"Kaposi's Sarcoma appears as:",options:["White patches","Purple skin lesions","Yellow nodules","Clear blisters"],correctIndex:1,rationale:"Vascular cancer causing purple/red lesions in AIDS patients."},{id:"quiz1_q16",text:"Which antibody is first to respond in infection?",options:["IgA","IgE","IgG","IgM"],correctIndex:3,rationale:"IgM appears first during acute infection ('M for iMmediate')."},{id:"quiz1_q17",text:"Anaphylaxis involves which antibody?",options:["IgA","IgE","IgG","IgM"],correctIndex:1,rationale:"IgE binds to allergens and triggers mast cell degranulation."},{id:"quiz1_q18",text:"Lab most specific for SLE?",options:["CBC","Anti-dsDNA","CRP","Uric acid"],correctIndex:1,rationale:"Anti-dsDNA and Anti-Smith antibodies are highly specific for Lupus."},{id:"quiz1_q19",text:"Standard precautions apply to:",options:["Infected patients only","HIV patients only","All patients","Surgical patients only"],correctIndex:2,rationale:"Standard precautions are used universally for all patient care."},{id:"quiz1_q20",text:"Undetectable = Untransmittable (U=U) means:",options:["HIV is cured","Cannot transmit HIV sexually","Can stop medications","CD4 is restored"],correctIndex:1,rationale:"Sustained viral suppression prevents sexual transmission of HIV."},{id:"quiz1_q21",text:"Which immunity provides immediate, non-specific defense?",options:["Adaptive","Innate","Passive","Humoral"],correctIndex:1,rationale:"Innate immunity (barriers, inflammation, phagocytes) responds immediately."},{id:"quiz1_q22",text:"First-line DMARD for Rheumatoid Arthritis?",options:["Prednisone","Methotrexate","Ibuprofen","Tylenol"],correctIndex:1,rationale:"Methotrexate is the gold-standard DMARD to slow RA progression."},{id:"quiz1_q23",text:"PPE doffing order (removal)?",options:["Mask first","Gloves -> Gown -> Mask","Gown first","Random order"],correctIndex:1,rationale:"Remove most contaminated items (gloves) first, mask last."},{id:"quiz1_q24",text:"PEP (Post-Exposure Prophylaxis) must start within:",options:["1 week","72 hours","1 month","No time limit"],correctIndex:1,rationale:"PEP is most effective when started within 72 hours of HIV exposure."},{id:"quiz1_q25",text:"Neutrophils primarily fight which infections?",options:["Viral","Bacterial","Parasitic","Fungal"],correctIndex:1,rationale:"Neutrophils are first responders to bacterial infections."}]}];function qf(e){let{onBackToHub:t,initialMode:n="ranked"}=e;const[i,a]=(0,r.useState)("menu"),[l,c]=(0,r.useState)("ranked"),[u,h]=(0,r.useState)(()=>{const e=localStorage.getItem("rnMasteryFlashcardCompleted");return e?JSON.parse(e):{}}),[j,O]=(0,r.useState)(100),[M,L]=(0,r.useState)(null),[D,F]=(0,r.useState)([]),[q,U]=(0,r.useState)(0),[V,B]=(0,r.useState)(null),[z,H]=(0,r.useState)(!1),[G,W]=(0,r.useState)(0),[K,Y]=(0,r.useState)(0),[Q,J]=(0,r.useState)(0),[X,$]=(0,r.useState)(0),[Z,ee]=(0,r.useState)([]),[te,ne]=(0,r.useState)(!1),[re,se]=(0,r.useState)([]),[ae,oe]=(0,r.useState)(null),[le,ce]=(0,r.useState)(30),[ue,de]=(0,r.useState)(0),[he,pe]=(0,r.useState)(null),[fe,me]=(0,r.useState)(!1),[ge,ye]=(0,r.useState)([]),[ve,xe]=(0,r.useState)(null),[be,we]=(0,r.useState)(0),[Ie,Ne]=(0,r.useState)(0),[Ee,Se]=(0,r.useState)(0),[Ce,_e]=(0,r.useState)(100),[Te,ke]=(0,r.useState)(!1),[Ae,Re]=(0,r.useState)([]),[je,Pe]=(0,r.useState)([]),[Oe,Me]=(0,r.useState)(()=>{const e=localStorage.getItem("rnMasteryWeakness");return e?JSON.parse(e):{missedBySkill:{},missedByConcept:{},missedByBloom:{}}}),[Le,De]=(0,r.useState)(()=>{const e=localStorage.getItem("rnMasteryConceptMissCount");return e?JSON.parse(e):{}}),[Fe,qe]=(0,r.useState)([]),[Ue,Ve]=(0,r.useState)(!1),[Be,ze]=(0,r.useState)(null),[He,Ge]=(0,r.useState)(()=>{const e=localStorage.getItem("rnMasteryRemediationCompleted");return e?JSON.parse(e):{}}),[We,Ke]=(0,r.useState)(()=>{const e=localStorage.getItem("rnMasteryQuestionHistory");return e?JSON.parse(e):{}}),[Ye,Qe]=(0,r.useState)(0),[Je,Xe]=(0,r.useState)(null),[$e,Ze]=(0,r.useState)({isolationRooms:1,emergencyPasses:1,providerCalls:1}),[et,tt]=(0,r.useState)(0),[nt,rt]=(0,r.useState)([]),[it,st]=(0,r.useState)("solo"),[at,ot]=(0,r.useState)(""),[lt,ct]=(0,r.useState)([]),[ut,dt]=(0,r.useState)(!1),[ht,pt]=(0,r.useState)(1),[ft,mt]=(0,r.useState)([]),[yt,vt]=(0,r.useState)(!1),[xt,bt]=(0,r.useState)(null),[wt,It]=(0,r.useState)([]),[Nt,Et]=(0,r.useState)(!1),[St,Ct]=(0,r.useState)(""),[_t,Tt]=(0,r.useState)(()=>{const e=localStorage.getItem("rnMasteryAnalytics");return e?JSON.parse(e):{totalAttempts:0,correctCount:0,missedCount:0,confidenceStats:{sureCorrect:0,sureWrong:0,guessCorrect:0,guessWrong:0}}}),[kt,At]=(0,r.useState)(null),[Rt,jt]=(0,r.useState)(!1),[Pt,Ot]=(0,r.useState)(null),[Mt,Lt]=(0,r.useState)(!1),[Dt,Ft]=(0,r.useState)(null),[qt,Ut]=(0,r.useState)(""),[Vt,Bt]=(0,r.useState)(!1),[zt,Ht]=(0,r.useState)([]),[Gt,Wt]=(0,r.useState)({connected:!!jp&&!!Pp,authenticated:!1,initializing:!0});(0,r.useEffect)(()=>{(async()=>{if(jp)try{const e=await fu(dc(jp,"customChapters")),t=[];e.forEach(e=>{t.push((0,s.A)((0,s.A)({},e.data()),{},{id:e.id}))}),Re(t)}catch(e){console.error("Error loading custom chapters:",e)}})();(async()=>{if(jp)try{const e=(await fu(dc(jp,"settings"))).docs.find(e=>"chapterAccess"===e.id);if(e){const t=e.data().unlocked||[];Pe(t)}else Pe(["ch18","ch19","ch20","ch21","ch22","quiz1"])}catch(e){console.error("Error loading chapter locks:",e),Pe(["ch18","ch19","ch20","ch21","ch22","quiz1","day-to-be-wrong"])}})()},[]),(0,r.useEffect)(()=>{if("ranked"!==l||"playing"!==i||z)return;const e=D[q],t=("day-to-be-wrong"===(null===M||void 0===M?void 0:M.id)&&null!==e&&void 0!==e&&e.timeLimit&&e.timeLimit,setInterval(()=>{ce(e=>e<=1?(clearInterval(t),$t(V,"TIMEOUT"),0):e-1),de(e=>e+1)},1e3));return()=>clearInterval(t)},[l,i,z,q]),(0,r.useEffect)(()=>{if(!Pp||!jp)return console.error("Firebase not initialized properly"),void Wt({connected:!1,authenticated:!1,initializing:!1});Wt({connected:!0,authenticated:!1,initializing:!0});const e=function(e,t,n,r){return ie(e).onAuthStateChanged(t,n,r)}(Pp,async e=>{if(console.log("Auth state changed:",e?"User logged in: ".concat(e.uid):"No user"),Ft(e),Wt({connected:!0,authenticated:!!e,initializing:!1}),e&&jp)try{const t=Xc(dc(jp,"artifacts",Df,"public","data","scores"),function(e,t,n){const r=t,i=Kc("where",e);return $c._create(i,r,n)}("uid","==",e.uid)),n=(await fu(t)).docs.map(e=>e.data().chapterTitle);Ht([...new Set(n)]),console.log("Loaded submitted chapters:",n)}catch(rm){console.error("Error fetching submitted chapters:",rm)}});return(async()=>{try{if(console.log("Starting auth initialization..."),"undefined"!==typeof window&&window.__initial_auth_token)console.log("Signing in with custom token"),await fh(Pp,window.__initial_auth_token);else{console.log("Attempting anonymous sign in...");const e=await async function(e){var t;if(gt(e.app))return Promise.reject(Tu(e));const n=Pd(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new oh({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await ah(n,{returnSecureToken:!0}),i=await oh._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}(Pp);console.log("Anonymous sign in successful:",e.user.uid)}}catch(e){console.error("Auth initialization FAILED:",e),console.error("Error code:",e.code),console.error("Error message:",e.message),"auth/operation-not-allowed"===e.code?alert("\u26a0\ufe0f Anonymous authentication is disabled.\n\nPlease enable it in:\nFirebase Console \u2192 Authentication \u2192 Sign-in method \u2192 Anonymous \u2192 Enable"):alert("Authentication failed: "+e.message),Wt({connected:!0,authenticated:!1,initializing:!1})}})(),()=>e()},[]);const Kt=e=>!0===u[e],Yt=()=>{if("ranked"!==l||0===D.length)return null;const e=Math.round(Q/D.length*40),t=be+Ie+X,n=t>0?Math.round((1*be+.5*Ie)/t*40):0,r=Ee/D.length;let i=20;i=r<5?Math.round(10):r>25?Math.round(14):r>=10&&r<=20?20:Math.round(17);return{total:e+n+i,accuracy:e,rationale:n,time:i,avgTime:Math.round(r)}},Qt=function(e){const t=e.id||e.chapterId;if("day-to-be-wrong"===t)return void vt(!0);if("ranked"===l&&Fe.length>0)return void alert("\u26a0\ufe0f Remediation Required\n\nYou must complete remediation for these concepts before accessing Rank Mode:\n\n".concat(Fe.map(e=>"\u2022 ".concat(e)).join("\n"),'\n\nClick the "\ud83d\udcda Remediation" button to strengthen your understanding.'));if("ranked"===l&&!Kt(t))return void alert("\ud83d\udd12 Flashcard Review Required\n\nPlease complete the Flashcard Study mode for this chapter before attempting Ranked Mode.\n\nGo to the Hub \u2192 Flashcard Study \u2192 ".concat(e.title,"\n\nThis ensures you're familiar with the content before testing!"));let n=Kp(e.questions);if(0!==n.length){if("ranked"===l){const e=["APPLICATION","ANALYSIS","PRIORITIZATION","CLINICAL_JUDGMENT","EVALUATE","SYNTHESIS"],r=n.filter(t=>t.bloom&&e.some(e=>t.bloom.toUpperCase().includes(e)));n=r.length>=5?r:n;const i=n.filter(e=>{const t=(e=>{const t=We[e];if(!t||!t.lastAttempt)return{isRecent:!1};const n=new Date(t.lastAttempt),r=(Date.now()-n.getTime())/36e5;return{isRecent:r<24,hoursSince:Math.round(r),attemptCount:t.attemptCount||0}})(e.id);return!t.isRecent||t.attemptCount<3});if(i.length<5)return void alert("\u26a0\ufe0f Anti-Memorization Protection\n\nYou've recently attempted most questions in this chapter.\n\nWait 24 hours or try a different chapter to ensure valid assessment.");n=i,"day-to-be-wrong"!==t&&(n=n.map(e=>Cf(e)))}L(e),F(n),U(0),W(0),Y(0),J(0),$(0),ee([]),ye([]),"ranked"===l&&(we(0),Ne(0),Se(0),_e(100),Qe(0)),a("playing"),Jt(),"ranked"===l&&(ce(30),de(0))}else alert("No questions found for this chapter.")},Jt=()=>{const e=D[q+1];if(B(null!==e&&void 0!==e&&e.isMultiSelect?[]:null),oe(null),pe(null),me(!1),xe(null),Xe(null),"ranked"===l){const e=D[q+1],t="day-to-be-wrong"===(null===M||void 0===M?void 0:M.id)&&null!==e&&void 0!==e&&e.timeLimit?e.timeLimit:30;ce(t),de(0)}H(!1),At(null),ne(!1),se([])},Xt=()=>{if(te||z)return;const e=D[q],t=Array.isArray(e.correctIndex)?e.correctIndex:[e.correctIndex],n=e.options.map((e,t)=>t).filter(e=>!t.includes(e)).sort(()=>Math.random()-.5).slice(0,2);se(n),ne(!0)},$t=(e,t)=>{if(!D||0===D.length||q>=D.length)return void console.warn("\u26a0\ufe0f handleAnswer called but no valid question available");const n=D[q];if(!n)return void console.warn("\u26a0\ufe0f handleAnswer called but question is undefined");if(B(e),oe(t),"TIMEOUT"!==t&&"ranked"===l&&n.requiresRationale&&!fe)return void me(!0);let r;if(n.isMultiSelect&&Array.isArray(n.correctIndex)){const t=Array.isArray(e)?e.sort((e,t)=>e-t):[],i=[...n.correctIndex].sort((e,t)=>e-t);r=t.length===i.length&&t.every((e,t)=>e===i[t])}else r=null!==e&&e===n.correctIndex;let i=0,o="";n.hardMode&&n.penalties&&(r?(i=10,ue<.66*n.timeLimit&&(i+=5,o=" (+5 quick decision bonus)")):(i=n.penalties.wrong||-15,o=" (".concat(n.penalties.wrong," priority error)"),ue>.75*n.timeLimit&&(i+=n.penalties.delayed||-5,o+=" (".concat(n.penalties.delayed," delayed)")),n.penalties.secondaryHarm&&null!==e&&(i+=n.penalties.secondaryHarm||-10,o+=" (".concat(n.penalties.secondaryHarm," secondary harm)"))));const c="day-to-be-wrong"===(null===M||void 0===M?void 0:M.id)||"day-to-be-wrong"===(null===M||void 0===M?void 0:M.chapterId);if(c&&n.consequences&&null!==e&&Xe(n.consequences[e]||null),c&&n.requiresResource&&r){const e=n.requiresResource;console.log("\ud83d\udcb3 Resource check:",{resourceType:e,currentAmount:$e[e],isCorrect:r}),$e[e]>0?(console.log("\u2705 Consuming resource:",e),Ze((0,s.A)((0,s.A)({},$e),{},{[e]:$e[e]-1}))):console.log("\u26a0\ufe0f Resource already used:",e)}let u=!1;if("ranked"===l&&ue<3&&(u=!0,Qe(Ye+1)),"ranked"===l&&((e,t,n)=>{const r=(0,s.A)({},We);r[e]||(r[e]={attemptCount:0,lastAttempt:null,averageTime:0,correctCount:0});const i=r[e];i.attemptCount++,i.lastAttempt=(new Date).toISOString(),i.averageTime=(i.averageTime*(i.attemptCount-1)+t)/i.attemptCount,n&&i.correctCount++,Ke(r),localStorage.setItem("rnMasteryQuestionHistory",JSON.stringify(r))})(n.id,ue,r),"ranked"===l){const t=[...ge,e].slice(-5);ye(t),Rf(t)&&console.warn("Answer pattern detected - possible guessing")}let d=0,h=1,p=null,f=null;if("TIMEOUT"===t){if($(X+1),Y(0),ee([...Z,{question:n,selectedAnswer:e,questionNumber:q+1,timeSpent:"ranked"===l?ue:null,selectedRationale:null,reason:"timeout"}]),n.skill||n.concept){const e=(0,s.A)({},Oe),t=(0,s.A)({},Le);Array.isArray(n.skill)&&n.skill.forEach(t=>{e.missedBySkill=e.missedBySkill||{},e.missedBySkill[t]=(e.missedBySkill[t]||0)+1}),n.concept&&(e.missedByConcept=e.missedByConcept||{},e.missedByConcept[n.concept]=(e.missedByConcept[n.concept]||0)+1,t[n.concept]=(t[n.concept]||0)+1,t[n.concept]>=2&&!He[n.concept]&&(Fe.includes(n.concept)||qe([...Fe,n.concept])),De(t),localStorage.setItem("rnMasteryConceptMissCount",JSON.stringify(t))),n.bloom&&(e.missedByBloom=e.missedByBloom||{},e.missedByBloom[n.bloom]=(e.missedByBloom[n.bloom]||0)+1),Me(e),localStorage.setItem("rnMasteryWeakness",JSON.stringify(e))}d=0}else if(r)if(J(Q+1),c)d=ue>45?3:10,Y(K+1);else if("ranked"===l)if(n.requiresRationale&&null!==he){const e=(m=he,n.correctRationaleIndex,0===m?{score:100,tier:"correct"}:1===m?{score:50,tier:"weak"}:{score:0,tier:"incorrect"});p=e.score,f=e.tier,xe(f),"correct"===f?we(be+1):"weak"===f&&Ne(Ie+1),Se(Ee+ue),"incorrect"===f?(d=0,Y(0)):(d="SURE"===t?150:100,d+=50*K,h=function(e,t){return e<3?.5:e<=15?1.3:e<=22?1:e<=t?.9:.7}(ue,n.timeLimit||30),d=Math.round(d*h),"weak"===f&&(d=Math.round(.5*d)),u&&ue<3&&(d=Math.round(.3*d)),Rf(ge)&&(d=Math.round(.5*d)),Y(K+1))}else d="SURE"===t?150:100,Y(K+1);else Y(K+1);else{if($(X+1),Y(0),ut&&!r)return pt(0),W(G+d),H(!0),void setTimeout(()=>{alert("\ud83d\udc80 SUDDEN DEATH ELIMINATION!\n\nYou answered incorrectly on Question ".concat(q+1,".\n\nFinal Score: ").concat(G+d,"\nQuestions Survived: ").concat(q,"/").concat(D.length,"\n\nOnly the perfect survive in Sudden Death mode!")),a("summary")},2e3);if(c&&(d=-10),ee([...Z,{question:n,selectedAnswer:e,questionNumber:q+1,timeSpent:"ranked"===l?ue:null,selectedRationale:"ranked"===l?he:null}]),n.skill||n.concept){const e=(0,s.A)({},Oe),t=(0,s.A)({},Le);Array.isArray(n.skill)&&n.skill.forEach(t=>{e.missedBySkill=e.missedBySkill||{},e.missedBySkill[t]=(e.missedBySkill[t]||0)+1}),n.concept&&(e.missedByConcept=e.missedByConcept||{},e.missedByConcept[n.concept]=(e.missedByConcept[n.concept]||0)+1,t[n.concept]=(t[n.concept]||0)+1,t[n.concept]>=2&&!He[n.concept]&&(Fe.includes(n.concept)||qe([...Fe,n.concept])),De(t),localStorage.setItem("rnMasteryConceptMissCount",JSON.stringify(t))),n.bloom&&(e.missedByBloom=e.missedByBloom||{},e.missedByBloom[n.bloom]=(e.missedByBloom[n.bloom]||0)+1),Me(e),localStorage.setItem("rnMasteryWeakness",JSON.stringify(e))}}var m;W(G+d);const g="SURE"===t?r?"sureCorrect":"sureWrong":r?"guessCorrect":"guessWrong",y=(0,s.A)((0,s.A)({},_t),{},{totalAttempts:_t.totalAttempts+1,correctCount:_t.correctCount+(r?1:0),missedCount:_t.missedCount+(r?0:1),confidenceStats:(0,s.A)((0,s.A)({},_t.confidenceStats),{},{[g]:_t.confidenceStats[g]+1})});if(Tt(y),localStorage.setItem("rnMasteryAnalytics",JSON.stringify(y)),Dt&&jp)try{const e=D[q];mu(dc(jp,"artifacts",Df,"public","data","analytics"),{uid:Dt.uid,questionId:e.id,chapterTitle:M.title,isCorrect:r,confidence:t,timeSpent:"ranked"===l?ue:null,timeMultiplier:"ranked"===l?h:null,rationaleCorrect:"ranked"===l&&e.requiresRationale?he===(e.correctRationaleIndex||0):null,rationaleTier:"ranked"===l&&e.requiresRationale?f:null,timestamp:vu()}).catch(e=>console.error("Analytics save error:",e))}catch(rm){console.error("Analytics error:",rm)}if(H(!0),console.log("\ud83d\udd0d Escalation Check:",{isDayToBeWrong:c,isCorrect:r,confLevel:t,suddenDeathActive:ut,competitiveMode:it,questionId:n.id,activeChapter:(null===M||void 0===M?void 0:M.id)||(null===M||void 0===M?void 0:M.chapterId),triggeredEscalations:nt}),c&&!r&&"TIMEOUT"!==t&&!ut&&"solo"===it){const e=Zt(n.id);if(console.log("\ud83d\udea8 Escalation triggered:",e),e&&!nt.includes(e)){console.log("\u2705 Inserting escalation into question queue:",e);const t=jf[e];if(t){const e=[...D.slice(0,q+1),t,...D.slice(q+1)];console.log("\ud83d\udccb Questions updated from",D.length,"to",e.length),F(e)}rt([...nt,e]),tt(et+1)}}ut&&!r&&"TIMEOUT"!==t&&(console.log("\ud83d\udc80 SUDDEN DEATH: Wrong answer - Game Over"),setTimeout(()=>{alert("\ud83d\udc80 SUDDEN DEATH\n\nOne mistake ends it all.\n\nFinal Score: "+G),a("summary")},2e3)),"team"!==it||r||console.log("\ud83d\udc65 TEAM MODE: Wrong answer affects team score")},Zt=e=>({ld_q01_mdro_moral_injury:"cdiff_outbreak",ld_q02_hiv_cd4_vs_viral_load:"hiv_crisis",ld_q04_priority_flip:"priority_code",ld_q05_needlestick_time:"needlestick_disaster"}[e]),en=()=>{if(console.log("\ud83d\udd04 nextQuestion called, moving to question",q+1,"of",D.length),q<D.length-1){if(U(q+1),Jt(),"ranked"===l&&q>0){const e=Math.round(Q/(q+1)*100);if(O(e),e<70&&q>=4)return alert("\u26a0\ufe0f Performance Alert\n\nYour current Rank Mode score is ".concat(e,"%.\n\nKeep practicing to improve your mastery!")),void a("menu")}}else{const e=Math.round(Q/D.length*100);if(Ue&&Be){if(e>=80){const t=(0,s.A)((0,s.A)({},He),{},{[Be]:!0});Ge(t),localStorage.setItem("rnMasteryRemediationCompleted",JSON.stringify(t)),qe(Fe.filter(e=>e!==Be)),alert("\u2705 Remediation Complete!\n\nYou scored ".concat(e,"% on ").concat(Be,".\n\n").concat(Fe.length>1?"Complete remaining remediation tasks to unlock Rank Mode.":"You can now access Rank Mode!"))}else alert("\ud83d\udcda Keep Practicing\n\nYou scored ".concat(e,"% on ").concat(Be," remediation.\n\nYou need 80% to complete remediation. Review the material and try again!"));return Ve(!1),ze(null),void a("menu")}e>=70&&(P({particleCount:100,spread:70,origin:{y:.6},colors:["#FFD700","#FFA500","#FF6B6B","#4ECDC4","#45B7D1"]}),100===e&&setTimeout(()=>{P({particleCount:150,spread:100,origin:{y:.5},colors:["#FFD700","#FFA500"]})},300)),a("summary")}},tn=async()=>{if(!({NODE_ENV:"production",PUBLIC_URL:"/Term-3-Gaming",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_GEMINI_API_KEY||""))return At("\ud83d\udca1 AI Tutor Feature\n\nTo enable AI-powered mnemonics and clinical pearls, set up a Google Gemini API key.\n\nGet your free API key at: https://aistudio.google.com/app/apikey\n\nFor now, review the rationale provided above to understand this concept!"),void jt(!1);jt(!0);const e=D[q],t='Context: Nursing Student Game - Clinical Pearls Focus. Question: "'.concat(e.text,'". Answer: "').concat(e.options[e.correctIndex],'". Rationale: "').concat(e.rationale,'". Task: Give a very short, memorable mnemonic AND a clinical pearl (real-world nursing insight) to help remember this concept in practice.'),n=await Lf(t);At(n),jt(!1)},nn=async()=>{if(!({NODE_ENV:"production",PUBLIC_URL:"/Term-3-Gaming",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_GEMINI_API_KEY||""))return void Ot("\ud83d\udcda AI Study Guide Feature\n\nTo enable AI-generated study guides, you need to set up a Google Gemini API key:\n\n1. Get a free API key at: https://aistudio.google.com/app/apikey\n2. Add it to your .env file:\n   REACT_APP_GEMINI_API_KEY=your_key_here\n3. Rebuild and redeploy\n\nFor the deployed version, the instructor needs to add the API key directly to the code or use a backend service.\n\nIn the meantime, use the download feature to export your quiz results and create your own study guide!");Lt(!0);const e='Create a high-yield study guide for: "'.concat(M.title,'". Include key concepts, clinical pearls, and NCLEX-style tips. Keep it concise (300 words max).'),t=await Lf(e);Ot(t),Lt(!1)},rn=()=>{if(!Pt)return;const e="AI STUDY GUIDE - ".concat(M.title,"\nGenerated: ").concat((new Date).toLocaleString(),"\n\n==============================================\nCHAPTER SUMMARY\n==============================================\n").concat(M.title,"\nScore: ").concat(G," | Accuracy: ").concat(Math.round(Q/D.length*100),"%\nQuestions Correct: ").concat(Q,"/").concat(D.length,"\n\n==============================================\nAI-GENERATED STUDY NOTES\n==============================================\n\n").concat(Pt,"\n\n==============================================\nMISSED QUESTIONS REVIEW\n==============================================\n\n").concat(Z.length>0?Z.map((e,t)=>"\nQuestion ".concat(e.questionNumber,":\n").concat(e.question.text,"\n\nYour Answer: ").concat(e.question.options[e.selectedAnswer],"\nCorrect Answer: ").concat(e.question.options[e.question.correctIndex],"\n\nRationale: ").concat(e.question.rationale,"\n\n---\n")).join("\n"):"No missed questions - Perfect score!","\n\n==============================================\n"),t=new Blob([e],{type:"text/plain"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="".concat(M.title.replace(/\s+/g,"_"),"_Study_Guide.txt"),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},sn=async()=>{if(qt.trim())if(Dt)if(zt.includes(M.title))alert("You have already submitted a score for this chapter!");else{Bt(!0);try{const t=Yt();console.log("Saving score to leaderboard:",{playerName:qt.trim(),score:G,chapterTitle:M.title,uid:Dt.uid,clinicalReasoningScore:null===t||void 0===t?void 0:t.total});const n={playerName:qt.trim(),score:G,chapterTitle:M.title,rank:(e=G,e<1e3?"Novice":e<2e3?"Apprentice":e<3e3?"Expert RN":"Clinical Legend \ud83d\udc51"),timestamp:vu(),uid:Dt.uid};"day-to-be-wrong"===M.id&&(n.mode=it,n.escalationLevel=et,n.resourcesPreserved=Object.values($e).reduce((e,t)=>e+t,0),"sudden-death"===it&&(n.survived=ht>0,n.questionsSurvived=Q),"team"===it&&at&&(n.teamName=at)),"ranked"===l&&t&&(n.clinicalReasoningScore=t.total,n.crsAccuracy=t.accuracy,n.crsRationale=t.rationale,n.crsTime=t.time),await mu(dc(jp,"artifacts",Df,"public","data","scores"),n),console.log("Score saved successfully!"),Ht([...zt,M.title]),Bt(!1),alert("Score submitted successfully! \ud83c\udf89"),a("leaderboard")}catch(t){console.error("Error saving score:",t),alert("Failed to save score: ".concat(t.message,". Please check your internet connection and try again.")),Bt(!1)}var e}else alert("Authentication required. Please wait a moment and try again.");else alert("Please enter your name before submitting!")},an=()=>(0,Vp.jsx)("div",{className:"min-h-screen bg-slate-900 text-white p-6 flex flex-col items-center justify-center font-sans",children:(0,Vp.jsxs)("div",{className:"max-w-5xl w-full animate-in fade-in zoom-in-95 duration-500",children:[t&&(0,Vp.jsxs)("button",{onClick:t,className:"mb-4 px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg flex items-center gap-2 transition",children:[(0,Vp.jsx)(p,{className:"w-4 h-4"}),"Back to Hub"]}),(0,Vp.jsxs)("header",{className:"text-center mb-8",children:[(0,Vp.jsxs)("h1",{className:"text-6xl font-black mb-2 tracking-tighter",children:[(0,Vp.jsx)("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-500",children:"RN"}),(0,Vp.jsx)("span",{className:"text-white",children:" MASTERY"})]}),(0,Vp.jsx)("p",{className:"text-slate-400 text-xl font-medium",children:"Classroom Edition v5.0"}),(0,Vp.jsx)("div",{className:"flex justify-center mt-6",children:(0,Vp.jsxs)("div",{className:"px-6 py-2 rounded-full font-bold flex items-center bg-purple-600 text-white shadow-lg shadow-purple-500/20",children:[(0,Vp.jsx)(f.A,{className:"w-4 h-4 mr-2"})," Ranked Mode"]})}),"ranked"===l&&(0,Vp.jsx)("p",{className:"text-slate-500 text-sm mt-3",children:"\ud83d\udd12 One-shot submission \u2022 High stakes scoring"})]}),Fe.length>0&&"ranked"===l&&(0,Vp.jsx)("div",{className:"mb-6 p-5 bg-gradient-to-r from-red-900/30 to-orange-900/30 border-2 border-red-500/50 rounded-2xl",children:(0,Vp.jsxs)("div",{className:"flex items-start gap-4",children:[(0,Vp.jsx)("div",{className:"w-12 h-12 bg-red-500/20 rounded-full flex items-center justify-center flex-shrink-0",children:(0,Vp.jsx)(o.A,{className:"w-6 h-6 text-red-400"})}),(0,Vp.jsxs)("div",{className:"flex-1",children:[(0,Vp.jsx)("h3",{className:"text-xl font-bold text-red-300 mb-2",children:"\u26a0\ufe0f Remediation Required"}),(0,Vp.jsx)("p",{className:"text-red-200 text-sm mb-3",children:"You've missed these concepts multiple times. Complete remediation to unlock Rank Mode:"}),(0,Vp.jsx)("div",{className:"space-y-2",children:Fe.map(e=>(0,Vp.jsxs)("div",{className:"flex items-center justify-between bg-slate-900/50 p-3 rounded-lg",children:[(0,Vp.jsx)("span",{className:"text-white font-semibold",children:e}),(0,Vp.jsx)("button",{onClick:()=>(e=>{const t=[...Ff,...Ae].flatMap(e=>Kp(e.questions||[])).filter(t=>t.concept===e);if(0===t.length)return void alert("No questions found for concept: ".concat(e));const n=Math.min(5,Math.max(3,t.length)),r=t.sort(()=>Math.random()-.5).slice(0,n);Ve(!0),ze(e),F(r),U(0),W(0),Y(0),J(0),$(0),ee([]),a("playing"),Jt(),alert("\ud83d\udcda Remediation: ".concat(e,"\n\nYou'll answer ").concat(n," questions to strengthen this concept.\n\nScore 80% or higher to complete remediation and unlock Rank Mode."))})(e),className:"px-4 py-2 bg-orange-600 hover:bg-orange-500 text-white rounded-lg font-bold text-sm transition-colors flex items-center gap-2",children:"\ud83d\udcda Start Remediation"})]},e))})]})]})}),(0,Vp.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Ff,...Ae].filter(e=>"day-to-be-wrong"!==(e.id||e.chapterId)||"ranked"===l).map(e=>{var t;const n=e.id||e.chapterId,r=zt.includes(e.title),i=!je.includes(n),s=Kt(n),a=(e=>!0===u[e])(n),o=i||"ranked"===l&&(!s||r);return(0,Vp.jsxs)("button",{disabled:o,onClick:()=>Qt(e),className:"p-6 rounded-2xl border flex flex-col items-center text-center transition-all group relative overflow-hidden ".concat(o?"bg-slate-800/50 border-slate-700 opacity-50 cursor-not-allowed":"bg-slate-800 border-slate-700 hover:border-cyan-500 hover:bg-slate-750"),children:[r&&(0,Vp.jsxs)("div",{className:"absolute top-2 right-2 bg-green-500/20 text-green-400 px-2 py-1 rounded-full text-xs font-bold flex items-center",children:[(0,Vp.jsx)(m,{className:"w-3 h-3 mr-1"})," Ranked"]}),i&&(0,Vp.jsxs)("div",{className:"absolute top-2 left-2 bg-red-500/20 text-red-400 px-2 py-1 rounded-full text-xs font-bold flex items-center",children:[(0,Vp.jsx)(g,{className:"w-3 h-3 mr-1"})," Locked"]}),(0,Vp.jsx)("div",{className:"p-4 rounded-xl mb-4 transition-transform group-hover:scale-110 ".concat("ranked"===l?"bg-purple-500/20 text-purple-400":"bg-emerald-500/20 text-emerald-400"),children:e.icon}),(0,Vp.jsx)("h3",{className:"font-bold text-lg text-white",children:e.title}),(0,Vp.jsxs)("div",{className:"text-xs text-slate-400 mt-1",children:[(null===(t=e.questions)||void 0===t?void 0:t.length)||25," Questions"]}),"ranked"===l&&(0,Vp.jsx)("div",{className:"mt-2 text-xs",children:a?(0,Vp.jsx)("span",{className:"text-green-400 font-semibold",children:"\u2713 Flashcards Reviewed"}):(0,Vp.jsx)("span",{className:"text-yellow-400 font-semibold",children:"\ud83d\udd12 Complete Flashcards First"})})]},n)})}),(0,Vp.jsxs)("div",{className:"mt-8 flex justify-center gap-4",children:[(0,Vp.jsxs)("button",{onClick:()=>a("leaderboard"),className:"text-slate-400 hover:text-white flex items-center text-sm transition",children:[(0,Vp.jsx)(y.A,{className:"w-4 h-4 mr-2"})," View Leaderboard"]}),(0,Vp.jsxs)("button",{onClick:()=>ke(!0),className:"text-slate-400 hover:text-white flex items-center text-sm transition",children:[(0,Vp.jsx)(v,{className:"w-4 h-4 mr-2"})," Instructor Mode"]})]})]})}),on=()=>{if("challenge"===it&&xt){const e=xt.getState(),t=e.phase,n=e.currentScenario;return n?t===Pf.JUDGE?(0,Vp.jsx)("div",{className:"min-h-screen bg-slate-900 text-white p-6",children:(0,Vp.jsx)(Sf,{gameState:e,onJudge:e=>{xt.judge(e),bt((0,s.A)({},xt))},onReveal:()=>{xt.revealAndScore(),bt((0,s.A)({},xt))}})}):t===Pf.REVEAL?(0,Vp.jsx)("div",{className:"min-h-screen bg-slate-900 text-white p-6",children:(0,Vp.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,Vp.jsxs)("h2",{className:"text-3xl font-black mb-6",children:["\ud83d\udcca Round ",e.round," Results"]}),(0,Vp.jsxs)("div",{className:"mb-6 p-6 bg-green-900/30 border-2 border-green-500 rounded-xl",children:[(0,Vp.jsx)("h3",{className:"text-xl font-bold text-green-400 mb-3",children:"\u2705 Correct Answer"}),(0,Vp.jsx)("p",{className:"text-lg mb-3",children:n.choices[n.correctIndex]}),(0,Vp.jsx)("p",{className:"text-slate-300",children:n.rationaleCorrect})]}),(0,Vp.jsxs)("div",{className:"mb-6 p-6 bg-slate-800 rounded-xl",children:[(0,Vp.jsx)("h3",{className:"text-xl font-bold mb-4",children:"\ud83c\udfc6 Current Standings"}),(0,Vp.jsx)("div",{className:"space-y-3",children:e.teams.sort((e,t)=>t.score-e.score).map((e,t)=>(0,Vp.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-700 rounded-lg",children:[(0,Vp.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Vp.jsx)("span",{className:"text-2xl",children:["\ud83e\udd47","\ud83e\udd48","\ud83e\udd49","4\ufe0f\u20e3"][t]}),(0,Vp.jsx)("span",{className:"font-bold",children:e.name})]}),(0,Vp.jsx)("span",{className:"text-2xl font-mono font-bold",children:e.score})]},e.id))})]}),(0,Vp.jsx)("button",{onClick:()=>{e.round<Mf.length?(xt.nextScenario(),bt((0,s.A)({},xt))):a("summary")},className:"w-full py-4 bg-yellow-500 hover:bg-yellow-400 rounded-xl font-black text-xl text-slate-900 transition",children:e.round<Mf.length?"\u27a1\ufe0f Next Round":"\ud83c\udfc1 View Final Results"})]})}):(0,Vp.jsx)("div",{className:"min-h-screen bg-slate-900 text-white p-6",children:(0,Vp.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,Vp.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("h2",{className:"text-2xl font-black",children:"\u2694\ufe0f Challenge Mode"}),(0,Vp.jsxs)("p",{className:"text-slate-400",children:["Round ",e.round," / ",Mf.length]})]}),(0,Vp.jsx)("button",{onClick:()=>{window.confirm("Exit Challenge Mode? Progress will be lost.")&&(bt(null),Et(!1),a("menu"))},className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition",children:"Exit"})]}),(0,Vp.jsx)("div",{className:"mb-6 p-4 bg-slate-800 rounded-xl",children:(0,Vp.jsx)("div",{className:"flex justify-around",children:e.teams.map(e=>(0,Vp.jsxs)("div",{className:"text-center",children:[(0,Vp.jsx)("div",{className:"font-bold",children:e.name}),(0,Vp.jsx)("div",{className:"text-2xl font-mono font-black",children:e.score})]},e.id))})}),(0,Vp.jsxs)("div",{className:"mb-6 p-6 bg-slate-800 rounded-xl",children:[(0,Vp.jsx)("h3",{className:"text-xl font-bold mb-4",children:n.prompt}),(0,Vp.jsx)("div",{className:"p-4 bg-slate-700 rounded-lg mb-4",children:(0,Vp.jsx)("p",{className:"text-slate-300",children:n.stem})}),t===Pf.QUESTION&&(0,Vp.jsxs)(Vp.Fragment,{children:[(0,Vp.jsx)("div",{className:"space-y-3 mb-6",children:n.choices.map((e,t)=>(0,Vp.jsxs)("div",{className:"w-full p-4 bg-slate-700 rounded-lg text-left",children:[(0,Vp.jsxs)("span",{className:"font-bold mr-3",children:[String.fromCharCode(65+t),"."]}),e]},t))}),(0,Vp.jsx)("div",{className:"text-center text-slate-400 text-sm",children:"\ud83d\udcf1 Teams: Submit your answers (simulated - click button below to proceed)"}),(0,Vp.jsx)("button",{onClick:()=>{xt.submitAnswer(e.teams[0].id,0),bt((0,s.A)({},xt))},className:"mt-4 w-full px-6 py-3 bg-blue-500 hover:bg-blue-400 rounded-lg font-bold transition",children:"Simulate Team Submissions (Testing)"})]}),t===Pf.ANSWER_LOCKED&&(0,Vp.jsxs)("div",{className:"text-center py-8",children:[(0,Vp.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\udd12"}),(0,Vp.jsx)("p",{className:"text-xl font-bold mb-2",children:"Answers Submitted"}),(0,Vp.jsx)("p",{className:"text-slate-400",children:"Instructor will open challenge window"}),(0,Vp.jsx)("button",{onClick:()=>{xt.openChallengeWindow(),bt((0,s.A)({},xt))},className:"mt-6 px-6 py-3 bg-yellow-500 hover:bg-yellow-400 rounded-lg font-bold text-slate-900 transition",children:"Open Challenge Window"})]}),t===Pf.CHALLENGE&&(0,Vp.jsxs)("div",{className:"text-center py-8",children:[(0,Vp.jsx)("div",{className:"text-4xl mb-4",children:"\u2694\ufe0f"}),(0,Vp.jsx)("p",{className:"text-xl font-bold mb-2",children:"Challenge Window Open"}),(0,Vp.jsx)("p",{className:"text-slate-400 mb-6",children:"Teams can submit challenges (simulated)"}),(0,Vp.jsx)("button",{onClick:()=>{xt.lockChallenges(),bt((0,s.A)({},xt))},className:"px-6 py-3 bg-red-500 hover:bg-red-400 rounded-lg font-bold transition",children:"Lock Challenges & Review"})]})]})]})}):(0,Vp.jsx)("div",{className:"min-h-screen bg-slate-900 text-white p-6 flex items-center justify-center",children:(0,Vp.jsxs)("div",{className:"text-center",children:[(0,Vp.jsx)("div",{className:"text-6xl mb-4",children:"\u2694\ufe0f"}),(0,Vp.jsx)("p",{className:"text-xl font-bold",children:"Loading Challenge Mode..."}),(0,Vp.jsxs)("p",{className:"text-sm text-slate-400 mt-2",children:["Debug: Phase = ",t]})]})})}if(!D||0===D.length||q>=D.length)return(0,Vp.jsx)("div",{className:"min-h-screen bg-slate-900 text-white p-6 flex items-center justify-center",children:(0,Vp.jsxs)("div",{className:"text-center",children:[(0,Vp.jsx)("div",{className:"text-4xl mb-4",children:"\u23f3"}),(0,Vp.jsx)("p",{className:"text-xl",children:"Loading questions..."})]})});const e=D[q],t=function(e){const{skill:t,concept:n}=e;return null!==t&&void 0!==t&&t.includes("TEACHING_ERROR")?"\ud83d\udca1 Exam Tip: 'Further teaching needed' = find the UNSAFE or INCORRECT statement.":null!==t&&void 0!==t&&t.includes("MED_SAFETY")?"\ud83d\udca1 Exam Tip: Medication questions are SAFETY questions. Think harm prevention first.":null!==t&&void 0!==t&&t.includes("PRIORITY")?"\ud83d\udca1 Exam Tip: Use ABC, Maslow, Safety first. Prevent harm > Comfort.":null!==t&&void 0!==t&&t.includes("SEQUENCING")?"\ud83d\udca1 Exam Tip: Follow proper order: Assessment before intervention, emergencies first.":null!==t&&void 0!==t&&t.includes("LAB_INTERPRETATION")?"\ud83d\udca1 Exam Tip: Know normal ranges. High/Low triggers action. Relate labs to symptoms.":null!==t&&void 0!==t&&t.includes("INFECTION_CONTROL")?"\ud83d\udca1 Exam Tip: Hand hygiene is #1. Know isolation types. PPE order matters.":"ANAPHYLAXIS"===n?"\ud83d\udca1 Exam Tip: Anaphylaxis = EPINEPHRINE first, always. Airway is life.":"C_DIFF"===n?"\ud83d\udca1 Exam Tip: C. diff = SOAP & WATER only. Alcohol doesn't kill spores.":"HIV_PROGRESSION"===n||"ANTIRETROVIRAL_THERAPY"===n?"\ud83d\udca1 Exam Tip: ART adherence >95%. Undetectable = Untransmittable (U=U).":"GOUT"===n?"\ud83d\udca1 Exam Tip: Gout = uric acid crystals. Colchicine for acute, Allopurinol prevents.":"RHEUMATOID_ARTHRITIS"===n?"\ud83d\udca1 Exam Tip: RA = symmetrical, morning stiffness >1hr, systemic. Methotrexate is gold standard.":"APPLICATION"===e.bloom?"\ud83d\udca1 Exam Tip: Application questions test your clinical judgment. Think 'What would I do?'":"\ud83d\udca1 Exam Tip: Read carefully, eliminate wrong answers, trust your nursing judgment."}(e);return(0,Vp.jsxs)("div",{className:"min-h-screen bg-slate-900 text-white flex flex-col font-sans",children:[(0,Vp.jsxs)("div",{className:"p-6 flex justify-between items-center border-b border-slate-800 bg-slate-900/90 backdrop-blur sticky top-0 z-10",children:[(0,Vp.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Vp.jsx)("button",{onClick:()=>a("menu"),className:"text-slate-400 hover:text-white transition",children:"Exit"}),Ue&&(0,Vp.jsxs)("div",{className:"px-3 py-1 rounded-full bg-orange-500/20 border border-orange-500 text-xs font-bold text-orange-300 flex items-center gap-2",children:["\ud83d\udcda Remediation: ",Be]}),e.concept&&!Ue&&(0,Vp.jsx)("div",{className:"px-3 py-1 rounded-full bg-slate-800 border border-slate-700 text-xs font-bold text-slate-300",children:e.concept.replace(/_/g," ")}),"ranked"===l&&!Ue&&(0,Vp.jsxs)("div",{className:"px-3 py-1 rounded-full border text-xs font-bold ".concat(le<=10?"bg-red-500/20 border-red-500 text-red-400 animate-pulse":le<=20?"bg-yellow-500/20 border-yellow-500 text-yellow-400":"bg-slate-800 border-slate-700 text-slate-300"),children:["\u23f1\ufe0f ",le,"s"]}),ut&&(0,Vp.jsx)("div",{className:"px-3 py-1 rounded-full bg-red-500/30 border-2 border-red-500 text-xs font-bold text-red-300 flex items-center gap-2 animate-pulse",children:"\ud83d\udc80 SUDDEN DEATH - 1 LIFE"}),"team"===it&&at&&(0,Vp.jsxs)("div",{className:"px-3 py-1 rounded-full bg-purple-500/20 border border-purple-500 text-xs font-bold text-purple-300 flex items-center gap-2",children:["\ud83d\udc65 Team: ",at]}),("day-to-be-wrong"===(null===M||void 0===M?void 0:M.id)||"day-to-be-wrong"===(null===M||void 0===M?void 0:M.chapterId))&&!ut&&(0,Vp.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Vp.jsxs)("div",{className:"px-2 py-1 rounded-md border text-xs font-bold ".concat($e.isolationRooms>0?"bg-blue-500/20 border-blue-500 text-blue-300":"bg-slate-700/50 border-slate-600 text-slate-500 line-through"),children:["\ud83d\udeaa ISO: ",$e.isolationRooms]}),(0,Vp.jsxs)("div",{className:"px-2 py-1 rounded-md border text-xs font-bold ".concat($e.emergencyPasses>0?"bg-red-500/20 border-red-500 text-red-300":"bg-slate-700/50 border-slate-600 text-slate-500 line-through"),children:["\ud83d\udea8 PASS: ",$e.emergencyPasses]}),(0,Vp.jsxs)("div",{className:"px-2 py-1 rounded-md border text-xs font-bold ".concat($e.providerCalls>0?"bg-purple-500/20 border-purple-500 text-purple-300":"bg-slate-700/50 border-slate-600 text-slate-500 line-through"),children:["\ud83d\udcde MD: ",$e.providerCalls]})]})]}),(0,Vp.jsxs)("div",{className:"flex items-center gap-6",children:[(0,Vp.jsxs)("div",{className:"flex items-center font-bold ".concat(K>2?"text-orange-400 animate-pulse":"text-slate-500"),children:[(0,Vp.jsx)(x,{className:"w-5 h-5 mr-1"})," ",K]}),(0,Vp.jsx)("div",{className:"font-mono text-xl font-black text-white",children:G})]})]}),(0,Vp.jsxs)("div",{className:"flex-1 max-w-3xl mx-auto w-full p-8 flex flex-col justify-center",children:[(0,Vp.jsxs)("div",{className:"mb-2 text-slate-500 text-sm font-bold",children:["Question ",q+1," / ",D.length,et>0&&(0,Vp.jsxs)("span",{className:"ml-2 px-2 py-0.5 bg-red-500/20 border border-red-500 text-red-400 rounded text-xs font-bold",children:["\ud83d\udea8 ESCALATION LEVEL ",et]})]}),e.requiresResource&&0===$e[e.requiresResource]&&(0,Vp.jsx)("div",{className:"mb-4 p-4 bg-red-900/30 border-2 border-red-500 rounded-xl",children:(0,Vp.jsxs)("div",{className:"flex items-center gap-3 text-red-300",children:[(0,Vp.jsx)(o.A,{className:"w-5 h-5 shrink-0"}),(0,Vp.jsxs)("div",{className:"text-sm font-semibold",children:["\u26a0\ufe0f This question requires a ",(0,Vp.jsx)("span",{className:"font-bold",children:e.requiresResource.replace(/([A-Z])/g," $1").toUpperCase()})," but you've already used it! Choose the best alternative."]})]})}),(0,Vp.jsx)("h2",{className:"text-2xl md:text-3xl font-bold leading-relaxed mb-2",children:e.text}),e.isMultiSelect&&(0,Vp.jsx)("div",{className:"mb-6",children:(0,Vp.jsx)("span",{className:"text-sm font-semibold bg-purple-500/20 text-purple-300 px-3 py-1.5 rounded-full border border-purple-500/30 inline-block",children:"\u2713 SELECT ALL THAT APPLY"})}),e.scenario&&(0,Vp.jsx)("div",{className:"mb-6 p-4 bg-slate-800/50 border border-slate-700 rounded-xl",children:(0,Vp.jsx)("div",{className:"text-sm text-slate-300 whitespace-pre-line leading-relaxed",children:e.scenario})}),(0,Vp.jsx)("div",{className:"grid gap-3 mb-8",children:e.options.map((t,n)=>{if(re.includes(n))return null;const r="string"===typeof t?t:String(t),i=e.isMultiSelect?Array.isArray(V)&&V.includes(n):V===n;let s="p-5 rounded-xl border-2 text-left font-medium transition-all w-full flex items-center ";if(z){s+=(e.isMultiSelect?Array.isArray(e.correctIndex)&&e.correctIndex.includes(n):n===e.correctIndex)?"bg-green-500/20 border-green-500 text-green-100":i?"bg-red-500/20 border-red-500 text-red-100":"bg-slate-800 border-slate-700 opacity-50"}else s+=i?"bg-cyan-500/20 border-cyan-500 text-white":"bg-slate-800 border-slate-700 hover:border-cyan-500 hover:bg-slate-750";const a="ranked"===l&&fe;return(0,Vp.jsxs)("button",{disabled:z||a,onClick:()=>{if(!a)if(e.isMultiSelect){const e=Array.isArray(V)?V:[];e.includes(n)?B(e.filter(e=>e!==n)):B([...e,n])}else B(n)},className:s+(a?" cursor-not-allowed opacity-75":""),children:[(0,Vp.jsx)("div",{className:"w-8 h-8 rounded-".concat(e.isMultiSelect?"lg":"full"," bg-slate-700 flex items-center justify-center mr-4 text-sm font-bold text-slate-300 shrink-0 ").concat(i&&!z?"bg-cyan-500 text-white":""),children:e.isMultiSelect&&i?"\u2713":String.fromCharCode(65+n)}),r]},n)})}),z?(0,Vp.jsxs)("div",{className:"bg-slate-800 border border-slate-700 rounded-2xl p-6 animate-in fade-in zoom-in-95",children:[(0,Vp.jsxs)("div",{className:"flex items-start gap-4 mb-6",children:[V===e.correctIndex?(0,Vp.jsx)(m,{className:"w-8 h-8 text-green-400 shrink-0"}):(0,Vp.jsx)(w,{className:"w-8 h-8 text-red-400 shrink-0"}),(0,Vp.jsxs)("div",{className:"flex-1",children:[(0,Vp.jsx)("h3",{className:"text-lg font-bold mb-1 ".concat(V===e.correctIndex?"text-green-400":"text-red-400"),children:V===e.correctIndex?"Correct!":null===V?"Time's Up!":"Incorrect"}),"ranked"===l&&"TIMEOUT"===ae&&(0,Vp.jsx)("div",{className:"mb-3",children:(0,Vp.jsxs)("div",{className:"flex items-center gap-2 text-orange-400 text-sm bg-orange-500/10 border border-orange-500/30 rounded-lg p-3",children:[(0,Vp.jsx)(I,{className:"w-4 h-4"}),(0,Vp.jsx)("span",{className:"font-semibold",children:"\u23f1\ufe0f Time expired - No points awarded. Try to answer faster next time!"})]})}),Je&&("day-to-be-wrong"===(null===M||void 0===M?void 0:M.id)||"day-to-be-wrong"===(null===M||void 0===M?void 0:M.chapterId))&&(0,Vp.jsx)("div",{className:"mb-4",children:(0,Vp.jsx)("div",{className:"p-4 rounded-xl border-2 ".concat(V===e.correctIndex?"bg-green-900/20 border-green-500/40 text-green-100":"bg-red-900/30 border-red-500/50 text-red-100"),children:(0,Vp.jsxs)("div",{className:"flex items-start gap-3",children:[(0,Vp.jsx)(N.A,{className:"w-5 h-5 shrink-0 mt-0.5"}),(0,Vp.jsxs)("div",{className:"flex-1",children:[(0,Vp.jsx)("div",{className:"text-xs font-bold uppercase tracking-wider mb-1 opacity-80",children:"Consequence"}),(0,Vp.jsx)("div",{className:"text-sm leading-relaxed whitespace-pre-line",children:Je}),e.hardMode&&e.penalties&&V!==e.correctIndex&&(0,Vp.jsxs)("div",{className:"mt-3 pt-3 border-t border-red-500/30",children:[(0,Vp.jsx)("div",{className:"text-xs font-bold uppercase tracking-wider mb-2 text-red-200",children:"Penalty Breakdown:"}),(0,Vp.jsxs)("div",{className:"text-xs space-y-1",children:[(0,Vp.jsxs)("div",{children:["\u274c Wrong Priority: ",e.penalties.wrong," points"]}),ue>.75*e.timeLimit&&(0,Vp.jsxs)("div",{children:["\u23f1\ufe0f Delayed Decision: ",e.penalties.delayed," points"]}),e.penalties.secondaryHarm&&(0,Vp.jsxs)("div",{children:["\u26a0\ufe0f Secondary Harm: ",e.penalties.secondaryHarm," points"]}),(0,Vp.jsxs)("div",{className:"pt-2 border-t border-red-500/20 font-bold text-red-300",children:["Total Impact: ",(e.penalties.wrong||0)+(ue>.75*e.timeLimit&&e.penalties.delayed||0)+(e.penalties.secondaryHarm||0)," points"]})]})]}),e.requiresResource&&V===e.correctIndex&&(0,Vp.jsx)("div",{className:"mt-3 pt-3 border-t border-green-500/30",children:(0,Vp.jsxs)("div",{className:"flex items-center gap-2 text-xs font-bold text-green-300",children:[(0,Vp.jsx)(m,{className:"w-4 h-4"}),(0,Vp.jsxs)("span",{children:["Used: ",e.requiresResource.replace(/([A-Z])/g," $1").toUpperCase()]})]})})]})]})})}),"ranked"===l&&V===e.correctIndex&&"TIMEOUT"!==ae&&(0,Vp.jsx)("div",{className:"mb-3",children:ue<3?(0,Vp.jsxs)("div",{className:"flex items-center gap-2 text-red-400 text-sm bg-red-500/10 border border-red-500/30 rounded-lg p-3",children:[(0,Vp.jsx)(o.A,{className:"w-4 h-4"}),(0,Vp.jsxs)("span",{className:"font-semibold",children:["\u26a0\ufe0f RUSH ANSWER! (",ue,"s) - Severe 70% penalty applied. Read carefully!"]})]}):ue<=15?(0,Vp.jsxs)("div",{className:"flex items-center gap-2 text-green-400 text-sm",children:[(0,Vp.jsx)(E.A,{className:"w-4 h-4"}),(0,Vp.jsxs)("span",{className:"font-semibold",children:["Excellent timing! (",ue,"s) - Bonus points earned \ud83c\udfaf"]})]}):ue<=22?(0,Vp.jsxs)("div",{className:"flex items-center gap-2 text-blue-400 text-sm",children:[(0,Vp.jsx)(S,{className:"w-4 h-4"}),(0,Vp.jsxs)("span",{className:"font-semibold",children:["Good pace (",ue,"s) - Full points awarded"]})]}):ue<=30?(0,Vp.jsxs)("div",{className:"flex items-center gap-2 text-orange-400 text-sm",children:[(0,Vp.jsx)(S,{className:"w-4 h-4"}),(0,Vp.jsxs)("span",{className:"font-semibold",children:["Close call (",ue,"s) - Small time penalty"]})]}):(0,Vp.jsxs)("div",{className:"flex items-center gap-2 text-red-400 text-sm",children:[(0,Vp.jsx)(S,{className:"w-4 h-4"}),(0,Vp.jsxs)("span",{className:"font-semibold",children:["Overtime (",ue,"s) - Score penalty applied"]})]})}),"ranked"===l&&ve&&(0,Vp.jsx)("div",{className:"mb-3",children:"correct"===ve?(0,Vp.jsxs)("div",{className:"flex items-center gap-2 text-green-400 text-sm bg-green-500/10 border border-green-500/30 rounded-lg p-3",children:[(0,Vp.jsx)(m,{className:"w-4 h-4"}),(0,Vp.jsx)("span",{className:"font-semibold",children:"Excellent reasoning! Full points for clinical judgment \u2713"})]}):"weak"===ve?(0,Vp.jsxs)("div",{className:"flex items-center gap-2 text-yellow-400 text-sm bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-3",children:[(0,Vp.jsx)(o.A,{className:"w-4 h-4"}),(0,Vp.jsx)("span",{className:"font-semibold",children:"Partial credit - Reasoning shows surface understanding but lacks depth"})]}):(0,Vp.jsxs)("div",{className:"flex items-center gap-2 text-red-400 text-sm bg-red-500/10 border border-red-500/30 rounded-lg p-3",children:[(0,Vp.jsx)(w,{className:"w-4 h-4"}),(0,Vp.jsx)("span",{className:"font-semibold",children:"Incorrect reasoning - Zero points. Right answer requires right rationale!"})]})}),"ranked"===l&&ve&&(0,Vp.jsx)("div",{className:"mb-3",children:"correct"===ve?(0,Vp.jsxs)("div",{className:"flex items-center gap-2 text-green-400 text-sm bg-green-500/10 border border-green-500/30 rounded-lg p-3",children:[(0,Vp.jsx)(m,{className:"w-4 h-4"}),(0,Vp.jsx)("span",{className:"font-semibold",children:"Excellent reasoning! Full points for clinical judgment \u2713"})]}):"weak"===ve?(0,Vp.jsxs)("div",{className:"flex items-center gap-2 text-yellow-400 text-sm bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-3",children:[(0,Vp.jsx)(o.A,{className:"w-4 h-4"}),(0,Vp.jsx)("span",{className:"font-semibold",children:"Partial credit - Reasoning shows surface understanding but lacks depth"})]}):(0,Vp.jsxs)("div",{className:"flex items-center gap-2 text-red-400 text-sm bg-red-500/10 border border-red-500/30 rounded-lg p-3",children:[(0,Vp.jsx)(w,{className:"w-4 h-4"}),(0,Vp.jsx)("span",{className:"font-semibold",children:"Incorrect reasoning - Zero points. Right answer requires right rationale!"})]})}),(0,Vp.jsx)("p",{className:"text-slate-300 leading-relaxed mb-4",children:e.rationale}),t&&(0,Vp.jsxs)("div",{className:"bg-blue-900/20 border border-blue-500/30 p-4 rounded-xl flex gap-3 items-start",children:[(0,Vp.jsx)(C,{className:"w-5 h-5 text-blue-400 shrink-0 mt-0.5"}),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("div",{className:"text-xs font-bold text-blue-400 uppercase tracking-wider mb-1",children:"NCLEX Strategy"}),(0,Vp.jsx)("p",{className:"text-sm text-blue-200 font-medium",children:t})]})]})]})]}),(0,Vp.jsxs)("div",{className:"flex justify-between items-center pt-4 border-t border-slate-700",children:["ranked"!==l&&(0,Vp.jsx)(Vp.Fragment,{children:kt?(0,Vp.jsxs)("div",{className:"text-sm text-purple-300 flex items-start",children:[(0,Vp.jsx)(T,{className:"w-3 h-3 mr-1 mt-0.5 shrink-0"}),(0,Vp.jsx)("span",{children:kt})]}):(0,Vp.jsxs)("button",{onClick:tn,disabled:Rt,className:"text-sm text-purple-400 hover:text-purple-300 flex items-center transition",children:[Rt?(0,Vp.jsx)(_,{className:"w-4 h-4 mr-2 animate-spin"}):(0,Vp.jsx)(T,{className:"w-4 h-4 mr-2"}),"Get Mnemonic"]})}),"ranked"===l&&(0,Vp.jsx)("div",{})," ",(0,Vp.jsxs)("button",{onClick:en,className:"px-6 py-3 bg-white text-slate-900 font-bold rounded-xl hover:bg-slate-200 transition-colors flex items-center ml-auto",children:["Next ",(0,Vp.jsx)(k,{className:"ml-2 w-4 h-4"})]})]})]}):(0,Vp.jsxs)(Vp.Fragment,{children:[fe&&"ranked"===l&&e.rationaleOptions&&e.rationaleOptions.length>0&&(0,Vp.jsxs)("div",{className:"mb-6 p-6 bg-purple-900/20 border border-purple-500/30 rounded-xl",children:[(0,Vp.jsx)("h3",{className:"text-lg font-bold text-purple-300 mb-4",children:"Select Your Reasoning:"}),(0,Vp.jsx)("div",{className:"grid gap-2",children:e.rationaleOptions.map((e,t)=>(0,Vp.jsxs)("button",{onClick:()=>pe(t),className:"p-3 rounded-lg text-left text-sm border-2 transition-all ".concat(he===t?"bg-purple-500/20 border-purple-500 text-white":"bg-slate-800 border-slate-700 hover:border-purple-500 text-slate-300"),children:[String.fromCharCode(65+t),". ",e]},t))})]}),(0,Vp.jsxs)("div",{className:"flex gap-4",children:["ranked"!==l&&(0,Vp.jsx)("button",{onClick:Xt,disabled:te,className:"p-4 bg-slate-800 hover:bg-slate-700 text-purple-400 border border-slate-700 rounded-xl font-bold transition-all disabled:opacity-50 disabled:cursor-not-allowed",title:"50/50 Lifeline",children:(0,Vp.jsx)(b,{className:"w-6 h-6"})}),fe&&null===he?(0,Vp.jsx)("div",{className:"flex-1 py-4 bg-purple-600/20 border-2 border-purple-500 text-purple-300 rounded-xl font-bold text-center",children:"Select a rationale to continue"}):(0,Vp.jsxs)(Vp.Fragment,{children:[(0,Vp.jsx)("button",{onClick:()=>$t(V,"GUESS"),disabled:e.isMultiSelect?!Array.isArray(V)||0===V.length:null===V,className:"flex-1 py-4 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded-xl font-bold transition-all disabled:opacity-50",children:"I'm Guessing \ud83e\udd14"}),(0,Vp.jsx)("button",{onClick:()=>$t(V,"SURE"),disabled:e.isMultiSelect?!Array.isArray(V)||0===V.length:null===V,className:"flex-1 py-4 bg-blue-600 hover:bg-blue-500 text-white rounded-xl font-bold transition-all shadow-lg shadow-blue-900/20 disabled:opacity-50",children:"I'm Sure! \ud83d\ude80"})]})]})]})]})]})},ln=()=>{const e=Math.round(Q/D.length*100),t=zt.includes(M.title),n=Yt();return(0,Vp.jsx)("div",{className:"min-h-screen bg-slate-900 text-white flex flex-col items-center justify-center p-6 font-sans",children:(0,Vp.jsxs)("div",{className:"max-w-md w-full bg-slate-800 border border-slate-700 rounded-3xl p-8 text-center shadow-2xl animate-in fade-in zoom-in-95",children:[(0,Vp.jsx)("div",{className:"w-20 h-20 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg shadow-orange-500/50",children:(0,Vp.jsx)(f.A,{className:"w-10 h-10 text-white"})}),(0,Vp.jsx)("h2",{className:"text-3xl font-black mb-2",children:"MODULE COMPLETE"}),(0,Vp.jsx)("div",{className:"text-slate-400 mb-8 font-bold",children:M.title}),(0,Vp.jsxs)("div",{className:"grid ".concat("ranked"===l?"grid-cols-3":"grid-cols-2"," gap-4 mb-8"),children:[(0,Vp.jsxs)("div",{className:"p-4 bg-slate-900 rounded-2xl border border-slate-700",children:[(0,Vp.jsx)("div",{className:"text-4xl font-black text-white",children:G}),(0,Vp.jsx)("div",{className:"text-xs font-bold text-slate-500 uppercase mt-1",children:"Score"})]}),(0,Vp.jsxs)("div",{className:"p-4 bg-slate-900 rounded-2xl border border-slate-700",children:[(0,Vp.jsxs)("div",{className:"text-4xl font-black ".concat(e>=80?"text-green-400":e>=70?"text-yellow-400":"text-orange-400"),children:[e,"%"]}),(0,Vp.jsx)("div",{className:"text-xs font-bold text-slate-500 uppercase mt-1",children:"Accuracy"})]}),"ranked"===l&&n&&(0,Vp.jsxs)("div",{className:"p-4 bg-gradient-to-br from-purple-900/30 to-blue-900/30 rounded-2xl border-2 border-purple-500/50",children:[(0,Vp.jsx)("div",{className:"text-4xl font-black ".concat(n.total>=80?"text-purple-300":n.total>=70?"text-blue-300":"text-slate-300"),children:n.total}),(0,Vp.jsx)("div",{className:"text-xs font-bold text-purple-400 uppercase mt-1",children:"CRS"})]})]}),"ranked"===l&&n&&(0,Vp.jsxs)("div",{className:"mb-6 p-4 bg-purple-900/10 border border-purple-500/30 rounded-xl",children:[(0,Vp.jsxs)("div",{className:"text-sm font-bold text-purple-300 mb-3 flex items-center justify-center gap-2",children:[(0,Vp.jsx)(d.A,{className:"w-4 h-4"}),"Clinical Reasoning Score Breakdown"]}),(0,Vp.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[(0,Vp.jsxs)("div",{className:"p-2 bg-slate-900/50 rounded-lg",children:[(0,Vp.jsxs)("div",{className:"font-bold text-green-400",children:[n.accuracy,"/40"]}),(0,Vp.jsx)("div",{className:"text-slate-400",children:"Accuracy"})]}),(0,Vp.jsxs)("div",{className:"p-2 bg-slate-900/50 rounded-lg",children:[(0,Vp.jsxs)("div",{className:"font-bold text-blue-400",children:[n.rationale,"/40"]}),(0,Vp.jsx)("div",{className:"text-slate-400",children:"Reasoning"})]}),(0,Vp.jsxs)("div",{className:"p-2 bg-slate-900/50 rounded-lg",children:[(0,Vp.jsxs)("div",{className:"font-bold text-purple-400",children:[n.time,"/20"]}),(0,Vp.jsx)("div",{className:"text-slate-400",children:"Timing"})]})]}),(0,Vp.jsxs)("div",{className:"text-xs text-slate-400 mt-2",children:["Avg time: ",n.avgTime,"s/question"]})]}),"ranked"===l&&Ye>=3&&(0,Vp.jsx)("div",{className:"mb-6 p-4 bg-red-900/20 border border-red-500/50 rounded-xl",children:(0,Vp.jsxs)("div",{className:"flex items-center gap-3 text-red-300",children:[(0,Vp.jsx)(o.A,{className:"w-5 h-5 flex-shrink-0"}),(0,Vp.jsxs)("div",{className:"text-sm",children:[(0,Vp.jsx)("div",{className:"font-bold mb-1",children:"\u26a0\ufe0f Anti-Memorization Alert"}),(0,Vp.jsxs)("div",{className:"text-red-200",children:["You rushed through ",Ye," questions (","<","3s each). Slow down and read carefully to demonstrate true understanding."]})]})]})}),(0,Vp.jsx)("div",{className:"mb-6",children:Pt?(0,Vp.jsxs)(Vp.Fragment,{children:[(0,Vp.jsxs)("div",{className:"bg-purple-900/20 border border-purple-500/30 p-4 rounded-xl text-left max-h-40 overflow-y-auto mb-3",children:[(0,Vp.jsx)("div",{className:"text-xs text-purple-300 font-bold mb-2",children:"AI STUDY NOTES:"}),(0,Vp.jsx)("p",{className:"text-sm text-slate-300 whitespace-pre-wrap",children:Pt})]}),(0,Vp.jsxs)("button",{onClick:rn,className:"w-full py-3 bg-blue-600/20 border border-blue-500/50 text-blue-300 rounded-xl font-bold hover:bg-blue-600/30 transition-colors flex items-center justify-center",children:[(0,Vp.jsx)(A,{className:"w-4 h-4 mr-2"}),"\ud83d\udcbe Download Study Guide"]})]}):(0,Vp.jsxs)("button",{onClick:nn,disabled:Mt,className:"w-full py-3 bg-purple-600/20 border border-purple-500/50 text-purple-300 rounded-xl font-bold hover:bg-purple-600/30 transition-colors flex items-center justify-center",children:[Mt?(0,Vp.jsx)(_,{className:"w-4 h-4 mr-2 animate-spin"}):(0,Vp.jsx)(T,{className:"w-4 h-4 mr-2"}),"Generate Study Guide"]})}),"ranked"===l&&(0,Vp.jsxs)("div",{className:"mb-4",children:[(0,Vp.jsxs)("div",{className:"mb-3 flex items-center justify-center gap-2 text-xs",children:[(0,Vp.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(Gt.authenticated?"bg-green-400":Gt.initializing?"bg-yellow-400 animate-pulse":Gt.connected?"bg-yellow-400":"bg-red-400")}),(0,Vp.jsx)("span",{className:"text-slate-400",children:Gt.authenticated?"Ready to submit":Gt.initializing?"Connecting to server...":Gt.connected?"Authenticating...":"Offline - scores cannot be saved"})]}),t?(0,Vp.jsxs)("div",{className:"bg-yellow-500/10 border border-yellow-500/30 p-4 rounded-xl",children:[(0,Vp.jsx)(g,{className:"w-5 h-5 text-yellow-400 mx-auto mb-2"}),(0,Vp.jsx)("p",{className:"text-yellow-400 font-bold text-sm",children:"Score already submitted"})]}):(0,Vp.jsxs)("div",{className:"bg-slate-900 border border-slate-700 p-4 rounded-xl",children:[(0,Vp.jsx)("h3",{className:"text-white font-bold mb-3 text-sm",children:"Submit to Leaderboard"}),Gt.initializing&&(0,Vp.jsxs)("p",{className:"text-yellow-400 text-xs mb-2 flex items-center justify-center gap-2",children:[(0,Vp.jsx)(_,{className:"w-3 h-3 animate-spin"}),"Initializing connection..."]}),!Gt.authenticated&&!Gt.initializing&&Gt.connected&&(0,Vp.jsx)("p",{className:"text-yellow-400 text-xs mb-2",children:"\u23f3 Authenticating..."}),!Gt.connected&&(0,Vp.jsx)("p",{className:"text-red-400 text-xs mb-2",children:"\u26a0\ufe0f Not connected to server. Check your internet connection."}),(0,Vp.jsxs)("div",{className:"flex gap-2",children:[(0,Vp.jsx)("input",{type:"text",placeholder:"Your Name",value:qt,onChange:e=>Ut(e.target.value),className:"flex-1 bg-slate-800 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-cyan-500 text-sm",disabled:!Gt.authenticated}),(0,Vp.jsx)("button",{onClick:sn,disabled:Vt||!qt.trim()||!Gt.authenticated,className:"bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg px-4 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed transition",title:Gt.initializing?"Connecting...":Gt.authenticated?qt.trim()?"Submit score":"Enter your name first":"Waiting for authentication...",children:Vt?(0,Vp.jsx)(_,{className:"w-4 h-4 animate-spin"}):(0,Vp.jsx)(R,{className:"w-4 h-4"})})]})]})]}),(0,Vp.jsx)("button",{onClick:()=>a("menu"),className:"w-full py-4 bg-slate-700 hover:bg-slate-600 text-white font-bold rounded-xl transition-all",children:"Return to Menu"})]})})},cn=()=>{const[e,t]=(0,r.useState)([]),[n,i]=(0,r.useState)("all");(0,r.useEffect)(()=>{if(!jp)return;var e;const n=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,s,a;e=ie(e);let o={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||fc(n[l])||(o=n[l],l++);const c={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(fc(n[l])){const e=n[l];n[l]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[l+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),n[l+2]=null===(a=e.complete)||void 0===a?void 0:a.bind(e)}let u,d,h;if(e instanceof cc)d=rc(e.firestore,mc),h=ci(e._key.path),u={next:t=>{n[l]&&n[l](yu(d,e,t))},error:n[l+1],complete:n[l+2]};else{const t=rc(e,lc);d=rc(t.firestore,mc),h=t._query;const r=new pu(d);u={next:e=>{n[l]&&n[l](new du(d,r,t,e))},error:n[l+1],complete:n[l+2]},Yc(e._query)}return function(e,t,n,r){const i=new Bl(r),s=new ul(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>rl(await Ql(e),s)),()=>{i.Za(),e.asyncQueue.enqueueAndForget(async()=>il(await Ql(e),s))}}(gc(d),h,c,u)}(Xc(dc(jp,"artifacts",Df,"public","data","scores"),(ic("limit",e=100),nu._create("limit",e,"F"))),e=>{const n=e.docs.map(e=>(0,s.A)({id:e.id},e.data()));n.sort((e,t)=>t.score-e.score),t(n)});return()=>n()},[]);const o=(()=>{let t=e.filter(e=>"\u2696\ufe0f A Day to be Wrong"===e.chapterTitle);switch(n){case"safest-unit":return t.filter(e=>void 0!==e.escalationLevel).sort((e,t)=>e.escalationLevel===t.escalationLevel?t.score-e.score:e.escalationLevel-t.escalationLevel).slice(0,20);case"resource-master":return t.filter(e=>void 0!==e.resourcesPreserved).sort((e,t)=>e.resourcesPreserved===t.resourcesPreserved?t.score-e.score:t.resourcesPreserved-e.resourcesPreserved).slice(0,20);case"sudden-death":return t.filter(e=>"sudden-death"===e.mode&&!0===e.survived).sort((e,t)=>t.questionsSurvived-e.questionsSurvived).slice(0,20);default:return t.slice(0,50)}})();return(0,Vp.jsx)("div",{className:"min-h-screen bg-slate-900 text-white p-6 flex flex-col items-center font-sans",children:(0,Vp.jsxs)("div",{className:"max-w-4xl w-full",children:[(0,Vp.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,Vp.jsxs)("h2",{className:"text-3xl font-black flex items-center",children:[(0,Vp.jsx)(y.A,{className:"w-8 h-8 mr-3 text-yellow-400"})," LEADERBOARD"]}),(0,Vp.jsx)("button",{onClick:()=>a("menu"),className:"text-slate-400 hover:text-white transition",children:"Back"})]}),(0,Vp.jsxs)("div",{className:"mb-6 flex gap-3 flex-wrap",children:[(0,Vp.jsx)("button",{onClick:()=>i("all"),className:"px-4 py-2 rounded-lg font-bold text-sm transition ".concat("all"===n?"bg-cyan-500 text-white":"bg-slate-800 text-slate-400 hover:bg-slate-700"),children:"\ud83c\udfc6 All Scores"}),(0,Vp.jsx)("button",{onClick:()=>i("safest-unit"),className:"px-4 py-2 rounded-lg font-bold text-sm transition ".concat("safest-unit"===n?"bg-green-500 text-white":"bg-slate-800 text-slate-400 hover:bg-slate-700"),children:"\ud83d\udee1\ufe0f Safest Unit"}),(0,Vp.jsx)("button",{onClick:()=>i("resource-master"),className:"px-4 py-2 rounded-lg font-bold text-sm transition ".concat("resource-master"===n?"bg-blue-500 text-white":"bg-slate-800 text-slate-400 hover:bg-slate-700"),children:"\ud83d\udc8e Resource Master"}),(0,Vp.jsx)("button",{onClick:()=>i("sudden-death"),className:"px-4 py-2 rounded-lg font-bold text-sm transition ".concat("sudden-death"===n?"bg-red-500 text-white":"bg-slate-800 text-slate-400 hover:bg-slate-700"),children:"\ud83d\udc80 Sudden Death Survivors"})]}),(0,Vp.jsxs)("div",{className:"mb-4 p-4 bg-slate-800/50 border border-slate-700 rounded-xl text-sm text-slate-300",children:["all"===n&&"\ud83c\udfc6 Top scores across all game modes","safest-unit"===n&&"\ud83d\udee1\ufe0f Players who triggered the fewest escalations","resource-master"===n&&"\ud83d\udc8e Players who preserved the most resources","sudden-death"===n&&"\ud83d\udc80 Hall of Fame: Players who survived all 5 questions without a single mistake"]}),(0,Vp.jsx)("div",{className:"space-y-2",children:0===o.length?(0,Vp.jsxs)("div",{className:"text-center py-12 text-slate-400",children:[(0,Vp.jsx)("p",{className:"text-lg",children:"No scores yet in this category"}),(0,Vp.jsx)("p",{className:"text-sm mt-2",children:"Be the first to make the leaderboard!"})]}):o.map((e,t)=>(0,Vp.jsxs)("div",{className:"bg-slate-800 p-4 rounded-xl flex items-center border border-slate-700 hover:border-slate-600 transition",children:[(0,Vp.jsxs)("div",{className:"w-8 font-bold ".concat(0===t?"text-yellow-400":1===t?"text-slate-400":2===t?"text-orange-600":"text-slate-500"),children:["#",t+1]}),(0,Vp.jsxs)("div",{className:"flex-1 ml-4",children:[(0,Vp.jsxs)("div",{className:"font-bold text-white flex items-center gap-2",children:[e.playerName,"sudden-death"===e.mode&&(0,Vp.jsx)("span",{className:"text-red-400 text-xs",children:"\ud83d\udc80"}),"team"===e.mode&&(0,Vp.jsx)("span",{className:"text-purple-400 text-xs",children:"\ud83d\udc65"})]}),(0,Vp.jsxs)("div",{className:"text-xs text-slate-400 flex items-center gap-3 mt-1",children:[(0,Vp.jsx)("span",{children:e.chapterTitle}),"safest-unit"===n&&void 0!==e.escalationLevel&&(0,Vp.jsxs)("span",{className:"text-green-400",children:["\ud83d\udee1\ufe0f ",e.escalationLevel," escalations"]}),"resource-master"===n&&void 0!==e.resourcesPreserved&&(0,Vp.jsxs)("span",{className:"text-blue-400",children:["\ud83d\udc8e ",e.resourcesPreserved,"/3 resources"]}),"sudden-death"===n&&void 0!==e.questionsSurvived&&(0,Vp.jsxs)("span",{className:"text-red-400",children:["\ud83d\udc80 ",e.questionsSurvived,"/5 perfect"]})]})]}),(0,Vp.jsx)("div",{className:"text-cyan-400 font-mono font-bold text-lg",children:e.score})]},e.id))})]})})};if(Te)return(0,Vp.jsx)(If,{onExit:()=>{ke(!1),jp&&(fu(dc(jp,"customChapters")).then(e=>{const t=[];e.forEach(e=>{t.push((0,s.A)((0,s.A)({},e.data()),{},{id:e.id}))}),Re(t)}),fu(dc(jp,"settings")).then(e=>{const t=e.docs.find(e=>"chapterAccess"===e.id);t&&Pe(t.data().unlocked||[])}))}});const un=()=>{const[e,t]=(0,r.useState)(""),[n,i]=(0,r.useState)(!1),s=t=>{var r;if("team"===t&&!n)return void i(!0);if("team"===t&&!e.trim())return void alert("Please enter a team name!");st(t),"sudden-death"===t&&(dt(!0),pt(1)),"team"===t&&ot(e.trim());const s=Ff.find(e=>"day-to-be-wrong"===e.id),o=Kp(s.questions);L(s),F(o),U(0),W(0),Y(0),J(0),$(0),ee([]),ye([]),Qe(0),Xe(null),Ze({isolationRooms:1,emergencyPasses:1,providerCalls:1}),tt(0),rt([]),vt(!1),a("playing"),Jt(),null!==(r=o[0])&&void 0!==r&&r.timeLimit?ce(o[0].timeLimit):ce(60),de(0)};return(0,Vp.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white flex items-center justify-center p-6",children:(0,Vp.jsxs)("div",{className:"max-w-4xl w-full",children:[(0,Vp.jsx)("button",{onClick:()=>{vt(!1),a("menu")},className:"mb-6 text-slate-400 hover:text-white transition flex items-center",children:"\u2190 Back to Menu"}),(0,Vp.jsxs)("div",{className:"text-center mb-12",children:[(0,Vp.jsx)("div",{className:"text-6xl mb-4",children:"\u2696\ufe0f"}),(0,Vp.jsx)("h1",{className:"text-4xl font-black mb-3",children:"A Day to be Wrong"}),(0,Vp.jsx)("p",{className:"text-lg text-slate-300",children:"Choose Your Challenge Mode"})]}),n&&(0,Vp.jsxs)("div",{className:"mb-8 p-6 bg-purple-900/30 border-2 border-purple-500 rounded-2xl",children:[(0,Vp.jsx)("h3",{className:"text-xl font-bold mb-4 text-purple-300",children:"\ud83d\udc65 Enter Team Name"}),(0,Vp.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"e.g., Night Shift Warriors, Code Blue Crew",className:"w-full px-4 py-3 bg-slate-800 border border-purple-500 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-purple-400 mb-4",maxLength:30,autoFocus:!0}),(0,Vp.jsxs)("div",{className:"flex gap-3",children:[(0,Vp.jsx)("button",{onClick:()=>{i(!1),t("")},className:"flex-1 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg font-bold transition",children:"Cancel"}),(0,Vp.jsx)("button",{onClick:()=>s("team"),className:"flex-1 py-2 bg-purple-500 hover:bg-purple-400 rounded-lg font-bold transition",children:"Start Battle \u2192"})]})]}),(0,Vp.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,Vp.jsxs)("button",{onClick:()=>s("solo"),className:"bg-slate-800 border-2 border-cyan-500 rounded-2xl p-8 hover:bg-slate-750 transition-all group",children:[(0,Vp.jsx)("div",{className:"text-5xl mb-4",children:"\ud83c\udfaf"}),(0,Vp.jsx)("h3",{className:"text-2xl font-bold mb-3",children:"Solo Mission"}),(0,Vp.jsx)("p",{className:"text-slate-400 text-sm mb-4",children:"Full escalation system. Every mistake triggers a crisis."}),(0,Vp.jsxs)("div",{className:"text-xs text-slate-500 space-y-1",children:[(0,Vp.jsx)("div",{children:"\u2022 5 base questions"}),(0,Vp.jsx)("div",{children:"\u2022 Up to 4 escalations"}),(0,Vp.jsx)("div",{children:"\u2022 3 limited resources"}),(0,Vp.jsx)("div",{children:"\u2022 Maximum 9 questions"})]}),(0,Vp.jsx)("div",{className:"mt-6 px-4 py-2 bg-cyan-500/20 text-cyan-300 rounded-lg text-sm font-bold",children:"Classic Mode"})]}),(0,Vp.jsxs)("button",{onClick:()=>s("team"),className:"bg-slate-800 border-2 border-purple-500 rounded-2xl p-8 hover:bg-slate-750 transition-all group relative overflow-hidden",children:[(0,Vp.jsx)("div",{className:"absolute top-2 right-2 bg-purple-500 text-white px-2 py-1 rounded-full text-xs font-bold",children:"COMPETITIVE"}),(0,Vp.jsx)("div",{className:"text-5xl mb-4",children:"\ud83d\udc65"}),(0,Vp.jsx)("h3",{className:"text-2xl font-bold mb-3",children:"Team Relay"}),(0,Vp.jsx)("p",{className:"text-slate-400 text-sm mb-4",children:"Pass questions between teammates. Collaborate strategically!"}),(0,Vp.jsxs)("div",{className:"text-xs text-slate-500 space-y-1",children:[(0,Vp.jsx)("div",{children:"\u2022 2-4 players take turns"}),(0,Vp.jsx)("div",{children:"\u2022 Can pass tough questions"}),(0,Vp.jsx)("div",{children:"\u2022 Shared resource pool"}),(0,Vp.jsx)("div",{children:"\u2022 Team completion time"})]}),(0,Vp.jsx)("div",{className:"mt-6 px-4 py-2 bg-purple-500/20 text-purple-300 rounded-lg text-sm font-bold",children:"Multiplayer"})]}),(0,Vp.jsxs)("button",{onClick:()=>s("sudden-death"),className:"bg-slate-800 border-2 border-red-500 rounded-2xl p-8 hover:bg-slate-750 transition-all group relative overflow-hidden",children:[(0,Vp.jsx)("div",{className:"absolute top-2 right-2 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold animate-pulse",children:"EXTREME"}),(0,Vp.jsx)("div",{className:"text-5xl mb-4",children:"\ud83d\udc80"}),(0,Vp.jsx)("h3",{className:"text-2xl font-bold mb-3",children:"Sudden Death"}),(0,Vp.jsx)("p",{className:"text-slate-400 text-sm mb-4",children:"One mistake and you're out. Ultimate high-stakes challenge."}),(0,Vp.jsxs)("div",{className:"text-xs text-slate-500 space-y-1",children:[(0,Vp.jsx)("div",{children:"\u2022 1 life only"}),(0,Vp.jsx)("div",{children:"\u2022 No escalations"}),(0,Vp.jsx)("div",{children:"\u2022 Instant elimination"}),(0,Vp.jsx)("div",{children:"\u2022 Hall of survivors"})]}),(0,Vp.jsx)("div",{className:"mt-6 px-4 py-2 bg-red-500/20 text-red-300 rounded-lg text-sm font-bold",children:"Expert Only"})]}),(0,Vp.jsxs)("button",{onClick:()=>{Et(!0),vt(!1)},className:"bg-slate-800 border-2 border-yellow-500 rounded-2xl p-8 hover:bg-slate-750 transition-all group relative overflow-hidden",children:[(0,Vp.jsx)("div",{className:"absolute top-2 right-2 bg-yellow-500 text-slate-900 px-2 py-1 rounded-full text-xs font-bold",children:"CLASSROOM"}),(0,Vp.jsx)("div",{className:"text-5xl mb-4",children:"\u2694\ufe0f"}),(0,Vp.jsx)("h3",{className:"text-2xl font-bold mb-3",children:"Challenge Mode"}),(0,Vp.jsx)("p",{className:"text-slate-400 text-sm mb-4",children:"Team battle with trap challenges. Instructor judges disputes."}),(0,Vp.jsxs)("div",{className:"text-xs text-slate-500 space-y-1",children:[(0,Vp.jsx)("div",{children:"\u2022 2-4 teams compete"}),(0,Vp.jsx)("div",{children:"\u2022 Challenge wrong answers"}),(0,Vp.jsx)("div",{children:"\u2022 Explain the trap"}),(0,Vp.jsx)("div",{children:"\u2022 Instructor decides"})]}),(0,Vp.jsx)("div",{className:"mt-6 px-4 py-2 bg-yellow-500/20 text-yellow-300 rounded-lg text-sm font-bold",children:"Instructor-Led"})]})]}),(0,Vp.jsx)("div",{className:"mt-8 text-center text-sm text-slate-400",children:(0,Vp.jsx)("p",{children:"\ud83d\udca1 Tip: Start with Solo Mode to learn the mechanics before trying competitive modes"})})]})})},dn=()=>{const e=()=>{St.trim()?wt.length>=4?alert("Maximum 4 teams allowed!"):(It([...wt,{id:"team-".concat(Date.now()),name:St.trim()}]),Ct("")):alert("Please enter a team name!")};return(0,Vp.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-yellow-900 to-slate-900 text-white flex items-center justify-center p-6",children:(0,Vp.jsxs)("div",{className:"max-w-3xl w-full",children:[(0,Vp.jsx)("button",{onClick:()=>{Et(!1),vt(!0)},className:"mb-6 text-slate-400 hover:text-white transition flex items-center",children:"\u2190 Back to Mode Select"}),(0,Vp.jsxs)("div",{className:"text-center mb-8",children:[(0,Vp.jsx)("div",{className:"text-6xl mb-4",children:"\u2694\ufe0f"}),(0,Vp.jsx)("h1",{className:"text-4xl font-black mb-3",children:"Challenge Mode Lobby"}),(0,Vp.jsx)("p",{className:"text-lg text-slate-300",children:"Set up teams for competitive battle"})]}),(0,Vp.jsxs)("div",{className:"mb-6 p-6 bg-yellow-900/30 border-2 border-yellow-500 rounded-2xl",children:[(0,Vp.jsx)("h3",{className:"text-xl font-bold mb-4 text-yellow-300",children:"\u2795 Add Team"}),(0,Vp.jsxs)("div",{className:"flex gap-3",children:[(0,Vp.jsx)("input",{type:"text",value:St,onChange:e=>Ct(e.target.value),onKeyPress:t=>"Enter"===t.key&&e(),placeholder:"Team name (e.g., Code Blue Crew)",className:"flex-1 px-4 py-3 bg-slate-800 border border-yellow-500 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-yellow-400",maxLength:30}),(0,Vp.jsx)("button",{onClick:e,className:"px-6 py-3 bg-yellow-500 hover:bg-yellow-400 rounded-lg font-bold transition text-slate-900",children:"Add Team"})]})]}),(0,Vp.jsxs)("div",{className:"mb-6 p-6 bg-slate-800 rounded-2xl",children:[(0,Vp.jsxs)("h3",{className:"text-xl font-bold mb-4 flex items-center justify-between",children:[(0,Vp.jsxs)("span",{children:["\ud83d\udc65 Teams (",wt.length,"/4)"]}),wt.length>=2&&(0,Vp.jsx)("span",{className:"text-sm text-green-400",children:"\u2713 Ready to start"})]}),0===wt.length?(0,Vp.jsx)("p",{className:"text-slate-400 text-center py-8",children:"No teams yet. Add at least 2 teams to begin."}):(0,Vp.jsx)("div",{className:"space-y-3",children:wt.map((e,t)=>(0,Vp.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-700 rounded-lg",children:[(0,Vp.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Vp.jsx)("div",{className:"text-2xl",children:["\ud83d\udd34","\ud83d\udd35","\ud83d\udfe2","\ud83d\udfe1"][t]}),(0,Vp.jsx)("span",{className:"font-bold text-lg",children:e.name})]}),(0,Vp.jsx)("button",{onClick:()=>{return t=e.id,void It(wt.filter(e=>e.id!==t));var t},className:"px-3 py-1 text-sm bg-red-500/20 text-red-400 hover:bg-red-500/30 rounded transition",children:"Remove"})]},e.id))})]}),(0,Vp.jsx)("button",{onClick:()=>{if(wt.length<2)return void alert("At least 2 teams required!");const e=function(){let{teams:e=[],scenarios:t=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Array.isArray(e)||e.length<2)throw new Error("Challenge mode needs at least 2 teams.");if(!Array.isArray(t)||0===t.length)throw new Error("No scenarios provided.");const n={phase:Pf.LOBBY,round:0,scenarioIndex:-1,teams:e.map(e=>({id:e.id,name:e.name,score:0})),currentScenario:null,submissions:{},challenges:[],judgeDecision:null};function r(e){const t=n.teams.find(t=>t.id===e);if(!t)throw new Error("Unknown teamId: ".concat(e));return t}function i(){var e,t;let{allowReveal:r=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=n.currentScenario,a=i?(0,s.A)({id:i.id,title:i.title?Of(i.title):"",prompt:i.prompt,stem:i.stem,choices:i.choices,difficulty:null!==(e=i.difficulty)&&void 0!==e?e:1,timerSeconds:null!==(t=i.timerSeconds)&&void 0!==t?t:60},r?{correctIndex:i.correctIndex,rationaleCorrect:Of(i.rationaleCorrect||""),rationaleWrong:Array.isArray(i.rationaleWrong)?i.rationaleWrong.map(Of):[],consequenceIfWrong:Of(i.consequenceIfWrong||"")}:{}):null;return{phase:n.phase,round:n.round,scenarioIndex:n.scenarioIndex,teams:n.teams.map(e=>(0,s.A)({},e)),currentScenario:a,submissions:(0,s.A)({},n.submissions),challenges:n.challenges.map(e=>(0,s.A)({},e)),judgeDecision:n.judgeDecision?(0,s.A)({},n.judgeDecision):null}}return{getState:()=>i({allowReveal:n.phase===Pf.REVEAL}),nextScenario:function(){n.round+=1,n.scenarioIndex=(n.scenarioIndex+1)%t.length;const e=t[n.scenarioIndex],r=(0,s.A)((0,s.A)({},e),{},{prompt:Of(e.prompt),stem:Of(e.stem),choices:(e.choices||[]).map(e=>Of(e))});return n.currentScenario=r,n.submissions={},n.challenges=[],n.judgeDecision=null,n.phase=Pf.QUESTION,i()},submitAnswer:function(e,t){if(![Pf.QUESTION,Pf.ANSWER_LOCKED].includes(n.phase))throw new Error("Cannot submit during phase ".concat(n.phase));const r=n.currentScenario;if(!r)throw new Error("No active scenario.");if("number"!==typeof t||t<0||t>=r.choices.length)throw new Error("Invalid choiceIndex.");if(n.submissions[e])throw new Error("This team already submitted.");return n.submissions[e]={choiceIndex:t,submittedAt:Date.now()},n.phase=Pf.ANSWER_LOCKED,i()},openChallengeWindow:function(){if(n.phase!==Pf.ANSWER_LOCKED)throw new Error("Challenge window can open only after at least one submission.");return n.phase=Pf.CHALLENGE,i()},challengeAnswer:function(e){let{challengerTeamId:t,targetTeamId:r,trapText:s,alternativeIndex:a}=e;if(n.phase!==Pf.CHALLENGE)throw new Error("Cannot challenge during phase ".concat(n.phase));if(t===r)throw new Error("Cannot challenge your own team.");if(!n.submissions[r])throw new Error("Target team has not submitted.");const o=n.currentScenario;if(!o)throw new Error("No active scenario.");const l=Of(s);if(!l||l.length<5)throw new Error("Trap explanation is too short.");if("number"!==typeof a||a<0||a>=o.choices.length)throw new Error("Invalid alternativeIndex.");if(n.challenges.find(e=>e.challengerTeamId===t&&e.targetTeamId===r))throw new Error("This challenge already exists.");return n.challenges.push({challengerTeamId:t,targetTeamId:r,trapText:l,alternativeIndex:a,createdAt:Date.now()}),i()},lockChallenges:function(){if(n.phase!==Pf.CHALLENGE)throw new Error("Not in challenge phase.");return n.phase=Pf.JUDGE,i()},judge:function(e){let{type:t,challengerTeamId:r,targetTeamId:s,note:a=""}=e;if(n.phase!==Pf.JUDGE)throw new Error("Cannot judge during phase ".concat(n.phase));return n.judgeDecision={type:t,challengerTeamId:r,targetTeamId:s,note:Of(a)},i()},revealAndScore:function(){if(![Pf.JUDGE,Pf.ANSWER_LOCKED].includes(n.phase))throw new Error("Reveal allowed after judge, or after answer lock if you skip challenges.");const e=n.currentScenario;if(!e)throw new Error("No active scenario.");const t=10,s=-10,a=8,o=-5,l=0,c=e.correctIndex,u=e=>{var t;return(null===(t=n.submissions[e])||void 0===t?void 0:t.choiceIndex)===c};for(const i of Object.keys(n.submissions))r(i).score+=u(i)?t:s;const d=n.judgeDecision;if("CHALLENGE_SUCCESS"===(null===d||void 0===d?void 0:d.type)&&d.challengerTeamId&&d.targetTeamId){r(d.challengerTeamId).score+=a;const e=r(d.targetTeamId);n.submissions[d.targetTeamId]&&u(d.targetTeamId)&&(e.score-=t,e.score+=l)}else"CHALLENGE_FAIL"===(null===d||void 0===d?void 0:d.type)&&d.challengerTeamId?r(d.challengerTeamId).score+=o:null===d||void 0===d||d.type;return n.phase=Pf.REVEAL,i({allowReveal:!0})}}}({teams:wt,scenarios:Mf});console.log("\ud83c\udfae Challenge game created:",e),e.nextScenario(),console.log("\ud83c\udfae First scenario loaded, state:",e.getState()),bt(e),st("challenge"),Et(!1),a("playing"),console.log("\ud83c\udfae Challenge Mode started!")},disabled:wt.length<2,className:"w-full py-4 rounded-xl font-black text-xl transition ".concat(wt.length>=2?"bg-yellow-500 hover:bg-yellow-400 text-slate-900":"bg-slate-700 text-slate-500 cursor-not-allowed"),children:wt.length<2?"Need at least 2 teams":"\u2694\ufe0f Start Challenge Battle"}),(0,Vp.jsxs)("div",{className:"mt-6 p-4 bg-slate-800/50 rounded-lg text-sm text-slate-400",children:[(0,Vp.jsx)("p",{className:"font-bold text-slate-300 mb-2",children:"How Challenge Mode Works:"}),(0,Vp.jsxs)("ul",{className:"space-y-1 list-disc list-inside",children:[(0,Vp.jsx)("li",{children:"Each round shows a clinical scenario with 4 answer choices"}),(0,Vp.jsx)("li",{children:"All teams submit their answers simultaneously (hidden from others)"}),(0,Vp.jsx)("li",{children:"Teams can challenge opponents' answers by explaining the trap"}),(0,Vp.jsx)("li",{children:"Instructor reviews challenges and makes final judgments"}),(0,Vp.jsx)("li",{children:"Points: +10 correct, -10 wrong, +8 challenge success, -5 challenge fail"})]})]})]})})};return Nt?(0,Vp.jsx)(dn,{}):yt?(0,Vp.jsx)(un,{}):"menu"===i?(0,Vp.jsx)(an,{}):"playing"===i?(0,Vp.jsx)(on,{}):"summary"===i?(0,Vp.jsx)(ln,{}):"leaderboard"===i?(0,Vp.jsx)(cn,{}):(0,Vp.jsx)(an,{})}const Uf=(0,h.A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var Vf=n(574);const Bf=[{id:"ch18",title:"Ch 18: Immune Assessment",description:"Anatomy, function, and assessment.",iconName:"Shield"},{id:"ch19",title:"Ch 19: Immune Disorders",description:"Hypersensitivities & Autoimmunity.",iconName:"AlertCircle"},{id:"ch20",title:"Ch 20: Connective Tissue",description:"RA, Lupus, Gout, Scleroderma.",iconName:"Bone"},{id:"ch21",title:"Ch 21: MDROs",description:"Transmission & Infection Control.",iconName:"Bug"},{id:"ch22",title:"Ch 22: HIV/AIDS",description:"Etiology, Progression, Management.",iconName:"Activity"},{id:"quiz1",title:"Review for Quiz 1",description:"Mixed Review: Chapters 18-22.",iconName:"Brain"}];function zf(){if(console.log("chapterManager: getChapterMetadata called"),console.log("chapterManager: chaptersConfig type:",typeof Bf),console.log("chapterManager: chaptersConfig isArray:",Array.isArray(Bf)),console.log("chapterManager: chaptersConfig value:",Bf),!Bf||!Array.isArray(Bf))return console.warn("Chapters config not loaded"),[];const e=Bf.map(e=>(0,s.A)((0,s.A)({},e),{},{IconComponent:(0,Vf.sW)(e.iconName)}));return console.log("chapterManager: Returning chapters:",e),e}function Hf(e){let{onSelectGame:t,onSettings:i,userName:a}=e;const[o,l]=(0,r.useState)([]),[c,u]=(0,r.useState)([]),[d,h]=(0,r.useState)(0),[f,m]=(0,r.useState)(null),[g,y]=(0,r.useState)(!0),[x,b]=(0,r.useState)(null);(0,r.useEffect)(()=>{w()},[]);const w=async()=>{try{y(!0);const{getCategories:e,getAllGames:t,getGamesByCategory:r}=await Promise.resolve().then(n.bind(n,574)),i=(e()||[]).map(e=>(0,s.A)((0,s.A)({},e),{},{games:r(e.id)}));l(i);const a=t();u(a||[]);const o=zf();h((null===o||void 0===o?void 0:o.length)||0),y(!1)}catch(e){console.error("Error loading hub:",e),b(e.message),y(!1)}};f&&c.filter(e=>e.category===f);return g?(0,Vp.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 text-white flex items-center justify-center",children:(0,Vp.jsxs)("div",{className:"text-center",children:[(0,Vp.jsx)("div",{className:"inline-block animate-spin rounded-full h-16 w-16 border-4 border-white border-t-transparent mb-4"}),(0,Vp.jsx)("p",{className:"text-xl",children:"Loading Hub..."})]})}):x?(0,Vp.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-red-900 via-purple-900 to-pink-900 text-white flex items-center justify-center p-6",children:(0,Vp.jsxs)("div",{className:"max-w-2xl bg-red-800/50 backdrop-blur p-8 rounded-lg",children:[(0,Vp.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"\u26a0\ufe0f Error Loading Hub"}),(0,Vp.jsx)("p",{className:"mb-4 text-lg",children:x}),(0,Vp.jsx)("button",{onClick:w,className:"px-6 py-3 bg-white text-red-900 rounded-lg hover:bg-gray-100 font-semibold",children:"Try Again"})]})}):(0,Vp.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 text-white",children:[(0,Vp.jsx)("div",{className:"bg-black/30 backdrop-blur-sm border-b border-white/10",children:(0,Vp.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-4 flex items-center justify-between",children:[(0,Vp.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Vp.jsx)(p,{className:"w-8 h-8"}),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("h1",{className:"text-2xl font-bold",children:"Nursing Education Hub"}),(0,Vp.jsx)("p",{className:"text-sm text-white/70",children:"Choose your learning path"})]})]}),(0,Vp.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Vp.jsxs)("div",{className:"text-right",children:[(0,Vp.jsx)("p",{className:"text-sm text-white/70",children:"Chapters Available"}),(0,Vp.jsx)("p",{className:"text-2xl font-bold",children:d})]}),a&&(0,Vp.jsxs)("div",{className:"flex items-center gap-2 bg-white/10 px-4 py-2 rounded-lg",children:[(0,Vp.jsx)(Uf,{className:"w-5 h-5"}),(0,Vp.jsx)("span",{children:a})]}),(0,Vp.jsx)("button",{onClick:i,className:"p-2 hover:bg-white/10 rounded-lg transition",children:(0,Vp.jsx)(v,{className:"w-6 h-6"})})]})]})}),(0,Vp.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-12",children:[(0,Vp.jsxs)("div",{className:"flex gap-3 mb-8 overflow-x-auto pb-2",children:[(0,Vp.jsx)("button",{onClick:()=>m(null),className:"px-6 py-2 rounded-full font-semibold whitespace-nowrap transition ".concat(null===f?"bg-white text-purple-900":"bg-white/10 hover:bg-white/20"),children:"All Games"}),o.map(e=>(0,Vp.jsxs)("button",{onClick:()=>m(e.id),className:"px-6 py-2 rounded-full font-semibold whitespace-nowrap transition flex items-center gap-2 ".concat(f===e.id?"bg-white text-purple-900":"bg-white/10 hover:bg-white/20"),children:[(0,Vp.jsx)(e.IconComponent,{className:"w-4 h-4"}),e.title]},e.id))]}),o.filter(e=>!f||e.id===f).map(e=>(0,Vp.jsxs)("div",{className:"mb-12",children:[(0,Vp.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,Vp.jsx)(e.IconComponent,{className:"w-8 h-8"}),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("h2",{className:"text-3xl font-bold",children:e.title}),(0,Vp.jsx)("p",{className:"text-white/70",children:e.description})]})]}),(0,Vp.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.games.map(e=>(0,Vp.jsxs)("button",{onClick:()=>(e=>{t(e)})(e),className:"bg-gradient-to-br ".concat(e.color," p-6 rounded-2xl shadow-2xl hover:scale-105 transition-all duration-300 text-left relative overflow-hidden group"),children:[(0,Vp.jsx)("div",{className:"absolute inset-0 opacity-10",children:(0,Vp.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle, white 1px, transparent 1px)",backgroundSize:"20px 20px"}})}),(0,Vp.jsxs)("div",{className:"relative z-10",children:[(0,Vp.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,Vp.jsx)(e.IconComponent,{className:"w-12 h-12"}),e.specialMode&&(0,Vp.jsx)("span",{className:"px-2 py-1 bg-yellow-400 text-yellow-900 text-xs font-bold rounded",children:"SPECIAL"})]}),(0,Vp.jsx)("h3",{className:"text-2xl font-bold mb-2",children:e.title}),(0,Vp.jsx)("p",{className:"text-white/90 mb-4",children:e.description}),(0,Vp.jsx)("div",{className:"flex flex-wrap gap-2",children:e.modes.map(e=>(0,Vp.jsx)("span",{className:"px-3 py-1 bg-black/20 rounded-full text-sm font-semibold",children:e},e))}),e.supportsDynamicChapters&&(0,Vp.jsxs)("div",{className:"mt-4 text-sm text-white/80 flex items-center gap-2",children:[(0,Vp.jsx)("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),"Supports all ",d," chapters"]})]}),(0,Vp.jsx)("div",{className:"absolute inset-0 bg-white/0 group-hover:bg-white/10 transition-all duration-300"})]},e.id))})]},e.id)),0===o.length&&(0,Vp.jsx)("div",{className:"text-center py-20",children:(0,Vp.jsx)("p",{className:"text-2xl text-white/50",children:"Loading games..."})})]}),(0,Vp.jsx)("div",{className:"bg-black/30 backdrop-blur-sm border-t border-white/10 mt-20",children:(0,Vp.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-8 text-center text-white/50",children:[(0,Vp.jsx)("p",{children:"\ud83c\udf93 Nursing Education Platform"}),(0,Vp.jsx)("p",{className:"text-sm mt-2",children:"Add new games and chapters without coding - just edit JSON files!"})]})})]})}const Gf={Shield:"\ud83d\udee1\ufe0f",AlertCircle:"\u26a0\ufe0f",Bone:"\ud83e\uddb4",Bug:"\ud83e\udda0",Activity:"\ud83d\udcca",Brain:"\ud83e\udde0",Scale:"\u2696\ufe0f",Heart:"\u2764\ufe0f",Stethoscope:"\ud83e\ude7a"},Wf=[{id:"ch18",title:"Ch 18: Immune Assessment",description:"Anatomy, function, and assessment.",iconName:"Shield"},{id:"ch19",title:"Ch 19: Immune Disorders",description:"Hypersensitivities & Autoimmunity.",iconName:"AlertCircle"},{id:"ch20",title:"Ch 20: Connective Tissue",description:"RA, Lupus, Gout, Scleroderma.",iconName:"Bone"},{id:"ch21",title:"Ch 21: MDROs",description:"Transmission & Infection Control.",iconName:"Bug"},{id:"ch22",title:"Ch 22: HIV/AIDS",description:"Etiology, Progression, Management.",iconName:"Activity"},{id:"quiz1",title:"Review for Quiz 1",description:"Mixed Review: Chapters 18-22.",iconName:"Brain"}];function Kf(e){let{onBackToHub:t}=e;const[n,i]=(0,r.useState)("chapter-select"),[s,a]=(0,r.useState)(null),[o,l]=(0,r.useState)([]),[c,u]=(0,r.useState)([]),[d,h]=(0,r.useState)(0),[p,f]=(0,r.useState)(!1),[m,g]=(0,r.useState)([]),[y,v]=(0,r.useState)([]),[x,b]=(0,r.useState)([]),[w,I]=(0,r.useState)(!1),[N,E]=(0,r.useState)(!0),[S,C]=(0,r.useState)(null),[_,T]=(0,r.useState)([]);(0,r.useEffect)(()=>{k()},[]);const k=async()=>{try{E(!0),console.log("FlashcardMode: Starting to load chapters..."),Up._initialized||(console.log("FlashcardMode: Initializing question loader..."),await Up.initialize()),console.log("FlashcardMode: Getting chapter metadata...");let e=zf();console.log("FlashcardMode: Loaded chapters:",e),console.log("FlashcardMode: Chapter count:",e.length),e&&0!==e.length||(console.warn("FlashcardMode: No chapters from config, using fallback"),e=Wf),l(e),E(!1)}catch(S){console.error("FlashcardMode: Error loading chapters:",S),l(Wf),E(!1)}},A=e=>{const t=[...e];for(let n=t.length-1;n>0;n--){const e=Math.floor(Math.random()*(n+1));[t[n],t[e]]=[t[e],t[n]]}return t},R=()=>{f(!p)},j=()=>{const e=c[d];m.includes(e.id)||g([...m,e.id]),M()},P=()=>{const e=c[d];y.includes(e.id)||v([...y,e.id]),M()},O=()=>{const e=c[d];x.includes(e.id)||b([...x,e.id]),M()},M=()=>{if(f(!1),d<c.length-1)h(d+1);else{if(null!==s&&void 0!==s&&s.id){const e=JSON.parse(localStorage.getItem("rnMasteryFlashcardCompleted")||"{}");e[s.id]=!0,localStorage.setItem("rnMasteryFlashcardCompleted",JSON.stringify(e)),console.log("Flashcard completion saved for ".concat(s.id))}i("summary")}},L=()=>{d>0&&(f(!1),h(d-1))},D=()=>{h(0),f(!1),g([]),v([]),b([]),i("flashcard-session")},F=()=>{const e=c.filter(e=>y.includes(e.id)||x.includes(e.id));u(w?A(e):e),h(0),f(!1),g([]),v([]),b([]),i("flashcard-session")};if("chapter-select"===n)return N?(0,Vp.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 text-white flex items-center justify-center",children:(0,Vp.jsxs)("div",{className:"text-center",children:[(0,Vp.jsx)("div",{className:"inline-block animate-spin rounded-full h-16 w-16 border-4 border-white border-t-transparent mb-4"}),(0,Vp.jsx)("p",{className:"text-xl",children:"Loading chapters..."})]})}):(0,Vp.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 text-white p-4",children:(0,Vp.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,Vp.jsx)("div",{className:"mb-4 bg-yellow-500/20 border border-yellow-500/50 rounded-xl p-4 text-center",children:(0,Vp.jsxs)("p",{className:"text-yellow-200 font-semibold",children:["\ud83c\udd95 New Flashcard Mode Available! Press ",(0,Vp.jsx)("kbd",{className:"px-2 py-1 bg-white/20 rounded",children:"Ctrl+Shift+R"})," (or ",(0,Vp.jsx)("kbd",{className:"px-2 py-1 bg-white/20 rounded",children:"Cmd+Shift+R"})," on Mac) to refresh and see all chapters"]})}),(0,Vp.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,Vp.jsx)("button",{onClick:t,className:"px-6 py-3 bg-white/10 hover:bg-white/20 rounded-xl font-semibold transition-all",children:"\u2190 Back to Hub"}),(0,Vp.jsx)("h1",{className:"text-4xl font-bold",children:"\ud83d\udcc7 Flashcard Study Mode"}),(0,Vp.jsx)("div",{className:"w-32"})]}),(0,Vp.jsx)("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-6 mb-6",children:(0,Vp.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,Vp.jsx)("input",{type:"checkbox",checked:w,onChange:e=>I(e.target.checked),className:"w-5 h-5 rounded"}),(0,Vp.jsx)("span",{className:"text-lg",children:"\ud83d\udd00 Shuffle cards"})]})}),(0,Vp.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-6",children:[(0,Vp.jsxs)("h3",{className:"text-2xl font-bold mb-6",children:["Select Chapter (",o.length," available)"]}),(0,Vp.jsxs)("div",{className:"mb-4 bg-blue-500/20 border border-blue-500/50 rounded-xl p-4 text-sm",children:[(0,Vp.jsx)("p",{className:"font-bold mb-2",children:"\ud83d\udd0d Debug Info:"}),(0,Vp.jsxs)("p",{children:["Chapters loaded: ",o.length]}),(0,Vp.jsxs)("p",{children:["Loading state: ",N?"true":"false"]}),(0,Vp.jsxs)("p",{children:["Chapter data: ",JSON.stringify(o.map(e=>e.id))]}),_.length>0&&(0,Vp.jsxs)("div",{className:"mt-2 p-2 bg-black/20 rounded",children:[(0,Vp.jsx)("p",{className:"font-bold",children:"Last Action Log:"}),_.map((e,t)=>(0,Vp.jsxs)("p",{className:"text-xs",children:["\u2022 ",e]},t))]}),S&&(0,Vp.jsxs)("div",{className:"mt-2 p-2 bg-red-500/20 border border-red-500/50 rounded",children:[(0,Vp.jsx)("p",{className:"font-bold text-red-300",children:"Error:"}),(0,Vp.jsx)("p",{className:"text-xs text-red-200",children:S})]})]}),0===o.length?(0,Vp.jsxs)("div",{className:"text-center py-12 text-white/60",children:[(0,Vp.jsx)("p",{className:"text-xl mb-2",children:"No chapters found"}),(0,Vp.jsx)("p",{className:"text-sm",children:"Debug info shown above"})]}):(0,Vp.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(e=>{const t=Gf[e.iconName]||"\ud83d\udcda";return(0,Vp.jsxs)("button",{onClick:()=>(async e=>{try{const t=["Clicked chapter: ".concat(e.title)];T(t),console.log("FlashcardMode: Starting flashcards for chapter:",e),a(e),C(null),t.push("Initializing question loader..."),T([...t]),await Up.initialize(),t.push("Loading questions for chapter..."),T([...t]);const n=Up.getQuestionsForChapter(e.id);if(!n||0===n.length)throw new Error("No questions found for ".concat(e.title));t.push("Loaded ".concat(n.length," questions")),T([...t]);const r=n.map((e,t)=>({id:t,front:e.text||e.question||"No question text",back:{answer:e.options?e.options[e.correctIndex]:e.correctAnswer||"No answer",rationale:e.rationale||"No rationale provided.",skill:e.skill||[],concept:e.concept||""}}));t.push("Created ".concat(r.length," flashcards")),t.push("Switching to flashcard view..."),T([...t]),u(w?A(r):r),h(0),f(!1),g([]),v([]),b([]),i("flashcard-session"),t.push("SUCCESS: Flashcard view loaded"),T([...t])}catch(S){console.error("FlashcardMode: Error starting flashcards:",S);const t="Error loading flashcards: ".concat(S.message);C(t),T([..._,"ERROR: ".concat(t)]),alert(t)}})(e),className:"p-6 bg-white/5 hover:bg-white/10 border border-white/20 hover:border-white/40 rounded-xl transition-all text-left",children:[(0,Vp.jsx)("div",{className:"text-3xl mb-3",children:t}),(0,Vp.jsx)("div",{className:"font-bold text-lg mb-2",children:e.title}),(0,Vp.jsx)("div",{className:"text-sm text-white/70",children:e.description})]},e.id)})})]})]})});if("flashcard-session"===n){var q,U;const e=c[d],t=(d+1)/c.length*100;return console.log("FlashcardMode: Current card:",e),console.log("FlashcardMode: All cards:",c),(0,Vp.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 text-white p-4",children:[(0,Vp.jsxs)("div",{className:"max-w-4xl mx-auto mb-4 p-3 bg-black/30 rounded-lg text-xs",children:[(0,Vp.jsxs)("div",{children:["Card Index: ",d]}),(0,Vp.jsxs)("div",{children:["Total Cards: ",c.length]}),(0,Vp.jsxs)("div",{children:["Front: ",null!==e&&void 0!==e&&e.front?"Yes":"No"," (",typeof(null===e||void 0===e?void 0:e.front),")"]}),(0,Vp.jsxs)("div",{children:["Back: ",null!==e&&void 0!==e&&e.back?"Yes":"No"," (",typeof(null===e||void 0===e?void 0:e.back),")"]}),(null===e||void 0===e?void 0:e.front)&&(0,Vp.jsxs)("div",{children:['Front text: "',e.front.substring(0,50),'..."']}),(null===e||void 0===e||null===(q=e.back)||void 0===q?void 0:q.answer)&&(0,Vp.jsxs)("div",{children:['Answer: "',e.back.answer.substring(0,50),'..."']})]}),(0,Vp.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,Vp.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Vp.jsx)("button",{onClick:()=>i("chapter-select"),className:"px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-all",children:"\u2190 Exit"}),(0,Vp.jsxs)("div",{className:"text-center",children:[(0,Vp.jsxs)("div",{className:"text-2xl font-bold",children:["Card ",d+1," of ",c.length]}),(0,Vp.jsx)("div",{className:"text-sm text-white/70",children:null===s||void 0===s?void 0:s.title})]}),(0,Vp.jsx)("div",{className:"w-20"})]}),(0,Vp.jsx)("div",{className:"mb-8",children:(0,Vp.jsx)("div",{className:"h-3 bg-white/20 rounded-full overflow-hidden",children:(0,Vp.jsx)("div",{className:"h-full bg-gradient-to-r from-green-400 to-blue-500 transition-all duration-300",style:{width:"".concat(t,"%")}})})}),(0,Vp.jsx)("div",{className:"relative h-96 mb-8 cursor-pointer",onClick:R,style:{perspective:"1000px"},children:(0,Vp.jsxs)("div",{className:"absolute w-full h-full transition-transform duration-500 preserve-3d ".concat(p?"rotate-y-180":""),style:{transformStyle:"preserve-3d"},children:[(0,Vp.jsxs)("div",{className:"absolute w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 rounded-3xl shadow-2xl p-8 flex flex-col items-center justify-center backface-hidden",style:{backfaceVisibility:"hidden"},children:[(0,Vp.jsx)("div",{className:"text-6xl mb-4",children:"\u2753"}),(0,Vp.jsx)("div",{className:"text-xl text-center leading-relaxed",children:null===e||void 0===e?void 0:e.front}),(0,Vp.jsx)("div",{className:"mt-6 text-sm text-white/70",children:"Click to reveal answer"})]}),(0,Vp.jsxs)("div",{className:"absolute w-full h-full bg-gradient-to-br from-green-500 to-teal-600 rounded-3xl shadow-2xl p-8 flex flex-col justify-center rotate-y-180 backface-hidden overflow-y-auto",style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:[(0,Vp.jsx)("div",{className:"text-4xl mb-4",children:"\u2705"}),(0,Vp.jsxs)("div",{className:"mb-4",children:[(0,Vp.jsx)("div",{className:"text-sm text-white/70 mb-2",children:"Correct Answer:"}),(0,Vp.jsx)("div",{className:"text-lg font-semibold",children:null===e||void 0===e?void 0:e.back.answer})]}),(0,Vp.jsxs)("div",{className:"mb-4",children:[(0,Vp.jsx)("div",{className:"text-sm text-white/70 mb-2",children:"Rationale:"}),(0,Vp.jsx)("div",{className:"text-base leading-relaxed",children:null===e||void 0===e?void 0:e.back.rationale})]}),(null===e||void 0===e||null===(U=e.back.skill)||void 0===U?void 0:U.length)>0&&(0,Vp.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:e.back.skill.map((e,t)=>(0,Vp.jsx)("span",{className:"px-3 py-1 bg-white/20 rounded-full text-xs",children:e},t))})]})]})}),(0,Vp.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,Vp.jsx)("button",{onClick:L,disabled:0===d,className:"px-6 py-3 bg-white/10 hover:bg-white/20 disabled:opacity-30 disabled:cursor-not-allowed rounded-xl font-semibold transition-all",children:"\u2190 Previous"}),(0,Vp.jsxs)("div",{className:"flex gap-3",children:[(0,Vp.jsx)("button",{onClick:O,className:"px-6 py-3 bg-red-500 hover:bg-red-600 rounded-xl font-semibold transition-all",disabled:!p,children:"\ud83d\udd34 Learning"}),(0,Vp.jsx)("button",{onClick:P,className:"px-6 py-3 bg-yellow-500 hover:bg-yellow-600 rounded-xl font-semibold transition-all",disabled:!p,children:"\ud83d\udfe1 Review"}),(0,Vp.jsx)("button",{onClick:j,className:"px-6 py-3 bg-green-500 hover:bg-green-600 rounded-xl font-semibold transition-all",disabled:!p,children:"\ud83d\udfe2 Know It"})]}),(0,Vp.jsx)("button",{onClick:M,disabled:d===c.length-1,className:"px-6 py-3 bg-white/10 hover:bg-white/20 disabled:opacity-30 disabled:cursor-not-allowed rounded-xl font-semibold transition-all",children:"Next \u2192"})]}),(0,Vp.jsxs)("div",{className:"mt-8 grid grid-cols-3 gap-4 text-center",children:[(0,Vp.jsxs)("div",{className:"bg-green-500/20 rounded-xl p-4",children:[(0,Vp.jsx)("div",{className:"text-3xl font-bold",children:m.length}),(0,Vp.jsx)("div",{className:"text-sm text-white/70",children:"Know It"})]}),(0,Vp.jsxs)("div",{className:"bg-yellow-500/20 rounded-xl p-4",children:[(0,Vp.jsx)("div",{className:"text-3xl font-bold",children:y.length}),(0,Vp.jsx)("div",{className:"text-sm text-white/70",children:"Review"})]}),(0,Vp.jsxs)("div",{className:"bg-red-500/20 rounded-xl p-4",children:[(0,Vp.jsx)("div",{className:"text-3xl font-bold",children:x.length}),(0,Vp.jsx)("div",{className:"text-sm text-white/70",children:"Learning"})]})]})]})]})}if("summary"===n){const e=c.length,n=Math.round(m.length/e*100);return(0,Vp.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 text-white p-4",children:(0,Vp.jsx)("div",{className:"max-w-3xl mx-auto",children:(0,Vp.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-3xl p-8 text-center",children:[(0,Vp.jsx)("div",{className:"text-6xl mb-6",children:"\ud83c\udf89"}),(0,Vp.jsx)("h2",{className:"text-4xl font-bold mb-4",children:"Flashcard Session Complete!"}),(0,Vp.jsx)("p",{className:"text-xl text-white/80 mb-8",children:null===s||void 0===s?void 0:s.title}),(0,Vp.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-8",children:[(0,Vp.jsxs)("div",{className:"bg-green-500/20 rounded-xl p-6",children:[(0,Vp.jsx)("div",{className:"text-4xl font-bold",children:m.length}),(0,Vp.jsx)("div",{className:"text-sm text-white/70",children:"Know It"})]}),(0,Vp.jsxs)("div",{className:"bg-yellow-500/20 rounded-xl p-6",children:[(0,Vp.jsx)("div",{className:"text-4xl font-bold",children:y.length}),(0,Vp.jsx)("div",{className:"text-sm text-white/70",children:"Review"})]}),(0,Vp.jsxs)("div",{className:"bg-red-500/20 rounded-xl p-6",children:[(0,Vp.jsx)("div",{className:"text-4xl font-bold",children:x.length}),(0,Vp.jsx)("div",{className:"text-sm text-white/70",children:"Learning"})]})]}),(0,Vp.jsxs)("div",{className:"text-5xl font-bold mb-8",children:[n,"% Mastery"]}),(0,Vp.jsxs)("div",{className:"flex flex-col gap-4",children:[(y.length>0||x.length>0)&&(0,Vp.jsxs)("button",{onClick:F,className:"px-8 py-4 bg-yellow-500 hover:bg-yellow-600 rounded-xl font-bold text-lg transition-all",children:["\ud83d\udd04 Review Difficult Cards (",y.length+x.length,")"]}),(0,Vp.jsx)("button",{onClick:D,className:"px-8 py-4 bg-blue-500 hover:bg-blue-600 rounded-xl font-bold text-lg transition-all",children:"\ud83d\udd01 Start Over"}),(0,Vp.jsx)("button",{onClick:()=>i("chapter-select"),className:"px-8 py-4 bg-purple-500 hover:bg-purple-600 rounded-xl font-bold text-lg transition-all",children:"\ud83d\udcda Choose Different Chapter"}),(0,Vp.jsx)("button",{onClick:t,className:"px-8 py-4 bg-white/10 hover:bg-white/20 rounded-xl font-semibold transition-all",children:"\u2190 Back to Hub"})]})]})})})}return null}const Yf=(0,h.A)("clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]),Qf=(0,h.A)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),Jf=(0,h.A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Xf=(0,h.A)("file-check",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]),$f=(0,h.A)("heart-pulse",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}],["path",{d:"M3.22 13H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"auskq0"}]]);var Zf=n(935);const em=(0,h.A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),tm=e=>{let{onBackToHub:t}=e;const[n,i]=(0,r.useState)("lobby"),[a,o]=(0,r.useState)(null),[l,c]=(0,r.useState)({patientsSeen:[],score:0,streak:0}),[d,h]=(0,r.useState)(900),[p,f]=(0,r.useState)(!1),[g,y]=(0,r.useState)("overview"),[v,x]=(0,r.useState)(null),[b,N]=(0,r.useState)(null),[E,C]=(0,r.useState)(0),[_,T]=(0,r.useState)(!1),k=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=null;return p&&d>0?e=setInterval(()=>{h(e=>e-1)},1e3):0===d&&f(!1),()=>clearInterval(e)},[p,d]);const A=e=>{const t=Math.floor(e/60),n=e%60;return"".concat(t,":").concat(n<10?"0":"").concat(n)},R=[{id:1,name:"Maria G.",age:28,chapter:"Ch 64: Assessment",acuity:"Routine",chiefComplaint:"Positive home pregnancy test, requesting intake.",tabs:{history:"Obstetric Hx: Two previous live births (full term). One miscarriage at 12 weeks (2 years ago). Menarche age 12. Cycles regular.",vitals:"BP: 118/74, HR: 82, LMP: 6 weeks ago. BMI: 24.",notes:"Patient is anxious about miscarriage risk. Confirming current pregnancy today via urine hCG. Family Hx: Mother had cervical cancer."},sbarOptions:[{id:"A",text:"S: Maria G., 28yo. B: G3P2012. A: Needs Pap smear and hCG. R: Schedule mammogram.",correct:!1},{id:"B",text:"S: Maria G., 28yo, presenting for intake. B: G4P2012 (currently pregnant). Hx of 1 SAB. A: Vitals stable. Needs education on prenatal signs and screening. R: Schedule follow-up OB visit; no mammogram needed yet.",correct:!0},{id:"C",text:"S: Maria G., pregnant. B: G3P2002. A: High risk for cervical cancer. R: Immediate colposcopy.",correct:!1}],questions:[{storyBeat:"Initial Assessment: You are reviewing Maria's obstetric history.",text:"Based on the intake data (2 Term births, 1 Miscarriage, Currently Pregnant), how would you document her GTPAL?",options:[{text:"G3 P2012",hint:"Don't forget the current pregnancy."},{text:"G4 P2012",hint:""},{text:"G4 P2002",hint:"Check 'Term' vs 'Preterm' definitions."},{text:"G3 P2102",hint:"Did she have preterm births?"}],correctIndex:1,rationale:"Correct: G4 P2012. Gravida=4 (Current + 2 Term + 1 Abortion). Term=2. Preterm=0. Abortion=1. Living=2. (Ch 64)",topic:"GTPAL Calculation"},{storyBeat:"Physical Exam: You proceed to the pelvic examination.",text:"You assess the glands responsible for lubrication located just inside the vaginal opening. These are documented as:",options:[{text:"Skene's Glands",hint:"These are paraurethral."},{text:"Bartholin's Glands",hint:""},{text:"Sebaceous Glands",hint:"These are skin glands."},{text:"Cowper's Glands",hint:"These are male anatomy."}],correctIndex:1,rationale:"Correct. Bartholin's glands (greater vestibular glands) are located just inside the vaginal opening and secrete mucus. (Ch 64)",topic:"Anatomy"},{storyBeat:"Health History: Maria mentions her mother had cervical cancer.",text:"She asks about screening. You explain that the Pap smear is the primary screening tool for:",options:[{text:"Ovarian Cancer",hint:"Pap does not screen for ovaries."},{text:"Endometrial Cancer",hint:"Pap is not diagnostic for this."},{text:"Cervical Cancer",hint:""},{text:"Vaginal Infections only",hint:"It screens for cancer too."}],correctIndex:2,rationale:"Correct. The Pap smear screens for precancerous and cancerous cells on the cervix. (Ch 64)",topic:"Cancer Screening"},{storyBeat:"Inclusivity Check: A colleague asks about screening for a transgender male patient in the waiting room.",text:"Based on reproductive health guidelines (Ch 65/64), does a transgender man with a cervix need a Pap smear?",options:[{text:"No, testosterone therapy prevents cervical cancer.",hint:"Incorrect."},{text:"No, they should only see a urologist.",hint:""},{text:"Yes, if they have a cervix, they require the same screening guidelines as cisgender women.",hint:""},{text:"Only if they are symptomatic.",hint:"Screening is preventative."}],correctIndex:2,rationale:"Correct. It is important for transgender male patients to receive appropriate gynecologic care and recommended preventive screening exams, including Pap smears, if they have the relevant anatomy. (Ch 65 Snippet)",topic:"Transgender Health"},{storyBeat:"Documentation: Menstrual History.",text:"If Maria reported she had not had a period for the last 6 months (before pregnancy) despite not being pregnant then, you would document this as:",options:[{text:"Dysmenorrhea",hint:"Painful periods."},{text:"Menorrhagia",hint:"Heavy bleeding."},{text:"Amenorrhea",hint:""},{text:"Metrorrhagia",hint:"Bleeding between periods."}],correctIndex:2,rationale:"Correct. Amenorrhea is the absence of menstruation. (Ch 64)",topic:"Reproductive Terminology"},{storyBeat:"Education: Signs of Pregnancy.",text:"Maria says 'I felt the baby move' (Quickening). Is this a Positive sign of pregnancy?",options:[{text:"Yes, movement is positive.",hint:""},{text:"No, this is a Presumptive sign.",hint:""},{text:"No, this is a Probable sign.",hint:""},{text:"Yes, but only after 20 weeks.",hint:""}],correctIndex:1,rationale:"Correct. Quickening is a Presumptive sign (subjective, felt by patient). Positive signs are objective (Fetal heart tones, Ultrasound). (Ch 64)",topic:"Signs of Pregnancy"},{storyBeat:"Procedure Prep: Colposcopy.",text:"The provider decides to perform a colposcopy due to an abnormal look of the cervix. How do you explain this?",options:[{text:"It is a surgery to remove the uterus.",hint:""},{text:"It involves looking at the cervix with a magnifying instrument.",hint:""},{text:"It is an x-ray of the fallopian tubes.",hint:""},{text:"It samples the lining of the uterus.",hint:""}],correctIndex:1,rationale:"Correct. Colposcopy uses a magnifying instrument (colposcope) to inspect the cervix, vagina, and vulva. (Ch 64)",topic:"Diagnostic Procedures"},{storyBeat:"Hormone Education.",text:"You explain that in early pregnancy, this hormone is crucial for maintaining the corpus luteum:",options:[{text:"FSH",hint:""},{text:"hCG (Human Chorionic Gonadotropin)",hint:""},{text:"Prolactin",hint:""},{text:"Oxytocin",hint:""}],correctIndex:1,rationale:"Correct. hCG maintains the corpus luteum in early pregnancy so it can produce progesterone. (Ch 64)",topic:"Physiology"},{storyBeat:"Discharge Planning: Mammogram Inquiry.",text:"She asks when she needs a mammogram. She is 28. What is the standard screening guideline for average risk?",options:[{text:"Start annually at age 45.",hint:""},{text:"Start annually at age 21.",hint:""},{text:"Only if you find a lump.",hint:""},{text:"Every 6 months starting now.",hint:""}],correctIndex:0,rationale:"Correct. For average risk women, annual mammograms typically begin at age 45 (ACS guidelines). (Ch 64)",topic:"Health Promotion"},{storyBeat:"Final Safety Check.",text:"Before she leaves, you verify her immunizations. Which vaccine is CONTRAINDICATED during pregnancy?",options:[{text:"Flu Vaccine (Inactivated)",hint:"Recommended."},{text:"Tdap",hint:"Recommended."},{text:"MMR (Measles Mumps Rubella)",hint:""},{text:"Hepatitis B",hint:"Safe."}],correctIndex:2,rationale:"Correct. MMR is a live virus vaccine and is contraindicated during pregnancy due to teratogenic risk. (Ch 64)",topic:"Safety/Pharmacology"}]},{id:2,name:"Sarah L.",age:45,chapter:"Ch 65: Female Disorders",acuity:"Urgent",chiefComplaint:"Follow-up on breast biopsy results.",tabs:{history:"No family history of breast cancer. Nonsmoker. Nulliparous (never gave birth).",vitals:"BP 124/80. Weight 68kg.",labs:"Pathology: Invasive Ductal Carcinoma.",imaging:"Mammo: Single mass, 1.8 cm. Nodes: Negative."},sbarOptions:[{id:"A",text:"S: Sarah L. B: Stage I Breast CA. A: Anxiety high. Needs chemo. R: Admit to ICU.",correct:!1},{id:"B",text:"S: Sarah L., 45yo. B: Nulliparous, diagnosed with Stage I Invasive Ductal Carcinoma. A: Tumor <2cm, nodes neg. Anxiety regarding prognosis. R: Pre-op teaching for Mastectomy, Tamoxifen education, Psychosocial support.",correct:!0},{id:"C",text:"S: Sarah L. B: Breast CA. A: BP 124/80. R: Discharge home.",correct:!1}],questions:[{storyBeat:"Consultation: Delivering the news.",text:"Sarah sees 'Stage I' on her chart and panics. Based on her tumor size (<2cm) and negative nodes, what is your response?",options:[{text:"Stage I is highly aggressive.",hint:""},{text:"Stage I describes a small localized tumor with no node involvement.",hint:""},{text:"Stage I means it has spread to the chest wall.",hint:""},{text:"You need chemotherapy immediately.",hint:""}],correctIndex:1,rationale:"Correct. Stage I indicates a tumor <2cm and no lymph node involvement. Prognosis is generally good. (Ch 65)",topic:"Staging"},{storyBeat:"Risk Assessment.",text:"Sarah asks, 'Why did I get this?' You review her chart. Which factor listed is a known risk factor?",options:[{text:"Having low blood pressure.",hint:""},{text:"Being Nulliparous (never having children).",hint:""},{text:"Her age (45 is considered elderly).",hint:""},{text:"Having regular menstrual cycles.",hint:""}],correctIndex:1,rationale:"Correct. Nulliparity (or first child after 30) is a risk factor due to prolonged estrogen exposure. (Ch 65)",topic:"Risk Factors"},{storyBeat:"Screening Education.",text:"Sarah asks when she should have been doing self-exams. You teach that Breast Self-Exam (BSE) is best performed:",options:[{text:"During ovulation.",hint:""},{text:"Right before menstruation.",hint:"Breasts are tender/swollen then."},{text:"5-7 days after menses begins.",hint:""},{text:"Daily.",hint:"Too frequent."}],correctIndex:2,rationale:"Correct. 5-7 days after menses counts as the time when hormonal influence/swelling is lowest. (Ch 65)",topic:"Health Promotion"},{storyBeat:"Pre-Op Education: Surgery Type.",text:"She asks what a Modified Radical Mastectomy entails compared to a lumpectomy.",options:[{text:"It removes only the lump.",hint:""},{text:"It removes the breast tissue and axillary nodes, but leaves the muscle.",hint:""},{text:"It removes the breast, muscle, and all bones.",hint:""},{text:"It is purely cosmetic.",hint:""}],correctIndex:1,rationale:"Correct. Modified radical mastectomy removes breast tissue and axillary nodes but preserves the pectoralis major muscle. (Ch 65)",topic:"Surgical Procedures"},{storyBeat:"Post-Op Day 1: Drain Care.",text:"You observe a Jackson-Pratt (JP) drain. What is the correct nursing action?",options:[{text:"Leave it open to air.",hint:""},{text:"Keep the bulb compressed to maintain suction.",hint:""},{text:"Irrigate it with saline every hour.",hint:""},{text:"Remove it if it has any drainage.",hint:""}],correctIndex:1,rationale:"Correct. The bulb must be compressed to create negative pressure (suction) for drainage. (Ch 65)",topic:"Post-Op Care"},{storyBeat:"Post-Op Safety: Lymphedema Precautions.",text:"The tech is about to take BP on Sarah's LEFT arm (the operative side). What do you do?",options:[{text:"Allow it, it's fine.",hint:""},{text:"Stop the tech; use the right arm or leg.",hint:""},{text:"Tell them to use a pediatric cuff.",hint:""},{text:"Take it yourself on the left arm.",hint:""}],correctIndex:1,rationale:"Correct. BP, IVs, and blood draws are contraindicated on the affected arm to prevent lymphedema. (Ch 65)",topic:"Lymphedema Prevention"},{storyBeat:"Rehabilitation.",text:"To restore arm function on the affected side, which activity do you recommend post-op (after drain removal)?",options:[{text:"Keep the arm strictly immobilized in a sling for 6 weeks.",hint:"Causes frozen shoulder."},{text:"Wall climbing with fingers or rope turning.",hint:""},{text:"Heavy weightlifting.",hint:""},{text:"Ice packs only.",hint:""}],correctIndex:1,rationale:"Correct. Wall climbing (spider walk) helps restore Range of Motion (ROM) without excessive strain. (Ch 65)",topic:"Rehab"},{storyBeat:"Discharge Meds: Tamoxifen.",text:"She is prescribed Tamoxifen. You explain its mechanism:",options:[{text:"It kills all fast-growing cells.",hint:""},{text:"It blocks estrogen receptors on the tumor cells.",hint:""},{text:"It increases estrogen levels.",hint:""},{text:"It prevents nausea.",hint:""}],correctIndex:1,rationale:"Correct. Tamoxifen is an anti-estrogen agent used for hormone-receptor-positive breast cancer. (Ch 65)",topic:"Pharmacology"},{storyBeat:"Side Effects Teaching.",text:"You warn Sarah about common side effects of Tamoxifen, which mimic:",options:[{text:"Hypoglycemia",hint:""},{text:"Menopausal symptoms (hot flashes).",hint:""},{text:"Hyperactivity",hint:""},{text:"Severe weight loss",hint:""}],correctIndex:1,rationale:"Correct. By blocking estrogen, Tamoxifen often causes hot flashes and other menopausal symptoms. (Ch 65)",topic:"Medication Side Effects"},{storyBeat:"Follow-Up: Psychosocial.",text:"Sarah reports feeling depressed about her body image. Best response?",options:[{text:"You should just be happy you survived.",hint:""},{text:"Encourage her to join a support group for survivors.",hint:""},{text:"Tell her to get plastic surgery immediately.",hint:""},{text:"Ignore the comment.",hint:""}],correctIndex:1,rationale:"Correct. Psychosocial support is critical. Support groups connect her with others sharing the experience. (Ch 65)",topic:"Psychosocial Care"}]},{id:3,name:"Robert T.",age:68,chapter:"Ch 66: Male Disorders",acuity:"Admitted",chiefComplaint:"Difficulty starting stream, waking up 4x/night.",tabs:{history:"HTN, Hyperlipidemia. Father had prostate cancer.",vitals:"BP 130/85. PSA: 5.2 ng/mL (Abnormal > 4.0).",notes:"DRE: Prostate symmetrically enlarged, smooth, rubbery."},sbarOptions:[{id:"A",text:"S: Robert T. B: BPH. A: PSA 5.2. R: Needs chemo.",correct:!1},{id:"B",text:"S: Robert T., 68yo. B: Hx of BPH, failed meds. Post-TURP day 1. A: CBI running, urine pink. Pain controlled with B&O. R: Continue CBI, monitor for clots, discharge teaching on lifting restrictions.",correct:!0},{id:"C",text:"S: Robert T. B: Prostate Cancer. A: DRE Hard/Nodular. R: Surgery.",correct:!1}],questions:[{storyBeat:"Initial Consult: DRE Results.",text:"Robert fears cancer. Based on the DRE (Smooth, Rubbery, Symmetrical), what condition is most likely?",options:[{text:"Prostate Cancer",hint:"Cancer is usually hard/irregular."},{text:"Benign Prostatic Hyperplasia (BPH)",hint:""},{text:"Prostatitis",hint:""},{text:"Testicular Cancer",hint:""}],correctIndex:1,rationale:"Correct. Smooth, rubbery enlargement is classic for BPH. Cancer presents as stony, hard, irregular nodules. (Ch 66)",topic:"Diagnosis"},{storyBeat:"Medication: Alpha Blockers.",text:"You prescribe Tamsulosin. What is the mechanism?",options:[{text:"Shrinks the prostate.",hint:""},{text:"Relaxes smooth muscle of prostate/bladder neck.",hint:""},{text:"Kills bacteria.",hint:""},{text:"Lowers PSA.",hint:""}],correctIndex:1,rationale:"Correct. Alpha blockers (Tamsulosin) relax smooth muscle to improve flow. (Ch 66)",topic:"Pharmacology"},{storyBeat:"Drug Interactions.",text:"Robert takes Sildenafil (Viagra). Risk with Alpha Blockers?",options:[{text:"Hypertension",hint:""},{text:"Severe Hypotension.",hint:""},{text:"Kidney failure",hint:""},{text:"Hyperkalemia",hint:""}],correctIndex:1,rationale:"Correct. Both cause vasodilation. Taking together can cause dangerous hypotension. (Ch 66)",topic:"Safety"},{storyBeat:"Lifestyle Education.",text:"Robert asks about diet to support prostate health. You suggest:",options:[{text:"High fat, high red meat.",hint:""},{text:"Decrease red meat and fats.",hint:""},{text:"Increase calcium supplements.",hint:""},{text:"No dietary changes needed.",hint:""}],correctIndex:1,rationale:"Correct. Reducing red meat and fats is recommended for prostate health. (Ch 66)",topic:"Health Promotion"},{storyBeat:"Escalation: Surgery Prep.",text:"Meds failed. He is scheduled for TURP. He asks if there's an incision.",options:[{text:"Yes, abdominal.",hint:""},{text:"No, the instrument goes up the urethra.",hint:""},{text:"Yes, perineal.",hint:""},{text:"No, radiation.",hint:""}],correctIndex:1,rationale:"Correct. TURP is endoscopic; the resectoscope is inserted through the urethra. (Ch 66)",topic:"Surgical Procedures"},{storyBeat:"Post-Op: CBI.",text:"Robert has a 3-way catheter (CBI). Drainage is bright red with clots. Priority?",options:[{text:"Call doctor.",hint:""},{text:"Increase irrigation rate.",hint:""},{text:"Clamp catheter.",hint:""},{text:"Remove catheter.",hint:""}],correctIndex:1,rationale:"Correct. Increase flow to flush clots. Goal is light pink. (Ch 66)",topic:"Post-Op Nursing Care"},{storyBeat:"Complication: Spasms.",text:"Robert has bladder spasms. Catheter is patent. Which med is indicated?",options:[{text:"Lasix",hint:""},{text:"B&O Suppository",hint:""},{text:"Aspirin",hint:""},{text:"Warfarin",hint:""}],correctIndex:1,rationale:"Correct. B&O suppositories are an antispasmodic/narcotic combo for TURP spasms. (Ch 66)",topic:"Pain Management"},{storyBeat:"Discharge: Activity.",text:"Going home. Vital activity instruction?",options:[{text:"Resume heavy lifting.",hint:""},{text:"Avoid straining (Valsalva) and heavy lifting.",hint:""},{text:"Restrict fluids.",hint:""},{text:"Drive immediately.",hint:""}],correctIndex:1,rationale:"Correct. Straining increases abdominal pressure and bleeding risk. (Ch 66)",topic:"Discharge Teaching"},{storyBeat:"Sexuality.",text:"Robert asks about sexual function post-TURP. You mention:",options:[{text:"Permanent impotence.",hint:""},{text:"Retrograde Ejaculation.",hint:""},{text:"Increased libido.",hint:""},{text:"Infertility.",hint:""}],correctIndex:1,rationale:"Correct. Semen may go into the bladder (cloudy urine) instead of exiting. Harmless but needs education. (Ch 66)",topic:"Sexual Health"},{storyBeat:"Screening Knowledge.",text:"He asks if he still needs DREs after this. You say:",options:[{text:"No, the prostate is gone.",hint:""},{text:"Yes, the prostate capsule remains and can develop cancer.",hint:""},{text:"Only PSA is needed.",hint:""},{text:"No, BPH prevents cancer.",hint:""}],correctIndex:1,rationale:"Correct. In a TURP, only the inner tissue is removed. The capsule remains and is still subject to cancer risk. (Ch 66)",topic:"Health Maintenance"}]},{id:4,name:"Liam K.",age:19,chapter:"Ch 67: STIs",acuity:"Routine",chiefComplaint:"STI Check / Counseling.",tabs:{history:"Sexually active with men (MSM). Multiple partners. Inconsistent condom use.",vitals:"Temp 99.1F.",notes:"Patient requests 'full panel' testing."},sbarOptions:[{id:"A",text:"S: Liam K. B: STI exposure. A: Has Herpes. R: Acyclovir.",correct:!1},{id:"B",text:"S: Liam K., 19yo. B: MSM, multiple partners. A: Presents with painless chancre (Primary Syphilis), VDRL positive. R: Administer Penicillin G Benzathine IM, report to Health Dept, educate on partner notification.",correct:!0},{id:"C",text:"S: Liam K. B: No Hx. A: Healthy. R: Discharge.",correct:!1}],questions:[{storyBeat:"Intake: HPV.",text:"Liam hasn't had the HPV vaccine. He thinks it's 'for girls'. You explain it causes which cancers in men?",options:[{text:"Prostate",hint:""},{text:"Penile, Anal, and Oropharyngeal.",hint:""},{text:"Liver",hint:""},{text:"Bone",hint:""}],correctIndex:1,rationale:"Correct. HPV is strongly linked to penile, anal, and throat cancers in men. (Ch 67)",topic:"Health Promotion"},{storyBeat:"Physical Findings.",text:"You note painless, indurated ulcers (chancres) on the penis. Hallmark of:",options:[{text:"Herpes Simplex (HSV)",hint:""},{text:"Primary Syphilis",hint:""},{text:"HPV Warts",hint:""},{text:"Gonorrhea",hint:""}],correctIndex:1,rationale:"Correct. A painless chancre is the classic sign of Primary Syphilis. Herpes is painful. (Ch 67)",topic:"Diagnosis"},{storyBeat:"Diagnostics.",text:"Which blood test screens for Syphilis?",options:[{text:"PSA",hint:""},{text:"VDRL or RPR",hint:""},{text:"CBC",hint:""},{text:"Bun/Creatinine",hint:""}],correctIndex:1,rationale:"Correct. VDRL/RPR are screening tests. FTA-ABS confirms. (Ch 67)",topic:"Labs"},{storyBeat:"Differentiation.",text:"If the ulcers were painful vesicles that crusted over, you would suspect:",options:[{text:"Syphilis",hint:""},{text:"Herpes Simplex Virus (HSV-2)",hint:""},{text:"Chlamydia",hint:""},{text:"HPV",hint:""}],correctIndex:1,rationale:"Correct. Herpes presents as painful, fluid-filled vesicles. (Ch 67)",topic:"Differential Diagnosis"},{storyBeat:"Disease Progression.",text:"Liam asks about untreated Syphilis risks. You mention Tertiary Syphilis affects:",options:[{text:"Lungs",hint:""},{text:"Neuro/Cardio systems (Dementia/Aortic issues).",hint:""},{text:"Muscles",hint:""},{text:"Hair",hint:""}],correctIndex:1,rationale:"Correct. Neurosyphilis is a severe late-stage complication. (Ch 67)",topic:"Complications"},{storyBeat:"Treatment.",text:"Confirmed Syphilis. Drug of choice?",options:[{text:"Penicillin G Benzathine",hint:""},{text:"Acyclovir",hint:""},{text:"Metronidazole",hint:""},{text:"Fluconazole",hint:""}],correctIndex:0,rationale:"Correct. Penicillin G IM is the gold standard. (Ch 67)",topic:"Pharmacology"},{storyBeat:"Herpes Management (Hypothetical).",text:"Liam asks, 'If it was Herpes, can I cure it?'",options:[{text:"Yes, antibiotics cure it.",hint:""},{text:"No, it's viral and recurrent. Antivirals manage outbreaks.",hint:""},{text:"Yes, surgery removes it.",hint:""},{text:"No, it is fatal.",hint:""}],correctIndex:1,rationale:"Correct. Herpes is a chronic viral infection. Acyclovir/Valacyclovir shorten outbreaks but do not cure. (Ch 67)",topic:"Patient Education"},{storyBeat:"Partner Notification.",text:"Role in partner notification?",options:[{text:"Don't tell anyone.",hint:""},{text:"Encourage notification/Report to Health Dept.",hint:""},{text:"Post on social media.",hint:""},{text:"Tell parents.",hint:""}],correctIndex:1,rationale:"Correct. Syphilis is reportable. Partners need treatment (Expedited Partner Therapy where legal). (Ch 67)",topic:"Public Health"},{storyBeat:"Co-Infection Risk.",text:"Ulcers increase risk for which other infection?",options:[{text:"Flu",hint:""},{text:"HIV",hint:""},{text:"Malaria",hint:""},{text:"Gout",hint:""}],correctIndex:1,rationale:"Correct. Ulcers break the skin barrier, facilitating HIV entry. (Ch 67)",topic:"Co-morbidities"},{storyBeat:"Follow-Up.",text:"When should Liam return for follow-up testing to ensure cure?",options:[{text:"Never.",hint:""},{text:"6 and 12 months.",hint:""},{text:"Tomorrow.",hint:""},{text:"5 years.",hint:""}],correctIndex:1,rationale:"Correct. Follow-up VDRL/RPR at 6 and 12 months is needed to ensure titers have decreased. (Ch 67)",topic:"Follow-Up Care"}]}],j=()=>{c({patientsSeen:[],score:0,streak:0}),h(900),f(!0),i("lobby")},P=()=>{if(null===b)return;const e=a.questions[E],t=b===e.correctIndex,n=t?"high"===v?150:100:0;c(e=>(0,s.A)((0,s.A)({},e),{},{score:e.score+n,streak:t?e.streak+1:0})),T(!0)},O=()=>{E<a.questions.length-1?(C(e=>e+1),N(null),x(null),T(!1),k.current&&(k.current.scrollTop=0)):i("sbar")},M=()=>{const e=a,t=e=>{if(e.includes("Abnormal")){const t=e.split("Abnormal");return(0,Vp.jsxs)("span",{children:[t[0]," ",(0,Vp.jsxs)("span",{className:"font-bold text-red-600 bg-red-50 px-1 rounded",children:["Abnormal ",t[1]]})]})}return e};switch(g){case"history":return(0,Vp.jsxs)("div",{className:"bg-white p-4 rounded border border-slate-200 animate-in fade-in duration-300",children:[(0,Vp.jsxs)("h4",{className:"font-bold text-slate-700 flex items-center mb-2",children:[(0,Vp.jsx)(Yf,{className:"w-4 h-4 mr-2"})," History & Risk Factors"]}),(0,Vp.jsx)("p",{className:"text-slate-600",children:e.tabs.history})]});case"vitals":return(0,Vp.jsxs)("div",{className:"bg-white p-4 rounded border border-slate-200 animate-in fade-in duration-300",children:[(0,Vp.jsxs)("h4",{className:"font-bold text-slate-700 flex items-center mb-2",children:[(0,Vp.jsx)(u.A,{className:"w-4 h-4 mr-2"})," Vitals & Diagnostics"]}),(0,Vp.jsx)("p",{className:"text-slate-600 mb-2",children:t(e.tabs.vitals)}),e.tabs.labs&&(0,Vp.jsxs)("p",{className:"text-slate-600 bg-yellow-50 p-2 rounded border border-yellow-100",children:[(0,Vp.jsx)("span",{className:"font-semibold",children:"Lab Alert:"})," ",e.tabs.labs]}),e.tabs.imaging&&(0,Vp.jsxs)("p",{className:"text-slate-600 bg-blue-50 p-2 rounded border border-blue-100 mt-2",children:[(0,Vp.jsx)("span",{className:"font-semibold",children:"Imaging:"})," ",e.tabs.imaging]})]});case"notes":return(0,Vp.jsxs)("div",{className:"bg-white p-4 rounded border border-slate-200 animate-in fade-in duration-300",children:[(0,Vp.jsxs)("h4",{className:"font-bold text-slate-700 flex items-center mb-2",children:[(0,Vp.jsx)(Qf,{className:"w-4 h-4 mr-2"})," Provider Notes"]}),(0,Vp.jsxs)("p",{className:"text-slate-600 italic",children:['"',e.tabs.notes,'"']})]});default:return(0,Vp.jsxs)("div",{className:"bg-blue-50 p-4 rounded border border-blue-100 animate-in fade-in duration-300",children:[(0,Vp.jsx)("h4",{className:"font-bold text-blue-800 mb-2",children:"Patient Overview"}),(0,Vp.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("span",{className:"text-xs text-blue-500 uppercase font-bold",children:"Name"}),(0,Vp.jsx)("p",{className:"font-medium text-slate-800",children:e.name})]}),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("span",{className:"text-xs text-blue-500 uppercase font-bold",children:"Age"}),(0,Vp.jsx)("p",{className:"font-medium text-slate-800",children:e.age})]}),(0,Vp.jsxs)("div",{className:"col-span-2",children:[(0,Vp.jsx)("span",{className:"text-xs text-blue-500 uppercase font-bold",children:"Chief Complaint"}),(0,Vp.jsx)("p",{className:"font-medium text-slate-800",children:e.chiefComplaint})]})]})]})}},L=()=>(0,Vp.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,Vp.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200 mb-6 flex justify-between items-center",children:[(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:"Nurse Station Dashboard"}),(0,Vp.jsxs)("p",{className:"text-slate-500",children:["Shift Status: Active | Patients Remaining: ",R.length-l.patientsSeen.length]})]}),(0,Vp.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,Vp.jsxs)("div",{className:"text-right",children:[(0,Vp.jsxs)("div",{className:"flex items-center text-slate-500 text-xs font-bold uppercase tracking-wider mb-1",children:[(0,Vp.jsx)(I,{className:"w-4 h-4 mr-1"})," Shift Timer"]}),(0,Vp.jsx)("div",{className:"text-2xl font-mono font-bold ".concat(d<60?"text-red-500 animate-pulse":"text-slate-700"),children:A(d)})]}),(0,Vp.jsx)("div",{className:"text-right border-l pl-6",children:(0,Vp.jsxs)("div",{className:"text-3xl font-bold text-blue-600",children:[l.score," ",(0,Vp.jsx)("span",{className:"text-sm font-normal text-slate-400",children:"PTS"})]})})]})]}),(0,Vp.jsx)("div",{className:"grid grid-cols-1 gap-4",children:R.map(e=>{const t=l.patientsSeen.includes(e.id);return(0,Vp.jsxs)("button",{onClick:()=>!t&&(e=>{o(e),y("overview"),x(null),N(null),C(0),T(!1),i("chart")})(e),disabled:t,className:"flex items-center p-4 rounded-xl border transition-all ".concat(t?"bg-slate-50 border-slate-200 opacity-70 cursor-default":"bg-white border-slate-200 hover:border-blue-400 hover:shadow-md cursor-pointer group"),children:[(0,Vp.jsx)("div",{className:"p-3 rounded-full mr-4 ".concat(t?"bg-slate-200 text-slate-400":"bg-blue-100 text-blue-600"),children:t?(0,Vp.jsx)(m,{className:"w-6 h-6"}):(0,Vp.jsx)(Xp.A,{className:"w-6 h-6"})}),(0,Vp.jsxs)("div",{className:"flex-1 text-left",children:[(0,Vp.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Vp.jsx)("h3",{className:"text-lg font-bold text-slate-800",children:e.name}),t&&(0,Vp.jsx)("span",{className:"text-xs bg-slate-200 text-slate-600 px-2 py-0.5 rounded",children:"Hand-off Complete"})]}),(0,Vp.jsxs)("p",{className:"text-sm text-slate-500",children:[e.chapter," \u2022 ",e.acuity]})]}),!t&&(0,Vp.jsx)(Jf,{className:"w-5 h-5 text-slate-300 group-hover:text-blue-500"})]},e.id)})})]}),D=()=>{const e=a.questions[E],t=b===e.correctIndex,n=E/a.questions.length*100;return(0,Vp.jsxs)("div",{className:"max-w-6xl mx-auto h-[calc(100vh-140px)] flex flex-col md:flex-row gap-6",children:[(0,Vp.jsxs)("div",{className:"w-full md:w-1/3 bg-white rounded-xl shadow-lg border border-slate-200 flex flex-col overflow-hidden",children:[(0,Vp.jsxs)("div",{className:"bg-slate-800 p-4 text-white",children:[(0,Vp.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Vp.jsx)("h2",{className:"font-bold text-lg",children:a.name}),(0,Vp.jsx)("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded font-bold uppercase",children:a.acuity})]}),(0,Vp.jsxs)("p",{className:"text-xs text-slate-300",children:["MRN: ",a.id,"9924-X"]})]}),(0,Vp.jsx)("div",{className:"flex border-b border-slate-200 bg-slate-50",children:["overview","history","vitals","notes"].map(e=>(0,Vp.jsx)("button",{onClick:()=>y(e),className:"flex-1 py-3 text-xs font-bold uppercase transition-colors border-b-2 ".concat(g===e?"border-blue-600 text-blue-600 bg-white":"border-transparent text-slate-500 hover:text-slate-700"),children:e},e))}),(0,Vp.jsx)("div",{className:"p-6 flex-1 bg-slate-50 overflow-y-auto",children:M()})]}),(0,Vp.jsx)("div",{className:"w-full md:w-2/3 flex flex-col h-full",children:(0,Vp.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 flex-1 flex flex-col overflow-hidden",children:[(0,Vp.jsx)("div",{className:"h-2 w-full bg-slate-100",children:(0,Vp.jsx)("div",{className:"h-full bg-blue-500 transition-all duration-500 ease-out",style:{width:"".concat(n,"%")}})}),(0,Vp.jsxs)("div",{ref:k,className:"flex-1 overflow-y-auto p-6 md:p-8",children:[(0,Vp.jsxs)("div",{className:"mb-6 bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg",children:[(0,Vp.jsxs)("div",{className:"flex items-center text-blue-900 font-bold text-sm uppercase tracking-wide mb-1",children:[(0,Vp.jsx)(S,{className:"w-4 h-4 mr-2"})," Clinical Update"]}),(0,Vp.jsx)("p",{className:"text-blue-900 text-lg leading-relaxed font-medium",children:e.storyBeat})]}),(0,Vp.jsxs)("div",{className:"mb-6",children:[(0,Vp.jsxs)("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider block mb-2",children:["Decision Point ",E+1," of ",a.questions.length]}),(0,Vp.jsx)("h3",{className:"text-xl font-bold text-slate-800 leading-snug",children:e.text})]}),(0,Vp.jsx)("div",{className:"space-y-3 mb-8",children:e.options.map((t,n)=>{let r="border-slate-200 hover:border-slate-300 bg-white";return b===n&&(r="border-blue-600 bg-blue-50 ring-1 ring-blue-600"),_&&(r=n===e.correctIndex?"border-green-500 bg-green-50 ring-1 ring-green-500":b===n?"border-red-500 bg-red-50 ring-1 ring-red-500":"opacity-40 border-slate-100"),(0,Vp.jsxs)("button",{disabled:_,onClick:()=>(e=>{_||N(e)})(n),className:"w-full text-left p-4 rounded-xl border-2 transition-all duration-200 flex items-center ".concat(r),children:[(0,Vp.jsxs)("div",{className:"w-6 h-6 rounded-full border-2 mr-4 flex-shrink-0 flex items-center justify-center transition-colors ".concat(_&&n===e.correctIndex?"border-green-500 bg-green-500 text-white":"border-slate-300"),children:[_&&n===e.correctIndex&&(0,Vp.jsx)(m,{className:"w-5 h-5"}),_&&b===n&&n!==e.correctIndex&&(0,Vp.jsx)(w,{className:"w-5 h-5 text-red-500 bg-white rounded-full"}),!_&&b===n&&(0,Vp.jsx)("div",{className:"w-2.5 h-2.5 bg-blue-600 rounded-full"})]}),(0,Vp.jsx)("span",{className:"text-base ".concat(_&&n===e.correctIndex?"font-bold text-green-900":"text-slate-700"),children:t.text})]},n)})})]}),(0,Vp.jsx)("div",{className:"p-6 bg-white border-t border-slate-200 z-10",children:_?(0,Vp.jsxs)("div",{children:[(0,Vp.jsxs)("div",{className:"p-4 rounded-lg mb-4 ".concat(t?"bg-green-50 text-green-800":"bg-red-50 text-red-800"),children:[(0,Vp.jsx)("p",{className:"font-bold mb-1",children:t?"Correct":"Incorrect"}),(0,Vp.jsx)("p",{className:"text-sm",children:e.rationale})]}),(0,Vp.jsxs)("button",{onClick:O,className:"w-full bg-slate-900 text-white py-3 rounded-xl font-bold flex justify-center",children:["Continue ",(0,Vp.jsx)(Jf,{className:"ml-2"})]})]}):(0,Vp.jsxs)("div",{className:"flex flex-col md:flex-row items-center gap-4",children:[(0,Vp.jsx)("div",{className:"flex items-center gap-2",children:["low","medium","high"].map(e=>(0,Vp.jsx)("button",{onClick:()=>x(e),className:"px-4 py-2 rounded-lg text-xs font-bold uppercase transition-all ".concat(v===e?"bg-blue-100 text-blue-700 ring-2 ring-blue-500":"bg-slate-100 text-slate-500"),children:e},e))}),(0,Vp.jsxs)("button",{disabled:!v||null===b,onClick:P,className:"flex-1 w-full bg-blue-600 hover:bg-blue-700 disabled:opacity-50 text-white py-3 rounded-xl font-bold flex justify-center items-center",children:["Confirm Decision ",(0,Vp.jsx)(Jf,{className:"ml-2 w-4 h-4"})]})]})})]})})]})},F=()=>(0,Vp.jsx)("div",{className:"max-w-3xl mx-auto pt-10",children:(0,Vp.jsxs)("div",{className:"bg-white p-8 rounded-2xl shadow-xl border border-slate-200",children:[(0,Vp.jsxs)("div",{className:"flex items-center mb-6",children:[(0,Vp.jsx)(Xf,{className:"w-10 h-10 text-blue-600 mr-4"}),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("h2",{className:"text-2xl font-bold text-slate-900",children:"End of Shift Handoff (SBAR)"}),(0,Vp.jsx)("p",{className:"text-slate-500",children:"Select the most accurate summary to report to the next nurse."})]})]}),(0,Vp.jsx)("div",{className:"space-y-4",children:a.sbarOptions.map(e=>(0,Vp.jsxs)("button",{onClick:()=>(e=>{e&&c(e=>(0,s.A)((0,s.A)({},e),{},{score:e.score+200}));const t=[...l.patientsSeen,a.id];c(e=>(0,s.A)((0,s.A)({},e),{},{patientsSeen:t})),i("lobby")})(e.correct),className:"w-full text-left p-6 rounded-xl border-2 border-slate-100 hover:border-blue-500 hover:bg-blue-50 transition-all group",children:[(0,Vp.jsxs)("span",{className:"font-bold text-slate-400 group-hover:text-blue-500 mb-2 block",children:["Option ",e.id]}),(0,Vp.jsx)("p",{className:"text-slate-700 font-medium leading-relaxed",children:e.text})]},e.id))})]})}),q=()=>(0,Vp.jsx)("div",{className:"max-w-lg mx-auto text-center pt-12",children:(0,Vp.jsxs)("div",{className:"bg-white p-8 rounded-2xl shadow-xl border border-slate-200",children:[(0,Vp.jsx)($f,{className:"w-20 h-20 text-blue-500 mx-auto mb-6"}),(0,Vp.jsx)("h2",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Shift Complete"}),(0,Vp.jsxs)("div",{className:"text-4xl font-bold text-blue-600 mb-8",children:[l.score," PTS"]}),(0,Vp.jsxs)("button",{onClick:j,className:"w-full bg-blue-600 text-white py-4 rounded-xl font-bold flex justify-center items-center",children:["Start New Shift ",(0,Vp.jsx)(Ef,{className:"ml-2 w-4 h-4"})]})]})});return(0,Vp.jsxs)("div",{className:"min-h-screen bg-slate-100 font-sans text-slate-900 p-4 md:p-6 lg:p-8",children:[(0,Vp.jsxs)("div",{className:"max-w-6xl mx-auto mb-6 flex justify-between items-center",children:[(0,Vp.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Vp.jsx)("div",{className:"bg-blue-600 p-2.5 rounded-xl shadow-lg shadow-blue-200",children:(0,Vp.jsx)(Zf.A,{className:"w-6 h-6 text-white"})}),(0,Vp.jsxs)("div",{children:[(0,Vp.jsx)("h1",{className:"text-xl font-bold text-slate-800 tracking-tight",children:"SimChart"}),(0,Vp.jsx)("p",{className:"text-xs font-medium text-slate-500",children:"Reproductive Health \u2022 Unit 4"})]})]}),"chart"===n?(0,Vp.jsxs)("button",{onClick:()=>i("lobby"),className:"text-sm font-medium text-slate-500 hover:text-slate-800 flex items-center bg-white px-3 py-1.5 rounded-lg border border-slate-200",children:[(0,Vp.jsx)(em,{className:"w-4 h-4 mr-1.5"})," Lobby"]}):(0,Vp.jsxs)("button",{onClick:t,className:"text-sm font-medium text-slate-500 hover:text-slate-800 flex items-center bg-white px-3 py-1.5 rounded-lg border border-slate-200",children:[(0,Vp.jsx)(em,{className:"w-4 h-4 mr-1.5"})," Back to Hub"]})]}),"lobby"===n&&(0,Vp.jsx)(L,{}),"chart"===n&&(0,Vp.jsx)(D,{}),"sbar"===n&&(0,Vp.jsx)(F,{}),"summary"===n&&(0,Vp.jsx)(q,{})]})};const nm=function(){var e;const[t,n]=(0,r.useState)("hub"),[i,s]=(0,r.useState)(null),[a,o]=(0,r.useState)("Student"),[l,c]=(0,r.useState)(null),u=e=>{try{console.log("Selected game:",e),s(e),n("game")}catch(t){console.error("Error selecting game:",t),c(t.message)}},d=()=>{try{n("hub"),s(null)}catch(e){console.error("Error returning to hub:",e),c(e.message)}},h=()=>{alert("Settings coming soon!")};return l?(0,Vp.jsxs)("div",{style:{minHeight:"100vh",background:"#991b1b",color:"white",padding:"40px",textAlign:"center",fontFamily:"system-ui"},children:[(0,Vp.jsx)("h1",{style:{fontSize:"32px",marginBottom:"20px"},children:"\u26a0\ufe0f Error"}),(0,Vp.jsx)("p",{style:{marginBottom:"20px",fontSize:"18px"},children:l}),(0,Vp.jsx)("button",{onClick:()=>{c(null),n("hub")},style:{padding:"12px 24px",fontSize:"16px",background:"white",color:"#991b1b",border:"none",borderRadius:"8px",cursor:"pointer"},children:"Return to Hub"})]}):"hub"===t?(0,Vp.jsx)(Hf,{onSelectGame:u,onSettings:h,userName:a}):"flashcards"===(null===i||void 0===i?void 0:i.id)?(0,Vp.jsx)(Kf,{onBackToHub:d}):"clinical-rounds"===(null===i||void 0===i?void 0:i.id)?(0,Vp.jsx)(tm,{onBackToHub:d}):(0,Vp.jsx)(qf,{onBackToHub:d,initialMode:(null===i||void 0===i||null===(e=i.modes)||void 0===e?void 0:e[0])||"study"})};i.createRoot(document.getElementById("root")).render((0,Vp.jsx)(r.StrictMode,{children:(0,Vp.jsx)(nm,{})}))})();
//# sourceMappingURL=main.d496d1f5.js.map